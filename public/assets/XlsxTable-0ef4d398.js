import{V as By,r as fu,a as QH,d as JH,c as eN,w as tN,o as nN,b as iN,n as rN}from"./index-417bad15.js";import{c as Ld,g as oN}from"./_commonjsHelpers-de833af9.js";import{r as AI}from"./worker-ref-e1853dd2.js";import{c as $d}from"./_commonjs-dynamic-modules-302442b1.js";var ju=function(t){return t&&t.Math===Math&&t},En=ju(typeof globalThis=="object"&&globalThis)||ju(typeof window=="object"&&window)||ju(typeof self=="object"&&self)||ju(typeof Ld=="object"&&Ld)||ju(typeof Ld=="object"&&Ld)||function(){return this}()||Function("return this")(),lS={},ci=function(t){try{return!!t()}catch{return!0}},sN=ci,Sr=!sN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),aN=ci,qm=!aN(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),lN=qm,kd=Function.prototype.call,Rr=lN?kd.bind(kd):function(){return kd.apply(kd,arguments)},HI={},NI={}.propertyIsEnumerable,DI=Object.getOwnPropertyDescriptor,uN=DI&&!NI.call({1:2},1);HI.f=uN?function(e){var n=DI(this,e);return!!n&&n.enumerable}:NI;var Zm=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},LI=qm,$I=Function.prototype,jy=$I.call,cN=LI&&$I.bind.bind(jy,jy),sn=LI?cN:function(t){return function(){return jy.apply(t,arguments)}},kI=sn,hN=kI({}.toString),dN=kI("".slice),ol=function(t){return dN(hN(t),8,-1)},fN=sn,gN=ci,mN=ol,dv=Object,pN=fN("".split),wN=gN(function(){return!dv("z").propertyIsEnumerable(0)})?function(t){return mN(t)==="String"?pN(t,""):dv(t)}:dv,Qm=function(t){return t==null},vN=Qm,CN=TypeError,nd=function(t){if(vN(t))throw new CN("Can't call method on "+t);return t},yN=wN,bN=nd,Jm=function(t){return yN(bN(t))},fv=typeof document=="object"&&document.all,Tn=typeof fv>"u"&&fv!==void 0?function(t){return typeof t=="function"||t===fv}:function(t){return typeof t=="function"},SN=Tn,ao=function(t){return typeof t=="object"?t!==null:SN(t)},gv=En,RN=Tn,EN=function(t){return RN(t)?t:void 0},Pu=function(t,e){return arguments.length<2?EN(gv[t]):gv[t]&&gv[t][e]},TN=sn,ep=TN({}.isPrototypeOf),MN=En,q0=MN.navigator,Z0=q0&&q0.userAgent,tp=Z0?String(Z0):"",FI=En,mv=tp,Q0=FI.process,J0=FI.Deno,eE=Q0&&Q0.versions||J0&&J0.version,tE=eE&&eE.v8,gr,em;tE&&(gr=tE.split("."),em=gr[0]>0&&gr[0]<4?1:+(gr[0]+gr[1]));!em&&mv&&(gr=mv.match(/Edge\/(\d+)/),(!gr||gr[1]>=74)&&(gr=mv.match(/Chrome\/(\d+)/),gr&&(em=+gr[1])));var _N=em,nE=_N,IN=ci,PN=En,ON=PN.String,uS=!!Object.getOwnPropertySymbols&&!IN(function(){var t=Symbol("symbol detection");return!ON(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&nE&&nE<41}),xN=uS,VI=xN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",AN=Pu,HN=Tn,NN=ep,DN=VI,LN=Object,cS=DN?function(t){return typeof t=="symbol"}:function(t){var e=AN("Symbol");return HN(e)&&NN(e.prototype,LN(t))},$N=String,np=function(t){try{return $N(t)}catch{return"Object"}},kN=Tn,FN=np,VN=TypeError,id=function(t){if(kN(t))return t;throw new VN(FN(t)+" is not a function")},WN=id,BN=Qm,ip=function(t,e){var n=t[e];return BN(n)?void 0:WN(n)},pv=Rr,wv=Tn,vv=ao,jN=TypeError,UN=function(t,e){var n,i;if(e==="string"&&wv(n=t.toString)&&!vv(i=pv(n,t))||wv(n=t.valueOf)&&!vv(i=pv(n,t))||e!=="string"&&wv(n=t.toString)&&!vv(i=pv(n,t)))return i;throw new jN("Can't convert object to primitive value")},WI={exports:{}},iE=En,zN=Object.defineProperty,hS=function(t,e){try{zN(iE,t,{value:e,configurable:!0,writable:!0})}catch{iE[t]=e}return e},YN=En,GN=hS,rE="__core-js_shared__",oE=WI.exports=YN[rE]||GN(rE,{});(oE.versions||(oE.versions=[])).push({version:"3.39.0",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var dS=WI.exports,sE=dS,BI=function(t,e){return sE[t]||(sE[t]=e||{})},KN=nd,XN=Object,rd=function(t){return XN(KN(t))},qN=sn,ZN=rd,QN=qN({}.hasOwnProperty),lo=Object.hasOwn||function(e,n){return QN(ZN(e),n)},JN=sn,eD=0,tD=Math.random(),nD=JN(1 .toString),jI=function(t){return"Symbol("+(t===void 0?"":t)+")_"+nD(++eD+tD,36)},iD=En,rD=BI,aE=lo,oD=jI,sD=uS,aD=VI,au=iD.Symbol,Cv=rD("wks"),lD=aD?au.for||au:au&&au.withoutSetter||oD,Ks=function(t){return aE(Cv,t)||(Cv[t]=sD&&aE(au,t)?au[t]:lD("Symbol."+t)),Cv[t]},uD=Rr,lE=ao,uE=cS,cD=ip,hD=UN,dD=Ks,fD=TypeError,gD=dD("toPrimitive"),mD=function(t,e){if(!lE(t)||uE(t))return t;var n=cD(t,gD),i;if(n){if(e===void 0&&(e="default"),i=uD(n,t,e),!lE(i)||uE(i))return i;throw new fD("Can't convert object to primitive value")}return e===void 0&&(e="number"),hD(t,e)},pD=mD,wD=cS,UI=function(t){var e=pD(t,"string");return wD(e)?e:e+""},vD=En,cE=ao,Uy=vD.document,CD=cE(Uy)&&cE(Uy.createElement),fS=function(t){return CD?Uy.createElement(t):{}},yD=Sr,bD=ci,SD=fS,zI=!yD&&!bD(function(){return Object.defineProperty(SD("div"),"a",{get:function(){return 7}}).a!==7}),RD=Sr,ED=Rr,TD=HI,MD=Zm,_D=Jm,ID=UI,PD=lo,OD=zI,hE=Object.getOwnPropertyDescriptor;lS.f=RD?hE:function(e,n){if(e=_D(e),n=ID(n),OD)try{return hE(e,n)}catch{}if(PD(e,n))return MD(!ED(TD.f,e,n),e[n])};var Xs={},xD=Sr,AD=ci,YI=xD&&AD(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),HD=ao,ND=String,DD=TypeError,Qo=function(t){if(HD(t))return t;throw new DD(ND(t)+" is not an object")},LD=Sr,$D=zI,kD=YI,Fd=Qo,dE=UI,FD=TypeError,yv=Object.defineProperty,VD=Object.getOwnPropertyDescriptor,bv="enumerable",Sv="configurable",Rv="writable";Xs.f=LD?kD?function(e,n,i){if(Fd(e),n=dE(n),Fd(i),typeof e=="function"&&n==="prototype"&&"value"in i&&Rv in i&&!i[Rv]){var r=VD(e,n);r&&r[Rv]&&(e[n]=i.value,i={configurable:Sv in i?i[Sv]:r[Sv],enumerable:bv in i?i[bv]:r[bv],writable:!1})}return yv(e,n,i)}:yv:function(e,n,i){if(Fd(e),n=dE(n),Fd(i),$D)try{return yv(e,n,i)}catch{}if("get"in i||"set"in i)throw new FD("Accessors not supported");return"value"in i&&(e[n]=i.value),e};var WD=Sr,BD=Xs,jD=Zm,od=WD?function(t,e,n){return BD.f(t,e,jD(1,n))}:function(t,e,n){return t[e]=n,t},GI={exports:{}},zy=Sr,UD=lo,KI=Function.prototype,zD=zy&&Object.getOwnPropertyDescriptor,gS=UD(KI,"name"),YD=gS&&(function(){}).name==="something",GD=gS&&(!zy||zy&&zD(KI,"name").configurable),KD={EXISTS:gS,PROPER:YD,CONFIGURABLE:GD},XD=sn,qD=Tn,Yy=dS,ZD=XD(Function.toString);qD(Yy.inspectSource)||(Yy.inspectSource=function(t){return ZD(t)});var QD=Yy.inspectSource,JD=En,eL=Tn,fE=JD.WeakMap,tL=eL(fE)&&/native code/.test(String(fE)),nL=BI,iL=jI,gE=nL("keys"),XI=function(t){return gE[t]||(gE[t]=iL(t))},mS={},rL=tL,qI=En,oL=ao,sL=od,Ev=lo,Tv=dS,aL=XI,lL=mS,mE="Object already initialized",Gy=qI.TypeError,uL=qI.WeakMap,tm,Th,nm,cL=function(t){return nm(t)?Th(t):tm(t,{})},hL=function(t){return function(e){var n;if(!oL(e)||(n=Th(e)).type!==t)throw new Gy("Incompatible receiver, "+t+" required");return n}};if(rL||Tv.state){var _r=Tv.state||(Tv.state=new uL);_r.get=_r.get,_r.has=_r.has,_r.set=_r.set,tm=function(t,e){if(_r.has(t))throw new Gy(mE);return e.facade=t,_r.set(t,e),e},Th=function(t){return _r.get(t)||{}},nm=function(t){return _r.has(t)}}else{var vl=aL("state");lL[vl]=!0,tm=function(t,e){if(Ev(t,vl))throw new Gy(mE);return e.facade=t,sL(t,vl,e),e},Th=function(t){return Ev(t,vl)?t[vl]:{}},nm=function(t){return Ev(t,vl)}}var dL={set:tm,get:Th,has:nm,enforce:cL,getterFor:hL},pS=sn,fL=ci,gL=Tn,Vd=lo,Ky=Sr,mL=KD.CONFIGURABLE,pL=QD,ZI=dL,wL=ZI.enforce,vL=ZI.get,pE=String,Mg=Object.defineProperty,CL=pS("".slice),yL=pS("".replace),bL=pS([].join),SL=Ky&&!fL(function(){return Mg(function(){},"length",{value:8}).length!==8}),RL=String(String).split("String"),EL=GI.exports=function(t,e,n){CL(pE(e),0,7)==="Symbol("&&(e="["+yL(pE(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Vd(t,"name")||mL&&t.name!==e)&&(Ky?Mg(t,"name",{value:e,configurable:!0}):t.name=e),SL&&n&&Vd(n,"arity")&&t.length!==n.arity&&Mg(t,"length",{value:n.arity});try{n&&Vd(n,"constructor")&&n.constructor?Ky&&Mg(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var i=wL(t);return Vd(i,"source")||(i.source=bL(RL,typeof e=="string"?e:"")),t};Function.prototype.toString=EL(function(){return gL(this)&&vL(this).source||pL(this)},"toString");var TL=GI.exports,ML=Tn,_L=Xs,IL=TL,PL=hS,OL=function(t,e,n,i){i||(i={});var r=i.enumerable,o=i.name!==void 0?i.name:e;if(ML(n)&&IL(n,o,i),i.global)r?t[e]=n:PL(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch{}r?t[e]=n:_L.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},QI={},xL=Math.ceil,AL=Math.floor,HL=Math.trunc||function(e){var n=+e;return(n>0?AL:xL)(n)},NL=HL,sd=function(t){var e=+t;return e!==e||e===0?0:NL(e)},DL=sd,LL=Math.max,$L=Math.min,kL=function(t,e){var n=DL(t);return n<0?LL(n+e,0):$L(n,e)},FL=sd,VL=Math.min,WL=function(t){var e=FL(t);return e>0?VL(e,9007199254740991):0},BL=WL,ad=function(t){return BL(t.length)},jL=Jm,UL=kL,zL=ad,wE=function(t){return function(e,n,i){var r=jL(e),o=zL(r);if(o===0)return!t&&-1;var s=UL(i,o),a;if(t&&n!==n){for(;o>s;)if(a=r[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in r)&&r[s]===n)return t||s||0;return!t&&-1}},YL={includes:wE(!0),indexOf:wE(!1)},GL=sn,Mv=lo,KL=Jm,XL=YL.indexOf,qL=mS,vE=GL([].push),JI=function(t,e){var n=KL(t),i=0,r=[],o;for(o in n)!Mv(qL,o)&&Mv(n,o)&&vE(r,o);for(;e.length>i;)Mv(n,o=e[i++])&&(~XL(r,o)||vE(r,o));return r},wS=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ZL=JI,QL=wS,JL=QL.concat("length","prototype");QI.f=Object.getOwnPropertyNames||function(e){return ZL(e,JL)};var eP={};eP.f=Object.getOwnPropertySymbols;var e$=Pu,t$=sn,n$=QI,i$=eP,r$=Qo,o$=t$([].concat),s$=e$("Reflect","ownKeys")||function(e){var n=n$.f(r$(e)),i=i$.f;return i?o$(n,i(e)):n},CE=lo,a$=s$,l$=lS,u$=Xs,tP=function(t,e,n){for(var i=a$(e),r=u$.f,o=l$.f,s=0;s<i.length;s++){var a=i[s];!CE(t,a)&&!(n&&CE(n,a))&&r(t,a,o(e,a))}},c$=ci,h$=Tn,d$=/#|\.prototype\./,ld=function(t,e){var n=g$[f$(t)];return n===p$?!0:n===m$?!1:h$(e)?c$(e):!!e},f$=ld.normalize=function(t){return String(t).replace(d$,".").toLowerCase()},g$=ld.data={},m$=ld.NATIVE="N",p$=ld.POLYFILL="P",w$=ld,Wd=En,v$=lS.f,C$=od,y$=OL,b$=hS,S$=tP,R$=w$,Mn=function(t,e){var n=t.target,i=t.global,r=t.stat,o,s,a,l,u,c;if(i?s=Wd:r?s=Wd[n]||b$(n,{}):s=Wd[n]&&Wd[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=v$(s,a),l=c&&c.value):l=s[a],o=R$(i?a:n+(r?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;S$(u,l)}(t.sham||l&&l.sham)&&C$(u,"sham",!0),y$(s,a,u,t)}},E$=qm,nP=Function.prototype,yE=nP.apply,bE=nP.call,rp=typeof Reflect=="object"&&Reflect.apply||(E$?bE.bind(yE):function(){return bE.apply(yE,arguments)}),T$=sn,M$=id,iP=function(t,e,n){try{return T$(M$(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},_$=ao,I$=function(t){return _$(t)||t===null},P$=I$,O$=String,x$=TypeError,A$=function(t){if(P$(t))return t;throw new x$("Can't set "+O$(t)+" as a prototype")},H$=iP,N$=ao,D$=nd,L$=A$,rP=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=H$(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(r,o){return D$(r),L$(o),N$(r)&&(t?n(r,o):r.__proto__=o),r}}():void 0),$$=Xs.f,k$=function(t,e,n){n in t||$$(t,n,{configurable:!0,get:function(){return e[n]},set:function(i){e[n]=i}})},F$=Tn,V$=ao,SE=rP,W$=function(t,e,n){var i,r;return SE&&F$(i=e.constructor)&&i!==n&&V$(r=i.prototype)&&r!==n.prototype&&SE(t,r),t},B$=Ks,j$=B$("toStringTag"),oP={};oP[j$]="z";var U$=String(oP)==="[object z]",z$=U$,Y$=Tn,_g=ol,G$=Ks,K$=G$("toStringTag"),X$=Object,q$=_g(function(){return arguments}())==="Arguments",Z$=function(t,e){try{return t[e]}catch{}},sP=z$?_g:function(t){var e,n,i;return t===void 0?"Undefined":t===null?"Null":typeof(n=Z$(e=X$(t),K$))=="string"?n:q$?_g(e):(i=_g(e))==="Object"&&Y$(e.callee)?"Arguments":i},Q$=sP,J$=String,op=function(t){if(Q$(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return J$(t)},ek=op,tk=function(t,e){return t===void 0?arguments.length<2?"":e:ek(t)},nk=ao,ik=od,rk=function(t,e){nk(e)&&"cause"in e&&ik(t,"cause",e.cause)},ok=sn,aP=Error,sk=ok("".replace),ak=function(t){return String(new aP(t).stack)}("zxcasd"),lP=/\n\s*at [^:]*:[^\n]*/,lk=lP.test(ak),uk=function(t,e){if(lk&&typeof t=="string"&&!aP.prepareStackTrace)for(;e--;)t=sk(t,lP,"");return t},ck=ci,hk=Zm,dk=!ck(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",hk(1,7)),t.stack!==7):!0}),fk=od,gk=uk,mk=dk,RE=Error.captureStackTrace,pk=function(t,e,n,i){mk&&(RE?RE(t,e):fk(t,"stack",gk(n,i)))},EE=Pu,wk=lo,TE=od,vk=ep,ME=rP,_E=tP,IE=k$,Ck=W$,yk=tk,bk=rk,Sk=pk,Rk=Sr,Ek=function(t,e,n,i){var r="stackTraceLimit",o=i?2:1,s=t.split("."),a=s[s.length-1],l=EE.apply(null,s);if(l){var u=l.prototype;if(wk(u,"cause")&&delete u.cause,!n)return l;var c=EE("Error"),h=e(function(d,g){var m=yk(i?g:d,void 0),w=i?new l(d):new l;return m!==void 0&&TE(w,"message",m),Sk(w,h,w.stack,2),this&&vk(u,this)&&Ck(w,this,h),arguments.length>o&&bk(w,arguments[o]),w});h.prototype=u,a!=="Error"?ME?ME(h,c):_E(h,c,{name:!0}):Rk&&r in l&&(IE(h,l,r),IE(h,l,"prepareStackTrace")),_E(h,l);try{u.name!==a&&TE(u,"name",a),u.constructor=h}catch{}return h}},uP=Mn,Tk=En,uo=rp,cP=Ek,Xy="WebAssembly",PE=Tk[Xy],im=new Error("e",{cause:7}).cause!==7,sl=function(t,e){var n={};n[t]=cP(t,e,im),uP({global:!0,constructor:!0,arity:1,forced:im},n)},vS=function(t,e){if(PE&&PE[t]){var n={};n[t]=cP(Xy+"."+t,e,im),uP({target:Xy,stat:!0,constructor:!0,arity:1,forced:im},n)}};sl("Error",function(t){return function(n){return uo(t,this,arguments)}});sl("EvalError",function(t){return function(n){return uo(t,this,arguments)}});sl("RangeError",function(t){return function(n){return uo(t,this,arguments)}});sl("ReferenceError",function(t){return function(n){return uo(t,this,arguments)}});sl("SyntaxError",function(t){return function(n){return uo(t,this,arguments)}});sl("TypeError",function(t){return function(n){return uo(t,this,arguments)}});sl("URIError",function(t){return function(n){return uo(t,this,arguments)}});vS("CompileError",function(t){return function(n){return uo(t,this,arguments)}});vS("LinkError",function(t){return function(n){return uo(t,this,arguments)}});vS("RuntimeError",function(t){return function(n){return uo(t,this,arguments)}});var Mk=ol,hP=Array.isArray||function(e){return Mk(e)==="Array"},_k=Sr,Ik=hP,Pk=TypeError,Ok=Object.getOwnPropertyDescriptor,xk=_k&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),dP=xk?function(t,e){if(Ik(t)&&!Ok(t,"length").writable)throw new Pk("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Ak=TypeError,Hk=9007199254740991,fP=function(t){if(t>Hk)throw Ak("Maximum allowed index exceeded");return t},Nk=Mn,Dk=rd,Lk=ad,$k=dP,kk=fP,Fk=ci,Vk=Fk(function(){return[].push.call({length:4294967296},1)!==4294967297}),Wk=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},Bk=Vk||!Wk();Nk({target:"Array",proto:!0,arity:1,forced:Bk},{push:function(e){var n=Dk(this),i=Lk(n),r=arguments.length;kk(i+r);for(var o=0;o<r;o++)n[i]=arguments[o],i++;return $k(n,i),i}});var _v=sn,Bd=Set.prototype,co={Set,add:_v(Bd.add),has:_v(Bd.has),remove:_v(Bd.delete),proto:Bd},jk=co.has,al=function(t){return jk(t),t},Uk=Rr,ll=function(t,e,n){for(var i=n?t:t.iterator,r=t.next,o,s;!(o=Uk(r,i)).done;)if(s=e(o.value),s!==void 0)return s},gP=sn,zk=ll,mP=co,Yk=mP.Set,pP=mP.proto,Gk=gP(pP.forEach),wP=gP(pP.keys),Kk=wP(new Yk).next,ud=function(t,e,n){return n?zk({iterator:wP(t),next:Kk},e):Gk(t,e)},vP=co,Xk=ud,qk=vP.Set,Zk=vP.add,CS=function(t){var e=new qk;return Xk(t,function(n){Zk(e,n)}),e},Qk=iP,Jk=co,cd=Qk(Jk.proto,"size","get")||function(t){return t.size},eF=function(t){return{iterator:t,next:t.next,done:!1}},OE=id,CP=Qo,xE=Rr,tF=sd,nF=eF,AE="Invalid size",iF=RangeError,rF=TypeError,oF=Math.max,yP=function(t,e){this.set=t,this.size=oF(e,0),this.has=OE(t.has),this.keys=OE(t.keys)};yP.prototype={getIterator:function(){return nF(CP(xE(this.keys,this.set)))},includes:function(t){return xE(this.has,this.set,t)}};var ul=function(t){CP(t);var e=+t.size;if(e!==e)throw new rF(AE);var n=tF(e);if(n<0)throw new iF(AE);return new yP(t,n)},sF=al,bP=co,aF=CS,lF=cd,uF=ul,cF=ud,hF=ll,dF=bP.has,HE=bP.remove,fF=function(e){var n=sF(this),i=uF(e),r=aF(n);return lF(n)<=i.size?cF(n,function(o){i.includes(o)&&HE(r,o)}):hF(i.getIterator(),function(o){dF(n,o)&&HE(r,o)}),r},gF=Pu,NE=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},cl=function(t){var e=gF("Set");try{new e()[t](NE(0));try{return new e()[t](NE(-1)),!1}catch{return!0}}catch{return!1}},mF=Mn,pF=fF,wF=cl;mF({target:"Set",proto:!0,real:!0,forced:!wF("difference")},{difference:pF});var vF=al,yS=co,CF=cd,yF=ul,bF=ud,SF=ll,RF=yS.Set,DE=yS.add,EF=yS.has,TF=function(e){var n=vF(this),i=yF(e),r=new RF;return CF(n)>i.size?SF(i.getIterator(),function(o){EF(n,o)&&DE(r,o)}):bF(n,function(o){i.includes(o)&&DE(r,o)}),r},MF=Mn,_F=ci,IF=TF,PF=cl,OF=!PF("intersection")||_F(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});MF({target:"Set",proto:!0,real:!0,forced:OF},{intersection:IF});var xF=Rr,LE=Qo,AF=ip,bS=function(t,e,n){var i,r;LE(t);try{if(i=AF(t,"return"),!i){if(e==="throw")throw n;return n}i=xF(i,t)}catch(o){r=!0,i=o}if(e==="throw")throw n;if(r)throw i;return LE(i),n},HF=al,NF=co.has,DF=cd,LF=ul,$F=ud,kF=ll,FF=bS,VF=function(e){var n=HF(this),i=LF(e);if(DF(n)<=i.size)return $F(n,function(o){if(i.includes(o))return!1},!0)!==!1;var r=i.getIterator();return kF(r,function(o){if(NF(n,o))return FF(r,"normal",!1)})!==!1},WF=Mn,BF=VF,jF=cl;WF({target:"Set",proto:!0,real:!0,forced:!jF("isDisjointFrom")},{isDisjointFrom:BF});var UF=al,zF=cd,YF=ud,GF=ul,KF=function(e){var n=UF(this),i=GF(e);return zF(n)>i.size?!1:YF(n,function(r){if(!i.includes(r))return!1},!0)!==!1},XF=Mn,qF=KF,ZF=cl;XF({target:"Set",proto:!0,real:!0,forced:!ZF("isSubsetOf")},{isSubsetOf:qF});var QF=al,JF=co.has,eV=cd,tV=ul,nV=ll,iV=bS,rV=function(e){var n=QF(this),i=tV(e);if(eV(n)<i.size)return!1;var r=i.getIterator();return nV(r,function(o){if(!JF(n,o))return iV(r,"normal",!1)})!==!1},oV=Mn,sV=rV,aV=cl;oV({target:"Set",proto:!0,real:!0,forced:!aV("isSupersetOf")},{isSupersetOf:sV});var lV=al,SS=co,uV=CS,cV=ul,hV=ll,dV=SS.add,fV=SS.has,gV=SS.remove,mV=function(e){var n=lV(this),i=cV(e).getIterator(),r=uV(n);return hV(i,function(o){fV(n,o)?gV(r,o):dV(r,o)}),r},pV=Mn,wV=mV,vV=cl;pV({target:"Set",proto:!0,real:!0,forced:!vV("symmetricDifference")},{symmetricDifference:wV});var CV=al,yV=co.add,bV=CS,SV=ul,RV=ll,EV=function(e){var n=CV(this),i=SV(e).getIterator(),r=bV(n);return RV(i,function(o){yV(r,o)}),r},TV=Mn,MV=EV,_V=cl;TV({target:"Set",proto:!0,real:!0,forced:!_V("union")},{union:MV});var IV=ol,PV=sn,OV=function(t){if(IV(t)==="Function")return PV(t)},$E=OV,xV=id,AV=qm,HV=$E($E.bind),SP=function(t,e){return xV(t),e===void 0?t:AV?HV(t,e):function(){return t.apply(e,arguments)}},NV=Pu,RP=NV("document","documentElement"),DV=sn,RS=DV([].slice),LV=TypeError,EP=function(t,e){if(t<e)throw new LV("Not enough arguments");return t},$V=tp,kV=/(?:ipad|iphone|ipod).*applewebkit/i.test($V),Uu=En,FV=tp,VV=ol,jd=function(t){return FV.slice(0,t.length)===t},TP=function(){return jd("Bun/")?"BUN":jd("Cloudflare-Workers")?"CLOUDFLARE":jd("Deno/")?"DENO":jd("Node.js/")?"NODE":Uu.Bun&&typeof Bun.version=="string"?"BUN":Uu.Deno&&typeof Deno.version=="object"?"DENO":VV(Uu.process)==="process"?"NODE":Uu.window&&Uu.document?"BROWSER":"REST"}(),WV=TP,BV=WV==="NODE",Si=En,jV=rp,UV=SP,kE=Tn,zV=lo,MP=ci,FE=RP,YV=RS,VE=fS,GV=EP,KV=kV,XV=BV,qy=Si.setImmediate,Zy=Si.clearImmediate,qV=Si.process,Iv=Si.Dispatch,ZV=Si.Function,WE=Si.MessageChannel,QV=Si.String,Pv=0,Jc={},BE="onreadystatechange",Mh,Js,Ov,xv;MP(function(){Mh=Si.location});var ES=function(t){if(zV(Jc,t)){var e=Jc[t];delete Jc[t],e()}},Av=function(t){return function(){ES(t)}},jE=function(t){ES(t.data)},UE=function(t){Si.postMessage(QV(t),Mh.protocol+"//"+Mh.host)};(!qy||!Zy)&&(qy=function(e){GV(arguments.length,1);var n=kE(e)?e:ZV(e),i=YV(arguments,1);return Jc[++Pv]=function(){jV(n,void 0,i)},Js(Pv),Pv},Zy=function(e){delete Jc[e]},XV?Js=function(t){qV.nextTick(Av(t))}:Iv&&Iv.now?Js=function(t){Iv.now(Av(t))}:WE&&!KV?(Ov=new WE,xv=Ov.port2,Ov.port1.onmessage=jE,Js=UV(xv.postMessage,xv)):Si.addEventListener&&kE(Si.postMessage)&&!Si.importScripts&&Mh&&Mh.protocol!=="file:"&&!MP(UE)?(Js=UE,Si.addEventListener("message",jE,!1)):BE in VE("script")?Js=function(t){FE.appendChild(VE("script"))[BE]=function(){FE.removeChild(this),ES(t)}}:Js=function(t){setTimeout(Av(t),0)});var _P={set:qy,clear:Zy},JV=Mn,eW=En,zE=_P.clear;JV({global:!0,bind:!0,enumerable:!0,forced:eW.clearImmediate!==zE},{clearImmediate:zE});var IP=En,tW=rp,nW=Tn,iW=TP,rW=tp,oW=RS,sW=EP,aW=IP.Function,lW=/MSIE .\./.test(rW)||iW==="BUN"&&function(){var t=IP.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),uW=function(t,e){var n=e?2:1;return lW?function(i,r){var o=sW(arguments.length,1)>n,s=nW(i)?i:aW(i),a=o?oW(arguments,n):[],l=o?function(){tW(s,this,a)}:s;return e?t(l,r):t(l)}:t},cW=Mn,PP=En,YE=_P.set,hW=uW,GE=PP.setImmediate?hW(YE,!1):YE;cW({global:!0,bind:!0,enumerable:!0,forced:PP.setImmediate!==GE},{setImmediate:GE});/*! @license DOMPurify 2.5.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.8/LICENSE */function Ts(t){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ts(t)}function Qy(t,e){return Qy=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Qy(t,e)}function dW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ig(t,e,n){return dW()?Ig=Reflect.construct:Ig=function(r,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(r,a),u=new l;return s&&Qy(u,s.prototype),u},Ig.apply(null,arguments)}function ar(t){return fW(t)||gW(t)||mW(t)||pW()}function fW(t){if(Array.isArray(t))return Jy(t)}function gW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function mW(t,e){if(t){if(typeof t=="string")return Jy(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jy(t,e)}}function Jy(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function pW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var wW=Object.hasOwnProperty,KE=Object.setPrototypeOf,vW=Object.isFrozen,CW=Object.getPrototypeOf,yW=Object.getOwnPropertyDescriptor,Gn=Object.freeze,Ui=Object.seal,bW=Object.create,OP=typeof Reflect<"u"&&Reflect,rm=OP.apply,eb=OP.construct;rm||(rm=function(e,n,i){return e.apply(n,i)});Gn||(Gn=function(e){return e});Ui||(Ui=function(e){return e});eb||(eb=function(e,n){return Ig(e,ar(n))});var SW=zi(Array.prototype.forEach),XE=zi(Array.prototype.pop),zu=zi(Array.prototype.push),Pg=zi(String.prototype.toLowerCase),Hv=zi(String.prototype.toString),qE=zi(String.prototype.match),Zi=zi(String.prototype.replace),RW=zi(String.prototype.indexOf),EW=zi(String.prototype.trim),Rn=zi(RegExp.prototype.test),Nv=TW(TypeError);function zi(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return rm(t,e,i)}}function TW(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return eb(t,n)}}function Ue(t,e,n){var i;n=(i=n)!==null&&i!==void 0?i:Pg,KE&&KE(t,null);for(var r=e.length;r--;){var o=e[r];if(typeof o=="string"){var s=n(o);s!==o&&(vW(e)||(e[r]=s),o=s)}t[o]=!0}return t}function ea(t){var e=bW(null),n;for(n in t)rm(wW,t,[n])===!0&&(e[n]=t[n]);return e}function Ud(t,e){for(;t!==null;){var n=yW(t,e);if(n){if(n.get)return zi(n.get);if(typeof n.value=="function")return zi(n.value)}t=CW(t)}function i(r){return console.warn("fallback value for",r),null}return i}var ZE=Gn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Dv=Gn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Lv=Gn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),MW=Gn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),$v=Gn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),_W=Gn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),QE=Gn(["#text"]),JE=Gn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),kv=Gn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),eT=Gn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zd=Gn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),IW=Ui(/\{\{[\w\W]*|[\w\W]*\}\}/gm),PW=Ui(/<%[\w\W]*|[\w\W]*%>/gm),OW=Ui(/\${[\w\W]*}/gm),xW=Ui(/^data-[\-\w.\u00B7-\uFFFF]+$/),AW=Ui(/^aria-[\-\w]+$/),HW=Ui(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),NW=Ui(/^(?:\w+script|data):/i),DW=Ui(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),LW=Ui(/^html$/i),$W=Ui(/^[a-z][.\w]*(-[.\w]+)+$/i),kW=function(){return typeof window>"u"?null:window},FW=function(e,n){if(Ts(e)!=="object"||typeof e.createPolicy!="function")return null;var i=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(i=n.currentScript.getAttribute(r));var o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function xP(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:kW(),e=function(A){return xP(A)};if(e.version="2.5.8",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,i=t.document,r=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,d=t.DOMParser,g=t.trustedTypes,m=a.prototype,w=Ud(m,"cloneNode"),C=Ud(m,"nextSibling"),S=Ud(m,"childNodes"),R=Ud(m,"parentNode");if(typeof o=="function"){var E=i.createElement("template");E.content&&E.content.ownerDocument&&(i=E.content.ownerDocument)}var H=FW(g,n),P=H?H.createHTML(""):"",B=i,j=B.implementation,Y=B.createNodeIterator,G=B.createDocumentFragment,z=B.getElementsByTagName,J=n.importNode,Z={};try{Z=ea(i).documentMode?i.documentMode:{}}catch{}var re={};e.isSupported=typeof R=="function"&&j&&j.createHTMLDocument!==void 0&&Z!==9;var pe=IW,Ie=PW,tt=OW,Ne=xW,ye=AW,we=NW,pt=DW,f=$W,p=HW,v=null,_=Ue({},[].concat(ar(ZE),ar(Dv),ar(Lv),ar($v),ar(QE))),O=null,F=Ue({},[].concat(ar(JE),ar(kv),ar(eT),ar(zd))),U=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,ue=null,he=!0,Q=!0,Ae=!1,Oe=!0,W=!1,Xe=!0,Ye=!1,nt=!1,Ve=!1,Te=!1,y=!1,b=!1,T=!0,$=!1,I="user-content-",k=!0,N=!1,x={},L=null,D=Ue({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),V=null,ne=Ue({},["audio","video","img","source","image","track"]),ce=null,Se=Ue({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$e="http://www.w3.org/1998/Math/MathML",Ze="http://www.w3.org/2000/svg",je="http://www.w3.org/1999/xhtml",Pe=je,Je=!1,kt=null,wl=Ue({},[$e,Ze,je],Hv),qi,Wu=["application/xhtml+xml","text/html"],Ei="text/html",Nt,an=null,bn=i.createElement("form"),Pt=function(A){return A instanceof RegExp||A instanceof Function},lv=function(A){an&&an===A||((!A||Ts(A)!=="object")&&(A={}),A=ea(A),qi=Wu.indexOf(A.PARSER_MEDIA_TYPE)===-1?qi=Ei:qi=A.PARSER_MEDIA_TYPE,Nt=qi==="application/xhtml+xml"?Hv:Pg,v="ALLOWED_TAGS"in A?Ue({},A.ALLOWED_TAGS,Nt):_,O="ALLOWED_ATTR"in A?Ue({},A.ALLOWED_ATTR,Nt):F,kt="ALLOWED_NAMESPACES"in A?Ue({},A.ALLOWED_NAMESPACES,Hv):wl,ce="ADD_URI_SAFE_ATTR"in A?Ue(ea(Se),A.ADD_URI_SAFE_ATTR,Nt):Se,V="ADD_DATA_URI_TAGS"in A?Ue(ea(ne),A.ADD_DATA_URI_TAGS,Nt):ne,L="FORBID_CONTENTS"in A?Ue({},A.FORBID_CONTENTS,Nt):D,K="FORBID_TAGS"in A?Ue({},A.FORBID_TAGS,Nt):{},ue="FORBID_ATTR"in A?Ue({},A.FORBID_ATTR,Nt):{},x="USE_PROFILES"in A?A.USE_PROFILES:!1,he=A.ALLOW_ARIA_ATTR!==!1,Q=A.ALLOW_DATA_ATTR!==!1,Ae=A.ALLOW_UNKNOWN_PROTOCOLS||!1,Oe=A.ALLOW_SELF_CLOSE_IN_ATTR!==!1,W=A.SAFE_FOR_TEMPLATES||!1,Xe=A.SAFE_FOR_XML!==!1,Ye=A.WHOLE_DOCUMENT||!1,Te=A.RETURN_DOM||!1,y=A.RETURN_DOM_FRAGMENT||!1,b=A.RETURN_TRUSTED_TYPE||!1,Ve=A.FORCE_BODY||!1,T=A.SANITIZE_DOM!==!1,$=A.SANITIZE_NAMED_PROPS||!1,k=A.KEEP_CONTENT!==!1,N=A.IN_PLACE||!1,p=A.ALLOWED_URI_REGEXP||p,Pe=A.NAMESPACE||je,U=A.CUSTOM_ELEMENT_HANDLING||{},A.CUSTOM_ELEMENT_HANDLING&&Pt(A.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=A.CUSTOM_ELEMENT_HANDLING.tagNameCheck),A.CUSTOM_ELEMENT_HANDLING&&Pt(A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),A.CUSTOM_ELEMENT_HANDLING&&typeof A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(U.allowCustomizedBuiltInElements=A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),W&&(Q=!1),y&&(Te=!0),x&&(v=Ue({},ar(QE)),O=[],x.html===!0&&(Ue(v,ZE),Ue(O,JE)),x.svg===!0&&(Ue(v,Dv),Ue(O,kv),Ue(O,zd)),x.svgFilters===!0&&(Ue(v,Lv),Ue(O,kv),Ue(O,zd)),x.mathMl===!0&&(Ue(v,$v),Ue(O,eT),Ue(O,zd))),A.ADD_TAGS&&(v===_&&(v=ea(v)),Ue(v,A.ADD_TAGS,Nt)),A.ADD_ATTR&&(O===F&&(O=ea(O)),Ue(O,A.ADD_ATTR,Nt)),A.ADD_URI_SAFE_ATTR&&Ue(ce,A.ADD_URI_SAFE_ATTR,Nt),A.FORBID_CONTENTS&&(L===D&&(L=ea(L)),Ue(L,A.FORBID_CONTENTS,Nt)),k&&(v["#text"]=!0),Ye&&Ue(v,["html","head","body"]),v.table&&(Ue(v,["tbody"]),delete K.tbody),Gn&&Gn(A),an=A)},W0=Ue({},["mi","mo","mn","ms","mtext"]),B0=Ue({},["annotation-xml"]),XH=Ue({},["title","style","font","a","script"]),Nd=Ue({},Dv);Ue(Nd,Lv),Ue(Nd,MW);var uv=Ue({},$v);Ue(uv,_W);var qH=function(A){var te=R(A);(!te||!te.tagName)&&(te={namespaceURI:Pe,tagName:"template"});var le=Pg(A.tagName),ut=Pg(te.tagName);return kt[A.namespaceURI]?A.namespaceURI===Ze?te.namespaceURI===je?le==="svg":te.namespaceURI===$e?le==="svg"&&(ut==="annotation-xml"||W0[ut]):!!Nd[le]:A.namespaceURI===$e?te.namespaceURI===je?le==="math":te.namespaceURI===Ze?le==="math"&&B0[ut]:!!uv[le]:A.namespaceURI===je?te.namespaceURI===Ze&&!B0[ut]||te.namespaceURI===$e&&!W0[ut]?!1:!uv[le]&&(XH[le]||!Nd[le]):!!(qi==="application/xhtml+xml"&&kt[A.namespaceURI]):!1},Ti=function(A){zu(e.removed,{element:A});try{A.parentNode.removeChild(A)}catch{try{A.outerHTML=P}catch{A.remove()}}},Dd=function(A,te){try{zu(e.removed,{attribute:te.getAttributeNode(A),from:te})}catch{zu(e.removed,{attribute:null,from:te})}if(te.removeAttribute(A),A==="is"&&!O[A])if(Te||y)try{Ti(te)}catch{}else try{te.setAttribute(A,"")}catch{}},j0=function(A){var te,le;if(Ve)A="<remove></remove>"+A;else{var ut=qE(A,/^[\r\n\t ]+/);le=ut&&ut[0]}qi==="application/xhtml+xml"&&Pe===je&&(A='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+A+"</body></html>");var Xn=H?H.createHTML(A):A;if(Pe===je)try{te=new d().parseFromString(Xn,qi)}catch{}if(!te||!te.documentElement){te=j.createDocument(Pe,"template",null);try{te.documentElement.innerHTML=Je?P:Xn}catch{}}var _n=te.body||te.documentElement;return A&&le&&_n.insertBefore(i.createTextNode(le),_n.childNodes[0]||null),Pe===je?z.call(te,Ye?"html":"body")[0]:Ye?te.documentElement:_n},U0=function(A){return Y.call(A.ownerDocument||A,A,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},cv=function(A){return A instanceof h&&(typeof A.nodeName!="string"||typeof A.textContent!="string"||typeof A.removeChild!="function"||!(A.attributes instanceof c)||typeof A.removeAttribute!="function"||typeof A.setAttribute!="function"||typeof A.namespaceURI!="string"||typeof A.insertBefore!="function"||typeof A.hasChildNodes!="function")},Bu=function(A){return Ts(s)==="object"?A instanceof s:A&&Ts(A)==="object"&&typeof A.nodeType=="number"&&typeof A.nodeName=="string"},mo=function(A,te,le){re[A]&&SW(re[A],function(ut){ut.call(e,te,le,an)})},z0=function(A){var te;if(mo("beforeSanitizeElements",A,null),cv(A)||Rn(/[\u0080-\uFFFF]/,A.nodeName))return Ti(A),!0;var le=Nt(A.nodeName);if(mo("uponSanitizeElement",A,{tagName:le,allowedTags:v}),A.hasChildNodes()&&!Bu(A.firstElementChild)&&(!Bu(A.content)||!Bu(A.content.firstElementChild))&&Rn(/<[/\w]/g,A.innerHTML)&&Rn(/<[/\w]/g,A.textContent)||le==="select"&&Rn(/<template/i,A.innerHTML)||A.nodeType===7||Xe&&A.nodeType===8&&Rn(/<[/\w]/g,A.data))return Ti(A),!0;if(!v[le]||K[le]){if(!K[le]&&G0(le)&&(U.tagNameCheck instanceof RegExp&&Rn(U.tagNameCheck,le)||U.tagNameCheck instanceof Function&&U.tagNameCheck(le)))return!1;if(k&&!L[le]){var ut=R(A)||A.parentNode,Xn=S(A)||A.childNodes;if(Xn&&ut)for(var _n=Xn.length,Sn=_n-1;Sn>=0;--Sn){var Qs=w(Xn[Sn],!0);Qs.__removalCount=(A.__removalCount||0)+1,ut.insertBefore(Qs,C(A))}}return Ti(A),!0}return A instanceof a&&!qH(A)||(le==="noscript"||le==="noembed"||le==="noframes")&&Rn(/<\/no(script|embed|frames)/i,A.innerHTML)?(Ti(A),!0):(W&&A.nodeType===3&&(te=A.textContent,te=Zi(te,pe," "),te=Zi(te,Ie," "),te=Zi(te,tt," "),A.textContent!==te&&(zu(e.removed,{element:A.cloneNode()}),A.textContent=te)),mo("afterSanitizeElements",A,null),!1)},Y0=function(A,te,le){if(T&&(te==="id"||te==="name")&&(le in i||le in bn))return!1;if(!(Q&&!ue[te]&&Rn(Ne,te))){if(!(he&&Rn(ye,te))){if(!O[te]||ue[te]){if(!(G0(A)&&(U.tagNameCheck instanceof RegExp&&Rn(U.tagNameCheck,A)||U.tagNameCheck instanceof Function&&U.tagNameCheck(A))&&(U.attributeNameCheck instanceof RegExp&&Rn(U.attributeNameCheck,te)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(te))||te==="is"&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&Rn(U.tagNameCheck,le)||U.tagNameCheck instanceof Function&&U.tagNameCheck(le))))return!1}else if(!ce[te]){if(!Rn(p,Zi(le,pt,""))){if(!((te==="src"||te==="xlink:href"||te==="href")&&A!=="script"&&RW(le,"data:")===0&&V[A])){if(!(Ae&&!Rn(we,Zi(le,pt,"")))){if(le)return!1}}}}}}return!0},G0=function(A){return A!=="annotation-xml"&&qE(A,f)},K0=function(A){var te,le,ut,Xn;mo("beforeSanitizeAttributes",A,null);var _n=A.attributes;if(!(!_n||cv(A))){var Sn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:O};for(Xn=_n.length;Xn--;){te=_n[Xn];var Qs=te,ln=Qs.name,hv=Qs.namespaceURI;if(le=ln==="value"?te.value:EW(te.value),ut=Nt(ln),Sn.attrName=ut,Sn.attrValue=le,Sn.keepAttr=!0,Sn.forceKeepAttr=void 0,mo("uponSanitizeAttribute",A,Sn),le=Sn.attrValue,!Sn.forceKeepAttr&&(Dd(ln,A),!!Sn.keepAttr)){if(!Oe&&Rn(/\/>/i,le)){Dd(ln,A);continue}W&&(le=Zi(le,pe," "),le=Zi(le,Ie," "),le=Zi(le,tt," "));var X0=Nt(A.nodeName);if(Y0(X0,ut,le)){if($&&(ut==="id"||ut==="name")&&(Dd(ln,A),le=I+le),Xe&&Rn(/((--!?|])>)|<\/(style|title)/i,le)){Dd(ln,A);continue}if(H&&Ts(g)==="object"&&typeof g.getAttributeType=="function"&&!hv)switch(g.getAttributeType(X0,ut)){case"TrustedHTML":{le=H.createHTML(le);break}case"TrustedScriptURL":{le=H.createScriptURL(le);break}}try{hv?A.setAttributeNS(hv,ln,le):A.setAttribute(ln,le),cv(A)?Ti(A):XE(e.removed)}catch{}}}}mo("afterSanitizeAttributes",A,null)}},ZH=function Re(A){var te,le=U0(A);for(mo("beforeSanitizeShadowDOM",A,null);te=le.nextNode();)mo("uponSanitizeShadowNode",te,null),z0(te),K0(te),te.content instanceof r&&Re(te.content);mo("afterSanitizeShadowDOM",A,null)};return e.sanitize=function(Re){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},te,le,ut,Xn,_n;if(Je=!Re,Je&&(Re="<!-->"),typeof Re!="string"&&!Bu(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw Nv("dirty is not a string, aborting")}else throw Nv("toString is not a function");if(!e.isSupported){if(Ts(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Re=="string")return t.toStaticHTML(Re);if(Bu(Re))return t.toStaticHTML(Re.outerHTML)}return Re}if(nt||lv(A),e.removed=[],typeof Re=="string"&&(N=!1),N){if(Re.nodeName){var Sn=Nt(Re.nodeName);if(!v[Sn]||K[Sn])throw Nv("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof s)te=j0("<!---->"),le=te.ownerDocument.importNode(Re,!0),le.nodeType===1&&le.nodeName==="BODY"||le.nodeName==="HTML"?te=le:te.appendChild(le);else{if(!Te&&!W&&!Ye&&Re.indexOf("<")===-1)return H&&b?H.createHTML(Re):Re;if(te=j0(Re),!te)return Te?null:b?P:""}te&&Ve&&Ti(te.firstChild);for(var Qs=U0(N?Re:te);ut=Qs.nextNode();)ut.nodeType===3&&ut===Xn||(z0(ut),K0(ut),ut.content instanceof r&&ZH(ut.content),Xn=ut);if(Xn=null,N)return Re;if(Te){if(y)for(_n=G.call(te.ownerDocument);te.firstChild;)_n.appendChild(te.firstChild);else _n=te;return(O.shadowroot||O.shadowrootmod)&&(_n=J.call(n,_n,!0)),_n}var ln=Ye?te.outerHTML:te.innerHTML;return Ye&&v["!doctype"]&&te.ownerDocument&&te.ownerDocument.doctype&&te.ownerDocument.doctype.name&&Rn(LW,te.ownerDocument.doctype.name)&&(ln="<!DOCTYPE "+te.ownerDocument.doctype.name+`>
`+ln),W&&(ln=Zi(ln,pe," "),ln=Zi(ln,Ie," "),ln=Zi(ln,tt," ")),H&&b?H.createHTML(ln):ln},e.setConfig=function(Re){lv(Re),nt=!0},e.clearConfig=function(){an=null,nt=!1},e.isValidAttribute=function(Re,A,te){an||lv({});var le=Nt(Re),ut=Nt(A);return Y0(le,ut,te)},e.addHook=function(Re,A){typeof A=="function"&&(re[Re]=re[Re]||[],zu(re[Re],A))},e.removeHook=function(Re){if(re[Re])return XE(re[Re])},e.removeHooks=function(Re){re[Re]&&(re[Re]=[])},e.removeAllHooks=function(){re={}},e}var VW=xP();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var AP;function q(){return AP.apply(null,arguments)}function WW(t){AP=t}function vr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function qa(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function at(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function TS(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(at(t,e))return!1;return!0}function ii(t){return t===void 0}function Ko(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function hd(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function HP(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function Os(t,e){for(var n in e)at(e,n)&&(t[n]=e[n]);return at(e,"toString")&&(t.toString=e.toString),at(e,"valueOf")&&(t.valueOf=e.valueOf),t}function ho(t,e,n,i){return nO(t,e,n,i,!0).utc()}function BW(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function We(t){return t._pf==null&&(t._pf=BW()),t._pf}var tb;Array.prototype.some?tb=Array.prototype.some:tb=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function MS(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=We(t),n=tb.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function sp(t){var e=ho(NaN);return t!=null?Os(We(e),t):We(e).userInvalidated=!0,e}var tT=q.momentProperties=[],Fv=!1;function _S(t,e){var n,i,r,o=tT.length;if(ii(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ii(e._i)||(t._i=e._i),ii(e._f)||(t._f=e._f),ii(e._l)||(t._l=e._l),ii(e._strict)||(t._strict=e._strict),ii(e._tzm)||(t._tzm=e._tzm),ii(e._isUTC)||(t._isUTC=e._isUTC),ii(e._offset)||(t._offset=e._offset),ii(e._pf)||(t._pf=We(e)),ii(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)i=tT[n],r=e[i],ii(r)||(t[i]=r);return t}function dd(t){_S(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Fv===!1&&(Fv=!0,q.updateOffset(this),Fv=!1)}function Cr(t){return t instanceof dd||t!=null&&t._isAMomentObject!=null}function NP(t){q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Gi(t,e){var n=!0;return Os(function(){if(q.deprecationHandler!=null&&q.deprecationHandler(null,t),n){var i=[],r,o,s,a=arguments.length;for(o=0;o<a;o++){if(r="",typeof arguments[o]=="object"){r+=`
[`+o+"] ";for(s in arguments[0])at(arguments[0],s)&&(r+=s+": "+arguments[0][s]+", ");r=r.slice(0,-2)}else r=arguments[o];i.push(r)}NP(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var nT={};function DP(t,e){q.deprecationHandler!=null&&q.deprecationHandler(t,e),nT[t]||(NP(e),nT[t]=!0)}q.suppressDeprecationWarnings=!1;q.deprecationHandler=null;function fo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function jW(t){var e,n;for(n in t)at(t,n)&&(e=t[n],fo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function nb(t,e){var n=Os({},t),i;for(i in e)at(e,i)&&(qa(t[i])&&qa(e[i])?(n[i]={},Os(n[i],t[i]),Os(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)at(t,i)&&!at(e,i)&&qa(t[i])&&(n[i]=Os({},n[i]));return n}function IS(t){t!=null&&this.set(t)}var ib;Object.keys?ib=Object.keys:ib=function(t){var e,n=[];for(e in t)at(t,e)&&n.push(e);return n};var UW={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function zW(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return fo(i)?i.call(e,n):i}function oo(t,e,n){var i=""+Math.abs(t),r=e-i.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var PS=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Yd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Vv={},gu={};function Ee(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(gu[t]=r),e&&(gu[e[0]]=function(){return oo(r.apply(this,arguments),e[1],e[2])}),n&&(gu[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function YW(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function GW(t){var e=t.match(PS),n,i;for(n=0,i=e.length;n<i;n++)gu[e[n]]?e[n]=gu[e[n]]:e[n]=YW(e[n]);return function(r){var o="",s;for(s=0;s<i;s++)o+=fo(e[s])?e[s].call(r,t):e[s];return o}}function Og(t,e){return t.isValid()?(e=LP(e,t.localeData()),Vv[e]=Vv[e]||GW(e),Vv[e](t)):t.localeData().invalidDate()}function LP(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(Yd.lastIndex=0;n>=0&&Yd.test(t);)t=t.replace(Yd,i),Yd.lastIndex=0,n-=1;return t}var KW={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function XW(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(PS).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var qW="Invalid date";function ZW(){return this._invalidDate}var QW="%d",JW=/\d{1,2}/;function eB(t){return this._ordinal.replace("%d",t)}var tB={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function nB(t,e,n,i){var r=this._relativeTime[n];return fo(r)?r(t,e,n,i):r.replace(/%d/i,t)}function iB(t,e){var n=this._relativeTime[t>0?"future":"past"];return fo(n)?n(e):n.replace(/%s/i,e)}var iT={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ki(t){return typeof t=="string"?iT[t]||iT[t.toLowerCase()]:void 0}function OS(t){var e={},n,i;for(i in t)at(t,i)&&(n=Ki(i),n&&(e[n]=t[i]));return e}var rB={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function oB(t){var e=[],n;for(n in t)at(t,n)&&e.push({unit:n,priority:rB[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var $P=/\d/,Ri=/\d\d/,kP=/\d{3}/,xS=/\d{4}/,ap=/[+-]?\d{6}/,Ht=/\d\d?/,FP=/\d\d\d\d?/,VP=/\d\d\d\d\d\d?/,lp=/\d{1,3}/,AS=/\d{1,4}/,up=/[+-]?\d{1,6}/,Ou=/\d+/,cp=/[+-]?\d+/,sB=/Z|[+-]\d\d:?\d\d/gi,hp=/Z|[+-]\d\d(?::?\d\d)?/gi,aB=/[+-]?\d+(\.\d{1,3})?/,fd=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,xu=/^[1-9]\d?/,HS=/^([1-9]\d|\d)/,om;om={};function ge(t,e,n){om[t]=fo(e)?e:function(i,r){return i&&n?n:e}}function lB(t,e){return at(om,t)?om[t](e._strict,e._locale):new RegExp(uB(t))}function uB(t){return Yo(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,o){return n||i||r||o}))}function Yo(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Fi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Fi(e)),n}var rb={};function Rt(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),Ko(e)&&(i=function(o,s){s[e]=Qe(o)}),r=t.length,n=0;n<r;n++)rb[t[n]]=i}function gd(t,e){Rt(t,function(n,i,r,o){r._w=r._w||{},e(n,r._w,r,o)})}function cB(t,e,n){e!=null&&at(rb,t)&&rb[t](e,n._a,n,t)}function dp(t){return t%4===0&&t%100!==0||t%400===0}var Dn=0,Fo=1,Qr=2,gn=3,mr=4,Vo=5,Wa=6,hB=7,dB=8;Ee("Y",0,0,function(){var t=this.year();return t<=9999?oo(t,4):"+"+t});Ee(0,["YY",2],0,function(){return this.year()%100});Ee(0,["YYYY",4],0,"year");Ee(0,["YYYYY",5],0,"year");Ee(0,["YYYYYY",6,!0],0,"year");ge("Y",cp);ge("YY",Ht,Ri);ge("YYYY",AS,xS);ge("YYYYY",up,ap);ge("YYYYYY",up,ap);Rt(["YYYYY","YYYYYY"],Dn);Rt("YYYY",function(t,e){e[Dn]=t.length===2?q.parseTwoDigitYear(t):Qe(t)});Rt("YY",function(t,e){e[Dn]=q.parseTwoDigitYear(t)});Rt("Y",function(t,e){e[Dn]=parseInt(t,10)});function eh(t){return dp(t)?366:365}q.parseTwoDigitYear=function(t){return Qe(t)+(Qe(t)>68?1900:2e3)};var WP=Au("FullYear",!0);function fB(){return dp(this.year())}function Au(t,e){return function(n){return n!=null?(BP(this,t,n),q.updateOffset(this,e),this):_h(this,t)}}function _h(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function BP(t,e,n){var i,r,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!dp(o)?28:a,r?i.setUTCFullYear(o,s,a):i.setFullYear(o,s,a)}}function gB(t){return t=Ki(t),fo(this[t])?this[t]():this}function mB(t,e){if(typeof t=="object"){t=OS(t);var n=oB(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=Ki(t),fo(this[t]))return this[t](e);return this}function pB(t,e){return(t%e+e)%e}var en;Array.prototype.indexOf?en=Array.prototype.indexOf:en=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function NS(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=pB(e,12);return t+=(e-n)/12,n===1?dp(t)?29:28:31-n%7%2}Ee("M",["MM",2],"Mo",function(){return this.month()+1});Ee("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ee("MMMM",0,0,function(t){return this.localeData().months(this,t)});ge("M",Ht,xu);ge("MM",Ht,Ri);ge("MMM",function(t,e){return e.monthsShortRegex(t)});ge("MMMM",function(t,e){return e.monthsRegex(t)});Rt(["M","MM"],function(t,e){e[Fo]=Qe(t)-1});Rt(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[Fo]=r:We(n).invalidMonth=t});var wB="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),jP="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),UP=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,vB=fd,CB=fd;function yB(t,e){return t?vr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||UP).test(e)?"format":"standalone"][t.month()]:vr(this._months)?this._months:this._months.standalone}function bB(t,e){return t?vr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[UP.test(e)?"format":"standalone"][t.month()]:vr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function SB(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=ho([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(r=en.call(this._shortMonthsParse,s),r!==-1?r:null):(r=en.call(this._longMonthsParse,s),r!==-1?r:null):e==="MMM"?(r=en.call(this._shortMonthsParse,s),r!==-1?r:(r=en.call(this._longMonthsParse,s),r!==-1?r:null)):(r=en.call(this._longMonthsParse,s),r!==-1?r:(r=en.call(this._shortMonthsParse,s),r!==-1?r:null))}function RB(t,e,n){var i,r,o;if(this._monthsParseExact)return SB.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=ho([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function zP(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Qe(e);else if(e=t.localeData().monthsParse(e),!Ko(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,NS(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function YP(t){return t!=null?(zP(this,t),q.updateOffset(this,!0),this):_h(this,"Month")}function EB(){return NS(this.year(),this.month())}function TB(t){return this._monthsParseExact?(at(this,"_monthsRegex")||GP.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=vB),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function MB(t){return this._monthsParseExact?(at(this,"_monthsRegex")||GP.call(this),t?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=CB),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function GP(){function t(l,u){return u.length-l.length}var e=[],n=[],i=[],r,o,s,a;for(r=0;r<12;r++)o=ho([2e3,r]),s=Yo(this.monthsShort(o,"")),a=Yo(this.months(o,"")),e.push(s),n.push(a),i.push(a),i.push(s);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function _B(t,e,n,i,r,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,o,s),a}function Ih(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function sm(t,e,n){var i=7+e-n,r=(7+Ih(t,0,i).getUTCDay()-e)%7;return-r+i-1}function KP(t,e,n,i,r){var o=(7+n-i)%7,s=sm(t,i,r),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=eh(l)+a):a>eh(t)?(l=t+1,u=a-eh(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Ph(t,e,n){var i=sm(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,o,s;return r<1?(s=t.year()-1,o=r+Go(s,e,n)):r>Go(t.year(),e,n)?(o=r-Go(t.year(),e,n),s=t.year()+1):(s=t.year(),o=r),{week:o,year:s}}function Go(t,e,n){var i=sm(t,e,n),r=sm(t+1,e,n);return(eh(t)-i+r)/7}Ee("w",["ww",2],"wo","week");Ee("W",["WW",2],"Wo","isoWeek");ge("w",Ht,xu);ge("ww",Ht,Ri);ge("W",Ht,xu);ge("WW",Ht,Ri);gd(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=Qe(t)});function IB(t){return Ph(t,this._week.dow,this._week.doy).week}var PB={dow:0,doy:6};function OB(){return this._week.dow}function xB(){return this._week.doy}function AB(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function HB(t){var e=Ph(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ee("d",0,"do","day");Ee("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ee("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ee("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ee("e",0,0,"weekday");Ee("E",0,0,"isoWeekday");ge("d",Ht);ge("e",Ht);ge("E",Ht);ge("dd",function(t,e){return e.weekdaysMinRegex(t)});ge("ddd",function(t,e){return e.weekdaysShortRegex(t)});ge("dddd",function(t,e){return e.weekdaysRegex(t)});gd(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:We(n).invalidWeekday=t});gd(["d","e","E"],function(t,e,n,i){e[i]=Qe(t)});function NB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function DB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function DS(t,e){return t.slice(e,7).concat(t.slice(0,e))}var LB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),XP="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),$B="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),kB=fd,FB=fd,VB=fd;function WB(t,e){var n=vr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?DS(n,this._week.dow):t?n[t.day()]:n}function BB(t){return t===!0?DS(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function jB(t){return t===!0?DS(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function UB(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=ho([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(r=en.call(this._weekdaysParse,s),r!==-1?r:null):e==="ddd"?(r=en.call(this._shortWeekdaysParse,s),r!==-1?r:null):(r=en.call(this._minWeekdaysParse,s),r!==-1?r:null):e==="dddd"?(r=en.call(this._weekdaysParse,s),r!==-1||(r=en.call(this._shortWeekdaysParse,s),r!==-1)?r:(r=en.call(this._minWeekdaysParse,s),r!==-1?r:null)):e==="ddd"?(r=en.call(this._shortWeekdaysParse,s),r!==-1||(r=en.call(this._weekdaysParse,s),r!==-1)?r:(r=en.call(this._minWeekdaysParse,s),r!==-1?r:null)):(r=en.call(this._minWeekdaysParse,s),r!==-1||(r=en.call(this._weekdaysParse,s),r!==-1)?r:(r=en.call(this._shortWeekdaysParse,s),r!==-1?r:null))}function zB(t,e,n){var i,r,o;if(this._weekdaysParseExact)return UB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=ho([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function YB(t){if(!this.isValid())return t!=null?this:NaN;var e=_h(this,"Day");return t!=null?(t=NB(t,this.localeData()),this.add(t-e,"d")):e}function GB(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function KB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=DB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function XB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||LS.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=kB),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function qB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||LS.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=FB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function ZB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||LS.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=VB),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function LS(){function t(c,h){return h.length-c.length}var e=[],n=[],i=[],r=[],o,s,a,l,u;for(o=0;o<7;o++)s=ho([2e3,1]).day(o),a=Yo(this.weekdaysMin(s,"")),l=Yo(this.weekdaysShort(s,"")),u=Yo(this.weekdays(s,"")),e.push(a),n.push(l),i.push(u),r.push(a),r.push(l),r.push(u);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function $S(){return this.hours()%12||12}function QB(){return this.hours()||24}Ee("H",["HH",2],0,"hour");Ee("h",["hh",2],0,$S);Ee("k",["kk",2],0,QB);Ee("hmm",0,0,function(){return""+$S.apply(this)+oo(this.minutes(),2)});Ee("hmmss",0,0,function(){return""+$S.apply(this)+oo(this.minutes(),2)+oo(this.seconds(),2)});Ee("Hmm",0,0,function(){return""+this.hours()+oo(this.minutes(),2)});Ee("Hmmss",0,0,function(){return""+this.hours()+oo(this.minutes(),2)+oo(this.seconds(),2)});function qP(t,e){Ee(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}qP("a",!0);qP("A",!1);function ZP(t,e){return e._meridiemParse}ge("a",ZP);ge("A",ZP);ge("H",Ht,HS);ge("h",Ht,xu);ge("k",Ht,xu);ge("HH",Ht,Ri);ge("hh",Ht,Ri);ge("kk",Ht,Ri);ge("hmm",FP);ge("hmmss",VP);ge("Hmm",FP);ge("Hmmss",VP);Rt(["H","HH"],gn);Rt(["k","kk"],function(t,e,n){var i=Qe(t);e[gn]=i===24?0:i});Rt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});Rt(["h","hh"],function(t,e,n){e[gn]=Qe(t),We(n).bigHour=!0});Rt("hmm",function(t,e,n){var i=t.length-2;e[gn]=Qe(t.substr(0,i)),e[mr]=Qe(t.substr(i)),We(n).bigHour=!0});Rt("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[gn]=Qe(t.substr(0,i)),e[mr]=Qe(t.substr(i,2)),e[Vo]=Qe(t.substr(r)),We(n).bigHour=!0});Rt("Hmm",function(t,e,n){var i=t.length-2;e[gn]=Qe(t.substr(0,i)),e[mr]=Qe(t.substr(i))});Rt("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[gn]=Qe(t.substr(0,i)),e[mr]=Qe(t.substr(i,2)),e[Vo]=Qe(t.substr(r))});function JB(t){return(t+"").toLowerCase().charAt(0)==="p"}var ej=/[ap]\.?m?\.?/i,tj=Au("Hours",!0);function nj(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var QP={calendar:UW,longDateFormat:KW,invalidDate:qW,ordinal:QW,dayOfMonthOrdinalParse:JW,relativeTime:tB,months:wB,monthsShort:jP,week:PB,weekdays:LB,weekdaysMin:$B,weekdaysShort:XP,meridiemParse:ej},Lt={},Yu={},Oh;function ij(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function rT(t){return t&&t.toLowerCase().replace("_","-")}function rj(t){for(var e=0,n,i,r,o;e<t.length;){for(o=rT(t[e]).split("-"),n=o.length,i=rT(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=fp(o.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&ij(o,i)>=n-1)break;n--}e++}return Oh}function oj(t){return!!(t&&t.match("^[^/\\\\]*$"))}function fp(t){var e=null,n;if(Lt[t]===void 0&&typeof module<"u"&&module&&module.exports&&oj(t))try{e=Oh._abbr,n=require,n("./locale/"+t),Ls(e)}catch{Lt[t]=null}return Lt[t]}function Ls(t,e){var n;return t&&(ii(e)?n=Jo(t):n=kS(t,e),n?Oh=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Oh._abbr}function kS(t,e){if(e!==null){var n,i=QP;if(e.abbr=t,Lt[t]!=null)DP("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Lt[t]._config;else if(e.parentLocale!=null)if(Lt[e.parentLocale]!=null)i=Lt[e.parentLocale]._config;else if(n=fp(e.parentLocale),n!=null)i=n._config;else return Yu[e.parentLocale]||(Yu[e.parentLocale]=[]),Yu[e.parentLocale].push({name:t,config:e}),null;return Lt[t]=new IS(nb(i,e)),Yu[t]&&Yu[t].forEach(function(r){kS(r.name,r.config)}),Ls(t),Lt[t]}else return delete Lt[t],null}function sj(t,e){if(e!=null){var n,i,r=QP;Lt[t]!=null&&Lt[t].parentLocale!=null?Lt[t].set(nb(Lt[t]._config,e)):(i=fp(t),i!=null&&(r=i._config),e=nb(r,e),i==null&&(e.abbr=t),n=new IS(e),n.parentLocale=Lt[t],Lt[t]=n),Ls(t)}else Lt[t]!=null&&(Lt[t].parentLocale!=null?(Lt[t]=Lt[t].parentLocale,t===Ls()&&Ls(t)):Lt[t]!=null&&delete Lt[t]);return Lt[t]}function Jo(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Oh;if(!vr(t)){if(e=fp(t),e)return e;t=[t]}return rj(t)}function aj(){return ib(Lt)}function FS(t){var e,n=t._a;return n&&We(t).overflow===-2&&(e=n[Fo]<0||n[Fo]>11?Fo:n[Qr]<1||n[Qr]>NS(n[Dn],n[Fo])?Qr:n[gn]<0||n[gn]>24||n[gn]===24&&(n[mr]!==0||n[Vo]!==0||n[Wa]!==0)?gn:n[mr]<0||n[mr]>59?mr:n[Vo]<0||n[Vo]>59?Vo:n[Wa]<0||n[Wa]>999?Wa:-1,We(t)._overflowDayOfYear&&(e<Dn||e>Qr)&&(e=Qr),We(t)._overflowWeeks&&e===-1&&(e=hB),We(t)._overflowWeekday&&e===-1&&(e=dB),We(t).overflow=e),t}var lj=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,uj=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,cj=/Z|[+-]\d\d(?::?\d\d)?/,Gd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Wv=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],hj=/^\/?Date\((-?\d+)/i,dj=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,fj={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function JP(t){var e,n,i=t._i,r=lj.exec(i)||uj.exec(i),o,s,a,l,u=Gd.length,c=Wv.length;if(r){for(We(t).iso=!0,e=0,n=u;e<n;e++)if(Gd[e][1].exec(r[1])){s=Gd[e][0],o=Gd[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(r[3]){for(e=0,n=c;e<n;e++)if(Wv[e][1].exec(r[3])){a=(r[2]||" ")+Wv[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(r[4])if(cj.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),WS(t)}else t._isValid=!1}function gj(t,e,n,i,r,o){var s=[mj(t),jP.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return o&&s.push(parseInt(o,10)),s}function mj(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function pj(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function wj(t,e,n){if(t){var i=XP.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return We(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function vj(t,e,n){if(t)return fj[t];if(e)return 0;var i=parseInt(n,10),r=i%100,o=(i-r)/100;return o*60+r}function eO(t){var e=dj.exec(pj(t._i)),n;if(e){if(n=gj(e[4],e[3],e[2],e[5],e[6],e[7]),!wj(e[1],n,t))return;t._a=n,t._tzm=vj(e[8],e[9],e[10]),t._d=Ih.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),We(t).rfc2822=!0}else t._isValid=!1}function Cj(t){var e=hj.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(JP(t),t._isValid===!1)delete t._isValid;else return;if(eO(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:q.createFromInputFallback(t)}q.createFromInputFallback=Gi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function nu(t,e,n){return t??e??n}function yj(t){var e=new Date(q.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function VS(t){var e,n,i=[],r,o,s;if(!t._d){for(r=yj(t),t._w&&t._a[Qr]==null&&t._a[Fo]==null&&bj(t),t._dayOfYear!=null&&(s=nu(t._a[Dn],r[Dn]),(t._dayOfYear>eh(s)||t._dayOfYear===0)&&(We(t)._overflowDayOfYear=!0),n=Ih(s,0,t._dayOfYear),t._a[Fo]=n.getUTCMonth(),t._a[Qr]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[gn]===24&&t._a[mr]===0&&t._a[Vo]===0&&t._a[Wa]===0&&(t._nextDay=!0,t._a[gn]=0),t._d=(t._useUTC?Ih:_B).apply(null,i),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[gn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(We(t).weekdayMismatch=!0)}}function bj(t){var e,n,i,r,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=nu(e.GG,t._a[Dn],Ph(At(),1,4).year),i=nu(e.W,1),r=nu(e.E,1),(r<1||r>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Ph(At(),o,s),n=nu(e.gg,t._a[Dn],u.year),i=nu(e.w,u.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+o,(e.e<0||e.e>6)&&(l=!0)):r=o),i<1||i>Go(n,o,s)?We(t)._overflowWeeks=!0:l!=null?We(t)._overflowWeekday=!0:(a=KP(n,i,r,o,s),t._a[Dn]=a.year,t._dayOfYear=a.dayOfYear)}q.ISO_8601=function(){};q.RFC_2822=function(){};function WS(t){if(t._f===q.ISO_8601){JP(t);return}if(t._f===q.RFC_2822){eO(t);return}t._a=[],We(t).empty=!0;var e=""+t._i,n,i,r,o,s,a=e.length,l=0,u,c;for(r=LP(t._f,t._locale).match(PS)||[],c=r.length,n=0;n<c;n++)o=r[n],i=(e.match(lB(o,t))||[])[0],i&&(s=e.substr(0,e.indexOf(i)),s.length>0&&We(t).unusedInput.push(s),e=e.slice(e.indexOf(i)+i.length),l+=i.length),gu[o]?(i?We(t).empty=!1:We(t).unusedTokens.push(o),cB(o,i,t)):t._strict&&!i&&We(t).unusedTokens.push(o);We(t).charsLeftOver=a-l,e.length>0&&We(t).unusedInput.push(e),t._a[gn]<=12&&We(t).bigHour===!0&&t._a[gn]>0&&(We(t).bigHour=void 0),We(t).parsedDateParts=t._a.slice(0),We(t).meridiem=t._meridiem,t._a[gn]=Sj(t._locale,t._a[gn],t._meridiem),u=We(t).era,u!==null&&(t._a[Dn]=t._locale.erasConvertYear(u,t._a[Dn])),VS(t),FS(t)}function Sj(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function Rj(t){var e,n,i,r,o,s,a=!1,l=t._f.length;if(l===0){We(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)o=0,s=!1,e=_S({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],WS(e),MS(e)&&(s=!0),o+=We(e).charsLeftOver,o+=We(e).unusedTokens.length*10,We(e).score=o,a?o<i&&(i=o,n=e):(i==null||o<i||s)&&(i=o,n=e,s&&(a=!0));Os(t,n||e)}function Ej(t){if(!t._d){var e=OS(t._i),n=e.day===void 0?e.date:e.day;t._a=HP([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),VS(t)}}function Tj(t){var e=new dd(FS(tO(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function tO(t){var e=t._i,n=t._f;return t._locale=t._locale||Jo(t._l),e===null||n===void 0&&e===""?sp({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Cr(e)?new dd(FS(e)):(hd(e)?t._d=e:vr(n)?Rj(t):n?WS(t):Mj(t),MS(t)||(t._d=null),t))}function Mj(t){var e=t._i;ii(e)?t._d=new Date(q.now()):hd(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Cj(t):vr(e)?(t._a=HP(e.slice(0),function(n){return parseInt(n,10)}),VS(t)):qa(e)?Ej(t):Ko(e)?t._d=new Date(e):q.createFromInputFallback(t)}function nO(t,e,n,i,r){var o={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(qa(t)&&TS(t)||vr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=t,o._f=e,o._strict=i,Tj(o)}function At(t,e,n,i){return nO(t,e,n,i,!1)}var _j=Gi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=At.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:sp()}),Ij=Gi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=At.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:sp()});function iO(t,e){var n,i;if(e.length===1&&vr(e[0])&&(e=e[0]),!e.length)return At();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function Pj(){var t=[].slice.call(arguments,0);return iO("isBefore",t)}function Oj(){var t=[].slice.call(arguments,0);return iO("isAfter",t)}var xj=function(){return Date.now?Date.now():+new Date},Gu=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Aj(t){var e,n=!1,i,r=Gu.length;for(e in t)if(at(t,e)&&!(en.call(Gu,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[Gu[i]]){if(n)return!1;parseFloat(t[Gu[i]])!==Qe(t[Gu[i]])&&(n=!0)}return!0}function Hj(){return this._isValid}function Nj(){return Er(NaN)}function gp(t){var e=OS(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=Aj(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+r+i*3+n*12,this._data={},this._locale=Jo(),this._bubble()}function xg(t){return t instanceof gp}function ob(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Dj(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),o=0,s;for(s=0;s<i;s++)(n&&t[s]!==e[s]||!n&&Qe(t[s])!==Qe(e[s]))&&o++;return o+r}function rO(t,e){Ee(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+oo(~~(n/60),2)+e+oo(~~n%60,2)})}rO("Z",":");rO("ZZ","");ge("Z",hp);ge("ZZ",hp);Rt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=BS(hp,t)});var Lj=/([\+\-]|\d\d)/gi;function BS(t,e){var n=(e||"").match(t),i,r,o;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(Lj)||["-",0,0],o=+(r[1]*60)+Qe(r[2]),o===0?0:r[0]==="+"?o:-o)}function jS(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(Cr(t)||hd(t)?t.valueOf():At(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),q.updateOffset(n,!1),n):At(t).local()}function sb(t){return-Math.round(t._d.getTimezoneOffset())}q.updateOffset=function(){};function $j(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=BS(hp,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=sb(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?aO(this,Er(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:sb(this)}function kj(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Fj(t){return this.utcOffset(0,t)}function Vj(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(sb(this),"m")),this}function Wj(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=BS(sB,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Bj(t){return this.isValid()?(t=t?At(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function jj(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Uj(){if(!ii(this._isDSTShifted))return this._isDSTShifted;var t={},e;return _S(t,this),t=tO(t),t._a?(e=t._isUTC?ho(t._a):At(t._a),this._isDSTShifted=this.isValid()&&Dj(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function zj(){return this.isValid()?!this._isUTC:!1}function Yj(){return this.isValid()?this._isUTC:!1}function oO(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Gj=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Kj=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Er(t,e){var n=t,i=null,r,o,s;return xg(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ko(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=Gj.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:Qe(i[Qr])*r,h:Qe(i[gn])*r,m:Qe(i[mr])*r,s:Qe(i[Vo])*r,ms:Qe(ob(i[Wa]*1e3))*r}):(i=Kj.exec(t))?(r=i[1]==="-"?-1:1,n={y:ta(i[2],r),M:ta(i[3],r),w:ta(i[4],r),d:ta(i[5],r),h:ta(i[6],r),m:ta(i[7],r),s:ta(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=Xj(At(n.from),At(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new gp(n),xg(t)&&at(t,"_locale")&&(o._locale=t._locale),xg(t)&&at(t,"_isValid")&&(o._isValid=t._isValid),o}Er.fn=gp.prototype;Er.invalid=Nj;function ta(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function oT(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Xj(t,e){var n;return t.isValid()&&e.isValid()?(e=jS(e,t),t.isBefore(e)?n=oT(t,e):(n=oT(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function sO(t,e){return function(n,i){var r,o;return i!==null&&!isNaN(+i)&&(DP(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),r=Er(n,i),aO(this,r,t),this}}function aO(t,e,n,i){var r=e._milliseconds,o=ob(e._days),s=ob(e._months);t.isValid()&&(i=i??!0,s&&zP(t,_h(t,"Month")+s*n),o&&BP(t,"Date",_h(t,"Date")+o*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&q.updateOffset(t,o||s))}var qj=sO(1,"add"),Zj=sO(-1,"subtract");function lO(t){return typeof t=="string"||t instanceof String}function Qj(t){return Cr(t)||hd(t)||lO(t)||Ko(t)||eU(t)||Jj(t)||t===null||t===void 0}function Jj(t){var e=qa(t)&&!TS(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,o,s=i.length;for(r=0;r<s;r+=1)o=i[r],n=n||at(t,o);return e&&n}function eU(t){var e=vr(t),n=!1;return e&&(n=t.filter(function(i){return!Ko(i)&&lO(t)}).length===0),e&&n}function tU(t){var e=qa(t)&&!TS(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,o;for(r=0;r<i.length;r+=1)o=i[r],n=n||at(t,o);return e&&n}function nU(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function iU(t,e){arguments.length===1&&(arguments[0]?Qj(arguments[0])?(t=arguments[0],e=void 0):tU(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||At(),i=jS(n,this).startOf("day"),r=q.calendarFormat(this,i)||"sameElse",o=e&&(fo(e[r])?e[r].call(this,n):e[r]);return this.format(o||this.localeData().calendar(r,this,At(n)))}function rU(){return new dd(this)}function oU(t,e){var n=Cr(t)?t:At(t);return this.isValid()&&n.isValid()?(e=Ki(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function sU(t,e){var n=Cr(t)?t:At(t);return this.isValid()&&n.isValid()?(e=Ki(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function aU(t,e,n,i){var r=Cr(t)?t:At(t),o=Cr(e)?e:At(e);return this.isValid()&&r.isValid()&&o.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function lU(t,e){var n=Cr(t)?t:At(t),i;return this.isValid()&&n.isValid()?(e=Ki(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function uU(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function cU(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function hU(t,e,n){var i,r,o;if(!this.isValid())return NaN;if(i=jS(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=Ki(e),e){case"year":o=Ag(this,i)/12;break;case"month":o=Ag(this,i);break;case"quarter":o=Ag(this,i)/3;break;case"second":o=(this-i)/1e3;break;case"minute":o=(this-i)/6e4;break;case"hour":o=(this-i)/36e5;break;case"day":o=(this-i-r)/864e5;break;case"week":o=(this-i-r)/6048e5;break;default:o=this-i}return n?o:Fi(o)}function Ag(t,e){if(t.date()<e.date())return-Ag(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,o;return e-i<0?(r=t.clone().add(n-1,"months"),o=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),o=(e-i)/(r-i)),-(n+o)||0}q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function dU(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function fU(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Og(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):fo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Og(n,"Z")):Og(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function gU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+i+r+o)}function mU(t){t||(t=this.isUtc()?q.defaultFormatUtc:q.defaultFormat);var e=Og(this,t);return this.localeData().postformat(e)}function pU(t,e){return this.isValid()&&(Cr(t)&&t.isValid()||At(t).isValid())?Er({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function wU(t){return this.from(At(),t)}function vU(t,e){return this.isValid()&&(Cr(t)&&t.isValid()||At(t).isValid())?Er({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function CU(t){return this.to(At(),t)}function uO(t){var e;return t===void 0?this._locale._abbr:(e=Jo(t),e!=null&&(this._locale=e),this)}var cO=Gi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function hO(){return this._locale}var am=1e3,mu=60*am,lm=60*mu,dO=(365*400+97)*24*lm;function pu(t,e){return(t%e+e)%e}function fO(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-dO:new Date(t,e,n).valueOf()}function gO(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-dO:Date.UTC(t,e,n)}function yU(t){var e,n;if(t=Ki(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?gO:fO,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=pu(e+(this._isUTC?0:this.utcOffset()*mu),lm);break;case"minute":e=this._d.valueOf(),e-=pu(e,mu);break;case"second":e=this._d.valueOf(),e-=pu(e,am);break}return this._d.setTime(e),q.updateOffset(this,!0),this}function bU(t){var e,n;if(t=Ki(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?gO:fO,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=lm-pu(e+(this._isUTC?0:this.utcOffset()*mu),lm)-1;break;case"minute":e=this._d.valueOf(),e+=mu-pu(e,mu)-1;break;case"second":e=this._d.valueOf(),e+=am-pu(e,am)-1;break}return this._d.setTime(e),q.updateOffset(this,!0),this}function SU(){return this._d.valueOf()-(this._offset||0)*6e4}function RU(){return Math.floor(this.valueOf()/1e3)}function EU(){return new Date(this.valueOf())}function TU(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function MU(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function _U(){return this.isValid()?this.toISOString():null}function IU(){return MS(this)}function PU(){return Os({},We(this))}function OU(){return We(this).overflow}function xU(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ee("N",0,0,"eraAbbr");Ee("NN",0,0,"eraAbbr");Ee("NNN",0,0,"eraAbbr");Ee("NNNN",0,0,"eraName");Ee("NNNNN",0,0,"eraNarrow");Ee("y",["y",1],"yo","eraYear");Ee("y",["yy",2],0,"eraYear");Ee("y",["yyy",3],0,"eraYear");Ee("y",["yyyy",4],0,"eraYear");ge("N",US);ge("NN",US);ge("NNN",US);ge("NNNN",BU);ge("NNNNN",jU);Rt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?We(n).era=r:We(n).invalidEra=t});ge("y",Ou);ge("yy",Ou);ge("yyy",Ou);ge("yyyy",Ou);ge("yo",UU);Rt(["y","yy","yyy","yyyy"],Dn);Rt(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Dn]=n._locale.eraYearOrdinalParse(t,r):e[Dn]=parseInt(t,10)});function AU(t,e){var n,i,r,o=this._eras||Jo("en")._eras;for(n=0,i=o.length;n<i;++n){switch(typeof o[n].since){case"string":r=q(o[n].since).startOf("day"),o[n].since=r.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":r=q(o[n].until).startOf("day").valueOf(),o[n].until=r.valueOf();break}}return o}function HU(t,e,n){var i,r,o=this.eras(),s,a,l;for(t=t.toUpperCase(),i=0,r=o.length;i<r;++i)if(s=o[i].name.toUpperCase(),a=o[i].abbr.toUpperCase(),l=o[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[i];break;case"NNNN":if(s===t)return o[i];break;case"NNNNN":if(l===t)return o[i];break}else if([s,a,l].indexOf(t)>=0)return o[i]}function NU(t,e){var n=t.since<=t.until?1:-1;return e===void 0?q(t.since).year():q(t.since).year()+(e-t.offset)*n}function DU(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function LU(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function $U(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function kU(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-q(r[t].since).year())*n+r[t].offset;return this.year()}function FU(t){return at(this,"_erasNameRegex")||zS.call(this),t?this._erasNameRegex:this._erasRegex}function VU(t){return at(this,"_erasAbbrRegex")||zS.call(this),t?this._erasAbbrRegex:this._erasRegex}function WU(t){return at(this,"_erasNarrowRegex")||zS.call(this),t?this._erasNarrowRegex:this._erasRegex}function US(t,e){return e.erasAbbrRegex(t)}function BU(t,e){return e.erasNameRegex(t)}function jU(t,e){return e.erasNarrowRegex(t)}function UU(t,e){return e._eraYearOrdinalRegex||Ou}function zS(){var t=[],e=[],n=[],i=[],r,o,s,a,l,u=this.eras();for(r=0,o=u.length;r<o;++r)s=Yo(u[r].name),a=Yo(u[r].abbr),l=Yo(u[r].narrow),e.push(s),t.push(a),n.push(l),i.push(s),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ee(0,["gg",2],0,function(){return this.weekYear()%100});Ee(0,["GG",2],0,function(){return this.isoWeekYear()%100});function mp(t,e){Ee(0,[t,t.length],0,e)}mp("gggg","weekYear");mp("ggggg","weekYear");mp("GGGG","isoWeekYear");mp("GGGGG","isoWeekYear");ge("G",cp);ge("g",cp);ge("GG",Ht,Ri);ge("gg",Ht,Ri);ge("GGGG",AS,xS);ge("gggg",AS,xS);ge("GGGGG",up,ap);ge("ggggg",up,ap);gd(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=Qe(t)});gd(["gg","GG"],function(t,e,n,i){e[i]=q.parseTwoDigitYear(t)});function zU(t){return mO.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function YU(t){return mO.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function GU(){return Go(this.year(),1,4)}function KU(){return Go(this.isoWeekYear(),1,4)}function XU(){var t=this.localeData()._week;return Go(this.year(),t.dow,t.doy)}function qU(){var t=this.localeData()._week;return Go(this.weekYear(),t.dow,t.doy)}function mO(t,e,n,i,r){var o;return t==null?Ph(this,i,r).year:(o=Go(t,i,r),e>o&&(e=o),ZU.call(this,t,e,n,i,r))}function ZU(t,e,n,i,r){var o=KP(t,e,n,i,r),s=Ih(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ee("Q",0,"Qo","quarter");ge("Q",$P);Rt("Q",function(t,e){e[Fo]=(Qe(t)-1)*3});function QU(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ee("D",["DD",2],"Do","date");ge("D",Ht,xu);ge("DD",Ht,Ri);ge("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Rt(["D","DD"],Qr);Rt("Do",function(t,e){e[Qr]=Qe(t.match(Ht)[0])});var pO=Au("Date",!0);Ee("DDD",["DDDD",3],"DDDo","dayOfYear");ge("DDD",lp);ge("DDDD",kP);Rt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Qe(t)});function JU(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ee("m",["mm",2],0,"minute");ge("m",Ht,HS);ge("mm",Ht,Ri);Rt(["m","mm"],mr);var ez=Au("Minutes",!1);Ee("s",["ss",2],0,"second");ge("s",Ht,HS);ge("ss",Ht,Ri);Rt(["s","ss"],Vo);var tz=Au("Seconds",!1);Ee("S",0,0,function(){return~~(this.millisecond()/100)});Ee(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ee(0,["SSS",3],0,"millisecond");Ee(0,["SSSS",4],0,function(){return this.millisecond()*10});Ee(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ee(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ee(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ee(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ee(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ge("S",lp,$P);ge("SS",lp,Ri);ge("SSS",lp,kP);var xs,wO;for(xs="SSSS";xs.length<=9;xs+="S")ge(xs,Ou);function nz(t,e){e[Wa]=Qe(("0."+t)*1e3)}for(xs="S";xs.length<=9;xs+="S")Rt(xs,nz);wO=Au("Milliseconds",!1);Ee("z",0,0,"zoneAbbr");Ee("zz",0,0,"zoneName");function iz(){return this._isUTC?"UTC":""}function rz(){return this._isUTC?"Coordinated Universal Time":""}var ee=dd.prototype;ee.add=qj;ee.calendar=iU;ee.clone=rU;ee.diff=hU;ee.endOf=bU;ee.format=mU;ee.from=pU;ee.fromNow=wU;ee.to=vU;ee.toNow=CU;ee.get=gB;ee.invalidAt=OU;ee.isAfter=oU;ee.isBefore=sU;ee.isBetween=aU;ee.isSame=lU;ee.isSameOrAfter=uU;ee.isSameOrBefore=cU;ee.isValid=IU;ee.lang=cO;ee.locale=uO;ee.localeData=hO;ee.max=Ij;ee.min=_j;ee.parsingFlags=PU;ee.set=mB;ee.startOf=yU;ee.subtract=Zj;ee.toArray=TU;ee.toObject=MU;ee.toDate=EU;ee.toISOString=fU;ee.inspect=gU;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=_U;ee.toString=dU;ee.unix=RU;ee.valueOf=SU;ee.creationData=xU;ee.eraName=DU;ee.eraNarrow=LU;ee.eraAbbr=$U;ee.eraYear=kU;ee.year=WP;ee.isLeapYear=fB;ee.weekYear=zU;ee.isoWeekYear=YU;ee.quarter=ee.quarters=QU;ee.month=YP;ee.daysInMonth=EB;ee.week=ee.weeks=AB;ee.isoWeek=ee.isoWeeks=HB;ee.weeksInYear=XU;ee.weeksInWeekYear=qU;ee.isoWeeksInYear=GU;ee.isoWeeksInISOWeekYear=KU;ee.date=pO;ee.day=ee.days=YB;ee.weekday=GB;ee.isoWeekday=KB;ee.dayOfYear=JU;ee.hour=ee.hours=tj;ee.minute=ee.minutes=ez;ee.second=ee.seconds=tz;ee.millisecond=ee.milliseconds=wO;ee.utcOffset=$j;ee.utc=Fj;ee.local=Vj;ee.parseZone=Wj;ee.hasAlignedHourOffset=Bj;ee.isDST=jj;ee.isLocal=zj;ee.isUtcOffset=Yj;ee.isUtc=oO;ee.isUTC=oO;ee.zoneAbbr=iz;ee.zoneName=rz;ee.dates=Gi("dates accessor is deprecated. Use date instead.",pO);ee.months=Gi("months accessor is deprecated. Use month instead",YP);ee.years=Gi("years accessor is deprecated. Use year instead",WP);ee.zone=Gi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",kj);ee.isDSTShifted=Gi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Uj);function oz(t){return At(t*1e3)}function sz(){return At.apply(null,arguments).parseZone()}function vO(t){return t}var lt=IS.prototype;lt.calendar=zW;lt.longDateFormat=XW;lt.invalidDate=ZW;lt.ordinal=eB;lt.preparse=vO;lt.postformat=vO;lt.relativeTime=nB;lt.pastFuture=iB;lt.set=jW;lt.eras=AU;lt.erasParse=HU;lt.erasConvertYear=NU;lt.erasAbbrRegex=VU;lt.erasNameRegex=FU;lt.erasNarrowRegex=WU;lt.months=yB;lt.monthsShort=bB;lt.monthsParse=RB;lt.monthsRegex=MB;lt.monthsShortRegex=TB;lt.week=IB;lt.firstDayOfYear=xB;lt.firstDayOfWeek=OB;lt.weekdays=WB;lt.weekdaysMin=jB;lt.weekdaysShort=BB;lt.weekdaysParse=zB;lt.weekdaysRegex=XB;lt.weekdaysShortRegex=qB;lt.weekdaysMinRegex=ZB;lt.isPM=JB;lt.meridiem=nj;function um(t,e,n,i){var r=Jo(),o=ho().set(i,e);return r[n](o,t)}function CO(t,e,n){if(Ko(t)&&(e=t,t=void 0),t=t||"",e!=null)return um(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=um(t,i,n,"month");return r}function YS(t,e,n,i){typeof t=="boolean"?(Ko(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ko(e)&&(n=e,e=void 0),e=e||"");var r=Jo(),o=t?r._week.dow:0,s,a=[];if(n!=null)return um(e,(n+o)%7,i,"day");for(s=0;s<7;s++)a[s]=um(e,(s+o)%7,i,"day");return a}function az(t,e){return CO(t,e,"months")}function lz(t,e){return CO(t,e,"monthsShort")}function uz(t,e,n){return YS(t,e,n,"weekdays")}function cz(t,e,n){return YS(t,e,n,"weekdaysShort")}function hz(t,e,n){return YS(t,e,n,"weekdaysMin")}Ls("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});q.lang=Gi("moment.lang is deprecated. Use moment.locale instead.",Ls);q.langData=Gi("moment.langData is deprecated. Use moment.localeData instead.",Jo);var po=Math.abs;function dz(){var t=this._data;return this._milliseconds=po(this._milliseconds),this._days=po(this._days),this._months=po(this._months),t.milliseconds=po(t.milliseconds),t.seconds=po(t.seconds),t.minutes=po(t.minutes),t.hours=po(t.hours),t.months=po(t.months),t.years=po(t.years),this}function yO(t,e,n,i){var r=Er(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function fz(t,e){return yO(this,t,e,1)}function gz(t,e){return yO(this,t,e,-1)}function sT(t){return t<0?Math.floor(t):Math.ceil(t)}function mz(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=sT(ab(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=Fi(t/1e3),i.seconds=r%60,o=Fi(r/60),i.minutes=o%60,s=Fi(o/60),i.hours=s%24,e+=Fi(s/24),l=Fi(bO(e)),n+=l,e-=sT(ab(l)),a=Fi(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function bO(t){return t*4800/146097}function ab(t){return t*146097/4800}function pz(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=Ki(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+bO(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(ab(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function es(t){return function(){return this.as(t)}}var SO=es("ms"),wz=es("s"),vz=es("m"),Cz=es("h"),yz=es("d"),bz=es("w"),Sz=es("M"),Rz=es("Q"),Ez=es("y"),Tz=SO;function Mz(){return Er(this)}function _z(t){return t=Ki(t),this.isValid()?this[t+"s"]():NaN}function hl(t){return function(){return this.isValid()?this._data[t]:NaN}}var Iz=hl("milliseconds"),Pz=hl("seconds"),Oz=hl("minutes"),xz=hl("hours"),Az=hl("days"),Hz=hl("months"),Nz=hl("years");function Dz(){return Fi(this.days()/7)}var Ao=Math.round,lu={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Lz(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function $z(t,e,n,i){var r=Er(t).abs(),o=Ao(r.as("s")),s=Ao(r.as("m")),a=Ao(r.as("h")),l=Ao(r.as("d")),u=Ao(r.as("M")),c=Ao(r.as("w")),h=Ao(r.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=i,Lz.apply(null,d)}function kz(t){return t===void 0?Ao:typeof t=="function"?(Ao=t,!0):!1}function Fz(t,e){return lu[t]===void 0?!1:e===void 0?lu[t]:(lu[t]=e,t==="s"&&(lu.ss=e-1),!0)}function Vz(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=lu,r,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},lu,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),o=$z(this,!n,i,r),n&&(o=r.pastFuture(+this,o)),r.postformat(o)}var Bv=Math.abs;function Cl(t){return(t>0)-(t<0)||+t}function pp(){if(!this.isValid())return this.localeData().invalidDate();var t=Bv(this._milliseconds)/1e3,e=Bv(this._days),n=Bv(this._months),i,r,o,s,a=this.asSeconds(),l,u,c,h;return a?(i=Fi(t/60),r=Fi(i/60),t%=60,i%=60,o=Fi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Cl(this._months)!==Cl(a)?"-":"",c=Cl(this._days)!==Cl(a)?"-":"",h=Cl(this._milliseconds)!==Cl(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(r||i||t?"T":"")+(r?h+r+"H":"")+(i?h+i+"M":"")+(t?h+s+"S":"")):"P0D"}var ot=gp.prototype;ot.isValid=Hj;ot.abs=dz;ot.add=fz;ot.subtract=gz;ot.as=pz;ot.asMilliseconds=SO;ot.asSeconds=wz;ot.asMinutes=vz;ot.asHours=Cz;ot.asDays=yz;ot.asWeeks=bz;ot.asMonths=Sz;ot.asQuarters=Rz;ot.asYears=Ez;ot.valueOf=Tz;ot._bubble=mz;ot.clone=Mz;ot.get=_z;ot.milliseconds=Iz;ot.seconds=Pz;ot.minutes=Oz;ot.hours=xz;ot.days=Az;ot.weeks=Dz;ot.months=Hz;ot.years=Nz;ot.humanize=Vz;ot.toISOString=pp;ot.toString=pp;ot.toJSON=pp;ot.locale=uO;ot.localeData=hO;ot.toIsoString=Gi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",pp);ot.lang=cO;Ee("X",0,0,"unix");Ee("x",0,0,"valueOf");ge("x",cp);ge("X",aB);Rt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});Rt("x",function(t,e,n){n._d=new Date(Qe(t))});//! moment.js
q.version="2.30.1";WW(At);q.fn=ee;q.min=Pj;q.max=Oj;q.now=xj;q.utc=ho;q.unix=oz;q.months=az;q.isDate=hd;q.locale=Ls;q.invalid=sp;q.duration=Er;q.isMoment=Cr;q.weekdays=uz;q.parseZone=sz;q.localeData=Jo;q.isDuration=xg;q.monthsShort=lz;q.weekdaysMin=hz;q.defineLocale=kS;q.updateLocale=sj;q.locales=aj;q.weekdaysShort=cz;q.normalizeUnits=Ki;q.relativeTimeRounding=kz;q.relativeTimeThreshold=Fz;q.calendarFormat=nU;q.prototype=ee;q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function RO(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function lb(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function th(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let o=0;o<i;o++)e[o]||(e[o]=[]),e[o][r]=t[r][o];return e}function nn(t,e,n,i){let r=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i&&a&&(r+=1,s=o[r]),r+=1;r<a;)s=e(s,o[r],r,o),r+=1;return s}function Xo(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];e(a,n,i)&&(s+=1,o[s]=a),n+=1}return o}function Ke(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];s+=1,o[s]=e(a,n,i),n+=1}return o}function M(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function EO(t){return nn(t,(e,n)=>e+n,0)}function Wz(t){return nn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function Bz(t){return nn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function jz(t){return t.length?EO(t)/t.length:0}function TO(t){return nn(t,(e,n)=>e.concat(Array.isArray(n)?TO(n):n),[])}function GS(t){const e=[];return M(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function ub(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let o=i;return M(r,s=>{o=o.filter(a=>!s.includes(a))}),o}function Uz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let o=i;return M(r,s=>{o=o.filter(a=>s.includes(a))}),o}function zz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e],o=new Set(i);return M(r,s=>{M(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function cb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const Yz=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:jz,arrayEach:M,arrayFilter:Xo,arrayFlatten:TO,arrayMap:Ke,arrayMax:Wz,arrayMin:Bz,arrayReduce:nn,arraySum:EO,arrayUnique:GS,extendArray:lb,getDifferenceOfArrays:ub,getIntersectionOfArrays:Uz,getUnionOfArrays:zz,pivot:th,stringToArray:cb,to2dArray:RO},Symbol.toStringTag,{value:"Module"}));function gt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return nn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function zt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function fe(t){return typeof t<"u"}function Mt(t){return typeof t>"u"}function Yt(t){return t===null||t===""||Mt(t)}function MO(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Gc="length",nh=t=>parseInt(t,16),aT=t=>parseInt(t,10),cm=(t,e,n)=>t.substr(e,n),ih=t=>t.codePointAt(0)-65,hb=t=>`${t}`.replace(/\-/g,""),Gz=t=>nh(cm(hb(t),nh("12"),ih("F")))/(nh(cm(hb(t),ih("B"),~~![][Gc]))||9),Kz=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let lT=!1;const uT={invalid:()=>gt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return gt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>gt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},cT={invalid:()=>gt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return gt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>gt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function _O(t,e){const n=!Yt(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="14.6.1";let o,s="invalid",a="invalid";t=hb(t||"");const l=Xz(t);if(n||i||l)if(l){const u=q("17/10/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=Gz(t);o=q((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else i?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(Kz()&&(s="valid",a="valid"),!lT&&s!=="valid"&&(uT[s]({keyValidityDate:o,hotVersion:r})&&console[s==="non_commercial"?"info":"warn"](uT[s]({keyValidityDate:o,hotVersion:r})),lT=!0),a!=="valid"&&e.parentNode&&cT[a]({keyValidityDate:o,hotVersion:r})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=cT[a]({keyValidityDate:o,hotVersion:r}),e.parentNode.insertBefore(c,e.nextSibling)}}function Xz(t){let e=[][Gc],n=e;if(t[Gc]!==ih("Z"))return!1;for(let i="",r="B<H4P+".split(""),o=ih(r.shift());o;o=ih(r.shift()||"A"))--o<""[Gc]?n=n|(aT(`${aT(nh(i)+(nh(cm(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=cm(t,o,o?r[Gc]===1?9:8:6);return n===e}const qz=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:_O,isDefined:fe,isEmpty:Yt,isRegExp:MO,isUndefined:Mt,stringify:zt},Symbol.toStringTag,{value:"Module"}));function Ln(t){return t[0].toUpperCase()+t.substr(1)}function Zz(){const t=[];for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];let r=n.length;for(;r;){r-=1;const o=zt(n[r]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function KS(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function XS(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function qS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function db(t){return wp(`${t}`,{ALLOWED_TAGS:[]})}function wp(t,e){return VW.sanitize(t,e)}const Qz=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Zz,isPercentValue:XS,randomString:KS,sanitize:wp,stripTags:db,substitute:qS,toUpperCaseFirst:Ln},Symbol.toStringTag,{value:"Module"})),Hu=t=>["tabindex",t],Jz=()=>["role","treegrid"],no=()=>["role","presentation"],eY=()=>["role","gridcell"],tY=()=>["role","rowheader"],IO=()=>["role","rowgroup"],nY=()=>["role","columnheader"],fb=()=>["role","row"],iY=()=>["role","menu"],rY=()=>["role","menuitem"],oY=()=>["role","menuitemcheckbox"],sY=()=>["role","combobox"],PO=()=>["role","listbox"],aY=()=>["role","option"],lY=()=>["role","checkbox"],uY=()=>["scope","col"],cY=()=>["scope","row"],hY=()=>["type","text"],hm=t=>["aria-label",t],dl=()=>["aria-hidden","true"],dY=()=>["aria-disabled","true"],fY=()=>["aria-multiselectable","true"],OO=t=>["aria-haspopup",t],xO=t=>["aria-rowcount",t],vp=t=>["aria-colcount",t],AO=t=>["aria-rowindex",t],ZS=t=>["aria-colindex",t],ji=t=>["aria-expanded",t],gY=t=>["aria-sort",t],hT=()=>["aria-readonly","true"],dT=()=>["aria-invalid","true"],HO=t=>["aria-checked",t],QS=()=>["aria-selected","true"],mY=()=>["aria-autocomplete","list"],pY=t=>["aria-controls",t],wY=t=>["aria-activedescendant",t],vY=t=>["aria-live",t],CY=t=>["aria-relevant",t],yY=t=>["aria-setsize",t],bY=t=>["aria-posinset",t];function NO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function DO(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function LO(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Za(t){return LO(t)&&t.parent}function SY(t){return!!Object.getPrototypeOf(t.parent)}function js(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===i&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===r?o=l:o=o.parentNode}return null}function Kc(t,e,n){const i=[];let r=t;for(;r&&(r=js(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const o=i.length;return o?i[o-1]:null}function $s(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function $O(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function vs(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function kO(t){return!t||!t.length?[]:t.filter(e=>!!e)}function FO(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],i=[];return i.push(...t.filter(r=>{const o=r instanceof RegExp;return o&&e&&n.push(r),!o})),e?{regexFree:i,regexes:n}:i}function _e(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=kO(e),e.length>0&&t.classList.add(...e)}function xe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=FO(e,!0);n=kO(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(o=>{r.test(o)&&t.classList.remove(o)})})}function Me(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function fl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=FO(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(o=>{r.test(o)&&t.removeAttribute(o)})})}function JS(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)JS(e[n])}}function yr(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const VO=/(<(.*)>|&(.*);)/;function gl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;VO.test(e)?t.innerHTML=n?wp(e):e:Us(t,e)}function Us(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(yr(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Qa(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Qa(n.host.impl);if(n.host)return Qa(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(so(n).display==="none")return!1;n=n.parentNode}return!0}function fn(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,o,s,a;for(o=r.offsetLeft,s=r.offsetTop,a=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)o+=r.offsetLeft,s+=r.offsetTop,a=r;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||i.scrollLeft,s+=n.pageYOffset||i.scrollTop),{left:o,top:s}}function eR(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Cp(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function yp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?eR(e):t.scrollTop}function tR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Cp(e):t.scrollLeft}function xh(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:o,overflowX:s,overflowY:a}=r.style;if([o,s,a].includes("scroll"))return r;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(r),i.includes(o)||i.includes(s)||i.includes(a)||r.clientHeight<=r.scrollHeight+1&&(i.includes(a)||i.includes(o))||r.clientWidth<=r.scrollWidth+1&&(i.includes(s)||i.includes(o)))return r;r=r.parentNode}return n}function WO(t){return t.scrollHeight-t.clientHeight}function BO(t){return t.scrollWidth-t.clientWidth}function Ja(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=so(i,n),o=["scroll","hidden","auto"],s=r.getPropertyValue("overflow"),a=r.getPropertyValue("overflow-y"),l=r.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return i;i=i.parentNode}return n}function Ru(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=so(t,n);if(r[e]!==""&&r[e]!==void 0)return r[e]}function RY(t,e){const{selectorText:n}=e;let i=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?i=t.msMatchesSelector(n):t.matches&&(i=t.matches(n))),i}function so(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function _t(t){return t.offsetWidth}function Zt(t){return t.offsetHeight}function Ba(t){return t.clientHeight||t.innerHeight}function nR(t){return t.clientWidth||t.innerWidth}function EY(t,e,n){t.addEventListener(e,n,!1)}function TY(t,e,n){t.removeEventListener(e,n,!1)}function iR(t){return t.selectionStart?t.selectionStart:0}function jO(t){return t.selectionEnd?t.selectionEnd:0}function MY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function gb(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function md(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}}let jv;function _Y(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.offsetWidth;n.style.overflow="scroll";let r=e.offsetWidth;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),i-r}function mn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return jv===void 0&&(jv=_Y(t)),jv}function UO(t){return t.offsetWidth!==t.clientWidth}function zO(t){return t.offsetHeight!==t.clientHeight}function bp(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function IY(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function pd(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function rh(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Sp(t){return rh(t)&&t.hasAttribute("data-hot-input")===!1}function PY(t){const e=t.ownerDocument.activeElement;Sp(e)||t.select()}function rR(t){return!t.parentNode}function YO(t,e){new IntersectionObserver((i,r)=>{i.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function oR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),o=i.defaultView.getSelection();Me(t,"contenteditable",!0),n&&Me(t,...dl()),e&&X(t,"invisibleSelection"),r.selectNodeContents(t),o.removeAllRanges(),o.addRange(r)}function sR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&xe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function GO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;oR(t,n),e(),sR(t,n)}const OY=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:VO,addClass:X,addEvent:EY,clearTextSelection:gb,closest:js,closestDown:Kc,empty:yr,fastInnerHTML:gl,fastInnerText:Us,getCaretPosition:iR,getComputedStyle:so,getCssTransform:IY,getFrameElement:LO,getMaximumScrollLeft:BO,getMaximumScrollTop:WO,getParent:NO,getParentWindow:Za,getScrollLeft:tR,getScrollTop:yp,getScrollableElement:xh,getScrollbarWidth:mn,getSelectionEndPosition:jO,getSelectionText:MY,getStyle:Ru,getTrimmingContainer:Ja,getWindowScrollLeft:Cp,getWindowScrollTop:eR,hasAccessToParentWindow:SY,hasClass:_e,hasHorizontalScrollbar:zO,hasVerticalScrollbar:UO,index:$O,innerHeight:Ba,innerWidth:nR,isChildOf:$s,isDetached:rR,isInput:rh,isOutsideInput:Sp,isThisHotChild:DO,isVisible:Qa,makeElementContentEditableAndSelectItsContent:oR,matchesCSSRules:RY,observeVisibilityChangeOnce:YO,offset:fn,outerHeight:Zt,outerWidth:_t,overlayContainsElement:vs,removeAttribute:fl,removeClass:xe,removeContentEditableFromElementAndDeselect:sR,removeEvent:TY,removeTextNodes:JS,resetCssTransform:pd,runWithSelectedContendEditableElement:GO,selectElementIfAllowed:PY,setAttribute:Me,setCaretPosition:md,setOverlayPosition:bp},Symbol.toStringTag,{value:"Module"}));function Et(t){return typeof t=="function"}function KO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const i={lastCallThrottled:!0};let r=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;i.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(i.lastCallThrottled=!1,t.apply(this,a)):(r&&clearTimeout(r),r=setTimeout(()=>{i.lastCallThrottled=!1,t.apply(this,a),n=0,r=void 0},h)),i}return o}function xY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const i=KO(t,e);let r=n;function o(){r=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return r?(r-=1,t.apply(this,l)):i.apply(this,l)}return s.clearHits=o,s}function Rp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,s)},e),i}return r}function AY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return nn(r,(u,c)=>c(u),i.apply(this,a))}}function aR(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function XO(t){const e=t.length;function n(i){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=i.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function HY(t){const e=t.length;function n(i){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=i.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function dm(t,e,n,i,r,o,s,a){return fe(a)?t.call(e,n,i,r,o,s,a):fe(s)?t.call(e,n,i,r,o,s):fe(o)?t.call(e,n,i,r,o):fe(r)?t.call(e,n,i,r):fe(i)?t.call(e,n,i):fe(n)?t.call(e,n):t.call(e)}const NY=Object.freeze(Object.defineProperty({__proto__:null,curry:XO,curryRight:HY,debounce:Rp,fastCall:dm,isFunction:Et,partial:aR,pipe:AY,throttle:KO,throttleAfterHits:xY},Symbol.toStringTag,{value:"Module"}));var DY=sn,fT=hP,LY=Tn,gT=ol,$Y=op,mT=DY([].push),kY=function(t){if(LY(t))return t;if(fT(t)){for(var e=t.length,n=[],i=0;i<e;i++){var r=t[i];typeof r=="string"?mT(n,r):(typeof r=="number"||gT(r)==="Number"||gT(r)==="String")&&mT(n,$Y(r))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(fT(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},FY=Mn,qO=Pu,ZO=rp,VY=Rr,wd=sn,QO=ci,pT=Tn,wT=cS,JO=RS,WY=kY,BY=uS,jY=String,ks=qO("JSON","stringify"),Kd=wd(/./.exec),vT=wd("".charAt),UY=wd("".charCodeAt),zY=wd("".replace),YY=wd(1 .toString),GY=/[\uD800-\uDFFF]/g,CT=/^[\uD800-\uDBFF]$/,yT=/^[\uDC00-\uDFFF]$/,bT=!BY||QO(function(){var t=qO("Symbol")("stringify detection");return ks([t])!=="[null]"||ks({a:t})!=="{}"||ks(Object(t))!=="{}"}),ST=QO(function(){return ks("\uDF06\uD834")!=='"\\udf06\\ud834"'||ks("\uDEAD")!=='"\\udead"'}),KY=function(t,e){var n=JO(arguments),i=WY(e);if(!(!pT(i)&&(t===void 0||wT(t))))return n[1]=function(r,o){if(pT(i)&&(o=VY(i,this,jY(r),o)),!wT(o))return o},ZO(ks,null,n)},XY=function(t,e,n){var i=vT(n,e-1),r=vT(n,e+1);return Kd(CT,t)&&!Kd(yT,r)||Kd(yT,t)&&!Kd(CT,i)?"\\u"+YY(UY(t,0),16):t};ks&&FY({target:"JSON",stat:!0,arity:3,forced:bT||ST},{stringify:function(e,n,i){var r=JO(arguments),o=ZO(bT?KY:ks,null,r);return ST&&typeof o=="string"?zY(o,GY,XY):o}});function Eu(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Fe(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=Eu(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[Eu(n[0])]:e[i]=[]:e[i]=null)})),e}function Tr(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function tn(t,e,n){const i=Array.isArray(n);return Fe(e,(r,o)=>{(i===!1||n.includes(o))&&(t[o]=r)}),t}function vd(t,e){Fe(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),vd(t[i],e[i])):t[i]=e[i]})}function $n(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function br(t){const e={};return Fe(t,(n,i)=>{e[i]=n}),e}function mt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return M(n,r=>{t.MIXINS.push(r.MIXIN_NAME),Fe(r,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=m=>{let w=m;return(Array.isArray(w)||ke(w))&&(w=$n(w)),w};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Ep(t,e){return JSON.stringify(t)===JSON.stringify(e)}function ke(t){return Object.prototype.toString.call(t)==="[object Object]"}function go(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function Fe(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function ex(t,e){const n=e.split(".");let i=t;return Fe(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function Hg(t,e,n){const i=e.split(".");let r=t;i.forEach((o,s)=>{s!==i.length-1?($t(r,o)||(r[o]={}),r=r[o]):r[o]=n})}function Tp(t){if(!ke(t))return 0;const e=function(n){let i=0;return ke(n)?Fe(n,(r,o)=>{o!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function Bi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function $t(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const qY=Object.freeze(Object.defineProperty({__proto__:null,clone:br,createObjectPropListener:Bi,deepClone:$n,deepExtend:vd,deepObjectSize:Tp,defineGetter:go,duckSchema:Eu,extend:tn,getProperty:ex,hasOwnProperty:$t,inherit:Tr,isObject:ke,isObjectEqual:Ep,mixin:mt,objectEach:Fe,setProperty:Hg},Symbol.toStringTag,{value:"Module"}));function Mp(t){return window.requestAnimationFrame(t)}function Ah(t){window.cancelAnimationFrame(t)}function lR(){return"ontouchstart"in window}function tx(){return typeof window<"u"}let yl;function nx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return yl||(typeof Intl=="object"?yl=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?yl=(n,i)=>`${n}`.localeCompare(i):yl=(n,i)=>n===i?0:n>i?-1:1,yl)}const ZY=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Ah,getComparisonFunction:nx,isCSR:tx,isTouchSupported:lR,requestAnimationFrame:Mp},Symbol.toStringTag,{value:"Module"})),Ni=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},ts={chrome:Ni((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Ni(t=>/CriOS/.test(t)),edge:Ni(t=>/Edge/.test(t)),edgeWebKit:Ni(t=>/EdgiOS/.test(t)),firefox:Ni(t=>/Firefox/.test(t)),firefoxWebKit:Ni(t=>/FxiOS/.test(t)),mobile:Ni(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Ni((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Nu={mac:Ni(t=>/^Mac/.test(t)),win:Ni(t=>/^Win/.test(t)),linux:Ni(t=>/^Linux/.test(t)),ios:Ni(t=>/iPhone|iPad|iPod/i.test(t))};function ix(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fe(ts,n=>{let{test:i}=n;return void i(t,e)})}function rx(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fe(Nu,e=>{let{test:n}=e;return void n(t)})}tx()&&(ix(),rx());function uR(){return ts.chrome.value}function ox(){return ts.chromeWebKit.value}function Ng(){return ts.firefox.value}function sx(){return ts.firefoxWebKit.value}function cR(){return ts.safari.value}function ax(){return ts.edge.value}function QY(){return ts.edgeWebKit.value}function Wo(){return ts.mobile.value}function hR(){return Nu.ios.value}function dR(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Nu.mac.value}function mb(){return Nu.win.value}function Hh(){return Nu.mac.value}function JY(){return Nu.linux.value}const eG=Object.freeze(Object.defineProperty({__proto__:null,isChrome:uR,isChromeWebKit:ox,isEdge:ax,isEdgeWebKit:QY,isFirefox:Ng,isFirefoxWebKit:sx,isIOS:hR,isIpadOS:dR,isLinuxOS:JY,isMacOS:Hh,isMobileBrowser:Wo,isSafari:cR,isWindowsOS:mb,setBrowserMeta:ix,setPlatformMeta:rx},Symbol.toStringTag,{value:"Module"})),ve={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Ng()?182:174,AUDIO_MUTE:Ng()?181:173,AUDIO_UP:Ng()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},tG=[ve.ALT,ve.ARROW_DOWN,ve.ARROW_LEFT,ve.ARROW_RIGHT,ve.ARROW_UP,ve.AUDIO_DOWN,ve.AUDIO_MUTE,ve.AUDIO_UP,ve.BACKSPACE,ve.CAPS_LOCK,ve.DELETE,ve.END,ve.ENTER,ve.ESCAPE,ve.F1,ve.F2,ve.F3,ve.F4,ve.F5,ve.F6,ve.F7,ve.F8,ve.F9,ve.F10,ve.F11,ve.F12,ve.F13,ve.F14,ve.F15,ve.F16,ve.F17,ve.F18,ve.F19,ve.HOME,ve.INSERT,ve.MEDIA_NEXT,ve.MEDIA_PLAY_PAUSE,ve.MEDIA_PREV,ve.MEDIA_STOP,ve.NULL,ve.NUM_LOCK,ve.PAGE_DOWN,ve.PAGE_UP,ve.PAUSE,ve.SCROLL_LOCK,ve.SHIFT,ve.TAB];function lx(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function fR(t){return tG.includes(t)}function nG(t){const e=[];return Hh()?e.push(ve.COMMAND_LEFT,ve.COMMAND_RIGHT,ve.COMMAND_FIREFOX):e.push(ve.CONTROL),e.includes(t)}function ux(t){return[ve.CONTROL,ve.COMMAND_LEFT,ve.COMMAND_RIGHT,ve.COMMAND_FIREFOX].includes(t)}function Du(t,e){const n=e.split("|");let i=!1;return M(n,r=>{if(t===ve[r])return i=!0,!1}),i}const iG=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ve,isCtrlKey:nG,isCtrlMetaKey:ux,isFunctionKey:fR,isKey:Du,isPrintableChar:lx},Symbol.toStringTag,{value:"Module"}));function Xi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ms(t){return t.isImmediatePropagationEnabled===!1}function zs(t){return t.button===2}function _p(t){return t.button===0}function cx(t){return t instanceof TouchEvent}function hx(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!(e instanceof HTMLElement)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}const rG=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ms,isLeftClick:_p,isRightClick:zs,isTouchEvent:cx,offsetRelativeTo:hx,stopImmediatePropagation:Xi},Symbol.toStringTag,{value:"Module"}));var dx={},oG=JI,sG=wS,aG=Object.keys||function(e){return oG(e,sG)},lG=Sr,uG=YI,cG=Xs,hG=Qo,dG=Jm,fG=aG;dx.f=lG&&!uG?Object.defineProperties:function(e,n){hG(e);for(var i=dG(n),r=fG(n),o=r.length,s=0,a;o>s;)cG.f(e,a=r[s++],i[a]);return e};var gG=Qo,mG=dx,RT=wS,pG=mS,wG=RP,vG=fS,CG=XI,ET=">",TT="<",pb="prototype",wb="script",fx=CG("IE_PROTO"),Uv=function(){},gx=function(t){return TT+wb+ET+t+TT+"/"+wb+ET},MT=function(t){t.write(gx("")),t.close();var e=t.parentWindow.Object;return t=null,e},yG=function(){var t=vG("iframe"),e="java"+wb+":",n;return t.style.display="none",wG.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(gx("document.F=Object")),n.close(),n.F},Xd,Dg=function(){try{Xd=new ActiveXObject("htmlfile")}catch{}Dg=typeof document<"u"?document.domain&&Xd?MT(Xd):yG():MT(Xd);for(var t=RT.length;t--;)delete Dg[pb][RT[t]];return Dg()};pG[fx]=!0;var bG=Object.create||function(e,n){var i;return e!==null?(Uv[pb]=gG(e),i=new Uv,Uv[pb]=null,i[fx]=e):i=Dg(),n===void 0?i:mG.f(i,n)},SG=Ks,RG=bG,EG=Xs.f,vb=SG("unscopables"),Cb=Array.prototype;Cb[vb]===void 0&&EG(Cb,vb,{configurable:!0,value:RG(null)});var gR=function(t){Cb[vb][t]=!0},TG=gR;TG("flatMap");function ft(){fe(console)&&console.warn(...arguments)}function mR(){fe(console)&&console.error(...arguments)}function MG(t,e,n){return(e=_G(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _G(t){var e=IG(t,"string");return typeof e=="symbol"?e:e+""}function IG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],PG=gt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,zv=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Yv=new Map([[]]),qd=new WeakMap;class mx{static getSingleton(){return xG()}constructor(){MG(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return M(bl,n=>{e[n]=[],this.initOrderMap(e,n)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;if(Array.isArray(n))M(n,o=>this.add(e,o,i));else{zv.has(e)&&ft(qS(PG,{hookName:e,removedInVersion:zv.get(e)})),Yv.has(e)&&ft(Yv.get(e));const o=this.getBucket(i);if(typeof o[e]>"u"&&(this.register(e),o[e]=[],this.initOrderMap(o,e)),n.skip=!1,o[e].indexOf(n)===-1){let s=!1;n.initialHook&&M(o[e],(a,l)=>{if(a.initialHook)return o[e][l]=n,s=!0,!1}),s||o[e].push(n)}this.setCallbackOrderIndex(o,e,n,r),this.orderBucketByOrderIndex(o,e)}return this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;Array.isArray(n)?M(n,o=>this.once(e,o,i)):(n.runOnce=!0,this.add(e,n,i,r))}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const r=this.getBucket(i);return typeof r[e]<"u"&&r[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=this.getBucket(n);return!!(i[e]!==void 0&&i[e].length)}run(e,n,i,r,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=dm(u[h],e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=dm(u[h],e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Fe(this.getBucket(e),(n,i,r)=>r[i].length=0)}register(e){this.isRegistered(e)||bl.push(e)}deregister(e){this.isRegistered(e)&&bl.splice(bl.indexOf(e),1)}isDeprecated(e){return Yv.has(e)||zv.has(e)}isRegistered(e){return bl.indexOf(e)>=0}getRegistered(){return bl}setCallbackOrderIndex(e,n,i,r){const o=Number.isInteger(r)?r:0,s=this.getCallbackOrderMap(e,n);s.set(o,[...s.get(o)||[],i])}orderBucketByOrderIndex(e,n){const i=this.getCallbackOrderMap(e,n);i===void 0||i.size===0||i.size===1&&i.has(0)||(e[n]=[...i].sort((r,o)=>r[0]-o[0]).flatMap(r=>{let[,o]=r;return o}))}initOrderMap(e,n){qd.has(e)||qd.set(e,[]),qd.get(e)[n]=new Map}getCallbackOrderMap(e,n){return qd.get(e)[n]}}const OG=new mx;function xG(){return OG}const de=mx,Gv=new Map;function Mr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Gv.has(t)||Gv.set(t,new Map);const e=Gv.get(t);function n(a,l){e.set(a,l)}function i(a){return e.get(a)}function r(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:i,hasItem:r,getNames:o,getValues:s}}const yb=new WeakMap,{register:AG,getItem:px,hasItem:wx,getNames:HG,getValues:kce}=Mr("editors");function NG(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},de.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function vx(t,e){let n;if(typeof t=="function")yb.get(t)||ri(null,t),n=yb.get(t);else if(typeof t=="string")n=px(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function fm(t){if(typeof t=="function")return t;if(!wx(t))throw Error(`No registered editor found under "${t}" name`);return px(t).getConstructor()}function ri(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new NG(e);typeof t=="string"&&AG(t,n),yb.set(e,n)}function DG(t,e,n){return(e=LG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LG(t){var e=$G(t,"string");return typeof e=="symbol"?e:e+""}function $G(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Lg=0;class kG{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;DG(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){i.call(this,FG(s))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:o,options:r,eventManager:this}),e.addEventListener(n,o,r),Lg+=1,()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(i&&i!==s.callback||r&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Lg-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),Lg-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):s=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function FG(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Xi(this)},t}const Yi=kG;function VG(){return Lg}function WG(t,e){BG(t,e),e.add(t)}function BG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function na(t,e,n){return(e=jG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jG(t){var e=UG(t,"string");return typeof e=="symbol"?e:e+""}function UG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _T(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Kv=new WeakSet;class bb{constructor(e,n,i){WG(this,Kv),na(this,"hot",void 0),na(this,"tableMeta",void 0),na(this,"selection",void 0),na(this,"eventManager",void 0),na(this,"destroyed",!1),na(this,"activeEditor",void 0),na(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new Yi(e),this.hot.addHook("afterDocumentKeyDown",r=>_T(Kv,this,zG).call(this,r)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",r=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",r)}),this.hot.view._wt.update("onCellDblClick",(r,o,s)=>_T(Kv,this,YG).call(this,r,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,o=this.hot.runHooks("modifyGetCellCoords",i,r);let s=i,a=r;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,r,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=vx(u,this.hot),this.activeEditor.prepare(i,r,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&r.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(i))||s.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function zG(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ms(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!fR(n)&&!ux(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function YG(t,e){e.isCell()&&this.openEditor(null,t,!0)}const IT=new WeakMap;bb.getInstance=function(t,e,n){let i=IT.get(t);return i||(i=new bb(t,e,n),IT.set(t,i)),i};const GG=bb;function KG(t,e){Cx(t,e),e.add(t)}function Ku(t,e,n){Cx(t,e),e.set(t,n)}function Cx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dt(t,e){return t.get(ko(t,e))}function Xu(t,e,n){return t.set(ko(t,e),n),n}function ko(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wu=Object.freeze({CELL:"cell",MIXED:"mixed"});var Cn=new WeakMap,Zd=new WeakMap,Qd=new WeakMap,Jd=new WeakMap,ef=new WeakMap,ys=new WeakSet;class XG{constructor(e){var n=this;KG(this,ys),Ku(this,Cn,void 0),Ku(this,Zd,void 0),Ku(this,Qd,1),Ku(this,Jd,null),Ku(this,ef,new Map);const i=e.getSettings();Xu(Cn,this,e),Xu(Zd,this,i.imeFastEdit?wu.MIXED:wu.CELL),Dt(Cn,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ko(ys,n,ZG).call(n,...o)}),Dt(Cn,this).addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ko(ys,n,PT).call(n,...o)}),Dt(Cn,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ko(ys,n,PT).call(n,...o)}),Dt(Cn,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ko(ys,n,qG).call(n,...o)})}getFocusMode(){return Dt(Zd,this)}setFocusMode(e){Object.values(wu).includes(e)?Xu(Zd,this,e):ft(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Dt(Qd,this)}setRefocusDelay(e){Xu(Qd,this,e)}setRefocusElementGetter(e){Xu(Jd,this,e)}getRefocusElement(){if(typeof Dt(Jd,this)=="function")return Dt(Jd,this).call(this);var e;return(e=Dt(Cn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,o;const s=(r=Dt(Cn,this).getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;if(!s)return;let a=Dt(Cn,this).runHooks("modifyFocusedElement",s.row,s.col,i);a instanceof HTMLElement||(a=i),a&&!((o=Dt(Cn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):ko(ys,this,pR).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dt(Qd,this);const i=this.getRefocusElement();Dt(Cn,this).getSettings().imeFastEdit&&!((e=Dt(Cn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&i&&(Dt(ef,this).has(n)||Dt(ef,this).set(n,Rp(()=>{i.select()},n)),Dt(ef,this).get(n)())}}function pR(t){var e;const n=(e=Dt(Cn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Dt(Cn,this).selection.isCellVisible(n)){t(null);return}const i=Dt(Cn,this).getCell(n.row,n.col,!0);i===null?Dt(Cn,this).addHookOnce("afterScroll",()=>{t(Dt(Cn,this).getCell(n.row,n.col,!0))}):t(i)}function PT(){ko(ys,this,pR).call(this,t=>{const{activeElement:e}=Dt(Cn,this).rootDocument;e&&Sp(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function qG(){ko(ys,this,pR).call(this,t=>{this.getFocusMode()===wu.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function ZG(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?wu.MIXED:wu.CELL)}var QG=ao,JG=ol,e2=Ks,t2=e2("match"),n2=function(t){var e;return QG(t)&&((e=t[t2])!==void 0?!!e:JG(t)==="RegExp")},i2=Qo,r2=function(){var t=i2(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},o2=Rr,s2=lo,a2=ep,l2=r2,OT=RegExp.prototype,u2=function(t){var e=t.flags;return e===void 0&&!("flags"in OT)&&!s2(t,"flags")&&a2(OT,t)?o2(l2,t):e},wR=sn,c2=rd,h2=Math.floor,Xv=wR("".charAt),d2=wR("".replace),qv=wR("".slice),f2=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,g2=/\$([$&'`]|\d{1,2})/g,m2=function(t,e,n,i,r,o){var s=n+t.length,a=i.length,l=g2;return r!==void 0&&(r=c2(r),l=f2),d2(o,l,function(u,c){var h;switch(Xv(c,0)){case"$":return"$";case"&":return t;case"`":return qv(e,0,n);case"'":return qv(e,s);case"<":h=r[qv(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var g=h2(d/10);return g===0?u:g<=a?i[g-1]===void 0?Xv(c,1):i[g-1]+Xv(c,1):u}h=i[d-1]}return h===void 0?"":h})},p2=Mn,w2=Rr,vR=sn,xT=nd,v2=Tn,C2=Qm,y2=n2,qu=op,b2=ip,S2=u2,R2=m2,E2=Ks,T2=E2("replace"),M2=TypeError,Zv=vR("".indexOf);vR("".replace);var AT=vR("".slice),_2=Math.max;p2({target:"String",proto:!0},{replaceAll:function(e,n){var i=xT(this),r,o,s,a,l,u,c,h,d,g,m=0,w="";if(!C2(e)){if(r=y2(e),r&&(o=qu(xT(S2(e))),!~Zv(o,"g")))throw new M2("`.replaceAll` does not allow non-global regexes");if(s=b2(e,T2),s)return w2(s,e,i,n)}for(a=qu(i),l=qu(e),u=v2(n),u||(n=qu(n)),c=l.length,h=_2(1,c),d=Zv(a,l);d!==-1;)g=u?qu(n(l,d,a)):R2(l,a,d,[],void 0,n),w+=AT(a,m,d)+g,m=d+c,d=d+h>a.length?-1:Zv(a,l,d+h);return m<a.length&&(w+=AT(a,m)),w}});const yx={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},I2=new RegExp(Object.keys(yx).map(t=>`(${t})`).join("|"),"gi");function P2(t){return(t&&t.nodeName||"")==="TABLE"}function Sb(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),o=r.length,s=o>0?r[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,m=[];for(let C=0;C<s;C+=1){const S=!g&&n&&C===0;let R="";if(g)R=`<th>${t.getColHeader(C-c)}</th>`;else if(S)R=`<th>${t.getRowHeader(d-h)}</th>`;else{const E=r[d][C],{hidden:H,rowspan:P,colspan:B}=t.getCellMeta(d-h,C-c);if(!H){const j=[];if(P&&j.push(`rowspan="${P}"`),B&&j.push(`colspan="${B}"`),Yt(E))R=`<td ${j.join(" ")}></td>`;else{const Y=E.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${j.join(" ")}>${Y}</td>`}}}m.push(R)}const w=["<tr>",...m,"</tr>"].join("");g?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Rb(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],o=r.length,s=[];i===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=r[a],u=Yt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function bx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let o=t;if(typeof o=="string"){const E=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,H=>{const P=H.match(/<td\b[^>]*?>/g)[0],B=/<p.*?>/g,j=H.substring(P.length,H.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(B,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${j}</td>`});r.insertAdjacentHTML("afterbegin",`${E}`),o=r.querySelector("table")}if(!o||!P2(o))return;const s=r.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((E,H)=>E+H.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,m=0;if(o.tHead){const E=Array.from(o.tHead.rows).filter(H=>{const P=H.querySelector("td")!==null;return P&&h.push(H),!P});g=E.length,d=g>0,g>1?n.nestedHeaders=Array.from(E).reduce((H,P)=>{const B=Array.from(P.cells).reduce((j,Y,G)=>{if(a&&G===0)return j;const{colSpan:z,innerHTML:J}=Y,Z=z>1?{label:J,colspan:z}:J;return j.push(Z),j},[]);return H.push(B),H},[]):d&&(n.colHeaders=Array.from(E[0].children).reduce((H,P,B)=>(a&&B===0||H.push(P.innerHTML),H),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const w=[...h,...Array.from(o.tBodies).reduce((E,H)=>(E.push(...Array.from(H.rows)),E),[]),...c];m=w.length;const C=new Array(m);for(let E=0;E<m;E++)C[E]=new Array(u);const S=[],R=[];for(let E=0;E<m;E++){const H=w[E],P=Array.from(H.cells),B=P.length;for(let j=0;j<B;j++){const Y=P[j],{nodeName:G,innerHTML:z,rowSpan:J,colSpan:Z}=Y,re=C[E].findIndex(pe=>pe===void 0);if(G==="TD"){if(J>1||Z>1){for(let Ne=E;Ne<E+J;Ne++)if(Ne<m)for(let ye=re;ye<re+Z;ye++)C[Ne][ye]=null;const Ie=Y.getAttribute("style");Ie&&Ie.includes("mso-ignore:colspan")||S.push({col:re,row:E,rowspan:J,colspan:Z})}let pe="";s&&/excel/gi.test(s.content)?pe=z.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):pe=z.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[E][re]=pe.replace(I2,Ie=>yx[Ie])}else R.push(z)}}return S.length&&(n.mergeCells=S),R.length&&(n.rowHeaders=R),C.length&&(n.data=C),n}const O2=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:Rb,htmlToGridSettings:bx,instanceToHTML:Sb},Symbol.toStringTag,{value:"Module"}));function Hn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Sx(t){return Hn(t,[","])}function Ce(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function Eb(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function CR(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function dt(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const x2=Object.freeze(Object.defineProperty({__proto__:null,clamp:dt,isNumeric:Hn,isNumericLike:Sx,rangeEach:Ce,rangeEachReverse:Eb,valueAccordingPercent:CR},Symbol.toStringTag,{value:"Module"})),Tb="asc",A2="desc",HT=new Map([[Tb,[-1,1]],[A2,[1,-1]]]),H2=t=>`The priority '${t}' is already declared in a map.`,N2=t=>`The priority '${t}' is not a number.`;function D2(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Et(t)?t:H2,e=Et(e)?e:N2;function i(o,s){if(!Hn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function r(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tb;const[s,a]=HT.get(o)||HT.get(Tb);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:i,getItems:r}}const L2=t=>`The id '${t}' is already declared in a map.`;function Ip(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Et(t)?t:L2;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function i(u){return e.delete(u)}function r(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:r,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:i}}const $2=t=>`'${t}' value is already declared in a unique set.`;function k2(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Et(t)?t:$2;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const yR=t=>`There is already registered "${t}" plugin.`,F2=t=>`There is already registered plugin on priority "${t}".`,V2=t=>`The priority "${t}" is not a number.`,Rx=D2({errorPriorityExists:F2,errorPriorityNaN:V2}),Ex=k2({errorItemExists:yR}),Mb=Ip({errorIdExists:yR});function bR(){return[...Rx.getItems(),...Ex.getItems()]}function Cd(t){const e=Ln(t);return Mb.getItem(e)}function W2(t){return!!Cd(t)}function it(t,e,n){[t,e,n]=j2(t,e,n),Cd(t)===void 0&&B2(t,e,n)}function B2(t,e,n){const i=Ln(t);if(Mb.hasItem(i))throw new Error(yR(i));n===void 0?Ex.addItem(i):Rx.addItem(n,i),Mb.addItem(i,e)}function j2(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:U2,getItem:z2,hasItem:Tx,getNames:Y2,getValues:Fce}=Mr("renderers");function gm(t){if(typeof t=="function")return t;if(!Tx(t))throw Error(`No registered renderer found under "${t}" name`);return z2(t)}function gi(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),U2(t,e)}const{register:G2,getItem:K2,hasItem:Mx,getNames:X2,getValues:Vce}=Mr("validators");function SR(t){if(typeof t=="function")return t;if(!Mx(t))throw Error(`No registered validator found under "${t}" name`);return K2(t)}function Va(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),G2(t,e)}var q2=Mn,Z2=rd,Q2=ad,J2=sd,eK=gR;q2({target:"Array",proto:!0},{at:function(e){var n=Z2(this),i=Q2(n),r=J2(e),o=r>=0?r:i+r;return o<0||o>=i?void 0:n[o]}});eK("at");var tK=Mn,nK=sn,iK=nd,rK=sd,oK=op,sK=ci,aK=nK("".charAt),lK=sK(function(){return"ð ®·".at(-2)!=="\uD842"});tK({target:"String",proto:!0,forced:lK},{at:function(e){var n=oK(iK(this)),i=n.length,r=rK(e),o=r>=0?r:i+r;return o<0||o>=i?void 0:aK(n,o)}});function Zu(t,e,n){return(e=uK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:e+""}function cK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hK{constructor(){Zu(this,"count",0),Zu(this,"startColumn",null),Zu(this,"endColumn",null),Zu(this,"startPosition",null),Zu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o,columnWidth:s}=n,a=r>0?o+1:o;i>=r&&i+s<=r+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=r&&(this.startColumn-=1),m>=r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r,d=i+r-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||i>u.at(-1)||-1*i-r>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Qu(t,e,n){return(e=dK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dK(t){var e=fK(t,"string");return typeof e=="symbol"?e:e+""}function fK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gK{constructor(){Qu(this,"count",0),Qu(this,"startRow",null),Qu(this,"endRow",null),Qu(this,"startPosition",null),Qu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o,rowHeight:s}=n;i>=r&&i+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=r-o&&(this.startRow-=1),d>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=i+r-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ju(t,e,n){return(e=mK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mK(t){var e=pK(t,"string");return typeof e=="symbol"?e:e+""}function pK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _x{constructor(){Ju(this,"count",0),Ju(this,"startColumn",null),Ju(this,"endColumn",null),Ju(this,"startPosition",null),Ju(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o}=n;i<=r&&(this.startColumn=e);const s=r>0?o+1:o;i>=r&&i<=r+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r;i+r-h<-1*o||i>u.at(-1)+c||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ec(t,e,n){return(e=wK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wK(t){var e=vK(t,"string");return typeof e=="symbol"?e:e+""}function vK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ix{constructor(){ec(this,"count",0),ec(this,"startRow",null),ec(this,"endRow",null),ec(this,"startPosition",null),ec(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o}=n;i<=r&&(this.startRow=e),i>=r&&i<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,i+r-o<0||i>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function tc(t,e,n){return(e=CK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CK(t){var e=yK(t,"string");return typeof e=="symbol"?e:e+""}function yK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bK{constructor(){tc(this,"count",0),tc(this,"startColumn",0),tc(this,"endColumn",0),tc(this,"startPosition",0),tc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function nc(t,e,n){return(e=SK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SK(t){var e=RK(t,"string");return typeof e=="symbol"?e:e+""}function RK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EK{constructor(){nc(this,"count",0),nc(this,"startRow",0),nc(this,"endRow",0),nc(this,"startPosition",0),nc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}class TK extends _x{finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:o}=e;this.startColumn!==null&&typeof i=="function"&&i(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class MK extends Ix{finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:o}=e;this.startRow!==null&&typeof i=="function"&&i(this),this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function NT(t,e,n){return(e=_K(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _K(t){var e=IK(t,"string");return typeof e=="symbol"?e:e+""}function IK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Px{constructor(e){NT(this,"calculationTypes",[]),NT(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Qi(t,e,n){return(e=PK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PK(t){var e=OK(t,"string");return typeof e=="symbol"?e:e+""}function OK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Pp=50;class xK extends Px{constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Qi(this,"viewportWidth",0),Qi(this,"scrollOffset",0),Qi(this,"zeroBasedScrollOffset",0),Qi(this,"totalColumns",0),Qi(this,"columnWidthFn",null),Qi(this,"columnWidth",0),Qi(this,"overrideFn",null),Qi(this,"inlineStartOffset",0),Qi(this,"totalCalculatedWidth",0),Qi(this,"startPositions",[]),Qi(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Pp:n}}function Mi(t,e,n){return(e=AK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AK(t){var e=HK(t,"string");return typeof e=="symbol"?e:e+""}function HK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ox=23;class NK extends Px{constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:o,rowHeightFn:s,overrideFn:a,horizontalScrollbarHeight:l}=e;super(n),Mi(this,"viewportHeight",0),Mi(this,"scrollOffset",0),Mi(this,"zeroBasedScrollOffset",0),Mi(this,"totalRows",0),Mi(this,"rowHeightFn",null),Mi(this,"rowHeight",0),Mi(this,"overrideFn",null),Mi(this,"horizontalScrollbarHeight",0),Mi(this,"innerViewportHeight",0),Mi(this,"totalCalculatedHeight",0),Mi(this,"startPositions",[]),Mi(this,"needReverse",!0),this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=o,this.rowHeightFn=s,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?Ox:n}}function DK(t,e,n){LK(t,e),e.set(t,n)}function LK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DT(t,e,n){return(e=$K(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $K(t){var e=kK(t,"string");return typeof e=="symbol"?e:e+""}function kK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sl(t,e){return t.get(xx(t,e))}function LT(t,e,n){return t.set(xx(t,e),n),n}function xx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wo=new WeakMap;class mm{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;DT(this,"row",null),DT(this,"col",null),DK(this,wo,!1),LT(wo,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Sl(wo,this)}isSouthEastOf(e){return this.row>=e.row&&(Sl(wo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Sl(wo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Sl(wo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Sl(wo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof mm&&LT(wo,this,e.isRtl()),this}clone(){return new mm(this.row,this.col,Sl(wo,this))}toObject(){return{row:this.row,col:this.col}}}const pm=mm;function FK(t,e,n){VK(t,e),e.set(t,n)}function VK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qv(t,e,n){return(e=WK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WK(t){var e=BK(t,"string");return typeof e=="symbol"?e:e+""}function BK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _i(t,e){return t.get(Ax(t,e))}function jK(t,e,n){return t.set(Ax(t,e),n),n}function Ax(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qn=new WeakMap;class RR{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Qv(this,"highlight",null),Qv(this,"from",null),Qv(this,"to",null),FK(this,qn,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),jK(qn,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=n&&o.row>=n&&r.col<=i&&o.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,s.row),u=Math.min(i.col,s.col),c=Math.max(r.row,a.row),h=Math.max(r.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _i(qn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _i(qn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _i(qn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _i(qn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _i(qn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _i(qn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _i(qn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _i(qn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof pm))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(_i(qn,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(_i(qn,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)!(this.from.row===r&&this.from.col===o)&&!(this.to.row===r&&this.to.col===o)&&i.push(this._createCellCoords(r,o));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)e.row===r&&e.col===o?i.push(e):n.row===r&&n.col===o?i.push(n):i.push(this._createCellCoords(r,o));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let o=n.col;o<=i.col;o++)if(e(r,o)===!1)return}clone(){return new RR(this.highlight,this.from,this.to,_i(qn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new pm(e,n,_i(qn,this))}}const ER=RR;function Ir(t,e,n){UK(t,e),e.set(t,n)}function UK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function be(t,e){return t.get(Hx(t,e))}function rs(t,e,n){return t.set(Hx(t,e),n),n}function Hx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ii=new WeakMap,Jv=new WeakMap,pn=new WeakMap,Rl=new WeakMap,tf=new WeakMap,Ji=new WeakMap,eC=new WeakMap,ic=new WeakMap,ia=new WeakMap,Pr=new WeakMap;let zK=class{constructor(e,n,i,r,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Ir(this,Ii,void 0),Ir(this,Jv,void 0),Ir(this,pn,void 0),Ir(this,Rl,void 0),Ir(this,tf,void 0),Ir(this,Ji,void 0),Ir(this,eC,void 0),Ir(this,ic,void 0),Ir(this,ia,[null,null]),Ir(this,Pr,[null,null]),rs(Ii,this,i),rs(Jv,this,n),rs(pn,this,o),rs(Rl,this,s),rs(tf,this,a),rs(Ji,this,r),rs(eC,this,e),this.registerEvents()}registerEvents(){be(Ji,this).addEventListener(be(pn,this).holder,"contextmenu",i=>this.onContextMenu(i)),be(Ji,this).addEventListener(be(pn,this).TABLE,"mouseover",i=>this.onMouseOver(i)),be(Ji,this).addEventListener(be(pn,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{be(Ji,this).addEventListener(be(pn,this).holder,"touchstart",i=>this.onTouchStart(i)),be(Ji,this).addEventListener(be(pn,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),be(Ji,this).addEventListener(be(pn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||be(Ii,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,be(Ii,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{be(Ji,this).addEventListener(be(pn,this).holder,"mouseup",i=>this.onMouseUp(i)),be(Ji,this).addEventListener(be(pn,this).holder,"mousedown",i=>this.onMouseDown(i))};Wo()?e():(lR()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(be(ic,this)&&i){const[r,o]=[i.row,be(ic,this).from.row],[s,a]=[i.col,be(ic,this).from.col];return r===o&&s===a}return!1}parentCell(e){const n={},i=be(pn,this).TABLE,r=Kc(e,["TD","TH"],i);return r?(n.coords=be(pn,this).getCoords(r),n.TD=r):_e(e,"wtBorder")&&_e(e,"current")?(n.coords=be(Rl,this).getFocusSelection().cellRange.highlight,n.TD=be(pn,this).getCell(n.coords)):_e(e,"wtBorder")&&_e(e,"area")&&be(Rl,this).getAreaSelection().cellRange&&(n.coords=be(Rl,this).getAreaSelection().cellRange.to,n.TD=be(pn,this).getCell(n.coords)),n}onMouseDown(e){const n=be(Jv,this).rootDocument.activeElement,i=aR(NO,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const o=this.parentCell(r);_e(r,"corner")?be(Ii,this).getSetting("onCellCornerMouseDown",e,r):o.TD&&be(Ii,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(be(Pr,this)[0]=o.TD,clearTimeout(be(ia,this)[0]),be(ia,this)[0]=setTimeout(()=>{be(Pr,this)[0]=null},1e3))}onContextMenu(e){if(be(Ii,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!be(Ii,this).has("onCellMouseOver"))return;const n=be(pn,this).TABLE,i=Kc(e.target,["TD","TH"],n),r=be(tf,this)||this;i&&i!==r.lastMouseOver&&$s(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,be(pn,this).getCoords(i),i))}onMouseOut(e){if(!be(Ii,this).has("onCellMouseOut"))return;const n=be(pn,this).TABLE,i=Kc(e.target,["TD","TH"],n),r=Kc(e.relatedTarget,["TD","TH"],n),o=be(tf,this)||this;i&&i!==r&&$s(i,n)&&(this.callListener("onCellMouseOut",e,be(pn,this).getCoords(i),i),r===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&be(Ii,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===be(Pr,this)[0]&&n.TD===be(Pr,this)[1]?(_e(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),be(Pr,this)[0]=null,be(Pr,this)[1]=null):n.TD===be(Pr,this)[0]&&(be(Pr,this)[1]=n.TD,clearTimeout(be(ia,this)[1]),be(ia,this)[1]=setTimeout(()=>{be(Pr,this)[1]=null},500)))}onTouchStart(e){rs(ic,this,be(Rl,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=fe(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&o&&be(Ii,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];hR()&&(ox()||sx())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const o=be(Ii,this).getSettingPure(e);o&&o(n,i,r,be(eC,this).call(this))}destroy(){clearTimeout(be(ia,this)[0]),clearTimeout(be(ia,this)[1]),be(Ji,this).destroy()}};const Nx=zK;function tC(t,e,n){return(e=YK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YK(t){var e=GK(t,"string");return typeof e=="symbol"?e:e+""}function GK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KK{constructor(e,n,i){tC(this,"offset",void 0),tC(this,"total",void 0),tC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const XK=KK;function nC(t,e,n){return(e=qK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qK(t){var e=ZK(t,"string");return typeof e=="symbol"?e:e+""}function ZK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QK{constructor(e,n,i){nC(this,"offset",void 0),nC(this,"total",void 0),nC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const JK=QK,e3=0,wm=1,vm=2;function nf(t,e,n){return(e=t3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t3(t){var e=n3(t,"string");return typeof e=="symbol"?e:e+""}function n3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $T{constructor(){nf(this,"currentSize",0),nf(this,"nextSize",0),nf(this,"currentOffset",0),nf(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function iC(t,e,n){return(e=i3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i3(t){var e=r3(t,"string");return typeof e=="symbol"?e:e+""}function r3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o3{constructor(){iC(this,"size",new $T),iC(this,"workingSpace",e3),iC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof $T}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=wm,e.workingSpace=vm,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=vm,e.workingSpace=wm,this.sharedSize=e.getViewSize()}}function El(t,e,n){return(e=s3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s3(t){var e=a3(t,"string");return typeof e=="symbol"?e:e+""}function a3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dx{constructor(e,n,i){El(this,"rootNode",void 0),El(this,"nodesPool",void 0),El(this,"sizeSet",new o3),El(this,"childNodeType",void 0),El(this,"visualIndex",0),El(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=i.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let i=0;if(this.isSharedViewSet()){let r=e.firstElementChild;for(;r;){if(r.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(wm))break;r=r.nextElementSibling}}else i=e.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,i=this.isSharedViewSet(),{nextSize:r}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<r;){const a=this.nodesPool();!i||i&&n.isPlaceOn(vm)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=i&&n.isPlaceOn(wm);for(;o>r;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(vm)&&(i+=n.sharedSize.nextSize);let r=e.childNodes[i];if(r.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}end(){}}class Lx extends Dx{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function l3(t,e,n){return(e=u3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u3(t){var e=c3(t,"string");return typeof e=="symbol"?e:e+""}function c3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h3{constructor(e){l3(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function rc(t,e,n){return(e=d3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d3(t){var e=f3(t,"string");return typeof e=="symbol"?e:e+""}function f3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yd{constructor(e,n){rc(this,"nodesPool",null),rc(this,"nodeType",void 0),rc(this,"rootNode",void 0),rc(this,"table",null),rc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new h3(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function kT(t,e,n){return(e=g3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g3(t){var e=m3(t,"string");return typeof e=="symbol"?e:e+""}function m3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p3 extends yd{constructor(){super("TH"),kT(this,"orderViews",new WeakMap),kT(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new Lx(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=r.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<i;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),fl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Me(d,[tY(),cY(),ZS(h+1),Hu(-1)]),n[h](a,d,h)}u.end()}}}class w3 extends yd{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,o=r+n;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<o;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)i.removeChild(i.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&yr(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Me(this.rootNode,[IO()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Me(s,[fb(),AO(n+1)]);for(let a=-1*o;a<r;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),fl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Me(u,[ZS(a+1+this.table.rowHeadersCount),Hu(-1),nY(),...a>=0?[uY()]:[fb()]]),i[n](l,u,n)}}}}let FT=!1;class v3 extends yd{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!FT&&e>1e3&&(FT=!0,ft(gt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width=`${s}px`}for(let r=0;r<e;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[r+n].style.width=`${s}px`}const i=this.rootNode.firstChild;i&&X(i,"rowHeader")}}function C3(t,e,n){return(e=y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y3(t){var e=b3(t,"string");return typeof e=="symbol"?e:e+""}function b3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rf={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let VT=!1;class S3 extends yd{constructor(e){super("TR",e),C3(this,"orderView",void 0),this.orderView=new Dx(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!VT&&e>1e3&&(VT=!0,ft(gt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Me(this.rootNode,[IO()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;Me(o,[fb(),AO(s+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}xe(o,[rf.rowEven,rf.rowOdd]),(s+1)%2===0?X(o,rf.rowEven):X(o,rf.rowOdd)}this.orderView.end()}}function WT(t,e,n){return(e=R3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R3(t){var e=E3(t,"string");return typeof e=="symbol"?e:e+""}function E3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T3 extends yd{constructor(){super("TD"),WT(this,"orderViews",new WeakMap),WT(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new Lx(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=r.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<n;d++){c.render();const g=c.getCurrentNode(),m=this.table.renderedColumnToSource(d);if(_e(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),fl(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,m,g),this.table.isAriaEnabled()){var o,s;Me(g,[...g.hasAttribute("role")?[]:[eY()],Hu(-1),ZS(m+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function un(t,e,n){return(e=M3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M3(t){var e=_3(t,"string");return typeof e=="symbol"?e:e+""}function _3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I3{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};un(this,"rootNode",void 0),un(this,"rootDocument",void 0),un(this,"rowHeaders",null),un(this,"columnHeaders",null),un(this,"colGroup",null),un(this,"rows",null),un(this,"cells",null),un(this,"rowFilter",null),un(this,"columnFilter",null),un(this,"rowUtils",null),un(this,"columnUtils",null),un(this,"rowsToRender",0),un(this,"columnsToRender",0),un(this,"rowHeaderFunctions",[]),un(this,"rowHeadersCount",0),un(this,"columnHeaderFunctions",[]),un(this,"columnHeadersCount",0),un(this,"cellRenderer",void 0),un(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i);if(r.firstChild){const o=this.renderedRowToSource(i),s=this.rowUtils.getHeightByOverlayName(o,this.activeOverlayName);s?r.firstChild.style.height=`${s-1}px`:r.firstChild.style.height=""}}}}class P3{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new I3(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new p3,columnHeaders:new w3(n),colGroup:new v3(i),rows:new S3(r),cells:new T3}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function oc(t,e,n){O3(t,e),e.set(t,n)}function O3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function of(t,e,n){return(e=x3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x3(t){var e=A3(t,"string");return typeof e=="symbol"?e:e+""}function A3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function In(t,e){return t.get($x(t,e))}function sc(t,e,n){return t.set($x(t,e),n),n}function $x(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sf=new WeakMap,Tl=new WeakMap,ac=new WeakMap,af=new WeakMap,ra=new WeakMap;class H3{constructor(e){let{totalColumns:n,stretchMode:i,stretchingColumnWidthFn:r,columnWidthFn:o}=e;of(this,"stretchAllRatio",0),of(this,"stretchLastWidth",0),of(this,"stretchAllColumnsWidth",[]),oc(this,sf,0),of(this,"needVerifyLastColumnWidth",!0),oc(this,Tl,()=>0),oc(this,ac,s=>s),oc(this,af,s=>s),oc(this,ra,()=>"none"),sc(Tl,this,n),sc(ra,this,i),sc(ac,this,r??In(ac,this)),sc(af,this,o??In(af,this))}refreshStretching(e){if(In(ra,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,sc(sf,this,e);let n=0;for(let r=0;r<In(Tl,this).call(this);r++){const o=this._getColumnWidth(r),s=In(ac,this).call(this,void 0,r);typeof s=="number"?e-=s:n+=o}const i=e-n;if(In(ra,this).call(this)==="all"&&i>0)this.stretchAllRatio=e/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(In(ra,this).call(this)==="last"&&e!==1/0){const r=this._getColumnWidth(In(Tl,this).call(this)-1),o=i+r;this.stretchLastWidth=o>=0?o:r}}getStretchedColumnWidth(e,n){let i=null;return In(ra,this).call(this)==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(e,n):In(ra,this).call(this)==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(e)),i}_getStretchedAllColumnWidth(e,n){let i=0;if(!this.stretchAllColumnsWidth[e]){const r=Math.round(n*this.stretchAllRatio),o=In(ac,this).call(this,r,e);o===void 0?this.stretchAllColumnsWidth[e]=r:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===In(Tl,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let r=0;r<this.stretchAllColumnsWidth.length;r++)i+=this.stretchAllColumnsWidth[r];i!==In(sf,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=In(sf,this)-i)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===In(Tl,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=In(af,this).call(this,e);return isNaN(n)&&(n=Pp),n}}function lf(t,e,n){return(e=N3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N3(t){var e=D3(t,"string");return typeof e=="symbol"?e:e+""}function D3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L3{constructor(e,n){lf(this,"dataAccessObject",void 0),lf(this,"wtSettings",void 0),lf(this,"headerWidths",new Map),lf(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=n,this.stretching=new H3({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(i,r)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",i,r),columnWidthFn:i=>this.dataAccessObject.wtTable.getColumnWidth(i)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let n=this.getWidth(e);const i=this.stretching.getStretchedColumnWidth(e,n);return i&&(n=i),n}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:n,cloneSource:i}=this.dataAccessObject,r=i?i.wtTable.holder:e.holder,o=r.offsetHeight<r.scrollHeight?mn():0;this.stretching.refreshStretching(n.getViewportWidth()-o)}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let o=0;o<i;o++){let s=Array.isArray(n)?n[o]:n;s=s??r,this.headerWidths.set(o,s)}}}}function BT(t,e,n){return(e=$3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $3(t){var e=k3(t,"string");return typeof e=="symbol"?e:e+""}function k3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F3{constructor(e,n){BT(this,"dataAccessObject",void 0),BT(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function Or(t,e,n){return(e=V3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V3(t){var e=W3(t,"string");return typeof e=="symbol"?e:e+""}function W3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B3{constructor(e,n,i,r,o){Or(this,"wtSettings",null),Or(this,"domBindings",void 0),Or(this,"TBODY",null),Or(this,"THEAD",null),Or(this,"COLGROUP",null),Or(this,"hasTableHeight",!0),Or(this,"hasTableWidth",!0),Or(this,"isTableVisible",!1),Or(this,"tableOffset",0),Or(this,"holderOffset",0),this.domBindings=i,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,JS(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new F3(this.dataAccessObject,this.wtSettings),this.columnUtils=new L3(this.dataAccessObject,this.wtSettings),this.tableRenderer=new P3({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!_e(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Me(i,[no()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!_e(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Me(i,[no()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!_e(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Me(i.parentNode,[no()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Me(i,[no()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=fn(this.holder),h=r.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const g=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=fn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=o>0?this.getFirstRenderedRow():0,m=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new JK(g,o,c),this.columnFilter=new XK(m,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),w=C.skipRender!==!0}if(w){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Jr)||this.is(Fs))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let C;if(this.isMaster&&(C=this.dataAccessObject.workspaceWidth,r.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Jr))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM();const S=_t(this.hider),R=_t(this.TABLE);S!==0&&R!==S&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),C!==r.getWorkspaceWidth()&&(r.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Jr)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,o=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(a=Ba(s),(!o&&r<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let o=0,s=r.length;o<s;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${i[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Jr))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const o=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i);if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!s&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const o=r.childNodes[i];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),o=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,a=(r<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[r];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=js(n,["TD","TH"])),n===null)return null;const i=n.parentNode,r=i.parentNode;let o=$O(i),s=n.cellIndex;return vs(nl,n,this.wtRootElement)||vs(el,n,this.wtRootElement)?r.nodeName==="THEAD"&&(o-=r.childNodes.length):vs(Fs,n,this.wtRootElement)||vs(Jr,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),vs(nl,n,this.wtRootElement)||vs(tl,n,this.wtRootElement)||vs(Fs,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),i=Ba(this.TBODY)-1;let r,o,s,a,l;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),r=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=Ba(l):o=Ba(a)-1,(!r&&this.wtSettings.getSetting("defaultRowHeight")<o||r<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return _t(this.TABLE)}getHeight(){return Zt(this.TABLE)}getTotalWidth(){const e=_t(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Zt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Qa(this.TABLE)}_modifyRowHeaderWidth(e){let n=Et(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Lu=B3,j3="stickyRowsBottom",kx={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};go(kx,"MIXIN_NAME",j3,{writable:!1,enumerable:!1});const Fx=kx,U3="stickyColumnsStart",Vx={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};go(Vx,"MIXIN_NAME",U3,{writable:!1,enumerable:!1});const TR=Vx;class MR extends Lu{constructor(e,n,i,r){super(e,n,i,r,Fs)}}mt(MR,Fx);mt(MR,TR);const z3=MR,el="top",Jr="bottom",tl="inline_start",nl="top_inline_start_corner",Fs="bottom_inline_start_corner",Wx=[el,Jr,tl,nl,Fs],Y3=new Map([[el,`ht_clone_${el}`],[Jr,`ht_clone_${Jr}`],[tl,`ht_clone_${tl} ht_clone_left`],[nl,`ht_clone_${nl} ht_clone_top_left_corner`],[Fs,`ht_clone_${Fs} ht_clone_bottom_left_corner`]]);function G3(t,e){K3(t,e),e.add(t)}function K3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function X3(t,e,n){return(e=q3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q3(t){var e=Z3(t,"string");return typeof e=="symbol"?e:e+""}function Z3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lc=new WeakSet;class Q3{constructor(e){G3(this,lc),X3(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i,r,o){const s=this.scrollViewportHorizontally(e.col,i,o),a=this.scrollViewportVertically(e.row,n,r);return s||a}scrollViewportHorizontally(e,n,i){const{drawn:r,totalColumns:o}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||e>o)return!1;const s=n===void 0&&i===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(s&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>o))return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(s&&(e<u||e>c)||!s)&&(h=l.scrollTo(e,s?e>=this.getLastPartiallyVisibleColumn():n)),h}scrollViewportVertically(e,n,i){const{drawn:r,totalRows:o}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||e>o)return!1;const s=n===void 0&&i===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject;if(s&&(e<l||e>o-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>o))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(s&&(e<c||e>h)||!s)&&(d=u.scrollTo(e,s?e>=this.getLastPartiallyVisibleRow():i)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return uf(lc,this,UT).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return uf(lc,this,UT).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return uf(lc,this,jT).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return uf(lc,this,jT).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function jT(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=fn(i.wtRootElement).left;const u=Math.abs(tR(s,s));if(l>u){const c=nR(s);let h=r.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function UT(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=fn(n.wtRootElement),a=yp(o,o);if(s.top>a){const l=Ba(o);let u=i.getColumnHeaderHeight();for(let c=1;c<=r;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}const J3=Q3;function er(t,e,n){return(e=eX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eX(t){var e=tX(t,"string");return typeof e=="symbol"?e:e+""}function tX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _R{get eventManager(){return new Yi(this)}constructor(e,n){er(this,"wtTable",void 0),er(this,"wtScroll",void 0),er(this,"wtViewport",void 0),er(this,"wtOverlays",void 0),er(this,"selectionManager",void 0),er(this,"wtEvent",void 0),er(this,"guid",`wt_${KS()}`),er(this,"drawInterrupted",!1),er(this,"drawn",!1),er(this,"domBindings",void 0),er(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new J3(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){Us(i,e[n])}])}}createCellCoords(e,n){return new pm(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new ER(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i,r,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,i,r,o)}scrollViewportHorizontally(e,n,i){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,i)}scrollViewportVertically(e,n,i){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,i)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function zT(t,e,n){return(e=nX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nX(t){var e=iX(t,"string");return typeof e=="symbol"?e:e+""}function iX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rX extends _R{constructor(e,n,i){super(e,n),zT(this,"cloneSource",void 0),zT(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new Nx(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function oX(t,e,n){return(e=sX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sX(t){var e=aX(t,"string");return typeof e=="symbol"?e:e+""}function aX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bd{constructor(e,n,i,r,o){oX(this,"wtSettings",null),go(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=r;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Ja(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Ja(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=xh(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){ft(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return r?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=r.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+mn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=r.top,{start:i.start+s,top:i.top+a}}getRelativeCellPositionWithinHolder(e,n,i,r,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(Wx.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${Y3.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Me(o,[no()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===el||u==="vertical"&&this.type===tl?this.mainTableScrollableElement=r:r.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=xh(e.TABLE),new rX(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,o=e.parentNode.style;[i,r,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class lX extends bd{constructor(e,n,i,r,o,s){super(e,n,Fs,i,r),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new z3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else pd(n),this.repositionOverlay();let i=Zt(this.clone.wtTable.TABLE);const r=_t(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=mn(i)),r.style.bottom=`${o}px`}}const uX="calculatedColumns",Bx={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};go(Bx,"MIXIN_NAME",uX,{writable:!1,enumerable:!1});const IR=Bx;class PR extends Lu{constructor(e,n,i,r){super(e,n,i,r,Jr)}}mt(PR,Fx);mt(PR,IR);const cX=PR;function hX(t,e,n){return(e=dX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dX(t){var e=fX(t,"string");return typeof e=="symbol"?e:e+""}function fX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gX extends bd{constructor(e,n,i,r){super(e,n,Jr,i,r),hX(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new cX(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=mn(i)),r.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Cp(n),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,wtSettings:r}=this.wot,o=r.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=i.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=mn(i),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Zt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=mn(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=s,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return yp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let o=!1;if((i||n===0)&&r.length>0){const s=this.wot.wtTable.holder.parentNode,a=_e(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(xe(s,"innerBorderBottom"),o=a)}return o}}const mX="calculatedRows",jx={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};go(jx,"MIXIN_NAME",mX,{writable:!1,enumerable:!1});const Ux=jx;class OR extends Lu{constructor(e,n,i,r){super(e,n,i,r,tl)}}mt(OR,Ux);mt(OR,TR);const pX=OR,wX="localHooks",zx={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,i,r,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)dm(this._localHooks[t][l],this,e,n,i,r,o,s)}},clearLocalHooks(){return this._localHooks={},this}};go(zx,"MIXIN_NAME",wX,{writable:!1,enumerable:!1});const kn=zx;let Yx=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};mt(Yx,kn);const vX=Yx,Gx="active-header",xR="header",AR="area",HR="focus",CX="fill",yX="row",bX="column",SX="custom-selection",NR=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var RX=gR;RX("flat");function EX(t,e){Kx(t,e),e.add(t)}function YT(t,e,n){Kx(t,e),e.set(t,n)}function Kx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qt(t,e){return t.get(oh(t,e))}function GT(t,e,n){return t.set(oh(t,e),n),n}function oh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tr=new WeakMap,ti=new WeakMap,cf=new WeakSet;class TX{constructor(){EX(this,cf),YT(this,tr,void 0),YT(this,ti,void 0)}setActiveOverlay(e){return GT(ti,this,e),this}setActiveSelection(e){return GT(tr,this,e),this}scan(){const e=Qt(tr,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,o]=Qt(tr,this).getCorners(),{wtTable:s}=Qt(ti,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<i||h>o)){for(let d=-l;d<0;d++){if(d<n||d>r)continue;const g=d+l;let m=s.getColumnHeader(h,g);const w=Qt(ti,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Qt(tr,this).settings.selectionType,columnCursor:u,selectionWidth:o-i+1});w!==null&&(w!==h&&(m=s.getColumnHeader(w,g)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,i,r,o]=Qt(tr,this).getCorners(),{wtTable:s}=Qt(ti,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>r)){for(let d=-l;d<0;d++){if(d<i||d>o)continue;const g=d+l;let m=s.getRowHeader(h,g);const w=Qt(ti,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Qt(tr,this).settings.selectionType,rowCursor:u,selectionHeight:r-n+1});w!==null&&(w!==h&&(m=s.getRowHeader(w,g)),e(m))}u+=1}}}scanCellsRange(e){const[n,i,r,o]=Qt(tr,this).getCorners(),{wtTable:s}=Qt(ti,this);oh(cf,this,rC).call(this,(a,l)=>{if(a>=n&&a<=r&&l>=i&&l<=o){const u=s.getCell(Qt(ti,this).createCellCoords(a,l)),c=Qt(ti,this).getSetting("onAfterDrawSelection",a,l,Qt(tr,this).settings.layerLevel);typeof c=="string"&&X(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,i]=Qt(tr,this).getCorners(),{wtTable:r}=Qt(ti,this);oh(cf,this,rC).call(this,(o,s)=>{if(o>=n&&o<=i){const a=r.getCell(Qt(ti,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,i]=Qt(tr,this).getCorners(),{wtTable:r}=Qt(ti,this);oh(cf,this,rC).call(this,(o,s)=>{if(s>=n&&s<=i){const a=r.getCell(Qt(ti,this).createCellCoords(o,s));e(a)}})}}function rC(t){const{wtTable:e}=Qt(ti,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const o=e.rowFilter.renderedToSource(r);for(let s=0;s<i;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class MX{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=NR,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Xi(e);const i=this,r=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(i.eventManager.removeEventListener(r,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const l=i[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),r=u.style,r.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,r.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,r.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Wo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const r={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`};Fe(r,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Fe(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),m=parseInt(u.width,10),w=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();u.top=`${parseInt(i-m-1,10)}px`,u[l]=`${parseInt(r-m-1,10)}px`,c.top=`${parseInt(i-w/4*3,10)}px`,c[l]=`${parseInt(r-w/4*3,10)}px`;const R=Math.min(parseInt(r+o,10),C-m-g*2),E=Math.min(parseInt(r+o-w/4,10),C-w-g*2);h[l]=`${R}px`,d[l]=`${E}px`;const H=Math.min(parseInt(i+s,10),S-m-g*2),P=Math.min(parseInt(i+s-w/4,10),S-w-g*2);h.top=`${H}px`,d.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:i,rootWindow:r}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let ye=0;ye<h;ye+=1){const we=n.rowFilter.renderedToSource(ye);if(we>=e[0]&&we<=e[2]){o=we,u=e[0];break}}for(let ye=h-1;ye>=0;ye-=1){const we=n.rowFilter.renderedToSource(ye);if(we>=e[0]&&we<=e[2]){s=we;break}}const d=n.getRenderedColumnsCount();for(let ye=0;ye<d;ye+=1){const we=n.columnFilter.renderedToSource(ye);if(we>=e[1]&&we<=e[3]){a=we,c=e[1];break}}for(let ye=d-1;ye>=0;ye-=1){const we=n.columnFilter.renderedToSource(ye);if(we>=e[1]&&we<=e[3]){l=we;break}}if(o===void 0||a===void 0){this.disappear();return}let g=n.getCell(this.wot.createCellCoords(o,a));const m=o!==s||a!==l,w=m?n.getCell(this.wot.createCellCoords(s,l)):g,C=fn(g),S=m?fn(w):C,R=fn(n.TABLE),E=_t(n.TABLE),H=C.top,P=C.left,B=this.wot.wtSettings.getSetting("rtlMode");let j=0,Y=0;if(B){const ye=_t(g),we=r.innerWidth-R.left-E;Y=P+ye-S.left,j=r.innerWidth-P-ye-we-1}else Y=S.left+_t(w)-P,j=P-R.left-1;if(this.isEntireColumnSelected(o,s)){const ye=this.getDimensionsFromHeader("columns",a,l,u,R);let we=null;ye&&([we,j,Y]=ye),we&&(g=we)}let G=H-R.top-1,z=S.top+Zt(w)-H;if(this.isEntireRowSelected(a,l)){const ye=this.getDimensionsFromHeader("rows",o,s,c,R);let we=null;ye&&([we,G,z]=ye),we&&(g=we)}const J=so(g,r);parseInt(J.borderTopWidth,10)>0&&(G+=1,z=z>0?z-1:0),parseInt(J[B?"borderRightWidth":"borderLeftWidth"],10)>0&&(j+=1,Y=Y>0?Y-1:0);const Z=B?"right":"left";this.topStyle.top=`${G}px`,this.topStyle[Z]=`${j}px`,this.topStyle.width=`${Y}px`,this.topStyle.display="block",this.startStyle.top=`${G}px`,this.startStyle[Z]=`${j}px`,this.startStyle.height=`${z}px`,this.startStyle.display="block";const re=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${G+z-re}px`,this.bottomStyle[Z]=`${j}px`,this.bottomStyle.width=`${Y}px`,this.bottomStyle.display="block",this.endStyle.top=`${G}px`,this.endStyle[Z]=`${j+Y-re}px`,this.endStyle.height=`${z+1}px`,this.endStyle.display="block";let pe=this.settings.border.cornerVisible;pe=typeof pe=="function"?pe(this.settings.layerLevel):pe;const Ie=this.wot.getSetting("onModifyGetCellCoords",s,l);let[tt,Ne]=[s,l];if(Ie&&Array.isArray(Ie)&&([,,tt,Ne]=Ie),Wo()||!pe||this.isPartRange(tt,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top=`${G+z+this.cornerCenterPointOffset-1}px`,this.cornerStyle[Z]=`${j+Y+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ye=Ja(n.TABLE);const we=ye===r;we&&(ye=i.documentElement);const pt=parseInt(this.cornerDefaultStyle.width,10)/2,f=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const p=we?w.getBoundingClientRect().left:w.offsetLeft;let v=!1,_=0;B?(_=p-parseInt(this.cornerDefaultStyle.width,10)/2,v=_<0):(_=p+_t(w)+parseInt(this.cornerDefaultStyle.width,10)/2,v=_>=nR(ye)),v&&(this.cornerStyle[Z]=`${Math.floor(j+Y+this.cornerCenterPointOffset-pt)}px`,this.cornerStyle[B?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(we?w.getBoundingClientRect().top:w.offsetTop)+Zt(w)+parseInt(this.cornerDefaultStyle.height,10)/2>=Ba(ye)&&(this.cornerStyle.top=`${Math.floor(G+z+this.cornerCenterPointOffset-f)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Wo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(s,l,G,j,Y,z)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,m=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Zt(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return _t(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(m=l(n,C-r),w=l(i,C-r),!m||!w)return!1;const S=fn(m),R=fn(w);return m&&w&&(h=S[g]-o[g]-1,d=R[g]+u(w)-S[g]),[m,h,d]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?X(this[e],"hidden"):(_e(this[e],"hidden")&&xe(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?X(this[e],"hidden"):xe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Wo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const KT=MX;function _X(t,e){Xx(t,e),e.add(t)}function Ml(t,e,n){Xx(t,e),e.set(t,n)}function Xx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ze(t,e){return t.get(DR(t,e))}function XT(t,e,n){return t.set(DR(t,e),n),n}function DR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var An=new WeakMap,oi=new WeakMap,oC=new WeakMap,Xc=new WeakMap,sC=new WeakMap,oa=new WeakMap,qT=new WeakSet;class IX{constructor(e){_X(this,qT),Ml(this,An,void 0),Ml(this,oi,void 0),Ml(this,oC,new TX),Ml(this,Xc,new WeakMap),Ml(this,sC,new WeakSet),Ml(this,oa,new Map),XT(oi,this,e)}setActiveOverlay(e){return XT(An,this,e),ze(oC,this).setActiveOverlay(ze(An,this)),ze(Xc,this).has(ze(An,this))||ze(Xc,this).set(ze(An,this),new Set),this}getFocusSelection(){return ze(oi,this)!==null?ze(oi,this).getFocus():null}getAreaSelection(){return ze(oi,this)!==null?ze(oi,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(ze(oa,this).has(e)){const i=ze(oa,this).get(e);if(i.has(ze(An,this)))return i.get(ze(An,this));const r=new KT(ze(An,this),e.settings);return i.set(ze(An,this),r),r}const n=new KT(ze(An,this),e.settings);return ze(oa,this).set(e,new Map([[ze(An,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=ze(oa,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){ze(oa,this).get(e).forEach(n=>n.destroy()),ze(oa,this).delete(e)}render(e){if(ze(oi,this)===null)return;e&&DR(qT,this,PX).call(this);const n=Array.from(ze(oi,this)),i=new Map,r=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;ze(sC,this).has(s)||(ze(sC,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&ze(oC,this).setActiveSelection(s).scan().forEach(m=>{if(i.has(m)){const w=i.get(m);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else i.set(m,new Map([[a,1]]));l&&(r.has(m)||r.set(m,[]),m.nodeName==="TH"&&r.get(m).push(...l))});const d=s.getCorners();ze(An,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}i.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>ze(Xc,this).get(ze(An,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=ze(oi,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Me(s,ze(oi,this).options.cellAttributes)}),Array.from(r.keys()).forEach(o=>{Me(o,[...r.get(o)])})}}function PX(){const t=ze(Xc,this).get(ze(An,this)),e=ze(An,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const o=ze(An,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((i=ze(oi,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(s=ze(oi,this).options.cellAttributes.map(a=>a[0])),Array.isArray((r=ze(oi,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(s=[...s,...ze(oi,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)xe(o[a],n),fl(o[a],s)}),t.clear()}class OX extends bd{constructor(e,n,i,r){super(e,n,tl,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new pX(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),bp(i,`${o}px`,"0px")):(o=this.getScrollPosition(),pd(i));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,eR(n)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,o=0;for(;r<n;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||i,r+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,r=mn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=r),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=_t(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(NR.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&r.length>0&&!_e(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=mn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,BO(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(tR(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=r-o;i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?xe(i,"emptyRows"):X(i,"emptyRows");let l=!1;if(!a){if(o&&!r.length)X(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&r.length){const u=_e(i,"innerBorderInlineStart");e?(X(i,"innerBorderLeft innerBorderInlineStart"),l=!u):(xe(i,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const xX="stickyRowsTop",qx={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};go(qx,"MIXIN_NAME",xX,{writable:!1,enumerable:!1});const Zx=qx;class LR extends Lu{constructor(e,n,i,r){super(e,n,i,r,nl)}}mt(LR,Zx);mt(LR,TR);const AX=LR;function ZT(t,e,n){return(e=HX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HX(t){var e=NX(t,"string");return typeof e=="symbol"?e:e+""}function NX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DX extends bd{constructor(e,n,i,r,o,s){super(e,n,nl,i,r),ZT(this,"topOverlay",void 0),ZT(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new AX(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();bp(e,`${r}px`,`${o}px`)}else pd(e);let n=Zt(this.clone.wtTable.TABLE);const i=_t(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class $R extends Lu{constructor(e,n,i,r){super(e,n,i,r,el)}}mt($R,Zx);mt($R,IR);const LX=$R;function $X(t,e,n){return(e=kX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kX(t){var e=FX(t,"string");return typeof e=="symbol"?e:e+""}function FX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VX extends bd{constructor(e,n,i,r){super(e,n,el,i,r),$X(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new LX(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,o=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,r=this.getOverlayOffset(),bp(e,"0px",`${r}px`)}else r=this.getScrollPosition(),pd(e);const s=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let i=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Cp(n),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultRowHeight");let r=e,o=0;for(;r<n;){const s=this.wot.wtTable.getRowHeight(r);o+=s===void 0?i:s,r+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,r=mn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=r),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Zt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(NR.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,s=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=r.getSetting("columnHeaders"),u=r.getSetting("fixedRowsTop")===0&&a.length>0&&!_e(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=mn(this.domBindings.rootDocument)),n){const d=r.getSetting("fixedRowsBottom"),g=r.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=i.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return c+=h,WO(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return yp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),s=i.getSetting("preventOverflow")==="horizontal";o?xe(r,"emptyColumns"):X(r,"emptyColumns");let a=!1;if(!n&&!s){const l=i.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=i.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=_e(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(X(r,"innerBorderTop"),a=!h):(xe(r,"innerBorderTop"),a=h)}}return a}}function hf(t,e,n){WX(t,e),e.set(t,n)}function WX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vo(t,e,n){return(e=BX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BX(t){var e=jX(t,"string");return typeof e=="symbol"?e:e+""}function jX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sa(t,e,n){return t.set(Qx(t,e),n),n}function Co(t,e){return t.get(Qx(t,e))}function Qx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _l=new WeakMap,df=new WeakMap,Il=new WeakMap,ff=new WeakMap;class UX{constructor(e,n,i,r,o,s){vo(this,"wot",null),hf(this,_l,[]),vo(this,"topOverlay",null),vo(this,"bottomOverlay",null),vo(this,"inlineStartOverlay",null),vo(this,"topInlineStartCornerOverlay",null),vo(this,"bottomInlineStartCornerOverlay",null),vo(this,"browserLineHeight",void 0),vo(this,"wtSettings",null),hf(this,df,!1),hf(this,Il,0),hf(this,ff,null),vo(this,"resizeObserver",new ResizeObserver(c=>{Mp(()=>{!Array.isArray(c)||!c.length||(sa(Il,this,Co(Il,this)+1),Co(Il,this)===100&&(ft("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Co(ff,this)!==null&&clearTimeout(Co(ff,this)),sa(ff,this,setTimeout(()=>{sa(Il,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=mn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:xh(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Co(_l,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),o=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new VX(...e),this.bottomOverlay=new gX(...e),this.inlineStartOverlay=new OX(...e),this.topInlineStartCornerOverlay=new DX(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new lX(...e,this.bottomOverlay,this.inlineStartOverlay),sa(_l,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){sa(df,this,Co(_l,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Co(_l,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Co(_l,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!uR())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",g=>this.onCloneWheel(g,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),sa(Il,this,0)},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==n&&o!==n&&!e.target.contains(r)||i!==n&&o!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==i&&s!==i&&!s.contains(o),l=r!==i&&s!==i&&!s.contains(r);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Du(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),o=this.scrollHorizontally(i);return r||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[r,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==r||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=r;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=r)}this.verticalScrolling&&(i.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!Co(df,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),sa(df,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=xh(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,g=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),m=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),w=g()?1:0,C=m()?1:0;if(d.width=`${c+C}px`,d.height=`${u+w}px`,this.scrollbarSize>0){const{scrollHeight:S,scrollWidth:R}=n.wtRootElement,{scrollHeight:E,scrollWidth:H}=n.holder;this.hasScrollbarRight=S<E,this.hasScrollbarBottom=R<H,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>R?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>S&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return M(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];M(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}const zX=UX;function QT(t,e,n){return(e=YX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YX(t){var e=GX(t,"string");return typeof e=="symbol"?e:e+""}function GX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KX{constructor(e){QT(this,"settings",{}),QT(this,"defaults",Object.freeze(this.getDefaults())),Fe(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);Us(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Fe(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,o){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class kR extends Lu{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=Ja(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=Ru(e,"height",n),o=Ru(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const g=parseInt(so(d,n).height,10);i.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=r==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Qa(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[i]=!0}}}mt(kR,Ux);mt(kR,IR);const XX=kR;class qX{constructor(e,n,i,r,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new EK:new MK],["fullyVisible",()=>new gK],["partiallyVisible",()=>new Ix]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new bK:new TK],["fullyVisible",()=>new hK],["partiallyVisible",()=>new _x]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=Zt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:i}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let d,g;if(a)return _t(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,o):d=Math.min(this.getContainerFillWidth(),h,o),r===i&&s>0&&this.sumColumnWidths(0,s-1)>d)return n.documentElement.clientWidth;if(r!==i&&(g=Ru(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(d,r.clientWidth);const m=e.getSetting("stretchH");return m==="none"||!m?Math.max(d,_t(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const i=n.offsetWidth;return this.containerWidth=i,e.removeChild(n),i}getWorkspaceOffset(){return fn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Zt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,o=n.length;r<o;r++)i?(this.rowHeaderWidth+=_t(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,r-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),r-=s),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=mn(this.domBindings.rootDocument),new NK({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:r,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>i.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,r-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=mn(this.domBindings.rootDocument)),new xK({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:r,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:o}=this.rowsRenderCalculator;return n<r||n===r&&n>0?!1:!(i>o||i===o&&i<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:o}=this.columnsRenderCalculator;return n<r||n===r&&n>0?!1:!(i>o||i===o&&i<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Fe(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}const ZX=qX;class QX extends _R{constructor(e,n){super(e,new KX(n));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new XX(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new ZX(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new IX(this.wtSettings.getSetting("selections")),this.wtEvent=new Nx(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new zX(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];Fe(e,(r,o)=>{this.wtSettings.getSetting(o).length&&i.push(r),n.push(r)}),xe(this.wtTable.wtRootElement.parentNode,n),X(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!Wx.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class FR{constructor(e){e instanceof _R?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new FR(n);return()=>i},this._wot=new QX(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i,r,o){return this._wot.scrollViewport(e,n,i,r,o)}scrollViewportHorizontally(e,n,i){return this._wot.scrollViewportHorizontally(e,n,i)}scrollViewportVertically(e,n,i){return this._wot.scrollViewportVertically(e,n,i)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,o){return this._wot.wtSettings.getSetting(e,n,i,r,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function JT(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(r):(u||c)&&r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(a(r.row,r.col)):u&&r.row<0&&!s.column?o.setRangeEnd(a(l.to.row,r.col)):c&&r.col<0&&!s.row?o.setRangeEnd(a(r.row,l.to.col)):(!u&&!c&&r.col<0||u&&r.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),r.row,r.col):(!u&&!c&&r.row<0||c&&r.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),r.col,r.row);else{const h=!o.inInSelection(r),d=n||i&&h;r.row<0&&r.col>=0&&!s.column?d&&o.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!s.row?d&&o.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!s.cell?d&&o.setRangeStart(r):r.col<0&&r.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function JX(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:o}=t;if(!e)return;const s=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),u=i.tableProps.countRows();i.markSource("mouse"),a&&!r.column?i.setRangeEnd(o(u-1,n.col)):s&&!r.row?i.setRangeEnd(o(n.row,l-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}const eq=new Map([["mousedown",JT],["mouseover",JX],["touchstart",JT]]);function eM(t,e){let{coords:n,selection:i,controller:r,cellCoordsFactory:o}=e;eq.get(t.type)({coords:n,selection:i,controller:r,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:_p(t)||t.type==="touchstart",isRightClick:zs(t)})}const Jx=new WeakMap,VR=Symbol("rootInstance");function tq(t){Jx.set(t,!0)}function nq(t){return t===VR}function $g(t){return Jx.has(t)}function iq(t,e){eA(t,e),e.add(t)}function aa(t,e,n){eA(t,e),e.set(t,n)}function eA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function os(t,e,n){return(e=rq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rq(t){var e=oq(t,"string");return typeof e=="symbol"?e:e+""}function oq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wn(t,e){return t.get(Nh(t,e))}function Pi(t,e,n){return t.set(Nh(t,e),n),n}function Nh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var aC=new WeakMap,gf=new WeakMap,mf=new WeakMap,yo=new WeakMap,nr=new WeakMap,lC=new WeakMap,uC=new WeakMap,kg=new WeakSet;class sq{constructor(e){iq(this,kg),os(this,"hot",void 0),os(this,"eventManager",void 0),os(this,"settings",void 0),os(this,"THEAD",void 0),os(this,"TBODY",void 0),os(this,"_wt",void 0),os(this,"activeWt",void 0),aa(this,aC,0),aa(this,gf,0),os(this,"postponedAdjustElementsSize",!1),aa(this,mf,!1),aa(this,yo,void 0),aa(this,nr,void 0),aa(this,lC,0),aa(this,uC,0),this.hot=e,this.eventManager=new Yi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i,r,o){return this._wt.scrollViewport(e,n,i,r,o)}scrollViewportHorizontally(e,n,i){return this._wt.scrollViewportHorizontally(e,n,i)}scrollViewportVertically(e,n,i){return this._wt.scrollViewportVertically(e,n,i)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),X(e,"handsontable"),Pi(nr,this,n.createElement("TABLE")),X(wn(nr,this),"htCore"),this.hot.getSettings().tableClassName&&X(wn(nr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Me(wn(nr,this),[no()]),Me(e,[Jz(),xO(-1),vp(this.hot.countCols()),fY()])),this.THEAD=n.createElement("THEAD"),wn(nr,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),wn(nr,this).appendChild(this.TBODY),this.hot.table=wn(nr,this),this.hot.container.insertBefore(wn(nr,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:i,rootWindow:r}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Pi(mf,this,!0),this.isTextSelectionAllowed(a.target)||(gb(r),a.preventDefault(),r.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Pi(mf,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{wn(mf,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&gb(r),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{i.isInProgress()&&!a.shiftKey&&i.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{i.isInProgress()&&_p(a)&&i.finish(),Pi(yo,this,!1);const l=Sp(n.activeElement);rh(n.activeElement)&&!l||(l||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(a.target)&&!zs(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{i.isInProgress()&&zs(a)&&(i.finish(),Pi(yo,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{i.isInProgress()&&i.finish(),Pi(yo,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(wn(yo,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const m=mn(n);if(n.elementFromPoint(u+m,c)!==d||n.elementFromPoint(u,c+m)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Za(r);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Za(s);this.eventManager.addEventListener(wn(nr,this),"selectstart",a=>{this.settings.fragmentSelection||rh(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const o=i.getNearestNotHiddenIndex(e,n),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=r-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:wn(nr,this),isDataViewInstance:()=>$g(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Pi(gf,this,o.length),this.hot.getSettings().ariaTags&&Nh(kg,this,tA).call(this)===this.hot.countCols()&&Nh(kg,this,aq).call(this,wn(gf,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Pi(aC,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let w=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,g)),this.hot.runHooks("beforeRenderer",a,l,u,m,w,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,m,w,g),this.hot.runHooks("afterRenderer",a,l,u,m,w,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Qa(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Pi(yo,this,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ms(o)&&(eM(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Pi(yo,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ms(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ms(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ms(o)&&(wn(yo,this)&&eM(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ms(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,d=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(d)){const[g,m,w,C]=d;return[g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,w>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(w,-1)):w,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new FR(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(rh(e))return!0;const n=$s(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return wn(yo,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!_e(i,"relative")){yr(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,o=i.createElement("div"),s=i.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,r),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;_e(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,i,r),s.className="",X(s,["relative",...o()])):(yr(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Me(a,...no()),Me(l,...no())),this.updateCellHeader(l,e,i,r),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(_e(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):_e(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?gl(e,i(n,r)):(Us(e,String.fromCharCode(160)),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){Pi(lC,this,e),Pi(uC,this,n)}getLastSize(){return{width:wn(lC,this),height:wn(uC,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return wn(aC,this)}getRowHeadersCount(){return wn(gf,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function tA(){return parseInt(this.hot.rootElement.getAttribute(vp()[0]),10)}function aq(t){const e=Nh(kg,this,tA).call(this)+t;Me(this.hot.rootElement,...vp(e))}const lq=sq,nA="ABCDEFGHIJKLMNOPQRSTUVWXYZ",_b=nA.length;function Op(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%_b,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/_b,10);return n}function uq(t){let e=0;if(t)for(let n=0,i=t.length-1;n<t.length;n+=1,i-=1)e+=_b**i*(nA.indexOf(t[n])+1);return e-=1,e}function cq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const o=[];for(r=0;r<e;r++)o.push(Op(r)+(i+1));n.push(o)}return n}function hq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const o={};for(r=0;r<e;r++)o[`prop${r}`]=Op(r)+(i+1);n.push(o)}return n}function dq(t,e){const n=[];let i;for(let r=0;r<t;r++){i=[];for(let o=0;o<e;o++)i.push("");n.push(i)}return n}function WR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,o)=>{Array.isArray(r)?r.forEach((s,a)=>{i.push([o+e,a,s])}):Object.keys(r).forEach(s=>{i.push([o+e,s,r[s]])})}),i}function BR(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&ke(t[0])&&(e=Tp(t[0]))),e}function iA(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function rA(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const fq=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:BR,createEmptySpreadsheetData:dq,createSpreadsheetData:cq,createSpreadsheetObjectData:hq,dataRowToChangesArray:WR,isArrayOfArrays:iA,isArrayOfObjects:rA,spreadsheetColumnIndex:uq,spreadsheetColumnLabel:Op},Symbol.toStringTag,{value:"Module"}));function uc(t,e,n){return(e=gq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gq(t){var e=mq(t,"string");return typeof e=="symbol"?e:e+""}function mq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pq{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];uc(this,"hot",void 0),uc(this,"data",void 0),uc(this,"dataType","array"),uc(this,"colToProp",()=>{}),uc(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return M(this.data,(i,r)=>{const o=this.getAtCell(r,e);n.push(o)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&i===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Ce(n,i,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(ke(a)||Et(a))if(r?l=[]:l={},!o||r){const c=this.countFirstRowKeys()-1;Ce(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(i||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);r?l.push(g):s?Hg(l,d,g):l[d]=g}})}else Fe(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Hg(l,c,h):l[c]=h});return l}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=Bi(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}Number.isInteger(n)?this.data[e][n]=i:Hg(this.data[e],n,i)}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();r=o?ex(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const o=Bi(r);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(r=o.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,o=null,s=null,a=null,l=null;e===null||n===null?(r=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return Ce(o,a,c=>{u.push(r?this.getAtRow(c,void 0,void 0,i):this.getAtRow(c,s,l,i))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return BR(this.data)}destroy(){this.data=null,this.hot=null}}const wq=pq;function tM(t,e,n){return(e=vq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vq(t){var e=Cq(t,"string");return typeof e=="symbol"?e:e+""}function Cq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ml{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;tM(this,"indexedValues",[]),tM(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Et(this.initValueOrFn)?Ce(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):Ce(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mt(ml,kn);function jR(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((o,s)=>Et(i)?i(o,s):i),...r===void 0?[]:t.slice(r)]}function UR(t,e){return Xo(t,(n,i)=>e.includes(i)===!1)}class qs extends ml{insert(e,n){this.indexedValues=jR(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=UR(this.indexedValues,e),super.remove(e)}}class xp extends qs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return nn(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function zR(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Dh(t,e){return Xo(t,n=>e.includes(n)===!1)}function YR(t,e){return Ke(t,n=>n-e.filter(i=>i<n).length)}function GR(t,e){const n=e[0],i=e.length;return Ke(t,r=>r>=n?r+i:r)}function yq(t,e,n){return(e=bq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bq(t){var e=Sq(t,"string");return typeof e=="symbol"?e:e+""}function Sq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ap extends ml{constructor(){super(...arguments),yq(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Dh(this.orderOfIndexes,[e]),Et(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=jR(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=GR(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=UR(this.indexedValues,e),this.orderOfIndexes=Dh(this.orderOfIndexes,e),this.orderOfIndexes=YR(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Sd extends qs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return nn(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const nM=new Map([["indexesSequence",{getListWithInsertedItems:zR,getListWithRemovedItems:Dh}],["physicallyIndexed",{getListWithInsertedItems:jR,getListWithRemovedItems:UR}]]),oA=t=>{if(nM.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return nM.get(t)};class sA extends ml{constructor(){super(e=>e)}insert(e,n){const i=GR(this.indexedValues,n);this.indexedValues=zR(i,e,n),super.insert(e,n)}remove(e){const n=Dh(this.indexedValues,e);this.indexedValues=YR(n,e),super.remove(e)}}const iM=new Map([["hiding",xp],["index",ml],["linkedPhysicalIndexToValue",Ap],["physicalIndexToValue",qs],["trimming",Sd]]);function Rq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!iM.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(iM.get(t))(e)}function Eq(t,e,n){return(e=Tq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tq(t){var e=Mq(t,"string");return typeof e=="symbol"?e:e+""}function Mq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Ib=0;class KR{constructor(){Eq(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),Ib+=1)}unregister(e){const n=this.collection.get(e);fe(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),Ib-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Mt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}mt(KR,kn);function _q(){return Ib}function cC(t,e,n){return(e=Iq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iq(t){var e=Pq(t,"string");return typeof e=="symbol"?e:e+""}function Pq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rM extends KR{constructor(e,n){super(),cC(this,"mergedValuesCache",[]),cC(this,"aggregationFunction",void 0),cC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ke(this.get(),o=>o.getValues()),i=[],r=fe(n[0])&&n[0].length||0;for(let o=0;o<r;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);i.push(s)}return Ke(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return fe(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Oq(t,e,n){xq(t,e),e.set(t,n)}function xq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aq(t,e,n){return t.set(aA(t,e),n),n}function Hq(t,e){return t.get(aA(t,e))}function aA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hC=new WeakMap;class lA{constructor(){Oq(this,hC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Hq(hC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Aq(hC,this,e)}}mt(lA,kn);function oM(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function cc(t,e,n){Nq(t,e),e.set(t,n)}function Nq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oi(t,e){return t.get(uA(t,e))}function pf(t,e,n){return t.set(uA(t,e),n),n}function uA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wf=new WeakMap,hc=new WeakMap,vf=new WeakMap,Cf=new WeakMap,yf=new WeakMap;class Dq{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};cc(this,wf,new Set),cc(this,hc,[]),cc(this,vf,[]),cc(this,Cf,!1),cc(this,yf,!1),pf(yf,this,e??!1)}createObserver(){const e=new lA;return Oi(wf,this).add(e),e.addLocalHook("unsubscribe",()=>{Oi(wf,this).delete(e)}),e._writeInitialChanges(oM(Oi(hc,this),Oi(vf,this))),e}emit(e){let n=Oi(vf,this);(!Oi(Cf,this)||Oi(hc,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Oi(yf,this)):pf(hc,this,new Array(e.length).fill(Oi(yf,this))),Oi(Cf,this)||(pf(Cf,this,!0),n=Oi(hc,this)));const i=oM(n,e);Oi(wf,this).forEach(r=>r._write(i)),pf(vf,this,e)}}function Fn(t,e,n){return(e=Lq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lq(t){var e=$q(t,"string");return typeof e=="symbol"?e:e+""}function $q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pb{constructor(){Fn(this,"indexesSequence",new sA),Fn(this,"trimmingMapsCollection",new rM(e=>e.some(n=>n===!0),!1)),Fn(this,"hidingMapsCollection",new rM(e=>e.some(n=>n===!0),!1)),Fn(this,"variousMapsCollection",new KR),Fn(this,"hidingChangesObservable",new Dq({initialIndexValue:!1})),Fn(this,"notTrimmedIndexesCache",[]),Fn(this,"notHiddenIndexesCache",[]),Fn(this,"isBatched",!1),Fn(this,"indexesSequenceChanged",!1),Fn(this,"indexesChangeSource",void 0),Fn(this,"trimmedIndexesChanged",!1),Fn(this,"hiddenIndexesChanged",!1),Fn(this,"renderablePhysicalIndexesCache",[]),Fn(this,"fromPhysicalToVisualIndexesCache",new Map),Fn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,Rq(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Sd?this.trimmingMapsCollection.register(e,n):n instanceof xp?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return fe(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return fe(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return fe(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return fe(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=Ke(e,u=>this.getPhysicalFromVisualIndex(u)),r=this.getNotTrimmedIndexesLength(),o=e.length,s=Dh(this.getIndexesSequence(),i),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<r){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(zR(s,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const i=this.getNotTrimmedIndexes()[e],r=fe(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=Ke(new Array(n).fill(r),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}mt(Pb,kn);function kq(t,e){return Fe(e,(n,i)=>{Mt(t[i])&&(t[i]=n)}),t}function cA(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function hA(t){fe(t)&&mR(gt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Fq(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Vq,getValues:Wq}=Mr("phraseFormatters");function Bq(t,e){Vq(t,e)}function jq(){return Wq()}Bq("pluralize",Fq);const dA="ContextMenu:items",De=dA,XR=`${De}.noItems`,Hp=`${De}.insertRowAbove`,Np=`${De}.insertRowBelow`,Dp=`${De}.insertColumnOnTheLeft`,Lp=`${De}.insertColumnOnTheRight`,$p=`${De}.removeRow`,kp=`${De}.removeColumn`,Fp=`${De}.undo`,Vp=`${De}.redo`,Lh=`${De}.readOnly`,Wp=`${De}.clearColumn`,Bp=`${De}.copy`,jp=`${De}.copyWithHeaders`,Up=`${De}.copyWithGroupHeaders`,zp=`${De}.copyHeadersOnly`,Yp=`${De}.cut`,Gp=`${De}.freezeColumn`,Kp=`${De}.unfreezeColumn`,Xp=`${De}.mergeCells`,qp=`${De}.unmergeCells`,Zp=`${De}.addComment`,Qp=`${De}.editComment`,Jp=`${De}.removeComment`,ew=`${De}.readOnlyComment`,tw=`${De}.align`,$h=`${De}.align.left`,kh=`${De}.align.center`,Fh=`${De}.align.right`,Vh=`${De}.align.justify`,Wh=`${De}.align.top`,Bh=`${De}.align.middle`,jh=`${De}.align.bottom`,nw=`${De}.borders`,iw=`${De}.borders.top`,rw=`${De}.borders.right`,ow=`${De}.borders.bottom`,sw=`${De}.borders.left`,aw=`${De}.borders.remove`,lw=`${De}.nestedHeaders.insertChildRow`,uw=`${De}.nestedHeaders.detachFromParent`,cw=`${De}.hideColumn`,hw=`${De}.showColumn`,dw=`${De}.hideRow`,fw=`${De}.showRow`,Kn="Filters:",Gt=`${Kn}conditions`,Rd=`${Gt}.none`,gw=`${Gt}.isEmpty`,mw=`${Gt}.isNotEmpty`,pw=`${Gt}.isEqualTo`,ww=`${Gt}.isNotEqualTo`,vw=`${Gt}.beginsWith`,Cw=`${Gt}.endsWith`,yw=`${Gt}.contains`,bw=`${Gt}.doesNotContain`,Uq=`${Gt}.byValue`,Sw=`${Gt}.greaterThan`,Rw=`${Gt}.greaterThanOrEqualTo`,Ew=`${Gt}.lessThan`,Tw=`${Gt}.lessThanOrEqualTo`,Mw=`${Gt}.isBetween`,_w=`${Gt}.isNotBetween`,Iw=`${Gt}.after`,Pw=`${Gt}.before`,Ow=`${Gt}.today`,xw=`${Gt}.tomorrow`,Aw=`${Gt}.yesterday`,Hw=`${Kn}labels.filterByCondition`,Nw=`${Kn}labels.filterByValue`,Dw=`${Kn}labels.conjunction`,Ed=`${Kn}labels.disjunction`,Uh=`${Kn}values.blankCells`,Lw=`${Kn}buttons.selectAll`,$w=`${Kn}buttons.clear`,kw=`${Kn}buttons.ok`,Fw=`${Kn}buttons.cancel`,Vw=`${Kn}buttons.placeholder.search`,Ww=`${Kn}buttons.placeholder.value`,Bw=`${Kn}buttons.placeholder.secondValue`,qR="CheckboxRenderer:",ZR=`${qR}checked`,QR=`${qR}unchecked`,zq=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:ZR,CHECKBOX_RENDERER_NAMESPACE:qR,CHECKBOX_UNCHECKED:QR,CONTEXTMENU_ITEMS_ADD_COMMENT:Zp,CONTEXTMENU_ITEMS_ALIGNMENT:tw,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:jh,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:kh,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Vh,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:$h,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Bh,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Fh,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Wh,CONTEXTMENU_ITEMS_BORDERS:nw,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:ow,CONTEXTMENU_ITEMS_BORDERS_LEFT:sw,CONTEXTMENU_ITEMS_BORDERS_RIGHT:rw,CONTEXTMENU_ITEMS_BORDERS_TOP:iw,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Wp,CONTEXTMENU_ITEMS_COPY:Bp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:zp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Up,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:jp,CONTEXTMENU_ITEMS_CUT:Yp,CONTEXTMENU_ITEMS_EDIT_COMMENT:Qp,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Gp,CONTEXTMENU_ITEMS_HIDE_COLUMN:cw,CONTEXTMENU_ITEMS_HIDE_ROW:dw,CONTEXTMENU_ITEMS_INSERT_LEFT:Dp,CONTEXTMENU_ITEMS_INSERT_RIGHT:Lp,CONTEXTMENU_ITEMS_MERGE_CELLS:Xp,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:uw,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:lw,CONTEXTMENU_ITEMS_NO_ITEMS:XR,CONTEXTMENU_ITEMS_READ_ONLY:Lh,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:ew,CONTEXTMENU_ITEMS_REDO:Vp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:aw,CONTEXTMENU_ITEMS_REMOVE_COLUMN:kp,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Jp,CONTEXTMENU_ITEMS_REMOVE_ROW:$p,CONTEXTMENU_ITEMS_ROW_ABOVE:Hp,CONTEXTMENU_ITEMS_ROW_BELOW:Np,CONTEXTMENU_ITEMS_SHOW_COLUMN:hw,CONTEXTMENU_ITEMS_SHOW_ROW:fw,CONTEXTMENU_ITEMS_UNDO:Fp,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Kp,CONTEXTMENU_ITEMS_UNMERGE_CELLS:qp,CONTEXT_MENU_ITEMS_NAMESPACE:dA,FILTERS_BUTTONS_CANCEL:Fw,FILTERS_BUTTONS_CLEAR:$w,FILTERS_BUTTONS_OK:kw,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Vw,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Bw,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Ww,FILTERS_BUTTONS_SELECT_ALL:Lw,FILTERS_CONDITIONS_AFTER:Iw,FILTERS_CONDITIONS_BEFORE:Pw,FILTERS_CONDITIONS_BEGINS_WITH:vw,FILTERS_CONDITIONS_BETWEEN:Mw,FILTERS_CONDITIONS_BY_VALUE:Uq,FILTERS_CONDITIONS_CONTAINS:yw,FILTERS_CONDITIONS_EMPTY:gw,FILTERS_CONDITIONS_ENDS_WITH:Cw,FILTERS_CONDITIONS_EQUAL:pw,FILTERS_CONDITIONS_GREATER_THAN:Sw,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Rw,FILTERS_CONDITIONS_LESS_THAN:Ew,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Tw,FILTERS_CONDITIONS_NAMESPACE:Gt,FILTERS_CONDITIONS_NONE:Rd,FILTERS_CONDITIONS_NOT_BETWEEN:_w,FILTERS_CONDITIONS_NOT_CONTAIN:bw,FILTERS_CONDITIONS_NOT_EMPTY:mw,FILTERS_CONDITIONS_NOT_EQUAL:ww,FILTERS_CONDITIONS_TODAY:Ow,FILTERS_CONDITIONS_TOMORROW:xw,FILTERS_CONDITIONS_YESTERDAY:Aw,FILTERS_DIVS_FILTER_BY_CONDITION:Hw,FILTERS_DIVS_FILTER_BY_VALUE:Nw,FILTERS_LABELS_CONJUNCTION:Dw,FILTERS_LABELS_DISJUNCTION:Ed,FILTERS_NAMESPACE:Kn,FILTERS_VALUES_BLANK_CELLS:Uh},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Yq={languageCode:"en-US",[XR]:"No available options",[Hp]:"Insert row above",[Np]:"Insert row below",[Dp]:"Insert column left",[Lp]:"Insert column right",[$p]:["Remove row","Remove rows"],[kp]:["Remove column","Remove columns"],[Fp]:"Undo",[Vp]:"Redo",[Lh]:"Read only",[Wp]:"Clear column",[tw]:"Alignment",[$h]:"Left",[kh]:"Center",[Fh]:"Right",[Vh]:"Justify",[Wh]:"Top",[Bh]:"Middle",[jh]:"Bottom",[Gp]:"Freeze column",[Kp]:"Unfreeze column",[nw]:"Borders",[iw]:"Top",[rw]:"Right",[ow]:"Bottom",[sw]:"Left",[aw]:"Remove border(s)",[Zp]:"Add comment",[Qp]:"Edit comment",[Jp]:"Delete comment",[ew]:"Read-only comment",[Xp]:"Merge cells",[qp]:"Unmerge cells",[Bp]:"Copy",[jp]:["Copy with header","Copy with headers"],[Up]:["Copy with group header","Copy with group headers"],[zp]:["Copy header only","Copy headers only"],[Yp]:"Cut",[lw]:"Insert child row",[uw]:"Detach from parent",[cw]:["Hide column","Hide columns"],[hw]:["Show column","Show columns"],[dw]:["Hide row","Hide rows"],[fw]:["Show row","Show rows"],[Rd]:"None",[gw]:"Is empty",[mw]:"Is not empty",[pw]:"Is equal to",[ww]:"Is not equal to",[vw]:"Begins with",[Cw]:"Ends with",[yw]:"Contains",[bw]:"Does not contain",[Sw]:"Greater than",[Rw]:"Greater than or equal to",[Ew]:"Less than",[Tw]:"Less than or equal to",[Mw]:"Is between",[_w]:"Is not between",[Iw]:"After",[Pw]:"Before",[Ow]:"Today",[xw]:"Tomorrow",[Aw]:"Yesterday",[Uh]:"Blank cells",[Hw]:"Filter by condition",[Nw]:"Filter by value",[Dw]:"And",[Ed]:"Or",[Lw]:"Select all",[$w]:"Clear",[kw]:"OK",[Fw]:"Cancel",[Vw]:"Search",[Ww]:"Value",[Bw]:"Second value",[ZR]:"Checked",[QR]:"Unchecked"},fA=Yq,Gq=zq,Ob=fA.languageCode,{register:Kq,getItem:gA,hasItem:Xq,getValues:qq}=Mr("languagesDictionaries");JR(fA);function JR(t,e){let n=t,i=e;return ke(t)&&(i=t,n=i.languageCode),Zq(n,i),Kq(n,$n(i)),$n(i)}function Zq(t,e){t!==Ob&&kq(e,gA(Ob))}function mA(t){return e0(t)?$n(gA(t)):null}function e0(t){return Xq(t)}function Qq(){return qq()}function pA(t,e,n){const i=mA(t);if(i===null)return null;const r=i[e];if(Mt(r))return null;const o=Jq(r,n);return Array.isArray(o)?o[0]:o}function Jq(t,e){let n=t;return M(jq(),i=>{n=i(t,e)}),n}function e4(t){let e=cA(t);return e0(e)||(e=Ob,hA(t)),e}function t4(t,e,n){return(e=n4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n4(t){var e=i4(t,"string");return typeof e=="symbol"?e:e+""}function i4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r4 extends vX{constructor(e,n){super(e,null),t4(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(i,-1);return r===null||o===null?null:((r.row>o.row||r.col>o.col)&&(r=n,o=i),this.settings.createCellRange(r,r,o))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return o===null?null:this.settings.createCellCoords(r,o)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,i,r)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}const ns=r4;function dC(t){let{activeHeaderClassName:e,...n}=t;return new ns({className:e,...n,selectionType:Gx})}function o4(t){let{areaCornerVisible:e,...n}=t;return new ns({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:AR})}function s4(t){let{...e}=t;return new ns({className:"highlight",...e,selectionType:AR})}function a4(t){let{columnClassName:e,...n}=t;return new ns({className:e,...n,selectionType:bX})}function l4(t){let{cellCornerVisible:e,...n}=t;return new ns({className:"current",headerAttributes:[QS()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:HR})}function u4(t){let{border:e,visualCellRange:n,...i}=t;return new ns({...e,...i,selectionType:SX},n)}function c4(t){let{...e}=t;return new ns({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:CX})}function sM(t){let{headerClassName:e,...n}=t;return new ns({className:e,...n,selectionType:xR})}function h4(t){let{rowClassName:e,...n}=t;return new ns({className:e,...n,selectionType:yX})}function d4(t,e){f4(t,e),e.add(t)}function f4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zn(t,e,n){return(e=g4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g4(t){var e=m4(t,"string");return typeof e=="symbol"?e:e+""}function m4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xr=new WeakSet;class p4{constructor(e){d4(this,xr),Zn(this,"options",void 0),Zn(this,"layerLevel",0),Zn(this,"focus",void 0),Zn(this,"fill",void 0),Zn(this,"layeredAreas",new Map),Zn(this,"areas",new Map),Zn(this,"rowHeaders",new Map),Zn(this,"columnHeaders",new Map),Zn(this,"activeRowHeaders",new Map),Zn(this,"activeColumnHeaders",new Map),Zn(this,"activeCornerHeaders",new Map),Zn(this,"rowHighlights",new Map),Zn(this,"columnHighlights",new Map),Zn(this,"customSelections",[]),this.options=e,this.focus=l4(e),this.fill=c4(e)}isEnabledFor(e,n){let i=e;e===HR&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return bo(xr,this,So).call(this,this.layeredAreas,o4)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return bo(xr,this,So).call(this,this.areas,s4)}getAreas(){return[...this.areas.values()]}createRowHeader(){return bo(xr,this,So).call(this,this.rowHeaders,sM)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return bo(xr,this,So).call(this,this.columnHeaders,sM)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return bo(xr,this,So).call(this,this.activeRowHeaders,dC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return bo(xr,this,So).call(this,this.activeColumnHeaders,dC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return bo(xr,this,So).call(this,this.activeCornerHeaders,dC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return bo(xr,this,So).call(this,this.rowHighlights,h4)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return bo(xr,this,So).call(this,this.columnHighlights,a4)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(u4({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),M(this.areas.values(),e=>void e.clear()),M(this.layeredAreas.values(),e=>void e.clear()),M(this.rowHeaders.values(),e=>void e.clear()),M(this.columnHeaders.values(),e=>void e.clear()),M(this.activeRowHeaders.values(),e=>void e.clear()),M(this.activeColumnHeaders.values(),e=>void e.clear()),M(this.activeCornerHeaders.values(),e=>void e.clear()),M(this.rowHighlights.values(),e=>void e.clear()),M(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function So(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}const w4=p4;function aM(t,e,n){return(e=v4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v4(t){var e=C4(t,"string");return typeof e=="symbol"?e:e+""}function C4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y4{constructor(e){aM(this,"ranges",[]),aM(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const b4=y4;function S4(t,e){wA(t,e),e.add(t)}function fC(t,e,n){wA(t,e),e.set(t,n)}function wA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){return t.get(on(t,e))}function bf(t,e,n){return t.set(on(t,e),n),n}function on(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sf=new WeakMap,It=new WeakMap,pr=new WeakMap,hn=new WeakSet;class vA{constructor(e,n){S4(this,hn),fC(this,Sf,void 0),fC(this,It,void 0),fC(this,pr,{x:0,y:0}),bf(Sf,this,e),bf(It,this,n)}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=rt(It,this).createCellCoords(e,n);let o=rt(Sf,this).current().highlight;const s=rt(It,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",r),s.row!==null&&s.col!==null){const{width:u,height:c}=on(hn,this,CA).call(this),{row:h,col:d}=on(hn,this,uM).call(this,o),g=rt(It,this).fixedRowsBottom(),m=rt(It,this).minSpareRows(),w=rt(It,this).minSpareCols(),C=rt(It,this).autoWrapRow(),S=rt(It,this).autoWrapCol(),R=rt(It,this).createCellCoords(h+r.row,d+r.col);if(R.row>=c){const P=Bi(i&&m>0&&g===0),B=R.col+1,j=rt(It,this).createCellCoords(R.row-c,B>=u?B-u:B);this.runLocalHooks("beforeColumnWrap",P,on(hn,this,Pl).call(this,j),B>=u),P.value?this.runLocalHooks("insertRowRequire",rt(It,this).countRenderableRows()):S&&R.assign(j)}else if(R.row<0){const P=Bi(S),B=R.col-1,j=rt(It,this).createCellCoords(c+R.row,B<0?u+B:B);this.runLocalHooks("beforeColumnWrap",P,on(hn,this,Pl).call(this,j),B<0),S&&R.assign(j)}if(R.col>=u){const P=Bi(i&&w>0),B=R.row+1,j=rt(It,this).createCellCoords(B>=c?B-c:B,R.col-u);this.runLocalHooks("beforeRowWrap",P,on(hn,this,Pl).call(this,j),B>=c),P.value?this.runLocalHooks("insertColRequire",rt(It,this).countRenderableColumns()):C&&R.assign(j)}else if(R.col<0){const P=Bi(C),B=R.row-1,j=rt(It,this).createCellCoords(B<0?c+B:B,u+R.col);this.runLocalHooks("beforeRowWrap",P,on(hn,this,Pl).call(this,j),B<0),C&&R.assign(j)}const{rowDir:E,colDir:H}=on(hn,this,lM).call(this,R);a=E,l=H,o=on(hn,this,Pl).call(this,R)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const i=rt(It,this).createCellCoords(e,n),r=rt(Sf,this).current(),o=rt(It,this).visualToRenderableCoords(r.highlight),s=on(hn,this,gC).call(this,r.to.row,r.from.row),a=on(hn,this,mC).call(this,r.to.col,r.from.col),l=r.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",i),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=on(hn,this,uM).call(this,r.highlight),g=rt(It,this).createCellCoords(s+i.row,a+i.col),m=r.getTopStartCorner(),w=r.getTopEndCorner(),C=r.getBottomEndCorner();if(i.col<0&&a>=d&&g.col<d){const H=g.col-d;g.col=on(hn,this,mC).call(this,m.col,w.col)+H}else if(i.col>0&&a<=d&&g.col>d){const H=on(hn,this,mC).call(this,w.col,m.col),P=Math.max(g.col-H,1);g.col=H+P}if(i.row<0&&s>=h&&g.row<h){const H=g.row-h;g.row=on(hn,this,gC).call(this,m.row,C.row)+H}else if(i.row>0&&s<=h&&g.row>h){const H=on(hn,this,gC).call(this,C.row,m.row),P=Math.max(g.row-H,1);g.row=H+P}const{rowDir:S,colDir:R}=on(hn,this,lM).call(this,g);u=S,c=R;const E=on(hn,this,Pl).call(this,g);i.row===0&&i.col!==0?l.col=E.col:i.row!==0&&i.col===0?l.row=E.row:(l.row=E.row,l.col=E.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:i}=e;bf(pr,this,{x:n,y:i})}resetOffsetSize(){bf(pr,this,{x:0,y:0})}}function lM(t){const{width:e,height:n}=on(hn,this,CA).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function CA(){return{width:rt(pr,this).x+rt(It,this).countRenderableColumns(),height:rt(pr,this).y+rt(It,this).countRenderableRows()}}function gC(t,e){const n=rt(It,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:rt(pr,this).y+n}function mC(t,e){const n=rt(It,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:rt(pr,this).x+n}function uM(t){const{row:e,col:n}=rt(It,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return rt(It,this).createCellCoords(rt(pr,this).y+e,rt(pr,this).x+n)}function Pl(t){const e=t.clone();return e.col=t.col-rt(pr,this).x,e.row=t.row-rt(pr,this).y,rt(It,this).renderableToVisualCoords(e)}mt(vA,kn);const cM=vA,jw=0,Uw=1,yA=2,t0=3,R4=[t0,yA],E4=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],pC=Symbol("root"),hM=Symbol("child");function Tu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pC;if(e!==pC&&e!==hM)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===pC;let r=jw;if(n){const o=t[0];t.length===0?r=Uw:i&&o instanceof ER?r=t0:i&&Array.isArray(o)?r=Tu(o,hM):t.length>=2&&t.length<=4&&!t.some((a,l)=>!E4[l].includes(typeof a))&&(r=yA)}return r}function zh(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!R4.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===t0;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof r=="function"&&(typeof l=="string"&&(l=r(l)),typeof c=="string"&&(c=r(c))),Mt(u)&&(u=a),Mt(c)&&(c=l),!i){const g=a,m=l,w=u,C=c;a=Math.min(g,w),l=Math.min(m,C),u=Math.max(g,w),c=Math.max(m,C)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function T4(t){const e=Tu(t.getSelected());if(e===jw||e===Uw)return[];const n=zh(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return nn(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function M4(t){const e=Tu(t.getSelected());if(e===jw||e===Uw)return[];const n=zh(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return nn(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Ol(t,e,n){_4(t,e),e.set(t,n)}function _4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function la(t,e,n){return(e=I4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I4(t){var e=P4(t,"string");return typeof e=="symbol"?e:e+""}function P4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ot(t,e){return t.get(bA(t,e))}function Ar(t,e,n){return t.set(bA(t,e),n),n}function bA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pn=new WeakMap,ua=new WeakMap,Rf=new WeakMap,dc=new WeakMap,Ef=new WeakMap,fc=new WeakMap;class SA{constructor(e,n){var i=this;la(this,"settings",void 0),la(this,"tableProps",void 0),la(this,"inProgress",!1),la(this,"selectedRange",new b4((r,o,s)=>this.tableProps.createCellRange(r,o,s))),la(this,"highlight",void 0),Ol(this,Pn,void 0),Ol(this,ua,void 0),la(this,"selectedByRowHeader",new Set),la(this,"selectedByColumnHeader",new Set),Ol(this,Rf,!1),Ol(this,dc,!1),Ol(this,Ef,"unknown"),Ol(this,fc,-1),this.settings=e,this.tableProps=n,this.highlight=new w4({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[QS()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,o)=>this.tableProps.isDisabledCellSelection(r,o),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),createCellRange:(r,o,s)=>this.tableProps.createCellRange(r,o,s)}),Ar(Pn,this,new cM(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Ar(ua,this,new cM(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,r.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,r.getOuterBottomEndCorner().col)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Ot(Pn,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformStart",...o)}),Ot(Pn,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformStart",...o)}),Ot(Pn,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformEnd",...o)}),Ot(Pn,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformEnd",...o)}),Ot(Pn,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertRowRequire",...o)}),Ot(Pn,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertColRequire",...o)}),Ot(Pn,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeRowWrap",...o)}),Ot(Pn,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeColumnWrap",...o)}),Ot(ua,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformFocus",...o)}),Ot(ua,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Ar(Ef,this,e)}markEndSource(){Ar(Ef,this,"unknown")}getSelectionSource(){return Ot(Ef,this)}setExpectedLayers(e){Ar(fc,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Ar(fc,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Ar(Rf,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!o||o&&!s&&Mt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||r>0)&&(i===0&&n.col<0&&!o||r===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Ot(fc,this)===-1||this.selectedRange.size()===Ot(fc,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();n<this.highlight.layerLevel&&(M(this.highlight.getAreas(),m=>void m.clear()),M(this.highlight.getLayeredAreas(),m=>void m.clear()),M(this.highlight.getRowHeaders(),m=>void m.clear()),M(this.highlight.getColumnHeaders(),m=>void m.clear()),M(this.highlight.getActiveRowHeaders(),m=>void m.clear()),M(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),M(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),M(this.highlight.getRowHighlights(),m=>void m.clear()),M(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(AR,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(xR,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),S=this.tableProps.createCellCoords(e.to.row,-1),R=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),E=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(R).commit(),d.add(C).commit(),g.add(R).commit()):(a.add(C).add(S).commit(),l.add(R).add(E).commit(),d.add(C).add(S).commit(),g.add(R).add(E).commit())}const m=!Ot(dc,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),w=!Ot(dc,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&w&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(HR,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(Ar(Rf,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Ot(Pn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Ot(Pn,this).resetOffsetSize(),this.setRangeStart(Ot(Pn,this).transformStart(e,n,i))}transformEnd(e,n){this.settings.navigableHeaders?Ot(Pn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Ot(Pn,this).resetOffsetSize(),this.setRangeEnd(Ot(Pn,this).transformEnd(e,n))}transformFocus(e,n){const i=this.selectedRange.current(),{row:r,col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?Ot(ua,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:r<0?Math.abs(r):-a}):Ot(ua,this).setOffsetSize({x:o<0?0:-s,y:r<0?0:-a});const l=Ot(ua,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(dt(r.row+h,c,a-1),r.col),g=this.tableProps.createCellCoords(dt(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(dt(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,dt(r.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,dt(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,dt(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Bi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Ot(Rf,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&r.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:o}=r.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&r.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=i?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=r;Ar(dc,this,g),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(dt(d.row,u,o-1),dt(d.col,c,s-1)));const m=this.tableProps.createCellCoords(u,c),w=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.finish(),Ar(dc,this,!1)}selectCells(e){var n=this;const i=Tu(e);if(i===Uw)return!1;if(i===jw)throw new Error(gt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=zh(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=r(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),M(e,l=>{const{from:u,to:c}=r(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,r),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,m=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(g=dt(i.row,u,s-1),m=dt(i.col,Math.min(r,o),Math.max(r,o))):(g=dt(i,u,s-1),m=r);const w=this.tableProps.createCellCoords(g,m),C=l===0?0:dt(w.row,u,-1),S=s-1,R=this.tableProps.createCellCoords(C,r),E=this.tableProps.createCellCoords(S,o);this.runLocalHooks("beforeSelectColumns",R,E,w),R.row=C,E.row=S,this.setRangeStartOnly(R,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",R,E,w),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:r,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(h=dt(i.row,Math.min(e,n),Math.max(e,n)),d=dt(i.col,a,o-1)):(h=e,d=dt(i,a,o-1));const g=this.tableProps.createCellCoords(h,d),m=s===0?0:dt(g.col,a,-1),w=o-1,C=this.tableProps.createCellCoords(e,m),S=this.tableProps.createCellCoords(n,w);this.runLocalHooks("beforeSelectRows",C,S,g),C.col=m,S.col=w,this.setRangeStartOnly(C,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectRows",C,S,g),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:o,highlight:s}=i;this.clear(),s.assign({row:dt(s.row,-1/0,e-1),col:dt(s.col,-1/0,n-1)}),r.assign({row:dt(r.row,-1/0,e-1),col:dt(r.col,-1/0,n-1)}),o.assign({row:dt(o.row,0,e-1),col:dt(o.col,0,n-1)}),this.selectedRange.ranges.push(i),this.highlight.getFocus().add(s).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),i=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(i)}}mt(SA,kn);const O4=SA,dM=/^(\r\n|\n\r|\r|\n)/,x4=/^[^\t\r\n]+/,fM=/^\t/;function A4(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(fM))t=t.replace(fM,""),n+=1,e[i][n]="";else if(t.match(dM))t=t.replace(dM,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(x4);o=s?s[0]:"",t=t.slice(o.length)}e[i][n]=o}return e}function sh(t){let e,n,i,r,o="",s;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(o+="	"),s=t[e][i],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function ca(t,e,n){return(e=H4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H4(t){var e=N4(t,"string");return typeof e=="symbol"?e:e+""}function N4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){ca(this,"hot",void 0),ca(this,"metaManager",void 0),ca(this,"tableMeta",void 0),ca(this,"dataSource",void 0),ca(this,"duckSchema",void 0),ca(this,"colToPropCache",void 0),ca(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,o=0,s=!1;if(typeof n=="function"){const a=Tp(e);r=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;r=Math.min(a,n.length)}for(i=0;i<r;i++){const a=s?n(i):n[i];if(ke(a)){if(typeof a.data<"u"){const l=s?o:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return BR(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,o=i,s;return typeof r>"u"&&(r=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Fe(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,r),r+=1):r=this.recursiveDuckColumns(a,r,`${l}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&fe(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(fe(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Eu(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,i)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=$n(this.getSchema()):(m=[],Ce(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},vd(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),r==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",g,a,i),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,i)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),g=0,m=c;r==="end"&&(m=Math.min(m+1,a));const w=m;for(;g<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let S=0;S<h;S+=1)typeof o[S]>"u"&&(o[S]=[]),o[S].push(null);else o.push([null]);else for(let S=0;S<h;S++)o[S].splice(m,0,null);g+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):i!=="auto"&&this.metaManager.createColumn(w,n));const C=this.hot.toVisualColumn(w);return this.hot.runHooks("afterCreateCol",C,g,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:w}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(r,n),s=this.hot.countSourceRows();if(r=(s+r)%s,this.hot.runHooks("beforeRemoveRow",r,o.length,o,i)===!1)return!1;const l=o.length;if(this.filterData(r,l,o),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=fe(this.tableMeta.columns)||fe(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",r,l,o,i),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const o=this.visualColumnsToPhysical(r,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",r,n,o,i)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,o,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];lb(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return RO(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];lb(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const o=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((o,s)=>i.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const o=this.hot.runHooks("modifyRowData",i);r=isNaN(o)?o:r;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(r&&r.hasOwnProperty&&$t(r,n))a=r[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=r;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const l=Bi(a);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let o=i,s=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Bi(o);this.hot.runHooks("modifyData",r,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&$t(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++)typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]];u[d[c]]=o}else typeof n=="function"?n(this.dataSource.slice(r,r+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let o=(i+e)%i,s=n,a;for(;o<i&&s;)a=this.hot.toPhysicalRow(o),r.push(a),s-=1,o+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let o=(i+e)%i,s=n;for(;o<i&&s;){const a=this.hot.toPhysicalColumn(o);r.push(a),s-=1,o+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,uu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=i===uu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&r.push(a)}return r}getText(e,n){return sh(this.getRange(e,n,uu.DESTINATION_RENDERER))}getCopyableText(e,n){return sh(this.getRange(e,n,uu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const D4=uu,{register:L4,getItem:$4,hasItem:RA,getNames:k4,getValues:jce}=Mr("cellTypes");function n0(t){if(!RA(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return $4(t)}function Ai(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&ri(t,n),i&&gi(t,i),r&&Va(t,r),L4(t,e)}function F4(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!$t(e,t)}function zw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?n0(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Fe(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!ke(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};Fe(i,(o,s)=>{if(F4(s,n)){var a;r[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),tn(t,r)}function V4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Tr(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function Fg(t){return Number.isInteger(t)&&t>=0}function Vg(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Tf(t){return t==null}const EA=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),Yt(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),Yt(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),Ep(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function gM(t,e,n){return(e=W4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W4(t){var e=B4(t,"string");return typeof e=="symbol"?e:e+""}function B4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j4(){return class{}}class U4{constructor(e){gM(this,"metaCtor",j4()),gM(this,"meta",void 0),this.meta=this.metaCtor.prototype,tn(this.meta,EA()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;tn(this.meta,e),zw(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function z4(t,e,n){return(e=Y4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y4(t){var e=G4(t,"string");return typeof e=="symbol"?e:e+""}function G4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K4{constructor(e){z4(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){tn(this.meta,e),zw(this.meta,e,e)}}function Mf(t,e,n){return(e=X4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X4(t){var e=q4(t,"string");return typeof e=="symbol"?e:e+""}function q4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cm{constructor(e){Mf(this,"valueFactory",void 0),Mf(this,"data",[]),Mf(this,"index",[]),Mf(this,"holes",new Set),this.valueFactory=e}obtain(e){Vg(()=>Fg(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Vg(()=>Fg(e)||Tf(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let s=0;s<n;s++)i.push(r+s),this.data.push(void 0);const o=Tf(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...i,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Vg(()=>Fg(e)||Tf(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(Tf(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const o=i[r];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return Xo(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function mM(t,e,n){return(e=Z4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z4(t){var e=Q4(t,"string");return typeof e=="symbol"?e:e+""}function Q4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const J4=["data","width"];class e6{constructor(e){mM(this,"globalMeta",void 0),mM(this,"metas",new Cm(()=>this._createMeta())),this.globalMeta=e,this.metas=new Cm(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);tn(i,n),zw(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return V4(this.globalMeta.getMetaConstructor(),J4).prototype}}function pM(t,e,n){return(e=t6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t6(t){var e=n6(t,"string");return typeof e=="symbol"?e:e+""}function n6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class i6{constructor(e){pM(this,"columnMeta",void 0),pM(this,"metas",new Cm(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);tn(r,i),zw(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),s[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)fe(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){Vg(()=>Fg(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Cm(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class TA{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new U4(e),this.tableMeta=new K4(this.globalMeta),this.columnMeta=new e6(this.globalMeta),this.cellMeta=new i6(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){let{visualRow:r,visualColumn:o}=i;const s=this.cellMeta.getMeta(e,n);return s.visualRow=r,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mt(TA,kn);function wM(t,e,n,i){const{hotInstance:r,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=i,h=Ln(a),d=r.getSettings();Array.isArray(d.dataSchema)?r.dataType="array":Et(d.dataSchema)?r.dataType="function":r.dataType="object",o&&o.destroy(),t=r.runHooks(`before${h}`,t,c,l);const g=new D4(r,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=g.getSchema();t=[];let w,C=0,S=0;for(C=0,S=d.startRows;C<S;C++)if((r.dataType==="object"||r.dataType==="function")&&d.dataSchema)w=$n(m),t.push(w);else if(r.dataType==="array")w=$n(m[0]),t.push(w);else{w=[];for(let R=0,E=d.startCols;R<E;R++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=r.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),r.runHooks(`after${h}`,t,c,l),c||(r.runHooks("afterChange",null,a),r.render()),r.getSettings().ariaTags&&Me(r.rootElement,[xO(-1),vp(r.countCols()+(r.view?r.countRowHeaders():0))])}function vM(t,e,n){return(e=r6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r6(t){var e=o6(t,"string");return typeof e=="symbol"?e:e+""}function o6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s6{constructor(e){vM(this,"metaManager",void 0),vM(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),de.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=$t(e,"type")?e.type:null;let c=Et(e.cells)?e.cells(i,r,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(i,r,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function a6(t,e,n){l6(t,e),e.set(t,n)}function l6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wC(t,e,n){return(e=u6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u6(t){var e=c6(t,"string");return typeof e=="symbol"?e:e+""}function c6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h6(t,e){return t.get(d6(t,e))}function d6(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var CM=new WeakMap;class f6{constructor(e){wC(this,"metaManager",void 0),wC(this,"usageTracker",new Set),wC(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),a6(this,CM,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:o}=e,s=typeof r=="string",a=s?r:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(r,l,o)):i&&(this.installPropWatcher(n,l,h6(CM,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const MA="gridDefault",Zs="editorManager.handlingEditor",g6={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},m6="hooksRefRegisterer",_A={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){M(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Fe(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};go(_A,"MIXIN_NAME",m6,{writable:!1,enumerable:!1});const p6=_A;function ir(t,e,n){return(e=w6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w6(t){var e=v6(t,"string");return typeof e=="symbol"?e:e+""}function v6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const C6="base",Xt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class $u{static get EDITOR_TYPE(){return C6}constructor(e){ir(this,"hot",void 0),ir(this,"state",Xt.VIRGIN),ir(this,"_opened",!1),ir(this,"_fullEditMode",!1),ir(this,"_closeCallback",null),ir(this,"TD",null),ir(this,"row",null),ir(this,"col",null),ir(this,"prop",null),ir(this,"originalValue",null),ir(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,o,s){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Xt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,o,s;if(n){const l=this.hot.getSelectedLast();i=Math.max(Math.min(l[0],l[2]),0),r=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[i,r,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,r);Array.isArray(a)&&([i,r]=a),this.hot.populateFromArray(i,r,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Xt.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(r,o)),this.state=Xt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:zt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,i){let r;if(i){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),i(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Xt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Xt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:r=[[o]],this.state=Xt.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Xt.FINISHED,this.discardEditor(s)}):(this.state=Xt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Xt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Xt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Xt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Xt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Xt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,o=this.hot.rootWindow,s=fn(n),a=_t(n),l=fn(this.hot.rootElement),u=_t(this.hot.rootElement),c=i.topOverlay.holder,h=i.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,m=o.innerWidth-l.left-u,{wtTable:w}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,C=w.name,S=["master","inline_start"].includes(C)?d:0,R=["master","top","bottom"].includes(C)?g:0,E=s.top===l.top?0:1;let H=s.top-l.top-E-S,P=0;this.hot.isRtl()?P=o.innerWidth-s.left-a-m-1+R:P=s.left-l.left-1-R,["top","top_inline_start_corner"].includes(C)&&(H+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(P+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const B=this.hot.hasColHeaders(),j=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Y=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),z=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(B&&j<=0||j===z)&&(H+=1),Y<=0&&(P+=1);const J=r.rowsRenderCalculator.startPosition,Z=r.columnsRenderCalculator.startPosition,re=Math.abs(i.inlineStartOverlay.getScrollPosition()),pe=i.topOverlay.getScrollPosition(),Ie=mn(this.hot.rootDocument);let tt=n.offsetTop;if(["inline_start","master"].includes(C)&&(tt+=J-pe),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:K,wtTable:ue}=i.bottomOverlay.clone;tt+=K.getWorkspaceHeight()-ue.getHeight()-Ie}let Ne=n.offsetLeft;this.hot.isRtl()?(Ne>=0?Ne=w.getWidth()-n.offsetLeft:Ne=Math.abs(Ne),Ne+=Z-re-a):["top","master","bottom"].includes(C)&&(Ne+=Z-re);const ye=so(this.TD,this.hot.rootWindow),we=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",pt=parseInt(ye[we],10)>0?0:1,f=parseInt(ye.borderTopWidth,10)>0?0:1,p=_t(n)+pt,v=Zt(n)+f,_=UO(c)?Ie:0,O=zO(h)?Ie:0,F=this.hot.view.maximumVisibleElementWidth(Ne)-_+pt,U=Math.max(this.hot.view.maximumVisibleElementHeight(tt)-O+f,23);return{top:H,start:P,height:v,maxHeight:U,width:p,maxWidth:F}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}mt($u,p6);const y6={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===Xt.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},b6={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},S6={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},R6={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},E6={name:"editorOpen",callback(t,e,n){const i=t._getEditorManager(),r=t.getSelectedRangeLast(),{highlight:o}=r;if(t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Xi(e))}};function T6(){return[g6,y6,b6,S6,R6,E6]}const M6={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},_6={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(i!==null){const r=t._createCellCoords(i,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(r.row-o,t.countRows()-1);t.selection.setRangeEnd(r),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},I6={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},P6={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},O6={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,i.col,e)}},x6={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=r.clone();l.row=i.row,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},A6={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=r.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,s))}}},H6={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=r.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},N6={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=r.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},D6={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=r.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},L6={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=r.clone();l.row=i.row,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},$6={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,i.row,e)}},k6={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},F6={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(i!==null){const r=t._createCellCoords(i,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(r.row-o,0);t.selection.setRangeEnd(r),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function V6(){return[M6,_6,I6,P6,O6,x6,A6,H6,N6,D6,L6,$6,k6,F6]}const W6={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},B6={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let r=t.countVisibleRows()+n;i===t.countRows()-1?r=1:i+r>t.countRows()&&(r=t.countRows()-i-1),t.selection.transformStart(r,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},j6={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-r.row,-r.col):t.selection.transformStart(-r.row,-r.col)}},U6={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(r.row,r.col):t.selection.transformStart(r.row,r.col)}},z6={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},Y6={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},G6={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},K6={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),s=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},X6={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},q6={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(i,1);e.setRangeStart(t._createCellCoords(r,o))}},Z6={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeLast().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(i,r))}},Q6={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeLast().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(i,r))}},J6={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},e9={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(r,1),a=i.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},t9={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},n9={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let r=-(t.countVisibleRows()+n);i===-n?r=-1:i+r<n&&(r=-(i+n)),t.selection.transformStart(r,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function i9(){return[W6,B6,j6,U6,z6,Y6,G6,K6,X6,q6,Z6,Q6,J6,e9,t9,n9]}const r9={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},o9={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,i=t.view.getFirstFullyVisibleColumn()-1,r=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,i),a=t._createCellCoords(r,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},s9={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},a9={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},l9={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==i)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,r])}});t.setDataAtCell(Array.from(o.values()))}},u9=[...T6(),...V6(),...i9(),r9,o9,s9,a9,l9];function IA(t){const e={};return u9.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r(t,...s)}}),e}function c9(t){const e=t.getShortcutManager().addContext("editor"),n=IA(t),i={group:Zs};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(r,o)=>n.editorCloseAndSave(r,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,o)=>n.editorCloseAndSaveByArrowKeys(r,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function h9(t){const e=t.getShortcutManager().addContext("grid"),n=IA(t),i={runOnlyIf:()=>{const{navigableHeaders:r}=t.getSettings();return fe(t.getSelected())&&(r||!r&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:MA};e.addShortcuts([{keys:[["F2"]],callback:r=>n.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorOpen(r,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Zs,runOnlyIf:()=>fe(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var r;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var r;return(r=t.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var r,o;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineStart(r)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineEnd(r)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function d9(t){[h9,c9].forEach(e=>e(t))}function f9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,i=yM(t),r=yM(t);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(i),n.lastChild.after(r),{activate(){t._registerTimeout(()=>{i.tabIndex=0,r.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,r.tabIndex=-1},10)}}}function yM(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Me(n,[no(),dl()]),n}function g9(t){const e=m9(t);let n;const{activate:i,deactivate:r}=f9(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:xb(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:Ab(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(h,d,g,m,w)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,w.value=!0),s){var C;n=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:MA,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(n=h.shiftKey?xb(t):Ab(t)),u(),!1;h.preventDefault()},position:"after"}])}function xb(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,o=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),o===0&&(o=n.getVisualFromRenderableIndex(o)),r===null||o===null?null:t._createCellCoords(r,o)}function Ab(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:o}=t.getSettings();let s=i.getRenderableIndexesLength()-1,a=r.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=r.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function m9(t){return e=>{if(!e)return null;const n=xb(t),i=Ab(t);return e.col<n.col&&(e.col=n.col),e.col>i.col&&(e.col=i.col),e.row<n.row&&(e.row=n.row),e.row>i.row&&(e.row=i.row),e}}function p9(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}function w9(){return()=>{}}function v9(t){return e=>{t.scrollViewportTo(e.toObject())}}function C9(t){return e=>{t.scrollViewportTo(e.toObject())}}function y9(t){return e=>{t.scrollViewportTo(e.toObject())}}function b9(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}function S9(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e;if(i<0&&r>=0)t.scrollViewportTo({col:r});else if(r<0&&i>=0)t.scrollViewportTo({row:i});else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r})}}}function R9(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var o;if(n||i){n=!1;return}let s;e.isFocusSelectionChanged()?s=v9(t):e.isSelectedByCorner()?s=w9():e.isSelectedByRowHeader()?s=b9(t):e.isSelectedByColumnHeader()?s=p9(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=C9(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=S9(t):e.getSelectedRange().size()>1&&(s=y9(t)),(o=s)===null||o===void 0||o(r)}}}const bM=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),_f=t=>t.map(e=>{const n=e.toLowerCase();return bM.has(n)?bM.get(n):n}).sort().join("+"),E9=t=>t.split("+"),SM=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),vC=t=>{let{which:e,key:n}=t;if(SM.has(e))return SM.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},PA=Symbol("shortcut-context");function OA(t){return ke(t)&&t.__kindOf===PA}const T9=t=>{const e=Ip({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:g=!0,stopPropagation:m=!1,relativeToGroup:w,position:C,forwardToContext:S}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Mt(c))throw new Error("You need to define the shortcut's group.");if(Et(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(gt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:g,stopPropagation:m};fe(w)&&(R.relativeToGroup=w,R.position=C),OA(S)&&(R.forwardToContext=S),l.forEach(E=>{const H=_f(E);if(e.hasItem(H)){const B=e.getItem(H);let j=B.findIndex(Y=>Y.group===w);j!==-1?C==="before"?j-=1:j+=1:j=B.length,B.splice(j,0,R)}else e.addItem(H,[R])})},i=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Fe(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},r=l=>{const u=_f(l);e.removeItem(u)};return{__kindOf:PA,addShortcut:n,addShortcuts:i,getShortcuts:l=>{const u=_f(l),c=e.getItem(u);return fe(c)?c.slice():[]},hasShortcut:l=>{const u=_f(l);return e.hasItem(u)},removeShortcutsByKeys:r,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const g=d.filter(m=>m.group!==l);g.length===0?r(E9(h)):(d.length=0,d.push(...g))})}}};function M9(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const _9=["meta","alt","shift","control"],gc=M9(),mc=[];let If=0;function I9(t,e,n,i,r){const o=g=>_9.includes(g),s=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return g.altKey&&w.push("alt"),m&&(g.ctrlKey||g.metaKey)?w.push("control/meta"):(g.ctrlKey&&w.push("control"),g.metaKey&&w.push("meta")),g.shiftKey&&w.push("shift"),w},a=g=>{if(e(g)===!1)return;const m=n(g);if(g.keyCode===229||m===!1||Ms(g))return;const w=vC(g);let C=[];o(w)||(C=s(g));const S=[w].concat(C);!r(g,S)&&(Hh()&&C.includes("meta")||!Hh()&&C.includes("control"))&&r(g,[w].concat(s(g,!0))),i(g)},l=g=>{if(g.key){const m=vC(g);o(m)&&gc.press(m)}},u=g=>{if(g.key){const m=vC(g);o(m)&&gc.release(m)}},c=()=>{gc.releaseAll()};return{mount:()=>{let g=t;for(If+=1;g;)If===1&&(g.document.documentElement.addEventListener("keydown",l),mc.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),mc.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Za(g)},unmount:()=>{let g=t;for(If-=1;g;){if(If===0){for(let m=0;m<mc.length;m++){const{event:w,listener:C}=mc[m];g.document.documentElement.removeEventListener(w,C)}mc.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Za(g)}},isPressed:g=>gc.isPressed(g),releasePressedKeys:()=>gc.releaseAll()}}const P9=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const o=Ip({errorIdExists:m=>`The "${m}" context name is already registered.`});let s="grid";const a=m=>{const w=T9(m);return o.addItem(m,w),w},l=()=>s,u=m=>o.getItem(m),c=m=>{if(!o.hasItem(m))throw new Error(gt`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=m};let h=!1;const d=function(m,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const S=OA(C)?C:u(C);let R=!1;if(!S.hasShortcut(w))return R;const E=S.getShortcuts(w);for(let H=0;H<E.length;H++){const{callback:P,runOnlyIf:B,preventDefault:j,stopPropagation:Y,captureCtrl:G,forwardToContext:z}=E[H];if(B(m)===!0){if(h=G,R=P(m,w)===!1,h=!1,j&&m.preventDefault(),Y&&(Xi(m),m.stopPropagation()),R)break;z&&d(m,w,z)}}return R},g=I9(e,n,i,r,d);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let CC=null;const yC=new Map;function xA(t,e){var n,i=this;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Yi(o);let a,l,u,c,h,d,g=!0;nq(r)&&tq(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",w=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=e4(e.language);const C=new TA(o,e,[s6,f6]),S=C.getTableMeta(),R=C.getGlobalMeta(),E=Ip();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),$g(this)&&_O(e.licenseKey,t),this.guid=`ht_${KS()}`,yC.set(this.guid,this),this.columnIndexMapper=new Pb,this.rowIndexMapper=new Pb,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterRowSequenceChange",f)}),l=new wq(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const H=f=>{const{row:p,col:v}=f;return o._createCellCoords(p>=0?o.rowIndexMapper.getRenderableFromVisualIndex(p):p,v>=0?o.columnIndexMapper.getRenderableFromVisualIndex(v):v)},P=f=>{const{row:p,col:v}=f;return o._createCellCoords(p>=0?o.rowIndexMapper.getVisualFromRenderableIndex(p):p,v>=0?o.columnIndexMapper.getVisualFromRenderableIndex(v):v)},B=(f,p)=>{const v=p>f?1:-1,_=Math.min(f,p),O=Math.max(f,p),F=o.rowIndexMapper.getNearestNotHiddenIndex(f,v);return F===null||v===1&&F>O||v===-1&&F<_?null:F>=0?o.rowIndexMapper.getRenderableFromVisualIndex(F):F},j=(f,p)=>{const v=p>f?1:-1,_=Math.min(f,p),O=Math.max(f,p),F=o.columnIndexMapper.getNearestNotHiddenIndex(f,v);return F===null||v===1&&F>O||v===-1&&F<_?null:F>=0?o.columnIndexMapper.getRenderableFromVisualIndex(F):F};let Y=new O4(S,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:f=>a.propToCol(f),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(f,p)=>o._createCellCoords(f,p),createCellRange:(f,p,v)=>o._createCellRange(f,p,v),visualToRenderableCoords:H,renderableToVisualCoords:P,findFirstNonHiddenRenderableRow:B,findFirstNonHiddenRenderableColumn:j,isDisabledCellSelection:(f,p)=>f<0||p<0?o.getSettings().disableVisualSelection:o.getCellMeta(f,p).disableVisualSelection});this.selection=Y;const G=f=>{let{hiddenIndexesChanged:p}=f;p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",(f,p)=>{const v=Bi(!1),_=this.selection.getSelectedRange(),{from:O,to:F}=_.current(),U=_.size()-1;this.runHooks("afterSelection",O.row,O.col,F.row,F.col,v,U),this.runHooks("afterSelectionByProp",O.row,o.colToProp(O.col),F.row,o.colToProp(F.col),v,U),p&&(!v.isTouched()||v.isTouched()&&!v.value)&&d.scrollTo(f);const K=Y.isSelectedByRowHeader(),ue=Y.isSelectedByColumnHeader();K&&ue?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):K?(xe(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):ue?(xe(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),Y.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const p=Bi(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(f),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const p=f.length-1,{from:v,to:_}=f[p];this.runHooks("afterSelectionEnd",v.row,v.col,_.row,_.col,p),this.runHooks("afterSelectionEndByProp",v.row,o.colToProp(v.col),_.row,o.colToProp(_.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const p=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,p=new Array(f),v=0;v<f;v++)p[v]=arguments[v];return i.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),u={alter(f,p){var v,_;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,F=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0;const K=ue=>{if(ue.length===0)return[];const he=[...ue];return he.sort((Ae,Oe)=>{let[W]=Ae,[Xe]=Oe;return W===Xe?0:W>Xe?1:-1}),nn(he,(Ae,Oe)=>{let[W,Xe]=Oe;const Ye=Ae[Ae.length-1],[nt,Ve]=Ye,Te=nt+Ve;if(W<=Te){const y=Math.max(Xe-(Te-W),0);Ye[1]+=y}else Ae.push([W,Xe]);return Ae},[he[0]])};switch(f){case"insert_row_below":case"insert_row_above":const ue=o.countSourceRows();if(S.maxRows===ue)return;const he=f==="insert_row_below"?"below":"above";p=(v=p)!==null&&v!==void 0?v:he==="below"?ue:0;const{delta:Q,startPhysicalIndex:Ae}=a.createRow(p,O,{source:F,mode:he});Y.shiftRows(o.toVisualRow(Ae),Q);break;case"insert_col_start":case"insert_col_end":const Oe=f==="insert_col_end"?"end":"start";p=(_=p)!==null&&_!==void 0?_:Oe==="end"?o.countSourceCols():0;const{delta:W,startPhysicalIndex:Xe}=a.createCol(p,O,{source:F,mode:Oe});if(W){if(Array.isArray(S.colHeaders)){const Ve=[o.toVisualColumn(Xe),0];Ve.length+=W,Array.prototype.splice.apply(S.colHeaders,Ve)}Y.shiftColumns(o.toVisualColumn(Xe),W)}break;case"remove_row":const Ye=Ve=>{let Te=0;M(Ve,y=>{let[b,T]=y;const $=Yt(b)?o.countRows()-1:Math.max(b-Te,0);if(Number.isInteger(b)&&(b=Math.max(b-Te,0)),!a.removeRow(b,T,F))return;if(Y.isSelected()){const{row:L}=o.getSelectedRangeLast().highlight;L>=b&&L<=b+T-1&&c.closeEditor(!0)}const k=o.countRows();k===0?Y.deselect():F==="ContextMenu.removeRow"?Y.refresh():Y.shiftRows(b,-T);const N=S.fixedRowsTop;N>=$+1&&(S.fixedRowsTop-=Math.min(T,N-$));const x=S.fixedRowsBottom;x&&$>=k-x&&(S.fixedRowsBottom-=Math.min(T,x)),Te+=T})};Array.isArray(p)?Ye(K(p)):Ye([[p,O]]);break;case"remove_col":const nt=Ve=>{let Te=0;M(Ve,y=>{let[b,T]=y;const $=Yt(b)?o.countCols()-1:Math.max(b-Te,0);let I=o.toPhysicalColumn($);if(Number.isInteger(b)&&(b=Math.max(b-Te,0)),!a.removeCol(b,T,F))return;if(Y.isSelected()){const{col:L}=o.getSelectedRangeLast().highlight;L>=b&&L<=b+T-1&&c.closeEditor(!0)}o.countCols()===0?Y.deselect():F==="ContextMenu.removeColumn"?Y.refresh():Y.shiftColumns(b,-T);const x=S.fixedColumnsStart;x>=$+1&&(S.fixedColumnsStart-=Math.min(T,x-$)),Array.isArray(S.colHeaders)&&(typeof I>"u"&&(I=-1),S.colHeaders.splice(I,T)),Te+=T})};Array.isArray(p)?nt(K(p)):nt([[p,O]]);break;default:throw new Error(`There is no such action "${f}"`)}o.view.render(),U||u.adjustRowsAndCols()},adjustRowsAndCols(){const f=S.minRows,p=S.minSpareRows,v=S.minCols,_=S.minSpareCols;if(f){const O=o.countRows();O<f&&a.createRow(O,f-O,{source:"auto"})}if(p){const O=o.countEmptyRows(!0);if(O<p){const F=p-O,U=Math.min(F,S.maxRows-o.countSourceRows());a.createRow(o.countRows(),U,{source:"auto"})}}{let O;(v||_)&&(O=o.countEmptyCols(!0));let F=o.countCols();if(v&&!S.columns&&F<v){const U=v-F;O+=U,a.createCol(F,U,{source:"auto"})}if(_&&!S.columns&&o.dataType==="array"&&O<_){F=o.countCols();const U=_-O,K=Math.min(U,S.maxCols-F);a.createCol(F,K,{source:"auto"})}}o.view&&o.view.adjustElementsSize()},populateFromArray(f,p,v,_,O){let F,U,K,ue;const he=[],Q={},Ae=[],Oe=f.row,W=f.col;if(U=p.length,U===0)return!1;let Xe=0,Ye=0;switch(ke(v)&&(Xe=v.col-W+1,Ye=v.row-Oe+1),O){case"shift_down":const nt=th(p),Ve=nt.length,Te=Math.max(Ve,Xe),y=o.getData().slice(Oe),b=th(y).slice(W,W+Te);for(K=0;K<Te;K+=1)if(K<Ve){for(F=0,U=nt[K].length;F<Ye-U;F+=1)nt[K].push(nt[K][F%U]);K<b.length?Ae.push(nt[K].concat(b[K])):Ae.push(nt[K].concat(new Array(y.length).fill(null)))}else Ae.push(nt[K%Ve].concat(b[K]));o.populateFromArray(Oe,W,th(Ae));break;case"shift_right":const T=p.length,$=Math.max(T,Ye),I=o.getData().slice(Oe).map(ce=>ce.slice(W));for(F=0;F<$;F+=1)if(F<T){for(K=0,ue=p[F].length;K<Xe-ue;K+=1)p[F].push(p[F][K%ue]);if(F<I.length)for(let ce=0;ce<I[F].length;ce+=1)p[F].push(I[F][ce]);else p[F].push(...new Array(I[0].length).fill(null))}else p.push(p[F%U].slice(0,$).concat(I[F]));o.populateFromArray(Oe,W,p);break;case"overwrite":default:Q.row=f.row,Q.col=f.col;let k=0,N=0,x=!0,L;const D=function(Se){let $e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ze=p[Se%p.length];return $e!==null?Ze[$e%Ze.length]:Ze},V=p.length,ne=v?v.row-f.row+1:0;for(v?U=ne:U=Math.max(V,ne),F=0;F<U&&!(v&&Q.row>v.row&&ne>V||!S.allowInsertRow&&Q.row>o.countRows()-1||Q.row>=S.maxRows);F++){const ce=F-k,Se=D(ce).length,$e=v?v.col-f.col+1:0;if(v?ue=$e:ue=Math.max(Se,$e),Q.col=f.col,L=o.getCellMeta(Q.row,Q.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&L.skipRowOnPaste){k+=1,Q.row+=1,U+=1;continue}for(N=0,K=0;K<ue&&!(v&&Q.col>v.col&&$e>Se||!S.allowInsertColumn&&Q.col>o.countCols()-1||Q.col>=S.maxCols);K++){if(L=o.getCellMeta(Q.row,Q.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&L.skipColumnOnPaste){N+=1,Q.col+=1,ue+=1;continue}if(L.readOnly&&_!=="UndoRedo.undo"){Q.col+=1;continue}const Ze=K-N;let je=D(ce,Ze),Pe=o.getDataAtCell(Q.row,Q.col);if(je!==null&&typeof je=="object")if(Array.isArray(je)&&Pe===null&&(Pe=[]),Pe===null||typeof Pe!="object")x=!1;else{const Je=Eu(Array.isArray(Pe)?Pe:Pe[0]||Pe),kt=Eu(Array.isArray(je)?je:je[0]||je);Ep(Je,kt)||Array.isArray(Je)&&Array.isArray(kt)?je=$n(je):x=!1}else Pe!==null&&typeof Pe=="object"&&(x=!1);x&&he.push([Q.row,Q.col,je]),x=!0,Q.col+=1}Q.row+=1}o.setDataAtCell(he,null,null,_||"populateFromArray");break}}};function z(f){const p=cA(f);e0(p)?(o.runHooks("beforeLanguageChange",p),R.language=p,o.runHooks("afterLanguageChange",p)):hA(f)}function J(f,p){const v=f==="className"?o.rootElement:o.table;if(g)X(v,p);else{let _=[],O=[];R[f]&&(_=Array.isArray(R[f])?R[f]:cb(R[f])),p&&(O=Array.isArray(p)?p:cb(p));const F=ub(_,O),U=ub(O,_);F.length&&xe(v,F),U.length&&X(v,U)}R[f]=p}this.init=function(){l.setData(S.data),o.runHooks("beforeInit"),(Wo()||dR())&&X(o.rootElement,"mobile"),this.updateSettings(S,!0),this.view=new lq(this),c=GG.getInstance(o,S,Y),d=R9(o),h=new XG(o),$g(this)&&g9(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&o.rootElement.offsetParent===null&&YO(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof g=="object"&&(o.runHooks("afterChange",g[0],g[1]),g=!1),o.runHooks("afterInit")};function Z(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function re(f){const p=f.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):f}function pe(f,p,v){if(!f.length){v();return}const _=o.getActiveEditor(),O=new Z;let F=!0;O.onQueueEmpty=()=>{_&&F&&_.cancelChanges(),v()};for(let U=f.length-1;U>=0;U--){const[K,ue,,he]=f[U],Q=a.propToCol(ue);let Ae;Number.isInteger(Q)?Ae=o.getCellMeta(K,Q):Ae={...Object.getPrototypeOf(S),...S},Ae.type==="numeric"&&typeof he=="string"&&Sx(he)&&(f[U][3]=re(he)),o.getCellValidator(Ae)&&(O.addValidatorToQueue(),o.validateCell(f[U][3],Ae,function(Oe,W){return function(Xe){if(typeof Xe!="boolean")throw new Error("Validation error: result is not boolean");Xe===!1&&W.allowInvalid===!1&&(F=!1,f.splice(Oe,1),W.valid=!0),O.removeValidatorFormQueue()}}(U,Ae),p))}O.checkIfQueueIsEmpty()}function Ie(f,p){for(let _=f.length-1;_>=0;_--){let O=!1;if(f[_]===null){f.splice(_,1);continue}if(!((f[_][2]===null||f[_][2]===void 0)&&(f[_][3]===null||f[_][3]===void 0))){if(S.allowInsertRow)for(;f[_][0]>o.countRows()-1;){const{delta:F}=a.createRow(void 0,void 0,{source:p});if(F===0){O=!0;break}}if(o.dataType==="array"&&(!S.columns||S.columns.length===0)&&S.allowInsertColumn)for(;a.propToCol(f[_][1])>o.countCols()-1;){const{delta:F}=a.createCol(void 0,void 0,{source:p});if(F===0){O=!0;break}}O||a.set(f[_][0],f[_][1],f[_][3])}}const v=f.length>0;if(o.forceFullRender=!0,v){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",f,p),c.closeEditor(),o.view.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",f,p||"edit");const _=o.getActiveEditor();_&&fe(_.refreshValue)&&_.refreshValue()}else o.view.render()}this._createCellCoords=function(f,p){return o.view._wt.createCellCoords(f,p)},this._createCellRange=function(f,p,v){return o.view._wt.createCellRange(f,p,v)},this.validateCell=function(f,p,v,_){let O=o.getCellValidator(p);function F(U){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){v(U);return}const ue=p.visualCol,he=p.visualRow,Q=o.getCell(he,ue,!0);if(Q&&Q.nodeName!=="TH"){const Ae=o.rowIndexMapper.getRenderableFromVisualIndex(he),Oe=o.columnIndexMapper.getRenderableFromVisualIndex(ue);o.view._wt.getSetting("cellRenderer",Ae,Oe,Q)}v(U)}MO(O)&&(O=function(U){return function(K,ue){ue(U.test(K))}}(O)),Et(O)?(f=o.runHooks("beforeValidate",f,p.visualRow,p.prop,_),o._registerImmediate(()=>{O.call(p,f,U=>{o&&(U=o.runHooks("afterValidate",U,f,p.visualRow,p.prop,_),p.valid=U,F(U),o.runHooks("postAfterValidate",U,f,p.visualRow,p.prop,_))})})):o._registerImmediate(()=>{p.valid=!0,F(p.valid,!1)})};function tt(f,p,v){return Array.isArray(f)?f:[[f,p,v]]}function Ne(f,p){const v=o.getActiveEditor(),_=o.runHooks("beforeChange",f,p||"edit"),O=f.filter(F=>F!==null);return _===!1||O.length===0?(v&&v.cancelChanges(),[]):O}this.setDataAtCell=function(f,p,v,_){const O=tt(f,p,v),F=[];let U=_,K,ue,he;for(K=0,ue=O.length;K<ue;K++){if(typeof O[K]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[K][1]>=this.countCols()?he=O[K][1]:he=a.colToProp(O[K][1]),F.push([O[K][0],he,l.getAtCell(this.toPhysicalRow(O[K][0]),O[K][1]),O[K][2]])}!U&&typeof f=="object"&&(U=p);const Q=Ne(F,_);o.runHooks("afterSetDataAtCell",Q,U),pe(Q,U,()=>{Ie(Q,U)})},this.setDataAtRowProp=function(f,p,v,_){const O=tt(f,p,v),F=[];let U=_,K,ue;for(K=0,ue=O.length;K<ue;K++)F.push([O[K][0],O[K][1],l.getAtCell(this.toPhysicalRow(O[K][0]),O[K][1]),O[K][2]]);!U&&typeof f=="object"&&(U=p);const he=Ne(F,_);o.runHooks("afterSetDataAtRowProp",he,U),pe(he,U,()=>{Ie(he,U)})},this.listen=function(){o&&!o.isListening()&&(yC.forEach(f=>{o!==f&&f.unlisten()}),CC=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(CC=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return CC===o.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(f),o.view.render(),p&&Y.isSelected()&&c.prepareEditor()},this.populateFromArray=function(f,p,v,_,O,F,U){if(!(typeof v=="object"&&typeof v[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const K=typeof _=="number"?o._createCellCoords(_,O):null;return u.populateFromArray(o._createCellCoords(f,p),v,K,F,U)},this.spliceCol=function(f,p,v){for(var _=arguments.length,O=new Array(_>3?_-3:0),F=3;F<_;F++)O[F-3]=arguments[F];return a.spliceCol(f,p,v,...O)},this.spliceRow=function(f,p,v){for(var _=arguments.length,O=new Array(_>3?_-3:0),F=3;F<_;F++)O[F-3]=arguments[F];return a.spliceRow(f,p,v,...O)},this.getSelected=function(){if(Y.isSelected())return Ke(Y.getSelectedRange(),f=>{let{from:p,to:v}=f;return[p.row,p.col,v.row,v.col]})},this.getSelectedLast=function(){const f=this.getSelected();let p;return f&&f.length>0&&(p=f[f.length-1]),p},this.getSelectedRange=function(){if(Y.isSelected())return Array.from(Y.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let p;return f&&f.length>0&&(p=f[f.length-1]),p},this.emptySelectedCells=function(f){if(!Y.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];M(Y.getSelectedRange(),v=>{if(v.isSingleHeader())return;const _=v.getTopStartCorner(),O=v.getBottomEndCorner();Ce(_.row,O.row,F=>{Ce(_.col,O.col,U=>{this.getCellMeta(F,U).readOnly||p.push([F,U,null])})})}),p.length>0&&this.setDataAtCell(p,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(f){this.suspendRender();const p=f();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const v=f();return this.resumeExecution(p),v},this.batch=function(f){this.suspendRender(),this.suspendExecution();const p=f();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!o.view)return;const{width:f,height:p}=o.view.getLastSize(),{width:v,height:_}=o.rootElement.getBoundingClientRect(),O=v!==f||_!==p;o.runHooks("beforeRefreshDimensions",{width:f,height:p},{width:v,height:_},O)!==!1&&((O||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(v,_),o.render()),o.runHooks("afterRefreshDimensions",{width:f,height:p},{width:v,height:_},O))},this.updateData=function(f,p){wM(f,v=>{a=v},v=>{a=v,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),Y.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:p,metaManager:C,firstRun:g})},this.loadData=function(f,p){wM(f,v=>{a=v},()=>{C.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),Y.refresh(),g&&(g=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:p,metaManager:C,firstRun:g})},this.getInitialColumnCount=function(){const f=S.columns;let p=0;if(Array.isArray(f))p=f.length;else if(Et(f))if(o.dataType==="array"){const v=this.countSourceCols();for(let _=0;_<v;_+=1)f(_)&&(p+=1)}else(o.dataType==="object"||o.dataType==="function")&&(p=a.colToPropCache.length);else if(fe(S.dataSchema)){const v=a.getSchema();p=Array.isArray(v)?v.length:Tp(v)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,p,v,_){return Mt(f)?a.getAll():a.getRange(o._createCellCoords(f,p),o._createCellCoords(v,_),a.DESTINATION_RENDERER)},this.getCopyableText=function(f,p,v,_){return a.getCopyableText(o._createCellCoords(f,p),o._createCellCoords(v,_))},this.getCopyableData=function(f,p){return a.getCopyable(f,a.colToProp(p))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=(g?o.loadData:o.updateData).bind(this);let _=!1,O,F;if(fe(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(fe(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(fe(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in f)O==="data"||(O==="language"?z(f.language):O==="className"?J("className",f.className):O==="tableClassName"&&o.table?(J("tableClassName",f.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):de.getSingleton().isRegistered(O)||de.getSingleton().isDeprecated(O)?(Et(f[O])||Array.isArray(f[O]))&&(f[O].initialHook=!0,o.addHook(O,f[O])):!p&&$t(f,O)&&(R[O]=f[O]));f.data===void 0&&S.data===void 0?v(null,"updateSettings"):f.data!==void 0?v(f.data,"updateSettings"):f.columns!==void 0&&(a.createMap(),o.initIndexMappers());const U=o.countCols(),K=S.columns;if(K&&Et(K)&&(_=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&C.clearCache(),U>0)for(O=0,F=0;O<U;O++){if(K){const Q=_?K(O):K[F];Q&&C.updateColumnMeta(F,Q)}F+=1}fe(f.cell)&&Fe(f.cell,Q=>{o.setCellMetaObject(Q.row,Q.col,Q)}),o.runHooks("afterCellMetaReset");let ue=o.rootElement.style.height;ue!==""&&(ue=parseInt(o.rootElement.style.height,10));let he=f.height;if(Et(he)&&(he=he()),p&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),he===null){const Q=o.rootElement.getAttribute("data-initialstyle");Q&&(Q.indexOf("height")>-1||Q.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",Q):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else he!==void 0&&(o.rootElement.style.height=isNaN(he)?`${he}`:`${he}px`,o.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let Q=f.width;Et(Q)&&(Q=Q()),o.rootElement.style.width=isNaN(Q)?`${Q}`:`${Q}px`}p||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",f)),u.adjustRowsAndCols(),o.view&&!g&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),!p&&o.view&&(ue===""||he===""||he===void 0)&&ue!==he&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=o.getSelectedLast();if(S.getValue){if(Et(S.getValue))return S.getValue.call(o);if(f)return o.getData()[f[0][0]][S.getValue]}else if(f)return o.getDataAtCell(f[0],f[1])},this.getSettings=function(){return S},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,p,v,_,O){u.alter(f,p,v,_,O)},this.getCell=function(f,p){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=p,O=f;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return O===null||_===null||O===void 0||_===void 0?null:o.view.getCellAtCoords(o._createCellCoords(O,_),v)},this.getCoords=function(f){const p=this.view._wt.wtTable.getCoords(f);if(p===null)return null;const{row:v,col:_}=p;let O=v,F=_;return v>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(v)),_>=0&&(F=this.columnIndexMapper.getVisualFromRenderableIndex(_)),o._createCellCoords(O,F)},this.colToProp=function(f){return a.colToProp(f)},this.propToCol=function(f){return a.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,p){return a.get(f,a.colToProp(p))},this.getDataAtRowProp=function(f,p){return a.get(f,p)},this.getDataAtCol=function(f){const p=[],v=a.getRange(o._createCellCoords(0,f),o._createCellCoords(S.data.length-1,f),a.DESTINATION_RENDERER);for(let _=0;_<v.length;_+=1)for(let O=0;O<v[_].length;O+=1)p.push(v[_][O]);return p},this.getDataAtProp=function(f){const p=[],v=a.getRange(o._createCellCoords(0,a.propToCol(f)),o._createCellCoords(S.data.length-1,a.propToCol(f)),a.DESTINATION_RENDERER);for(let _=0;_<v.length;_+=1)for(let O=0;O<v[_].length;O+=1)p.push(v[_][O]);return p},this.getSourceData=function(f,p,v,_){let O;return f===void 0?O=l.getData():O=l.getByRange(o._createCellCoords(f,p),o._createCellCoords(v,_)),O},this.getSourceDataArray=function(f,p,v,_){let O;return f===void 0?O=l.getData(!0):O=l.getByRange(o._createCellCoords(f,p),o._createCellCoords(v,_),!0),O},this.getSourceDataAtCol=function(f){return l.getAtColumn(f)},this.setSourceDataAtCell=function(f,p,v,_){const O=tt(f,p,v),F=this.hasHook("afterSetSourceDataAtCell"),U=[];F&&M(O,ue=>{let[he,Q,Ae]=ue;U.push([he,Q,l.getAtCell(he,Q),Ae])}),M(O,ue=>{let[he,Q,Ae]=ue;l.setAtCell(he,Q,Ae)}),F&&this.runHooks("afterSetSourceDataAtCell",U,_),this.render();const K=o.getActiveEditor();K&&fe(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(f){return l.getAtRow(f)},this.getSourceDataAtCell=function(f,p){return l.getAtCell(f,p)},this.getDataAtRow=function(f){return a.getRange(o._createCellCoords(f,0),o._createCellCoords(f,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,p,v,_){const O=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,p,v,_],[F,U]=O;let[,,K,ue]=O,he=null,Q=null;K===void 0&&(K=F),ue===void 0&&(ue=U);let Ae="mixed";return Ce(Math.max(Math.min(F,K),0),Math.max(F,K),Oe=>{let W=!0;return Ce(Math.max(Math.min(U,ue),0),Math.max(U,ue),Xe=>(Q=this.getCellMeta(Oe,Xe).type,he?W=he===Q:he=Q,W)),Ae=W?Q:"mixed",W}),Ae},this.removeCellMeta=function(f,p,v){const[_,O]=[this.toPhysicalRow(f),this.toPhysicalColumn(p)];let F=C.getCellMetaKeyValue(_,O,v);o.runHooks("beforeRemoveCellMeta",f,p,v,F)!==!1&&(C.removeCellMeta(_,O,v),o.runHooks("afterRemoveCellMeta",f,p,v,F)),F=null},this.spliceCellsMeta=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var v=arguments.length,_=new Array(v>2?v-2:0),O=2;O<v;O++)_[O-2]=arguments[O];if(_.length>0&&!Array.isArray(_[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&C.removeRow(this.toPhysicalRow(f),p),_.length>0&&M(_.reverse(),F=>{C.createRow(this.toPhysicalRow(f)),M(F,(U,K)=>this.setCellMetaObject(f,K,U))}),o.render()},this.setCellMetaObject=function(f,p,v){typeof v=="object"&&Fe(v,(_,O)=>{this.setCellMeta(f,p,O,_)})},this.setCellMeta=function(f,p,v,_){if(o.runHooks("beforeSetCellMeta",f,p,v,_)===!1)return;let F=f,U=p;f<this.countRows()&&(F=this.toPhysicalRow(f)),p<this.countCols()&&(U=this.toPhysicalColumn(p)),C.setCellMeta(F,U,v,_),o.runHooks("afterSetCellMeta",f,p,v,_)},this.getCellsMeta=function(){return C.getCellsMeta()},this.getCellMeta=function(f,p){let v=this.toPhysicalRow(f),_=this.toPhysicalColumn(p);return v===null&&(v=f),_===null&&(_=p),C.getCellMeta(v,_,{visualRow:f,visualColumn:p})},this.getColumnMeta=function(f){return C.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return C.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||S.columns)},this.getCellRenderer=function(f,p){const v=typeof f=="number"?o.getCellMeta(f,p).renderer:f.renderer;return typeof v=="string"?gm(v):Mt(v)?gm("text"):v},this.getCellEditor=function(f,p){const v=typeof f=="number"?o.getCellMeta(f,p).editor:f.editor;return typeof v=="string"?fm(v):Mt(v)?fm("text"):v},this.getCellValidator=function(f,p){const v=typeof f=="number"?o.getCellMeta(f,p).validator:f.validator;return typeof v=="string"?SR(v):v},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,p){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,f)},this.validateColumns=function(f,p){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,f)},this._validateCells=function(f,p,v){const _=new Z;f&&(_.onQueueEmpty=f);let O=o.countRows()-1;for(;O>=0;){if(p!==void 0&&p.indexOf(O)===-1){O-=1;continue}let F=o.countCols()-1;for(;F>=0;){if(v!==void 0&&v.indexOf(F)===-1){F-=1;continue}_.addValidatorToQueue(),o.validateCell(o.getDataAtCell(O,F),o.getCellMeta(O,F),U=>{if(typeof U!="boolean")throw new Error("Validation error: result is not boolean");U===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),F-=1}O-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let p=S.rowHeaders,v=f;return v!==void 0&&(v=o.runHooks("modifyRowHeader",v)),v===void 0?(p=[],Ce(o.countRows()-1,_=>{p.push(o.getRowHeader(_))})):Array.isArray(p)&&p[v]!==void 0?p=p[v]:Et(p)?p=p(v):p&&typeof p!="string"&&typeof p!="number"&&(p=v+1),p},this.hasRowHeaders=function(){return!!S.rowHeaders},this.hasColHeaders=function(){if(S.colHeaders!==void 0&&S.colHeaders!==null)return!!S.colHeaders;for(let f=0,p=o.countCols();f<p;f++)if(o.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const v=o.runHooks("modifyColHeader",f);if(v===void 0){const K=[],ue=o.countCols();for(let he=0;he<ue;he++)K.push(o.getColHeader(he));return K}let _=S.colHeaders;const O=function(K){const ue=[],he=o.countCols();let Q=0;for(;Q<he;Q++)Et(S.columns)&&S.columns(Q)&&ue.push(Q);return ue[K]},F=o.toPhysicalColumn(v),U=O(F);return S.colHeaders===!1?_=null:S.columns&&Et(S.columns)&&S.columns(U)&&S.columns(U).title?_=S.columns(U).title:S.columns&&S.columns[F]&&S.columns[F].title?_=S.columns[F].title:Array.isArray(S.colHeaders)&&S.colHeaders[F]!==void 0?_=S.colHeaders[F]:Et(S.colHeaders)?_=S.colHeaders(F):S.colHeaders&&typeof S.colHeaders!="string"&&typeof S.colHeaders!="number"&&(_=Op(v)),_=o.runHooks("modifyColumnHeaderValue",_,f,p),_},this._getColWidthFromSettings=function(f){let p;if(f>=0&&(p=o.getCellMeta(0,f).width),(p===void 0||p===S.width)&&(p=S.colWidths),p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(f){let p=o._getColWidthFromSettings(f);return p=o.runHooks("modifyColWidth",p,f),p===void 0&&(p=Pp),p},this._getRowHeightFromSettings=function(f){let p=S.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(f){let p=o._getRowHeightFromSettings(f);return p=o.runHooks("modifyRowHeight",p,f),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const f=S.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,p)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return Eb(o.countRows()-1,v=>{if(o.isEmptyRow(v))p+=1;else if(f===!0)return!1}),p},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return Eb(o.countCols()-1,v=>{if(o.isEmptyCol(v))p+=1;else if(f===!0)return!1}),p},this.isEmptyRow=function(f){return S.isEmptyRow.call(o,f)},this.isEmptyCol=function(f){return S.isEmptyCol.call(o,f)},this.selectCell=function(f,p,v,_){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,F=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Mt(f)||Mt(p)?!1:this.selectCells([[f,p,v,_]],O,F)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&d.suspend();const _=Y.selectCells(f);return _&&v&&o.listen(),d.resume(),_},this.selectColumns=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,v=arguments.length>2?arguments[2]:void 0;return Y.selectColumns(f,p,v)},this.selectRows=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,v=arguments.length>2?arguments[2]:void 0;return Y.selectRows(f,p,v)},this.deselectCell=function(){Y.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,v=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),Y.selectAll(f,p,v)};const ye=(f,p)=>f.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(f){var p;if(typeof f=="number"){var v;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(v=arguments[4])!==null&&v!==void 0?v:!0}}const{row:_,col:O,verticalSnap:F,horizontalSnap:U,considerHiddenIndexes:K}=(p=f)!==null&&p!==void 0?p:{};let ue,he,Q,Ae;F!==void 0&&(ue=F==="top",he=!ue),U!==void 0&&(Q=U==="start",Ae=!Q);let Oe=_,W=O;if(K===void 0||K){const nt=Number.isInteger(_)&&_>=0,Ve=Number.isInteger(O)&&O>=0,Te=nt?ye(this.rowIndexMapper,_):void 0,y=Ve?ye(this.columnIndexMapper,O):void 0;if(Te===null||y===null)return!1;Oe=nt?o.rowIndexMapper.getRenderableFromVisualIndex(Te):_,W=Ve?o.columnIndexMapper.getRenderableFromVisualIndex(y):O}const Xe=Number.isInteger(Oe),Ye=Number.isInteger(W);return Xe&&Oe>=0&&Ye&&W>=0?o.view.scrollViewport(o._createCellCoords(Oe,W),ue,Ae,he,Q):Xe&&Oe>=0&&(Ye&&W<0||!Ye)?o.view.scrollViewportVertically(Oe,ue,he):Ye&&W>=0&&(Xe&&Oe<0||!Xe)?o.view.scrollViewportHorizontally(W,Ae,Q):!1},this.scrollToFocusedCell=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",f);const{highlight:p}=this.getSelectedRangeLast();this.scrollViewportTo(p.toObject())?this.view.render():(this.removeHook("afterScroll",f),this._registerImmediate(()=>f()))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),C.clearCache(),yC.delete(this.guid),$g(o)){const f=this.rootDocument.querySelector(".hot-display-license-info");f&&f.parentNode.removeChild(f)}yr(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),E.getItems().forEach(f=>{let[,p]=f;p.destroy()}),E.clear(),o.runHooks("afterDestroy")},!0),de.getSingleton().destroy(o),Fe(o,(f,p,v)=>{Et(f)?v[p]=we(p):p!=="guid"&&(v[p]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,Y=null,c=null,o=null};function we(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){const p=Ln(f);return p==="UndoRedo"?this.undoRedo:E.getItem(p)},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:E.getId(f)},this.getInstance=function(){return o},this.addHook=function(f,p,v){de.getSingleton().add(f,p,o,v)},this.hasHook=function(f){return de.getSingleton().has(f,o)||de.getSingleton().has(f)},this.addHookOnce=function(f,p,v){de.getSingleton().once(f,p,o,v)},this.removeHook=function(f,p){de.getSingleton().remove(f,p,o)},this.runHooks=function(f,p,v,_,O,F,U){return de.getSingleton().run(o,f,p,v,_,O,F,U)},this.getTranslatedPhrase=function(f,p){return pA(S.language,f,p)},this.toHTML=()=>Sb(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",Sb(this)),f.firstElementChild},this.timeouts=[],this._registerTimeout=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=f;typeof v=="function"&&(v=setTimeout(v,p)),this.timeouts.push(v)},this._clearTimeouts=function(){M(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){M(this.immediates,f=>{clearImmediate(f)})},this._getEditorManager=function(){return c},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};const pt=P9({handleEvent(){return o.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&pt.releasePressedKeys()}),this.getShortcutManager=function(){return pt},this.getFocusManager=function(){return h},bR().forEach(f=>{const p=Cd(f);E.addItem(f,new p(this))}),d9(o),pt.setActiveContextName("grid"),de.getSingleton().run(o,"construct")}function RM(t,e,n){t.addEventListener(e,n,!1)}function EM(t,e,n){t.removeEventListener(e,n,!1)}function TM(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function O9(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,i=t.createTextNode(""),r=t.createElement("span");let o;function s(){i.textContent=o.value,r.style.position="absolute",r.style.fontSize=TM(o).fontSize,r.style.fontFamily=TM(o).fontFamily,r.style.whiteSpace="pre",n.appendChild(r);const c=r.clientWidth+2;n.removeChild(r);const h=o.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const d=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>d?h.height=`${e.minHeight}px`:e.maxHeight<d?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${d}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}r.firstChild||(r.className="autoResize",r.style.display="inline-block",r.appendChild(i))}function u(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),d&&(RM(o,"input",s),RM(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){EM(o,"input",s),EM(o,"keydown",a)}}}function MM(t,e){const n=iR(e),i=e.value.split(`
`);let r=n,o=0;for(let s=0;s<i.length;s++){const a=i[s];s!==0&&(o+=i[s-1].length+1);const l=o+a.length;if(t==="home"?r=o:t==="end"&&(r=l),n<=l)break}md(e,r)}function ha(t,e,n){return(e=x9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x9(t){var e=A9(t,"string");return typeof e=="symbol"?e:e+""}function A9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const H9="ht_editor_visible",Pf="ht_editor_hidden",_M="textEditor",N9="text";class pl extends $u{static get EDITOR_TYPE(){return N9}constructor(e){super(e),ha(this,"eventManager",new Yi(this)),ha(this,"autoResize",O9(this.hot.rootDocument)),ha(this,"TEXTAREA",void 0),ha(this,"textareaStyle",void 0),ha(this,"TEXTAREA_PARENT",void 0),ha(this,"textareaParentStyle",void 0),ha(this,"layerClass",void 0),this.eventManager=new Yi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),DO(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,o,s){const a=this.state;if(super.prepare(e,n,i,r,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Xt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Xt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),md(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Me(this.TEXTAREA,[["data-hot-input",""],Hu(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),_e(this.TEXTAREA_PARENT,this.layerClass)&&xe(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Pf),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){ax()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",xe(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Pf)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;Ce(e.length-1,i=>{const r=e[i];if(_e(r,"handsontableEditor"))return n=!0,!1}),_e(this.TEXTAREA_PARENT,Pf)&&xe(this.TEXTAREA_PARENT,Pf),n?(this.layerClass=H9,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Xt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=so(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=so(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=r-c,g=s-h,m=o-c,w=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,m),minHeight:Math.min(g,w),maxWidth:m,maxHeight:w},!0)}bindEvents(){hR()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Xt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Xt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>fe(this.hot.getSelected()),group:_M},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;MM(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;MM(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(_M)}}const D9="base";function Td(t,e,n,i,r,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(hT())):a&&c.push(hT()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(dT())):(u.push(s.invalidCellClassName),a&&c.push(dT()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),xe(e,u),X(e,l),fl(e,c),Me(e,h)}Td.RENDERER_TYPE=D9;const L9="text";function is(t,e,n,i,r,o,s){Td.apply(this,[t,e,n,i,r,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=zt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){yr(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else Us(e,a)}is.RENDERER_TYPE=L9;const $9="text",AA={CELL_TYPE:$9,editor:pl,renderer:is};Ai(AA);oe.editors={BaseEditor:$u};function oe(t,e){const n=new xA(t,e||{},VR);return n.init(),n}oe.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new xA(t,e,VR)};oe.DefaultSettings=EA();oe.hooks=de.getSingleton();oe.CellCoords=pm;oe.CellRange=ER;oe.packageName="handsontable";oe.buildDate="17/10/2024 09:16:16";oe.version="14.6.1";oe.languages={dictionaryKeys:Gq,getLanguageDictionary:mA,getLanguagesDictionaries:Qq,registerLanguageDictionary:JR,getTranslatedPhrase:pA};function k9(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IM(t,e,n){return e=ym(e),W9(t,HA()?Reflect.construct(e,n||[],ym(t).constructor):e.apply(t,n))}function PM(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F9(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,DA(i.key),i)}}function OM(t,e,n){return e&&F9(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function V9(t,e,n){return(e=DA(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ym(t){return ym=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ym(t)}function xM(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hb(t,e)}function HA(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HA=function(){return!!t})()}function AM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function NA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AM(Object(n),!0).forEach(function(i){V9(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AM(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function W9(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k9(t)}function Hb(t,e){return Hb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Hb(t,e)}function B9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DA(t){var e=B9(t,"string");return typeof e=="symbol"?e:e+""}function Vs(t){"@babel/helpers - typeof";return Vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vs(t)}var vu=Symbol("unassigned"),pc=null,j9="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function U9(t){t.hotInstance&&(t.hotInstance.addHook("beforeChange",function(){t.__internalEdit=!0}),t.hotInstance.addHook("beforeCreateRow",function(){t.__internalEdit=!0}),t.hotInstance.addHook("beforeCreateCol",function(){t.__internalEdit=!0}),t.hotInstance.addHook("beforeRemoveRow",function(){t.__internalEdit=!0}),t.hotInstance.addHook("beforeRemoveCol",function(){t.__internalEdit=!0}))}function LA(t){var e=oe.hooks.getRegistered(),n={};Object.assign(n,oe.DefaultSettings);for(var i in n)n[i]={default:vu};for(var r=0;r<e.length;r++)n[e[r]]={default:vu};return n.settings={default:vu},t==="HotTable"&&(n.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},n.wrapperRendererCacheSize={type:Number,default:3e3}),n}function $A(t){var e={},n=t.settings;if(n!==vu)for(var i in n)n.hasOwnProperty(i)&&n[i]!==vu&&(e[i]=n[i]);for(var r in t)t.hasOwnProperty(r)&&r!=="settings"&&t[r]!==vu&&(e[r]=t[r]);return e}function HM(t,e){var n=$A(t),i=t.settings?t.settings:n,r=t.settings?n:null,o={};for(var s in i)i.hasOwnProperty(s)&&i[s]!==void 0&&(!(e&&s!=="data")||!DM(e[s],i[s]))&&(o[s]=i[s]);for(var a in r)r.hasOwnProperty(a)&&a!=="id"&&a!=="settings"&&a!=="wrapperRendererCacheSize"&&r[a]!==void 0&&(!(e&&a!=="data")||!DM(e[a],r[a]))&&(o[a]=r[a]);return o}function bm(t,e){var n=null;return t.every(function(i,r){return i.data&&i.data.attrs&&i.data.attrs[e]!==void 0?(n=i,!1):!0}),n}function z9(t){return t.filter(function(e){return e.$options.name==="HotColumn"})}function NM(t,e,n,i){var r=e.$el?e.$el.ownerDocument:document,o={propsData:n,parent:e,data:i};pc||(pc=r.createElement("DIV"),pc.id="vueHotComponents",r.body.appendChild(pc));var s=r.createElement("DIV");return pc.appendChild(s),new t.componentOptions.Ctor(o).$mount(s)}function DM(t,e){var n=function(r){var o=function(){var s=new WeakSet;return function(a,l){if(Vs(l)==="object"&&l!==null){if(s.has(l))return;s.add(l)}return l}}();return JSON.stringify(r,o)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():Vs(t)!==Vs(e)?!1:n(t)===n(e)}var Y9="14.6.1",G9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Nb={};(function(t){(function(e,n){var i=t;n(i)})(G9,function(e){var n=Symbol("newer"),i=Symbol("older");function r(s,a){typeof s!="number"&&(a=s,s=0),this.size=0,this.limit=s,this.oldest=this.newest=void 0,this._keymap=new Map,a&&(this.assign(a),s<1&&(this.limit=this.size))}e.LRUMap=r;function o(s,a){this.key=s,this.value=a,this[n]=void 0,this[i]=void 0}r.prototype._markEntryAsUsed=function(s){s!==this.newest&&(s[n]&&(s===this.oldest&&(this.oldest=s[n]),s[n][i]=s[i]),s[i]&&(s[i][n]=s[n]),s[n]=void 0,s[i]=this.newest,this.newest&&(this.newest[n]=s),this.newest=s)},r.prototype.assign=function(s){var a,l=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var u=s[Symbol.iterator](),c=u.next();!c.done;c=u.next()){var h=new o(c.value[0],c.value[1]);if(this._keymap.set(h.key,h),a?(a[n]=h,h[i]=a):this.oldest=h,a=h,l--==0)throw new Error("overflow")}this.newest=a,this.size=this._keymap.size},r.prototype.get=function(s){var a=this._keymap.get(s);if(a)return this._markEntryAsUsed(a),a.value},r.prototype.set=function(s,a){var l=this._keymap.get(s);return l?(l.value=a,this._markEntryAsUsed(l),this):(this._keymap.set(s,l=new o(s,a)),this.newest?(this.newest[n]=l,l[i]=this.newest):this.oldest=l,this.newest=l,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var s=this.oldest;if(s)return this.oldest[n]?(this.oldest=this.oldest[n],this.oldest[i]=void 0):(this.oldest=void 0,this.newest=void 0),s[n]=s[i]=void 0,this._keymap.delete(s.key),--this.size,[s.key,s.value]},r.prototype.has=function(s){return this._keymap.has(s)}})})(Nb);var K9={name:"HotTable",props:LA("HotTable"),watch:{mergedHotSettings:function(e){!this.hotInstance||e===void 0||(e.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete e.data),Object.keys(e).length?this.hotInstance.updateSettings(e):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var e=this,n=new Nb.LRUMap(this.wrapperRendererCacheSize);return n.shift=function(){var i=Nb.LRUMap.prototype.shift.call(this);return i[1].component.$destroy(),i},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:n,editorCache:new Map,get hotInstance(){return!e.__hotInstance||e.__hotInstance&&!e.__hotInstance.isDestroyed?e.__hotInstance:(console.warn(j9),null)},set hotInstance(i){e.__hotInstance=i}}},computed:{mergedHotSettings:function(){return HM(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var e=this.getGlobalRendererVNode(),n=this.getGlobalEditorVNode(),i=HM(this.$props);i.columns=this.columnSettings?this.columnSettings:i.columns,n&&(i.editor=this.getEditorClass(n,this),n.child.$destroy()),e&&(i.renderer=this.getRendererWrapper(e,this),e.child.$destroy()),this.hotInstance=new oe.Core(this.$el,i),this.hotInstance.init(),U9(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var n=this.hotInstance.getSourceData(),i=[],r=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)i.push(l);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&((u=n[0])===null||u===void 0?void 0:u.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)r.push(c)}this.hotInstance.batch(function(){i.length>0?e.hotInstance.rowIndexMapper.removeIndexes(i):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&n.length!==0&&(r.length>0?e.hotInstance.columnIndexMapper.removeIndexes(r):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))})}},getGlobalRendererVNode:function(){var e=this.$slots.default||[];return bm(e,"hot-renderer")},getGlobalEditorVNode:function(){var e=this.$slots.default||[];return bm(e,"hot-editor")},getColumnSettings:function(){var e=z9(this.$children),n=!1,i=e.map(function(r){return r.usesRendererComponent&&(n=!0),NA({},r.columnSettings)});return n&&this.settings&&(this.settings.autoColumnSize!==!1||this.settings.autoRowSize)&&(this.autoColumnSize!==!1||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),i.length?i:void 0},getRendererWrapper:function(e,n){var i=this;return function(r,o,s,a,l,u,c){if(o&&!o.getAttribute("ghost-table")){var h=i.rendererCache,d={hotInstance:r,TD:o,row:s,col:a,prop:l,value:u,cellProperties:c,isRenderer:!0};if(h&&!h.has("".concat(s,"-").concat(a))){var g=NM(e,n,e.componentOptions.propsData,d);h.set("".concat(s,"-").concat(a),{component:g,lastUsedTD:null})}var m=h.get("".concat(s,"-").concat(a)),w=m.component,C=m.lastUsedTD;if(Object.assign(w.$data,d),!w.$el.parentElement||C!==o){for(;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(w.$el),m.lastUsedTD=o}}return o}},getEditorClass:function(e,n){var i=e.key?e.key.toString():null,r=e.componentOptions.Ctor.options.name,o=i?"".concat(r,":").concat(i):r,s=this.editorCache,a=null;return s.has(o)?a=s.get(o):(a=NM(e,n,e.componentOptions.propsData,{isEditor:!0}),s.set(o,a)),a.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:Y9};function X9(t,e,n,i,r,o,s,a,l,u){const c=typeof n=="function"?n.options:n;return t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),n}var q9=K9,Z9=function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{attrs:{id:e.id}},[e._t("default")],2)},Q9=[],J9=void 0,e8=void 0,t8=!1,n8=X9({render:Z9,staticRenderFns:Q9},J9,q9,e8,t8);LA("HotColumn");function i8(t,e,n,i){var r=arguments.length,o=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,n,o):s(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o}function Wg(t){return typeof Symbol=="function"&&Vs(Symbol.iterator)==="symbol"?Wg=function(n){return Vs(n)}:Wg=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":Vs(n)},Wg(t)}function r8(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o8(t){return s8(t)||a8(t)||l8()}function s8(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function a8(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function l8(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function u8(){return typeof Reflect<"u"&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function c8(t,e){bC(t,e),Object.getOwnPropertyNames(e.prototype).forEach(function(n){bC(t.prototype,e.prototype,n)}),Object.getOwnPropertyNames(e).forEach(function(n){bC(t,e,n)})}function bC(t,e,n){var i=n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e);i.forEach(function(r){var o=n?Reflect.getOwnMetadata(r,e,n):Reflect.getOwnMetadata(r,e);n?Reflect.defineMetadata(r,o,t,n):Reflect.defineMetadata(r,o,t)})}var h8={__proto__:[]},d8=h8 instanceof Array;function f8(t){var e=Wg(t);return t==null||e!=="object"&&e!=="function"}function g8(t,e){var n=e.prototype._init;e.prototype._init=function(){var o=this,s=Object.getOwnPropertyNames(t);if(t.$options.props)for(var a in t.$options.props)t.hasOwnProperty(a)||s.push(a);s.forEach(function(l){Object.defineProperty(o,l,{get:function(){return t[l]},set:function(c){t[l]=c},configurable:!0})})};var i=new e;e.prototype._init=n;var r={};return Object.keys(i).forEach(function(o){i[o]!==void 0&&(r[o]=i[o])}),r}var Db=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function LM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach(function(a){if(a!=="constructor"){if(Db.indexOf(a)>-1){e[a]=n[a];return}var l=Object.getOwnPropertyDescriptor(n,a);l.value!==void 0?typeof l.value=="function"?(e.methods||(e.methods={}))[a]=l.value:(e.mixins||(e.mixins=[])).push({data:function(){return r8({},a,l.value)}}):(l.get||l.set)&&((e.computed||(e.computed={}))[a]={get:l.get,set:l.set})}}),(e.mixins||(e.mixins=[])).push({data:function(){return g8(this,t)}});var i=t.__decorators__;i&&(i.forEach(function(a){return a(e)}),delete t.__decorators__);var r=Object.getPrototypeOf(t.prototype),o=r instanceof By?r.constructor:By,s=o.extend(e);return p8(s,t,o),u8()&&c8(s,t),s}var m8={prototype:!0,arguments:!0,callee:!0,caller:!0};function p8(t,e,n){Object.getOwnPropertyNames(e).forEach(function(i){if(!m8[i]){var r=Object.getOwnPropertyDescriptor(t,i);if(!(r&&!r.configurable)){var o=Object.getOwnPropertyDescriptor(e,i);if(!d8){if(i==="cid")return;var s=Object.getOwnPropertyDescriptor(n,i);if(!f8(o.value)&&s&&s.value===o.value)return}Object.defineProperty(t,i,o)}}})}function kA(t){return typeof t=="function"?LM(t):function(e){return LM(e,t)}}kA.registerHooks=function(e){Db.push.apply(Db,o8(e))};var $M=function(t){function e(){var n;return PM(this,e),n=IM(this,e,arguments),n.name="BaseEditorComponent",n.instance=null,n.row=null,n.col=null,n.prop=null,n.TD=null,n.originalValue=null,n.cellProperties=null,n.state=null,n.hot=null,n}return xM(e,t),OM(e,[{key:"mounted",value:function(){var i=this;this.$data.hotCustomEditorClass=function(){var r=function(o){function s(a){var l;return PM(this,s),l=IM(this,s,[a]),i.$data.hotCustomEditorInstance=l,l}return xM(s,o),OM(s,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(oe.editors.BaseEditor);return Object.getOwnPropertyNames(oe.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(r.prototype[o]=function(){for(var s,a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(s=i[o]).call.apply(s,[this].concat(l))})}),r}()}},{key:"_fireCallbacks",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];(i=oe.editors.BaseEditor.prototype._fireCallbacks).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"beginEditing",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.beginEditing).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"cancelChanges",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.cancelChanges).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"checkEditorSection",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.checkEditorSection).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"close",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.close).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"discardEditor",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.discardEditor).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"enableFullEditMode",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.enableFullEditMode).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"extend",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.extend).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"finishEditing",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.finishEditing).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"focus",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.focus).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getValue",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.getValue).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"init",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.init).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isInFullEditMode",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.isInFullEditMode).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isOpened",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.isOpened).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isWaiting",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.isWaiting).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"open",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.open).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"prepare",value:function(i,r,o,s,a,l){return this.$data.hotInstance=l.instance,this.$data.row=i,this.$data.col=r,this.$data.prop=o,this.$data.TD=s,this.$data.originalValue=a,this.$data.cellProperties=l,oe.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,i,r,o,s,a,l)}},{key:"saveValue",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.saveValue).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"setValue",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.setValue).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"addHook",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.addHook).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"removeHooksByKey",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.removeHooksByKey).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"clearHooks",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.clearHooks).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCell",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.getEditedCell).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellRect",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.getEditedCellRect).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsZIndex",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsLayerClass",value:function(){for(var i,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(i=oe.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(i,[this.$data.hotCustomEditorInstance].concat(o))}}])}(By);$M=i8([kA({})],$M);function w8(t,e){return`${t}-${e}`}(()=>{if(!window.matchMedia)return{value:fu(null)};const t=fu(window.matchMedia("(prefers-color-scheme: dark)").matches);return window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>t.value=e.matches),{value:t}})();const v8={create(){return AI().defaults(()=>new Worker(new URL(""+new URL("xlsx.worker-a0c9ac4c.js",import.meta.url).href,self.location),{type:"module"}))}},C8={create(){return AI().defaults(()=>new Worker(new URL(""+new URL("sheet.worker-98cf8ecc.js",import.meta.url).href,self.location),{type:"module"}))}},kM="handsontableEditor",y8="handsontable";class i0 extends pl{static get EDITOR_TYPE(){return y8}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),md(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&tn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:kM,relativeToGroup:Zs,position:"before"},r=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Xi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),r(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return r(a,o)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(kM)}}function b8(t,e,n){S8(t,e),e.set(t,n)}function S8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Of(t,e,n){return(e=R8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R8(t){var e=E8(t,"string");return typeof e=="symbol"?e:e+""}function E8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FM(t,e){return t.get(T8(t,e))}function T8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const M8="autocomplete";var SC=new WeakMap;class r0 extends i0{constructor(){super(...arguments),Of(this,"query",null),Of(this,"strippedChoices",[]),Of(this,"rawChoices",[]),b8(this,SC,this.hot.guid.slice(0,9)),Of(this,"sortByRelevance",function(e,n,i){const r=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=db(zt(n[c])),i)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,r.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(r.sort((d,g)=>{if(g.index===-1)return-1;if(d.index===-1)return 1;if(d.index<g.index)return-1;if(g.index<d.index)return 1;if(d.index===g.index){if(d.charsLeft<g.charsLeft)return-1;if(d.charsLeft>g.charsLeft)return 1}return 0}),c=0,a=r.length;c<a;c++)o.push(r[c].baseIndex);return o})}static get EDITOR_TYPE(){return M8}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return fe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),X(this.htContainer,"autocompleteEditor"),X(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Me(this.TEXTAREA,[hY(),sY(),OO("listbox"),mY()])}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.hot.getSettings().ariaTags&&Me(this.TEXTAREA,[ji("false"),pY(`${FM(SC,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i==null?void 0:i.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=mn();a===0&&Hh()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[_t(this.TEXTAREA)-2]:void 0,width:e?_t(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,d,g,m)=>{is(l,u,c,h,d,g,m);const{filteringCaseSensitive:w,allowHtml:C,locale:S}=this.cellProperties,R=this.query;let E=zt(g),H,P;E&&!C&&(H=w===!0?E.indexOf(R):E.toLocaleLowerCase(S).indexOf(R.toLocaleLowerCase(S)),H!==-1&&(P=E.substr(H,R.length),E=E.replace(P,`<strong>${P}</strong>`))),n&&Me(u,[aY(),...i?[yY(r)]:[],...i?[bY(i.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=E},afterSelectionEnd:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Me(c,[QS()]),Me(this.TEXTAREA,...wY(c.id))}}}),n&&(Me(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...no()),Me(this.htEditor.rootElement,[PO(),vY("polite"),CY("text"),["id",`${FM(SC,this)}-listbox-${o}-${s}`]]),Me(this.TEXTAREA,...ji("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Me(this.TEXTAREA,[ji("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=iR(this.TEXTAREA),i=jO(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;r&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(r&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(th([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),md(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownIfNeeded(){const e=Ja(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(n||!n&&(i||i==="horizontal"))return!1;const r=fn(this.TEXTAREA),o=Zt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Zt(this.hot.view._wt.wtTable.THEAD),u=fn(e),c=r.top-u.top-l+a,h=e.scrollHeight-c-l-o,d=s>h&&c>h;return d?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,s),d}limitDropdownIfNeeded(e,n){if(n>e){let i=0,r=0,o=0,s=null;do o=this.htEditor.getRowHeight(r)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=o,r+=1;while(i<e);s=i-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(i-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+mn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=Ke(e,o=>zt(o));return Ke(i,o=>n?o:db(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),i={row:n?n.from.row:-1};let r=!1;return e===ve.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),e===ve.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(e){if(lx(e.keyCode)||e.keyCode===ve.BACKSPACE||e.keyCode===ve.DELETE||e.keyCode===ve.INSERT){let n=10;if(e.keyCode===ve.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const _8="checkbox";class FA extends $u{static get EDITOR_TYPE(){return _8}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');_e(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const As=()=>window,$i=()=>window.document,Lb=(t,e)=>window.setTimeout(t,e),zr=function(t,e,n,i){t.addEventListener(e,n,!!i)},Ro=function(t,e,n,i){t.removeEventListener(e,n,!!i)},I8=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},fi=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},RC=function(t,e){fi(t,e)||(t.className=t.className===""?e:t.className+" "+e)},EC=function(t,e){t.className=I8((" "+t.className+" ").replace(" "+e+" "," "))},o0=function(t){return/Array/.test(Object.prototype.toString.call(t))},wi=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},P8=function(t){let e=t.getDay();return e===0||e===6},O8=function(t){return t%4===0&&t%100!==0||t%400===0},VM=function(t,e){return[31,O8(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},xf=function(t){wi(t)&&t.setHours(0,0,0,0)},Af=function(t,e){return t.getTime()===e.getTime()},Sm=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?wi(e[i])?n&&(t[i]=new Date(e[i].getTime())):o0(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=Sm({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},WM=function(t,e,n){let i=$i().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=Sm(i,n),t.dispatchEvent(i)},BM=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Hr={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},jM=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},x8=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},A8=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,o=r-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(i));let l=new Date(t.getFullYear(),0,r),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},H8=function(t,e,n,i,r){let o=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():A8(o,r))+"</td>"},N8=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},D8=function(t){return"<tbody>"+t.join("")+"</tbody>"},L8=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+jM(t,e)+'">'+jM(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},$8=function(t,e,n,i,r,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',g,m,w=!0,C=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===r?s-e:12+s-e)+'"'+(s===i?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(g='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",o0(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+g:d+=g+m,c&&(i===0||u.minMonth>=i)&&(w=!1),h&&(i===11||u.maxMonth<=i)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},k8=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+L8(t)+D8(e)+"</table>"};function $b(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||As().event;let o=r.target||r.srcElement;if(o)if(fi(o,"is-disabled")||(fi(o,"pika-button")&&!fi(o,"is-empty")&&!fi(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&Lb(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):fi(o,"pika-prev")?e.prevMonth():fi(o,"pika-next")&&e.nextMonth()),fi(o,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||As().event;let o=r.target||r.srcElement;o&&(fi(o,"pika-select-month")?e.gotoMonth(o.value):fi(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(r){if(r=r||As().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let o;r.firedBy!==e&&(o=e._parseFieldValue(),wi(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=$i().activeElement;do if(fi(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=Lb(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||As().event;let o=r.target||r.srcElement,s=o;if(o){!hasEventListeners&&fi(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),zr(o,"change",e._onChange)));do if(fi(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=$i().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),zr(e.el,"mousedown",e._onMouseDown,!0),zr(e.el,"touchend",e._onMouseDown,!0),zr(e.el,"change",e._onChange),n.keyboardInput&&zr($i(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?$i().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),zr(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;wi(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",zr(n.trigger,"click",e._onInputClick),zr(n.trigger,"focus",e._onInputFocus),zr(n.trigger,"blur",e._onInputBlur)):this.show()}$b.prototype={config:function(t){this._o||(this._o=Sm({},Hr,!0));let e=Sm(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,wi(e.minDate)||(e.minDate=!1),wi(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),o0(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Hr.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,wi(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return wi(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",WM(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!wi(t))return;let n=this._o.minDate,i=this._o.maxDate;wi(n)&&t<n?t=n:wi(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),xf(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),WM(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(wi(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=BM(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=BM({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(xf(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Hr.minDate,this._o.minYear=Hr.minYear,this._o.minMonth=Hr.minMonth,this._o.startRange=Hr.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(xf(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Hr.maxDate,this._o.maxYear=Hr.maxYear,this._o.maxMonth=Hr.maxMonth,this._o.endRange=Hr.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+$8(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&Lb(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=As().innerWidth||$i().documentElement.clientWidth,r=As().innerHeight||$i().documentElement.clientHeight,o=$i().body.scrollTop||$i().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+As().pageXOffset,a=l.bottom+As().pageYOffset,(this._o.reposition&&s+e>i||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>r+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",RC(this.el,u?"left-aligned":"right-aligned"),RC(this.el,c?"bottom-aligned":"top-aligned"),EC(this.el,u?"right-aligned":"left-aligned"),EC(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,o=VM(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];xf(r),i.firstDay>0&&(s-=i.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,g=VM(h,u),m=o+s,w=m;for(;w>7;)w-=7;m+=7-w;let C=!1;for(let S=0,R=0;S<m;S++){let E=new Date(t,e,1+(S-s)),H=wi(this._d)?Af(E,this._d):!1,P=Af(E,r),B=i.events.indexOf(E.toDateString())!==-1,j=S<s||S>=o+s,Y=1+(S-s),G=e,z=t,J=i.startRange&&Af(i.startRange,E),Z=i.endRange&&Af(i.endRange,E),re=i.startRange&&i.endRange&&i.startRange<E&&E<i.endRange,pe=i.minDate&&E<i.minDate||i.maxDate&&E>i.maxDate||i.disableWeekends&&P8(E)||i.disableDayFn&&i.disableDayFn(E);j&&(S<s?(Y=g+Y,G=u,z=h):(Y=Y-o,G=c,z=d));let Ie={day:Y,month:G,year:z,hasEvent:B,isSelected:H,isToday:P,isDisabled:pe,isEmpty:j,isStartRange:J,isEndRange:Z,isInRange:re,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&H&&(C=!0),l.push(x8(Ie)),++R===7&&(i.showWeekNumber&&l.unshift(H8(this,S-s,e,t,i.firstWeekOfYearMinDays)),a.push(N8(l,i.isRTL,i.pickWholeWeek,C)),l=[],R=0,C=!1)}return k8(i,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),EC(this.el,"is-hidden"),this._o.bound&&(zr($i(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Ro($i(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),RC(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Ro(this.el,"mousedown",this._onMouseDown,!0),Ro(this.el,"touchend",this._onMouseDown,!0),Ro(this.el,"change",this._onChange),t.keyboardInput&&Ro($i(),"keydown",this._onKeyChange),t.field&&(Ro(t.field,"change",this._onInputChange),t.bound&&(Ro(t.trigger,"click",this._onInputClick),Ro(t.trigger,"focus",this._onInputFocus),Ro(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function TC(t,e,n){return(e=F8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F8(t){var e=V8(t,"string");return typeof e=="symbol"?e:e+""}function V8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const VA="date",UM="dateEditor";class WA extends pl{constructor(){super(...arguments),TC(this,"defaultDateFormat","DD/MM/YYYY"),TC(this,"parentDestroyed",!1),TC(this,"$datePicker",null)}static get EDITOR_TYPE(){return VA}init(){if(typeof q!="function")throw new Error("You need to include moment.js to your project.");if(typeof $b!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),X(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{_e(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:UM})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(UM),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),r=e?fR(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new $b(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(q),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,q(o,n,!0).isValid()&&this.$datePicker.setMoment(q(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,q(o,n,!0).isValid()&&this.$datePicker.setMoment(q(o,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&vd(n,this.cellProperties.datePickerConfig);const i=n.onSelect,r=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=q(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),i&&i()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),r&&r()},n}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Xt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+Zt(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-_t(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const W8="dropdown";class s0 extends r0{static get EDITOR_TYPE(){return W8}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}de.getSingleton().add("beforeValidate",function(t,e,n){const i=this.propToCol(n);if(Number.isInteger(i)){const r=this.getCellMeta(e,i);r.editor===s0&&r.strict===void 0&&(r.filter=!1,r.strict=!0)}});const B8="numeric";class BA extends pl{static get EDITOR_TYPE(){return B8}}const j8="password";class jA extends pl{static get EDITOR_TYPE(){return j8}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,yr(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const MC="ht_editor_visible",zM="selectEditor",U8="select";class UA extends $u{static get EDITOR_TYPE(){return U8}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",X(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",_e(this.select,MC)&&xe(this.select,MC),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),yr(this.select),Fe(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,gl(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Xt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),o=this.select.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",X(this.select,MC)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:zM};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(zM)}}const z8="time";class zA extends pl{static get EDITOR_TYPE(){return z8}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.TEXTAREA.dir="ltr"}}function Y8(){ri($u),ri(r0),ri(FA),ri(WA),ri(s0),ri(i0),ri(BA),ri(jA),ri(UA),ri(pl),ri(zA)}const G8="html";function a0(t,e,n,i,r,o,s){Td.apply(this,[t,e,n,i,r,o,s]),gl(e,o??"",!1)}a0.RENDERER_TYPE=G8;const K8="autocomplete";function ku(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=s.allowHtml?a0:is,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...dl()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,i,r,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),X(e,"htAutocomplete"),!t.acArrowListener){const h=new Yi(t);t.acArrowListener=function(d){_e(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}ku.RENDERER_TYPE=K8;const X8="dropdown";function l0(t,e,n,i,r,o,s){ku.apply(this,[t,e,n,i,r,o,s])}l0.RENDERER_TYPE=X8;const YM=new WeakMap,GM=new WeakMap,q8="htBadValue",Mu="data-row",_u="data-col",Z8="checkboxRenderer",YA="checkbox";de.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:o,column:s,prop:a}=e;if(r===YA){if(i){const{value:l,property:u}=i;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function u0(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Td.apply(this,[t,e,n,i,r,o,s]),Q8(t);let u=J8(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),yr(e),o===s.checkedTemplate||zt(o).toLocaleLowerCase(s.locale)===zt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||zt(o).toLocaleLowerCase(s.locale)===zt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Yt(o)?X(u,"noValue"):(u.style.display="none",X(u,q8),h=!0),Me(u,[[Mu,n],[_u,i]]),l&&Me(u,[hm(u.checked?t.getTranslatedPhrase(ZR):t.getTranslatedPhrase(QR)),HO(u.checked),lY()]),!h&&c){let w="";if(c.value)w=typeof c.value=="function"?c.value.call(this,n,i,r,o):c.value;else if(c.property){const S=t.getDataAtRowProp(n,c.property);w=S!==null?S:""}const C=e7(a,w,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(C),e.appendChild(u)):(C.appendChild(u),u=C):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(C)):(C.insertBefore(u,C.firstChild),u=C))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),YM.has(t)||(YM.set(t,!0),d());function d(){const C=t.getShortcutManager().getContext("grid"),S={group:Z8,relativeToGroup:Zs,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(g(),!m()),runOnlyIf:()=>{var R;return(R=t.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}},{keys:[["enter"]],callback:()=>(g(),!m()),runOnlyIf:()=>{const R=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(R==null?void 0:R.isSingle())&&R.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!m()),runOnlyIf:()=>{var R;return(R=t.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}}],S)}function g(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=t.getSelectedRange(),S=[],R=new Map;let E=[],H=0;if(C){for(let P=0;P<C.length;P++){const{row:B,col:j}=C[P].getTopStartCorner(),{row:Y,col:G}=C[P].getBottomEndCorner();for(let z=B;z<=Y;z+=1)for(let J=j;J<=G;J+=1){const Z=t.getCellMeta(z,J),re={checkedTemplate:Z.checkedTemplate,uncheckedTemplate:Z.uncheckedTemplate};if(Z.type!=="checkbox"){w===!0&&!Z.readOnly&&(R.has(S.length)?R.set(S.length,[...R.get(S.length),[z,J,null]]):R.set(S.length,[[z,J,null]]));continue}if(Z.readOnly===!0)continue;typeof Z.checkedTemplate>"u"&&(Z.checkedTemplate=!0),typeof Z.uncheckedTemplate>"u"&&(Z.uncheckedTemplate=!1);const pe=t.getDataAtCell(z,J);w===!1?[Z.checkedTemplate,Z.checkedTemplate.toString()].includes(pe)?E.push([z,J,Z.uncheckedTemplate,re]):[Z.uncheckedTemplate,Z.uncheckedTemplate.toString(),null,void 0].includes(pe)&&E.push([z,J,Z.checkedTemplate,re]):E.push([z,J,Z.uncheckedTemplate,re]),H+=1}S.push(H),H=0}E.every(P=>{let[,,B]=P;return B===E[0][2]})?E=E.map(P=>{let[B,j,Y]=P;return[B,j,Y]}):E=E.map(P=>{let[B,j,,Y]=P;return[B,j,Y.checkedTemplate]}),E.length>0&&S.forEach((P,B)=>{let j=E.splice(0,P);R.size&&R.has(B)&&(j=[...j,...R.get(B)]),t.setDataAtCell(j)})}}function m(){const w=t.getSelectedRange();if(w){for(let C=0;C<w.length;C++){const S=w[C].getTopStartCorner(),R=w[C].getBottomEndCorner();for(let E=S.row;E<=R.row;E++)for(let H=S.col;H<=R.col;H++){const P=t.getCellMeta(E,H),B=t.getCell(E,H);if(B==null)return!0;if(B.querySelectorAll("input[type=checkbox]").length>0&&!P.readOnly)return!0}}return!1}}}u0.RENDERER_TYPE=YA;function Q8(t){let e=GM.get(t);if(!e){const{rootElement:n}=t;e=new Yi(t),e.addEventListener(n,"click",i=>n7(i,t)),e.addEventListener(n,"mouseup",i=>t7(i,t)),e.addEventListener(n,"change",i=>i7(i,t)),GM.set(t,e)}return e}function J8(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function e7(t,e,n){const i=t.createElement("label");return i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,i.appendChild(t.createTextNode(e)),i.cloneNode(!0)}function t7(t,e){const{target:n}=t;c0(n)&&(!n.hasAttribute(Mu)||!n.hasAttribute(_u)||setTimeout(e.listen,10))}function n7(t,e){const{target:n}=t;if(!c0(n)||!n.hasAttribute(Mu)||!n.hasAttribute(_u))return;const i=parseInt(n.getAttribute(Mu),10),r=parseInt(n.getAttribute(_u),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function i7(t,e){const{target:n}=t;if(!c0(n)||!n.hasAttribute(Mu)||!n.hasAttribute(_u))return;const i=parseInt(n.getAttribute(Mu),10),r=parseInt(n.getAttribute(_u),10),o=e.getCellMeta(i,r);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(i,r,s)}}function c0(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const r7="handsontable";function h0(t,e,n,i,r,o,s){ku.apply(this,[t,e,n,i,r,o,s])}h0.RENDERER_TYPE=r7;var GA={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(i,r,o){function s(u,c){if(!r[u]){if(!i[u]){var h=typeof $d=="function"&&$d;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var g=r[u]={exports:{}};i[u][0].call(g.exports,function(m){return s(i[u][1][m]||m)},g,g.exports,n,i,r,o)}return r[u].exports}for(var a=typeof $d=="function"&&$d,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,i,r){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",d=1e14,g=14,m=9007199254740991,w=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],C=1e7,S=1e9;function R(G){var z=0|G;return 0<G||G===z?z:z-1}function E(G){for(var z,J,Z=1,re=G.length,pe=G[0]+"";Z<re;){for(z=G[Z++]+"",J=g-z.length;J--;z="0"+z);pe+=z}for(re=pe.length;pe.charCodeAt(--re)===48;);return pe.slice(0,re+1||1)}function H(G,z){var J,Z,re=G.c,pe=z.c,Ie=G.s,tt=z.s,Ne=G.e,ye=z.e;if(!Ie||!tt)return null;if(J=re&&!re[0],Z=pe&&!pe[0],J||Z)return J?Z?0:-tt:Ie;if(Ie!=tt)return Ie;if(J=Ie<0,Z=Ne==ye,!re||!pe)return Z?0:!re^J?1:-1;if(!Z)return ye<Ne^J?1:-1;for(tt=(Ne=re.length)<(ye=pe.length)?Ne:ye,Ie=0;Ie<tt;Ie++)if(re[Ie]!=pe[Ie])return re[Ie]>pe[Ie]^J?1:-1;return Ne==ye?0:ye<Ne^J?1:-1}function P(G,z,J,Z){if(G<z||J<G||G!==(G<0?l(G):u(G)))throw Error(c+(Z||"Argument")+(typeof G=="number"?G<z||J<G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(G))}function B(G){var z=G.c.length-1;return R(G.e/g)==z&&G.c[z]%2!=0}function j(G,z){return(1<G.length?G.charAt(0)+"."+G.slice(1):G)+(z<0?"e":"e+")+z}function Y(G,z,J){var Z,re;if(z<0){for(re=J+".";++z;re+=J);G=re+G}else if(++z>(Z=G.length)){for(re=J,z-=Z;--z;re+=J);G+=re}else z<Z&&(G=G.slice(0,z)+"."+G.slice(z));return G}(s=function G(z){var J,Z,re,pe,Ie,tt,Ne,ye,we,pt,f=W.prototype={constructor:W,toString:null,valueOf:null},p=new W(1),v=20,_=4,O=-7,F=21,U=-1e7,K=1e7,ue=!1,he=1,Q=0,Ae={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Oe="0123456789abcdefghijklmnopqrstuvwxyz";function W(y,b){var T,$,I,k,N,x,L,D,V=this;if(!(V instanceof W))return new W(y,b);if(b==null){if(y instanceof W)return V.s=y.s,V.e=y.e,void(V.c=(y=y.c)?y.slice():y);if((x=typeof y=="number")&&0*y==0){if(V.s=1/y<0?(y=-y,-1):1,y===~~y){for(k=0,N=y;10<=N;N/=10,k++);return V.e=k,void(V.c=[y])}D=String(y)}else{if(D=String(y),!a.test(D))return re(V,D,x);V.s=D.charCodeAt(0)==45?(D=D.slice(1),-1):1}-1<(k=D.indexOf("."))&&(D=D.replace(".","")),0<(N=D.search(/e/i))?(k<0&&(k=N),k+=+D.slice(N+1),D=D.substring(0,N)):k<0&&(k=D.length)}else{if(P(b,2,Oe.length,"Base"),D=String(y),b==10)return Ve(V=new W(y instanceof W?y:D),v+V.e+1,_);if(x=typeof y=="number"){if(0*y!=0)return re(V,D,x,b);if(V.s=1/y<0?(D=D.slice(1),-1):1,W.DEBUG&&15<D.replace(/^0\.0*|\./,"").length)throw Error(h+y);x=!1}else V.s=D.charCodeAt(0)===45?(D=D.slice(1),-1):1;for(T=Oe.slice(0,b),k=N=0,L=D.length;N<L;N++)if(T.indexOf($=D.charAt(N))<0){if($=="."){if(k<N){k=L;continue}}else if(!I&&(D==D.toUpperCase()&&(D=D.toLowerCase())||D==D.toLowerCase()&&(D=D.toUpperCase()))){I=!0,N=-1,k=0;continue}return re(V,String(y),x,b)}-1<(k=(D=Z(D,b,10,V.s)).indexOf("."))?D=D.replace(".",""):k=D.length}for(N=0;D.charCodeAt(N)===48;N++);for(L=D.length;D.charCodeAt(--L)===48;);if(D=D.slice(N,++L)){if(L-=N,x&&W.DEBUG&&15<L&&(m<y||y!==u(y)))throw Error(h+V.s*y);if(K<(k=k-N-1))V.c=V.e=null;else if(k<U)V.c=[V.e=0];else{if(V.e=k,V.c=[],N=(k+1)%g,k<0&&(N+=g),N<L){for(N&&V.c.push(+D.slice(0,N)),L-=g;N<L;)V.c.push(+D.slice(N,N+=g));D=D.slice(N),N=g-D.length}else N-=L;for(;N--;D+="0");V.c.push(+D)}}else V.c=[V.e=0]}function Xe(y,b,T,$){var I,k,N,x,L;if(T==null?T=_:P(T,0,8),!y.c)return y.toString();if(I=y.c[0],N=y.e,b==null)L=E(y.c),L=$==1||$==2&&(N<=O||F<=N)?j(L,N):Y(L,N,"0");else if(k=(y=Ve(new W(y),b,T)).e,x=(L=E(y.c)).length,$==1||$==2&&(b<=k||k<=O)){for(;x<b;L+="0",x++);L=j(L,k)}else if(b-=N,L=Y(L,k,"0"),x<k+1){if(0<--b)for(L+=".";b--;L+="0");}else if(0<(b+=k-x))for(k+1==x&&(L+=".");b--;L+="0");return y.s<0&&I?"-"+L:L}function Ye(y,b){for(var T,$=1,I=new W(y[0]);$<y.length;$++){if(!(T=new W(y[$])).s){I=T;break}b.call(I,T)&&(I=T)}return I}function nt(y,b,T){for(var $=1,I=b.length;!b[--I];b.pop());for(I=b[0];10<=I;I/=10,$++);return(T=$+T*g-1)>K?y.c=y.e=null:y.c=T<U?[y.e=0]:(y.e=T,b),y}function Ve(y,b,T,$){var I,k,N,x,L,D,V,ne=y.c,ce=w;if(ne){e:{for(I=1,x=ne[0];10<=x;x/=10,I++);if((k=b-I)<0)k+=g,N=b,V=(L=ne[D=0])/ce[I-N-1]%10|0;else if((D=l((k+1)/g))>=ne.length){if(!$)break e;for(;ne.length<=D;ne.push(0));L=V=0,N=(k%=g)-g+(I=1)}else{for(L=x=ne[D],I=1;10<=x;x/=10,I++);V=(N=(k%=g)-g+I)<0?0:L/ce[I-N-1]%10|0}if($=$||b<0||ne[D+1]!=null||(N<0?L:L%ce[I-N-1]),$=T<4?(V||$)&&(T==0||T==(y.s<0?3:2)):5<V||V==5&&(T==4||$||T==6&&(0<k?0<N?L/ce[I-N]:0:ne[D-1])%10&1||T==(y.s<0?8:7)),b<1||!ne[0])return ne.length=0,$?(b-=y.e+1,ne[0]=ce[(g-b%g)%g],y.e=-b||0):ne[0]=y.e=0,y;if(k==0?(ne.length=D,x=1,D--):(ne.length=D+1,x=ce[g-k],ne[D]=0<N?u(L/ce[I-N]%ce[N])*x:0),$)for(;;){if(D==0){for(k=1,N=ne[0];10<=N;N/=10,k++);for(N=ne[0]+=x,x=1;10<=N;N/=10,x++);k!=x&&(y.e++,ne[0]==d&&(ne[0]=1));break}if(ne[D]+=x,ne[D]!=d)break;ne[D--]=0,x=1}for(k=ne.length;ne[--k]===0;ne.pop());}y.e>K?y.c=y.e=null:y.e<U&&(y.c=[y.e=0])}return y}function Te(y){var b,T=y.e;return T===null?y.toString():(b=E(y.c),b=T<=O||F<=T?j(b,T):Y(b,T,"0"),y.s<0?"-"+b:b)}return W.clone=G,W.ROUND_UP=0,W.ROUND_DOWN=1,W.ROUND_CEIL=2,W.ROUND_FLOOR=3,W.ROUND_HALF_UP=4,W.ROUND_HALF_DOWN=5,W.ROUND_HALF_EVEN=6,W.ROUND_HALF_CEIL=7,W.ROUND_HALF_FLOOR=8,W.EUCLID=9,W.config=W.set=function(y){var b,T;if(y!=null){if(typeof y!="object")throw Error(c+"Object expected: "+y);if(y.hasOwnProperty(b="DECIMAL_PLACES")&&(P(T=y[b],0,S,b),v=T),y.hasOwnProperty(b="ROUNDING_MODE")&&(P(T=y[b],0,8,b),_=T),y.hasOwnProperty(b="EXPONENTIAL_AT")&&((T=y[b])&&T.pop?(P(T[0],-S,0,b),P(T[1],0,S,b),O=T[0],F=T[1]):(P(T,-S,S,b),O=-(F=T<0?-T:T))),y.hasOwnProperty(b="RANGE"))if((T=y[b])&&T.pop)P(T[0],-S,-1,b),P(T[1],1,S,b),U=T[0],K=T[1];else{if(P(T,-S,S,b),!T)throw Error(c+b+" cannot be zero: "+T);U=-(K=T<0?-T:T)}if(y.hasOwnProperty(b="CRYPTO")){if((T=y[b])!==!!T)throw Error(c+b+" not true or false: "+T);if(T){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ue=!T,Error(c+"crypto unavailable");ue=T}else ue=T}if(y.hasOwnProperty(b="MODULO_MODE")&&(P(T=y[b],0,9,b),he=T),y.hasOwnProperty(b="POW_PRECISION")&&(P(T=y[b],0,S,b),Q=T),y.hasOwnProperty(b="FORMAT")){if(typeof(T=y[b])!="object")throw Error(c+b+" not an object: "+T);Ae=T}if(y.hasOwnProperty(b="ALPHABET")){if(typeof(T=y[b])!="string"||/^.$|[+-.\s]|(.).*\1/.test(T))throw Error(c+b+" invalid: "+T);Oe=T}}return{DECIMAL_PLACES:v,ROUNDING_MODE:_,EXPONENTIAL_AT:[O,F],RANGE:[U,K],CRYPTO:ue,MODULO_MODE:he,POW_PRECISION:Q,FORMAT:Ae,ALPHABET:Oe}},W.isBigNumber=function(y){return y instanceof W||y&&y._isBigNumber===!0||!1},W.maximum=W.max=function(){return Ye(arguments,f.lt)},W.minimum=W.min=function(){return Ye(arguments,f.gt)},W.random=(pe=9007199254740992,Ie=Math.random()*pe&2097151?function(){return u(Math.random()*pe)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(y){var b,T,$,I,k,N=0,x=[],L=new W(p);if(y==null?y=v:P(y,0,S),I=l(y/g),ue)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(I*=2));N<I;)9e15<=(k=131072*b[N]+(b[N+1]>>>11))?(T=crypto.getRandomValues(new Uint32Array(2)),b[N]=T[0],b[N+1]=T[1]):(x.push(k%1e14),N+=2);N=I/2}else{if(!crypto.randomBytes)throw ue=!1,Error(c+"crypto unavailable");for(b=crypto.randomBytes(I*=7);N<I;)9e15<=(k=281474976710656*(31&b[N])+1099511627776*b[N+1]+4294967296*b[N+2]+16777216*b[N+3]+(b[N+4]<<16)+(b[N+5]<<8)+b[N+6])?crypto.randomBytes(7).copy(b,N):(x.push(k%1e14),N+=7);N=I/7}if(!ue)for(;N<I;)(k=Ie())<9e15&&(x[N++]=k%1e14);for(I=x[--N],y%=g,I&&y&&(k=w[g-y],x[N]=u(I/k)*k);x[N]===0;x.pop(),N--);if(N<0)x=[$=0];else{for($=-1;x[0]===0;x.splice(0,1),$-=g);for(N=1,k=x[0];10<=k;k/=10,N++);N<g&&($-=g-N)}return L.e=$,L.c=x,L}),W.sum=function(){for(var y=1,b=arguments,T=new W(b[0]);y<b.length;)T=T.plus(b[y++]);return T},Z=function(){var y="0123456789";function b(T,$,I,k){for(var N,x,L=[0],D=0,V=T.length;D<V;){for(x=L.length;x--;L[x]*=$);for(L[0]+=k.indexOf(T.charAt(D++)),N=0;N<L.length;N++)L[N]>I-1&&(L[N+1]==null&&(L[N+1]=0),L[N+1]+=L[N]/I|0,L[N]%=I)}return L.reverse()}return function(T,$,I,k,N){var x,L,D,V,ne,ce,Se,$e,Ze=T.indexOf("."),je=v,Pe=_;for(0<=Ze&&(V=Q,Q=0,T=T.replace(".",""),ce=($e=new W($)).pow(T.length-Ze),Q=V,$e.c=b(Y(E(ce.c),ce.e,"0"),10,I,y),$e.e=$e.c.length),D=V=(Se=b(T,$,I,N?(x=Oe,y):(x=y,Oe))).length;Se[--V]==0;Se.pop());if(!Se[0])return x.charAt(0);if(Ze<0?--D:(ce.c=Se,ce.e=D,ce.s=k,Se=(ce=J(ce,$e,je,Pe,I)).c,ne=ce.r,D=ce.e),Ze=Se[L=D+je+1],V=I/2,ne=ne||L<0||Se[L+1]!=null,ne=Pe<4?(Ze!=null||ne)&&(Pe==0||Pe==(ce.s<0?3:2)):V<Ze||Ze==V&&(Pe==4||ne||Pe==6&&1&Se[L-1]||Pe==(ce.s<0?8:7)),L<1||!Se[0])T=ne?Y(x.charAt(1),-je,x.charAt(0)):x.charAt(0);else{if(Se.length=L,ne)for(--I;++Se[--L]>I;)Se[L]=0,L||(++D,Se=[1].concat(Se));for(V=Se.length;!Se[--V];);for(Ze=0,T="";Ze<=V;T+=x.charAt(Se[Ze++]));T=Y(T,D,x.charAt(0))}return T}}(),J=function(){function y($,I,k){var N,x,L,D,V=0,ne=$.length,ce=I%C,Se=I/C|0;for($=$.slice();ne--;)V=((x=ce*(L=$[ne]%C)+(N=Se*L+(D=$[ne]/C|0)*ce)%C*C+V)/k|0)+(N/C|0)+Se*D,$[ne]=x%k;return V&&($=[V].concat($)),$}function b($,I,k,N){var x,L;if(k!=N)L=N<k?1:-1;else for(x=L=0;x<k;x++)if($[x]!=I[x]){L=$[x]>I[x]?1:-1;break}return L}function T($,I,k,N){for(var x=0;k--;)$[k]-=x,x=$[k]<I[k]?1:0,$[k]=x*N+$[k]-I[k];for(;!$[0]&&1<$.length;$.splice(0,1));}return function($,I,k,N,x){var L,D,V,ne,ce,Se,$e,Ze,je,Pe,Je,kt,wl,qi,Wu,Ei,Nt,an=$.s==I.s?1:-1,bn=$.c,Pt=I.c;if(!(bn&&bn[0]&&Pt&&Pt[0]))return new W($.s&&I.s&&(bn?!Pt||bn[0]!=Pt[0]:Pt)?bn&&bn[0]==0||!Pt?0*an:an/0:NaN);for(je=(Ze=new W(an)).c=[],an=k+(D=$.e-I.e)+1,x||(x=d,D=R($.e/g)-R(I.e/g),an=an/g|0),V=0;Pt[V]==(bn[V]||0);V++);if(Pt[V]>(bn[V]||0)&&D--,an<0)je.push(1),ne=!0;else{for(qi=bn.length,Ei=Pt.length,an+=2,1<(ce=u(x/(Pt[V=0]+1)))&&(Pt=y(Pt,ce,x),bn=y(bn,ce,x),Ei=Pt.length,qi=bn.length),wl=Ei,Je=(Pe=bn.slice(0,Ei)).length;Je<Ei;Pe[Je++]=0);Nt=Pt.slice(),Nt=[0].concat(Nt),Wu=Pt[0],Pt[1]>=x/2&&Wu++;do{if(ce=0,(L=b(Pt,Pe,Ei,Je))<0){if(kt=Pe[0],Ei!=Je&&(kt=kt*x+(Pe[1]||0)),1<(ce=u(kt/Wu)))for(x<=ce&&(ce=x-1),$e=(Se=y(Pt,ce,x)).length,Je=Pe.length;b(Se,Pe,$e,Je)==1;)ce--,T(Se,Ei<$e?Nt:Pt,$e,x),$e=Se.length,L=1;else ce==0&&(L=ce=1),$e=(Se=Pt.slice()).length;if($e<Je&&(Se=[0].concat(Se)),T(Pe,Se,Je,x),Je=Pe.length,L==-1)for(;b(Pt,Pe,Ei,Je)<1;)ce++,T(Pe,Ei<Je?Nt:Pt,Je,x),Je=Pe.length}else L===0&&(ce++,Pe=[0]);je[V++]=ce,Pe[0]?Pe[Je++]=bn[wl]||0:(Pe=[bn[wl]],Je=1)}while((wl++<qi||Pe[0]!=null)&&an--);ne=Pe[0]!=null,je[0]||je.splice(0,1)}if(x==d){for(V=1,an=je[0];10<=an;an/=10,V++);Ve(Ze,k+(Ze.e=V+D*g-1)+1,N,ne)}else Ze.e=D,Ze.r=+ne;return Ze}}(),tt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ne=/^([^.]+)\.$/,ye=/^\.([^.]+)$/,we=/^-?(Infinity|NaN)$/,pt=/^\s*\+(?=[\w.])|^\s+|\s+$/g,re=function(y,b,T,$){var I,k=T?b:b.replace(pt,"");if(we.test(k))y.s=isNaN(k)?null:k<0?-1:1,y.c=y.e=null;else{if(!T&&(k=k.replace(tt,function(N,x,L){return I=(L=L.toLowerCase())=="x"?16:L=="b"?2:8,$&&$!=I?N:x}),$&&(I=$,k=k.replace(Ne,"$1").replace(ye,"0.$1")),b!=k))return new W(k,I);if(W.DEBUG)throw Error(c+"Not a"+($?" base "+$:"")+" number: "+b);y.c=y.e=y.s=null}},f.absoluteValue=f.abs=function(){var y=new W(this);return y.s<0&&(y.s=1),y},f.comparedTo=function(y,b){return H(this,new W(y,b))},f.decimalPlaces=f.dp=function(y,b){var T,$,I;if(y!=null)return P(y,0,S),b==null?b=_:P(b,0,8),Ve(new W(this),y+this.e+1,b);if(!(T=this.c))return null;if($=((I=T.length-1)-R(this.e/g))*g,I=T[I])for(;I%10==0;I/=10,$--);return $<0&&($=0),$},f.dividedBy=f.div=function(y,b){return J(this,new W(y,b),v,_)},f.dividedToIntegerBy=f.idiv=function(y,b){return J(this,new W(y,b),0,1)},f.exponentiatedBy=f.pow=function(y,b){var T,$,I,k,N,x,L,D,V=this;if((y=new W(y)).c&&!y.isInteger())throw Error(c+"Exponent not an integer: "+Te(y));if(b!=null&&(b=new W(b)),N=14<y.e,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!y.c||!y.c[0])return D=new W(Math.pow(+Te(V),N?2-B(y):+Te(y))),b?D.mod(b):D;if(x=y.s<0,b){if(b.c?!b.c[0]:!b.s)return new W(NaN);($=!x&&V.isInteger()&&b.isInteger())&&(V=V.mod(b))}else{if(9<y.e&&(0<V.e||V.e<-1||(V.e==0?1<V.c[0]||N&&24e7<=V.c[1]:V.c[0]<8e13||N&&V.c[0]<=9999975e7)))return k=V.s<0&&B(y)?-0:0,-1<V.e&&(k=1/k),new W(x?1/k:k);Q&&(k=l(Q/g+2))}for(L=N?(T=new W(.5),x&&(y.s=1),B(y)):(I=Math.abs(+Te(y)))%2,D=new W(p);;){if(L){if(!(D=D.times(V)).c)break;k?D.c.length>k&&(D.c.length=k):$&&(D=D.mod(b))}if(I){if((I=u(I/2))===0)break;L=I%2}else if(Ve(y=y.times(T),y.e+1,1),14<y.e)L=B(y);else{if((I=+Te(y))==0)break;L=I%2}V=V.times(V),k?V.c&&V.c.length>k&&(V.c.length=k):$&&(V=V.mod(b))}return $?D:(x&&(D=p.div(D)),b?D.mod(b):k?Ve(D,Q,_,void 0):D)},f.integerValue=function(y){var b=new W(this);return y==null?y=_:P(y,0,8),Ve(b,b.e+1,y)},f.isEqualTo=f.eq=function(y,b){return H(this,new W(y,b))===0},f.isFinite=function(){return!!this.c},f.isGreaterThan=f.gt=function(y,b){return 0<H(this,new W(y,b))},f.isGreaterThanOrEqualTo=f.gte=function(y,b){return(b=H(this,new W(y,b)))===1||b===0},f.isInteger=function(){return!!this.c&&R(this.e/g)>this.c.length-2},f.isLessThan=f.lt=function(y,b){return H(this,new W(y,b))<0},f.isLessThanOrEqualTo=f.lte=function(y,b){return(b=H(this,new W(y,b)))===-1||b===0},f.isNaN=function(){return!this.s},f.isNegative=function(){return this.s<0},f.isPositive=function(){return 0<this.s},f.isZero=function(){return!!this.c&&this.c[0]==0},f.minus=function(y,b){var T,$,I,k,N=this,x=N.s;if(b=(y=new W(y,b)).s,!x||!b)return new W(NaN);if(x!=b)return y.s=-b,N.plus(y);var L=N.e/g,D=y.e/g,V=N.c,ne=y.c;if(!L||!D){if(!V||!ne)return V?(y.s=-b,y):new W(ne?N:NaN);if(!V[0]||!ne[0])return ne[0]?(y.s=-b,y):new W(V[0]?N:_==3?-0:0)}if(L=R(L),D=R(D),V=V.slice(),x=L-D){for((I=(k=x<0)?(x=-x,V):(D=L,ne)).reverse(),b=x;b--;I.push(0));I.reverse()}else for($=(k=(x=V.length)<(b=ne.length))?x:b,x=b=0;b<$;b++)if(V[b]!=ne[b]){k=V[b]<ne[b];break}if(k&&(I=V,V=ne,ne=I,y.s=-y.s),0<(b=($=ne.length)-(T=V.length)))for(;b--;V[T++]=0);for(b=d-1;x<$;){if(V[--$]<ne[$]){for(T=$;T&&!V[--T];V[T]=b);--V[T],V[$]+=d}V[$]-=ne[$]}for(;V[0]==0;V.splice(0,1),--D);return V[0]?nt(y,V,D):(y.s=_==3?-1:1,y.c=[y.e=0],y)},f.modulo=f.mod=function(y,b){var T,$,I=this;return y=new W(y,b),!I.c||!y.s||y.c&&!y.c[0]?new W(NaN):!y.c||I.c&&!I.c[0]?new W(I):(he==9?($=y.s,y.s=1,T=J(I,y,0,3),y.s=$,T.s*=$):T=J(I,y,0,he),(y=I.minus(T.times(y))).c[0]||he!=1||(y.s=I.s),y)},f.multipliedBy=f.times=function(y,b){var T,$,I,k,N,x,L,D,V,ne,ce,Se,$e,Ze,je,Pe=this,Je=Pe.c,kt=(y=new W(y,b)).c;if(!(Je&&kt&&Je[0]&&kt[0]))return!Pe.s||!y.s||Je&&!Je[0]&&!kt||kt&&!kt[0]&&!Je?y.c=y.e=y.s=null:(y.s*=Pe.s,Je&&kt?(y.c=[0],y.e=0):y.c=y.e=null),y;for($=R(Pe.e/g)+R(y.e/g),y.s*=Pe.s,(L=Je.length)<(ne=kt.length)&&($e=Je,Je=kt,kt=$e,I=L,L=ne,ne=I),I=L+ne,$e=[];I--;$e.push(0));for(Ze=d,je=C,I=ne;0<=--I;){for(T=0,ce=kt[I]%je,Se=kt[I]/je|0,k=I+(N=L);I<k;)T=((D=ce*(D=Je[--N]%je)+(x=Se*D+(V=Je[N]/je|0)*ce)%je*je+$e[k]+T)/Ze|0)+(x/je|0)+Se*V,$e[k--]=D%Ze;$e[k]=T}return T?++$:$e.splice(0,1),nt(y,$e,$)},f.negated=function(){var y=new W(this);return y.s=-y.s||null,y},f.plus=function(y,b){var T,$=this,I=$.s;if(b=(y=new W(y,b)).s,!I||!b)return new W(NaN);if(I!=b)return y.s=-b,$.minus(y);var k=$.e/g,N=y.e/g,x=$.c,L=y.c;if(!k||!N){if(!x||!L)return new W(I/0);if(!x[0]||!L[0])return L[0]?y:new W(x[0]?$:0*I)}if(k=R(k),N=R(N),x=x.slice(),I=k-N){for((T=0<I?(N=k,L):(I=-I,x)).reverse();I--;T.push(0));T.reverse()}for((I=x.length)-(b=L.length)<0&&(T=L,L=x,x=T,b=I),I=0;b;)I=(x[--b]=x[b]+L[b]+I)/d|0,x[b]=d===x[b]?0:x[b]%d;return I&&(x=[I].concat(x),++N),nt(y,x,N)},f.precision=f.sd=function(y,b){var T,$,I;if(y!=null&&y!==!!y)return P(y,1,S),b==null?b=_:P(b,0,8),Ve(new W(this),y,b);if(!(T=this.c))return null;if($=(I=T.length-1)*g+1,I=T[I]){for(;I%10==0;I/=10,$--);for(I=T[0];10<=I;I/=10,$++);}return y&&this.e+1>$&&($=this.e+1),$},f.shiftedBy=function(y){return P(y,-m,m),this.times("1e"+y)},f.squareRoot=f.sqrt=function(){var y,b,T,$,I,k=this,N=k.c,x=k.s,L=k.e,D=v+4,V=new W("0.5");if(x!==1||!N||!N[0])return new W(!x||x<0&&(!N||N[0])?NaN:N?k:1/0);if((T=(x=Math.sqrt(+Te(k)))==0||x==1/0?(((b=E(N)).length+L)%2==0&&(b+="0"),x=Math.sqrt(+b),L=R((L+1)/2)-(L<0||L%2),new W(b=x==1/0?"1e"+L:(b=x.toExponential()).slice(0,b.indexOf("e")+1)+L)):new W(x+"")).c[0]){for((x=(L=T.e)+D)<3&&(x=0);;)if(I=T,T=V.times(I.plus(J(k,I,D,1))),E(I.c).slice(0,x)===(b=E(T.c)).slice(0,x)){if(T.e<L&&--x,(b=b.slice(x-3,x+1))!="9999"&&($||b!="4999")){+b&&(+b.slice(1)||b.charAt(0)!="5")||(Ve(T,T.e+v+2,1),y=!T.times(T).eq(k));break}if(!$&&(Ve(I,I.e+v+2,0),I.times(I).eq(k))){T=I;break}D+=4,x+=4,$=1}}return Ve(T,T.e+v+1,_,y)},f.toExponential=function(y,b){return y!=null&&(P(y,0,S),y++),Xe(this,y,b,1)},f.toFixed=function(y,b){return y!=null&&(P(y,0,S),y=y+this.e+1),Xe(this,y,b)},f.toFormat=function(y,b,T){var $;if(T==null)y!=null&&b&&typeof b=="object"?(T=b,b=null):y&&typeof y=="object"?(T=y,y=b=null):T=Ae;else if(typeof T!="object")throw Error(c+"Argument not an object: "+T);if($=this.toFixed(y,b),this.c){var I,k=$.split("."),N=+T.groupSize,x=+T.secondaryGroupSize,L=T.groupSeparator||"",D=k[0],V=k[1],ne=this.s<0,ce=ne?D.slice(1):D,Se=ce.length;if(x&&(I=N,N=x,Se-=x=I),0<N&&0<Se){for(I=Se%N||N,D=ce.substr(0,I);I<Se;I+=N)D+=L+ce.substr(I,N);0<x&&(D+=L+ce.slice(I)),ne&&(D="-"+D)}$=V?D+(T.decimalSeparator||"")+((x=+T.fractionGroupSize)?V.replace(new RegExp("\\d{"+x+"}\\B","g"),"$&"+(T.fractionGroupSeparator||"")):V):D}return(T.prefix||"")+$+(T.suffix||"")},f.toFraction=function(y){var b,T,$,I,k,N,x,L,D,V,ne,ce,Se=this,$e=Se.c;if(y!=null&&(!(x=new W(y)).isInteger()&&(x.c||x.s!==1)||x.lt(p)))throw Error(c+"Argument "+(x.isInteger()?"out of range: ":"not an integer: ")+Te(x));if(!$e)return new W(Se);for(b=new W(p),D=T=new W(p),$=L=new W(p),ce=E($e),k=b.e=ce.length-Se.e-1,b.c[0]=w[(N=k%g)<0?g+N:N],y=!y||0<x.comparedTo(b)?0<k?b:D:x,N=K,K=1/0,x=new W(ce),L.c[0]=0;V=J(x,b,0,1),(I=T.plus(V.times($))).comparedTo(y)!=1;)T=$,$=I,D=L.plus(V.times(I=D)),L=I,b=x.minus(V.times(I=b)),x=I;return I=J(y.minus(T),$,0,1),L=L.plus(I.times(D)),T=T.plus(I.times($)),L.s=D.s=Se.s,ne=J(D,$,k*=2,_).minus(Se).abs().comparedTo(J(L,T,k,_).minus(Se).abs())<1?[D,$]:[L,T],K=N,ne},f.toNumber=function(){return+Te(this)},f.toPrecision=function(y,b){return y!=null&&P(y,1,S),Xe(this,y,b,2)},f.toString=function(y){var b,T=this,$=T.s,I=T.e;return I===null?$?(b="Infinity",$<0&&(b="-"+b)):b="NaN":(b=y==null?I<=O||F<=I?j(E(T.c),I):Y(E(T.c),I,"0"):y===10?Y(E((T=Ve(new W(T),v+I+1,_)).c),T.e,"0"):(P(y,2,Oe.length,"Base"),Z(Y(E(T.c),I,"0"),10,y,$,!0)),$<0&&T.c[0]&&(b="-"+b)),b},f.valueOf=f.toJSON=function(){return Te(this)},f._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(f[Symbol.toStringTag]="BigNumber",f[Symbol.for("nodejs.util.inspect.custom")]=f.valueOf),z!=null&&W.set(z),W}()).default=s.BigNumber=s,i!==void 0&&i.exports?i.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,i,r){i.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,i,r){function o(R,E){return function(H){if(Array.isArray(H))return H}(R)||function(H,P){var B=[],j=!0,Y=!1,G=void 0;try{for(var z,J=H[Symbol.iterator]();!(j=(z=J.next()).done)&&(B.push(z.value),!P||B.length!==P);j=!0);}catch(Z){Y=!0,G=Z}finally{try{j||J.return==null||J.return()}finally{if(Y)throw G}}return B}(R,E)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(R){var E=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},H=2<arguments.length?arguments[2]:void 0;if(typeof E=="string"&&(E=l.parseFormat(E)),!a.validateFormat(E))return"ERROR: invalid format";var P=E.prefix||"",B=E.postfix||"",j=function(Y,G,z){switch(G.output){case"currency":return G=S(G,s.currentCurrencyDefaultFormat()),function(Oe,W,Xe){var Ye=Xe.currentCurrency(),nt=Object.assign({},h,W),Ve=void 0,Te="",y=!!nt.totalLength||!!nt.forceAverage||nt.average,b=W.currencyPosition||Ye.position,T=W.currencySymbol||Ye.symbol;nt.spaceSeparated&&(Te=" "),b==="infix"&&(Ve=Te+T+Te);var $=C({instance:Oe,providedFormat:W,state:Xe,decimalSeparator:Ve});return b==="prefix"&&($=Oe._value<0&&nt.negative==="sign"?"-".concat(Te).concat(T).concat($.slice(1)):T+Te+$),b&&b!=="postfix"||($=$+(Te=y?"":Te)+T),$}(Y,G,s);case"percent":return G=S(G,s.currentPercentageDefaultFormat()),function(Oe,W,Xe,Ye){var nt=W.prefixSymbol,Ve=C({instance:Ye(100*Oe._value),providedFormat:W,state:Xe}),Te=Object.assign({},h,W);return nt?"%".concat(Te.spaceSeparated?" ":"").concat(Ve):"".concat(Ve).concat(Te.spaceSeparated?" ":"","%")}(Y,G,s,z);case"byte":return G=S(G,s.currentByteDefaultFormat()),p=Y,_=s,O=z,F=(v=G).base||"binary",U=c[F],K=g(p._value,U.suffixes,U.scale),ue=K.value,he=K.suffix,Q=C({instance:O(ue),providedFormat:v,state:_,defaults:_.currentByteDefaultFormat()}),Ae=_.currentAbbreviations(),"".concat(Q).concat(Ae.spaced?" ":"").concat(he);case"time":return G=S(G,s.currentTimeDefaultFormat()),ye=Y,we=Math.floor(ye._value/60/60),pt=Math.floor((ye._value-60*we*60)/60),f=Math.round(ye._value-60*we*60-60*pt),"".concat(we,":").concat(pt<10?"0":"").concat(pt,":").concat(f<10?"0":"").concat(f);case"ordinal":return G=S(G,s.currentOrdinalDefaultFormat()),J=Y,Z=G,pe=(re=s).currentOrdinal(),Ie=Object.assign({},h,Z),tt=C({instance:J,providedFormat:Z,state:re}),Ne=pe(J._value),"".concat(tt).concat(Ie.spaceSeparated?" ":"").concat(Ne);case"number":default:return C({instance:Y,providedFormat:G,numbro:z})}var J,Z,re,pe,Ie,tt,Ne,ye,we,pt,f,p,v,_,O,F,U,K,ue,he,Q,Ae}(R,E,H);return j=(j=P+j)+B}function g(R,E,H){var P=E[0],B=Math.abs(R);if(H<=B){for(var j=1;j<E.length;++j){var Y=Math.pow(H,j),G=Math.pow(H,j+1);if(Y<=B&&B<G){P=E[j],R/=Y;break}}P===E[0]&&(R/=Math.pow(H,E.length-1),P=E[E.length-1])}return{value:R,suffix:P}}function m(R){for(var E="",H=0;H<R;H++)E+="0";return E}function w(R,E){return R.toString().indexOf("e")!==-1?function(H,P){var B=H.toString(),j=o(B.split("e"),2),Y=j[0],G=j[1],z=o(Y.split("."),2),J=z[0],Z=z[1],re=Z===void 0?"":Z;if(0<+G)B=J+re+m(G-re.length);else{var pe=".";pe=+J<0?"-0".concat(pe):"0".concat(pe);var Ie=(m(-G-1)+Math.abs(J)+re).substr(0,P);Ie.length<P&&(Ie+=m(P-Ie.length)),B=pe+Ie}return 0<+G&&0<P&&(B+=".".concat(m(P))),B}(R,E):(Math.round(+"".concat(R,"e+").concat(E))/Math.pow(10,E)).toFixed(E)}function C(R){var E=R.instance,H=R.providedFormat,P=R.state,B=P===void 0?s:P,j=R.decimalSeparator,Y=R.defaults,G=Y===void 0?B.currentDefaults():Y,z=E._value;if(z===0&&B.hasZeroFormat())return B.getZeroFormat();if(!isFinite(z))return z.toString();var J,Z,re,pe,Ie,tt,Ne,ye,we=Object.assign({},h,G,H),pt=we.totalLength,f=pt?0:we.characteristic,p=we.optionalCharacteristic,v=we.forceAverage,_=!!pt||!!v||we.average,O=pt?-1:_&&H.mantissa===void 0?0:we.mantissa,F=!pt&&(H.optionalMantissa===void 0?O===-1:we.optionalMantissa),U=we.trimMantissa,K=we.thousandSeparated,ue=we.spaceSeparated,he=we.negative,Q=we.forceSign,Ae=we.exponential,Oe="";if(_){var W=function(y){var b=y.value,T=y.forceAverage,$=y.abbreviations,I=y.spaceSeparated,k=I!==void 0&&I,N=y.totalLength,x=N===void 0?0:N,L="",D=Math.abs(b),V=-1;if(D>=Math.pow(10,12)&&!T||T==="trillion"?(L=$.trillion,b/=Math.pow(10,12)):D<Math.pow(10,12)&&D>=Math.pow(10,9)&&!T||T==="billion"?(L=$.billion,b/=Math.pow(10,9)):D<Math.pow(10,9)&&D>=Math.pow(10,6)&&!T||T==="million"?(L=$.million,b/=Math.pow(10,6)):(D<Math.pow(10,6)&&D>=Math.pow(10,3)&&!T||T==="thousand")&&(L=$.thousand,b/=Math.pow(10,3)),L&&(L=(k?" ":"")+L),x){var ne=b.toString().split(".")[0];V=Math.max(x-ne.length,0)}return{value:b,abbreviation:L,mantissaPrecision:V}}({value:z,forceAverage:v,abbreviations:B.currentAbbreviations(),spaceSeparated:ue,totalLength:pt});z=W.value,Oe+=W.abbreviation,pt&&(O=W.mantissaPrecision)}if(Ae){var Xe=(Z=(J={value:z,characteristicPrecision:f}).value,re=J.characteristicPrecision,pe=re===void 0?0:re,Ie=o(Z.toExponential().split("e"),2),tt=Ie[0],Ne=Ie[1],ye=+tt,pe&&1<pe&&(ye*=Math.pow(10,pe-1),Ne=0<=(Ne=+Ne-(pe-1))?"+".concat(Ne):Ne),{value:ye,abbreviation:"e".concat(Ne)});z=Xe.value,Oe=Xe.abbreviation+Oe}var Ye,nt,Ve,Te=function(y,b,T,$,I){if($===-1)return y;var k=w(b,$),N=o(k.toString().split("."),2),x=N[0],L=N[1],D=L===void 0?"":L;if(D.match(/^0+$/)&&(T||I))return x;var V=D.match(/0+$/);return I&&V?"".concat(x,".").concat(D.toString().slice(0,V.index)):k.toString()}(z.toString(),z,F,O,U);return Te=function(y,b,T,$,I){var k=$.currentDelimiters(),N=k.thousands;I=I||k.decimal;var x=k.thousandsSize||3,L=y.toString(),D=L.split(".")[0],V=L.split(".")[1];return T&&(b<0&&(D=D.slice(1)),function(ne,ce){for(var Se=[],$e=0,Ze=ne;0<Ze;Ze--)$e===ce&&(Se.unshift(Ze),$e=0),$e++;return Se}(D.length,x).forEach(function(ne,ce){D=D.slice(0,ne+ce)+N+D.slice(ne+ce)}),b<0&&(D="-".concat(D))),L=V?D+I+V:D}(Te=function(y,b,T,$){var I=y,k=o(I.toString().split("."),2),N=k[0],x=k[1];if(N.match(/^-?0$/)&&T)return x?"".concat(N.replace("0",""),".").concat(x):N.replace("0","");if(N.length<$)for(var L=$-N.length,D=0;D<L;D++)I="0".concat(I);return I.toString()}(Te,0,p,f),z,K,B,j),(_||Ae)&&(Te=Te+Oe),(Q||z<0)&&(Ye=Te,Ve=he,Te=(nt=z)===0?Ye:+Ye==0?Ye.replace("-",""):0<nt?"+".concat(Ye):Ve==="sign"?Ye:"(".concat(Ye.replace("-",""),")")),Te}function S(R,E){if(!R)return E;var H=Object.keys(R);return H.length===1&&H[0]==="output"?E:R}i.exports=function(R){return{format:function(){for(var E=arguments.length,H=new Array(E),P=0;P<E;P++)H[P]=arguments[P];return d.apply(void 0,H.concat([R]))},getByteUnit:function(){for(var E=arguments.length,H=new Array(E),P=0;P<E;P++)H[P]=arguments[P];return(function(B){var j=c.general;return g(B._value,j.suffixes,j.scale).suffix}).apply(void 0,H.concat([R]))},getBinaryByteUnit:function(){for(var E=arguments.length,H=new Array(E),P=0;P<E;P++)H[P]=arguments[P];return(function(B){var j=c.binary;return g(B._value,j.suffixes,j.scale).suffix}).apply(void 0,H.concat([R]))},getDecimalByteUnit:function(){for(var E=arguments.length,H=new Array(E),P=0;P<E;P++)H[P]=arguments[P];return(function(B){var j=c.decimal;return g(B._value,j.suffixes,j.scale).suffix}).apply(void 0,H.concat([R]))},formatOrDefault:S}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,i,r){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,d={};function g(w){u=w}function m(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return m().currency},l.currentAbbreviations=function(){return m().abbreviations},l.currentDelimiters=function(){return m().delimiters},l.currentOrdinal=function(){return m().ordinal},l.currentDefaults=function(){return Object.assign({},m().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().timeFormat)},l.setDefaults=function(w){w=a.parseFormat(w),s.validateFormat(w)&&(d=w)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(w){return h=typeof w=="string"?w:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(w){if(w){if(c[w])return c[w];throw new Error('Unknown tag "'.concat(w,'"'))}return m()},l.registerLanguage=function(w){var C=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(w))throw new Error("Invalid language data");c[w.languageTag]=w,C&&g(w.languageTag)},l.setLanguage=function(w){var C=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[w]){var S=w.split("-")[0],R=Object.keys(c).find(function(E){return E.split("-")[0]===S});return c[R]?void g(R):void g(C)}g(w)},l.registerLanguage(o),u=o.languageTag,i.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,i,r){i.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,i,r){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}i.exports=function(a){return{add:function(l,u){return h=u,d=a,g=new o((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new o(m),c._value=g.plus(m).toNumber(),c;var c,h,d,g,m},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,d=a,g=new o((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new o(m),c._value=g.times(m).toNumber(),c;var c,h,d,g,m},divide:function(l,u){return h=u,d=a,g=new o((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new o(m),c._value=g.dividedBy(m).toNumber(),c;var c,h,d,g,m},set:function(l,u){return c=l,d=h=u,a.isNumbro(h)&&(d=h._value),c._value=d,c;var c,h,d},difference:function(l,u){return c=u,s(d=(h=a)(l._value),c,h),Math.abs(d._value);var c,h,d}}}},{"bignumber.js":1}],7:[function(n,i,r){function o(C,S){for(var R=0;R<S.length;R++){var E=S[R];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(C,E.key,E)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(w),u=n("./unformatting"),c=n("./formatting")(w),h=n("./manipulating")(w),d=n("./parsing"),g=function(){function C(E){(function(H,P){if(!(H instanceof P))throw new TypeError("Cannot call a class as a function")})(this,C),this._value=E}var S,R;return S=C,(R=[{key:"clone",value:function(){return w(this._value)}},{key:"format",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,E)}},{key:"formatCurrency",value:function(E){return typeof E=="string"&&(E=d.parseFormat(E)),(E=c.formatOrDefault(E,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,E)}},{key:"formatTime",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return E.output="time",c.format(this,E)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(E){return h.difference(this,E)}},{key:"add",value:function(E){return h.add(this,E)}},{key:"subtract",value:function(E){return h.subtract(this,E)}},{key:"multiply",value:function(E){return h.multiply(this,E)}},{key:"divide",value:function(E){return h.divide(this,E)}},{key:"set",value:function(E){return h.set(this,m(E))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(S.prototype,R),C}();function m(C){var S=C;return w.isNumbro(C)?S=C._value:typeof C=="string"?S=w.unformat(C):isNaN(C)&&(S=NaN),S}function w(C){return new g(m(C))}w.version="2.1.2",w.isNumbro=function(C){return C instanceof g},w.language=s.currentLanguage,w.registerLanguage=s.registerLanguage,w.setLanguage=s.setLanguage,w.languages=s.languages,w.languageData=s.languageData,w.zeroFormat=s.setZeroFormat,w.defaultFormat=s.currentDefaults,w.setDefaults=s.setDefaults,w.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,w.validate=a.validate,w.loadLanguagesInNode=l.loadLanguagesInNode,w.unformat=u.unformat,i.exports=w},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,i,r){i.exports={parseFormat:function(o){var s,a,l,u,c,h,d,g,m,w,C,S,R,E,H,P,B,j,Y,G,z=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=z,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=z,function(J,Z){if(J.indexOf("$")===-1){if(J.indexOf("%")===-1)return J.indexOf("bd")!==-1?(Z.output="byte",Z.base="general"):J.indexOf("b")!==-1?(Z.output="byte",Z.base="binary"):J.indexOf("d")!==-1?(Z.output="byte",Z.base="decimal"):J.indexOf(":")===-1?J.indexOf("o")!==-1&&(Z.output="ordinal"):Z.output="time";Z.output="percent"}else Z.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,z),d=z,(g=o.match(/[1-9]+[0-9]*/))&&(d.totalLength=+g[0]),m=z,(w=o.split(".")[0].match(/0+/))&&(m.characteristic=w[0].length),function(J,Z){if(J.indexOf(".")!==-1){var re=J.split(".")[0];Z.optionalCharacteristic=re.indexOf("0")===-1}}(o,z),C=z,o.indexOf("a")!==-1&&(C.average=!0),R=z,(S=o).indexOf("K")!==-1?R.forceAverage="thousand":S.indexOf("M")!==-1?R.forceAverage="million":S.indexOf("B")!==-1?R.forceAverage="billion":S.indexOf("T")!==-1&&(R.forceAverage="trillion"),function(J,Z){var re=J.split(".")[1];if(re){var pe=re.match(/0+/);pe&&(Z.mantissa=pe[0].length)}}(o,z),H=z,(E=o).match(/\[\.]/)?H.optionalMantissa=!0:E.match(/\./)&&(H.optionalMantissa=!1),P=z,o.indexOf(",")!==-1&&(P.thousandSeparated=!0),B=z,o.indexOf(" ")!==-1&&(B.spaceSeparated=!0),Y=z,(j=o).match(/^\+?\([^)]*\)$/)&&(Y.negative="parenthesis"),j.match(/^\+?-/)&&(Y.negative="sign"),G=z,o.match(/^\+/)&&(G.forceSign=!0),z)}}},{}],9:[function(n,i,r){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,m=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function w(C,S){var R=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",E=3<arguments.length?arguments[3]:void 0,H=4<arguments.length?arguments[4]:void 0,P=5<arguments.length?arguments[5]:void 0,B=6<arguments.length?arguments[6]:void 0;if(!isNaN(+C))return+C;var j="",Y=C.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(Y!==C)return-1*w(Y,S,R,E,H,P,B);for(var G=0;G<o.length;G++){var z=o[G];if((j=C.replace(z.key,""))!==C)return w(j,S,R,E,H,P,B)*z.factor}if((j=C.replace("%",""))!==C)return w(j,S,R,E,H,P,B)/100;var J=parseFloat(C);if(!isNaN(J)){var Z=E(J);if(Z&&Z!=="."&&(j=C.replace(new RegExp("".concat(s(Z),"$")),""))!==C)return w(j,S,R,E,H,P,B);var re={};Object.keys(P).forEach(function(pt){re[P[pt]]=pt});for(var pe=Object.keys(re).sort().reverse(),Ie=pe.length,tt=0;tt<Ie;tt++){var Ne=pe[tt],ye=re[Ne];if((j=C.replace(Ne,""))!==C){var we=void 0;switch(ye){case"thousand":we=Math.pow(10,3);break;case"million":we=Math.pow(10,6);break;case"billion":we=Math.pow(10,9);break;case"trillion":we=Math.pow(10,12)}return w(j,S,R,E,H,P,B)*we}}}}(function(w,C){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",R=w.replace(S,"");return R=(R=R.replace(new RegExp("([0-9])".concat(s(C.thousands),"([0-9])"),"g"),"$1$2")).replace(C.decimal,".")}(l,u,c),u,c,h,d,g,m)}i.exports={unformat:function(l,u){var c,h,d,g=n("./globalState"),m=g.currentDelimiters(),w=g.currentCurrency().symbol,C=g.currentOrdinal(),S=g.getZeroFormat(),R=g.currentAbbreviations(),E=void 0;if(typeof l=="string")E=function(H,P){if(!H.indexOf(":")||P.thousands===":")return!1;var B=H.split(":");if(B.length!==3)return!1;var j=+B[0],Y=+B[1],G=+B[2];return!isNaN(j)&&!isNaN(Y)&&!isNaN(G)}(l,m)?(c=l.split(":"),h=+c[0],d=+c[1],+c[2]+60*d+3600*h):a(l,m,w,C,S,R,u);else{if(typeof l!="number")return;E=l}if(E!==void 0)return E}}},{"./globalState":4}],10:[function(n,i,r){function o(m){return function(w){if(Array.isArray(w)){for(var C=0,S=new Array(w.length);C<w.length;C++)S[C]=w[C];return S}}(m)||function(w){if(Symbol.iterator in Object(w)||Object.prototype.toString.call(w)==="[object Arguments]")return Array.from(w)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(m){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(m)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(m,w){return w.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(m){return m.output==="byte"}},characteristic:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(m){return 0<=m},message:"value must be positive"},{restriction:function(m,w){return!w.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(m,w){return w.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(m){return m.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(m){return!!a.unformat(m)}function d(m,w,C){var S=3<arguments.length&&arguments[3]!==void 0&&arguments[3],R=Object.keys(m).map(function(E){if(!w[E])return console.error("".concat(C," Invalid key: ").concat(E)),!1;var H=m[E],P=w[E];if(typeof P=="string"&&(P={type:P}),P.type==="format"){if(!d(H,u,"[Validate ".concat(E,"]"),!0))return!1}else if(s(H)!==P.type)return console.error("".concat(C," ").concat(E,' type mismatched: "').concat(P.type,'" expected, "').concat(s(H),'" provided')),!1;if(P.restrictions&&P.restrictions.length)for(var B=P.restrictions.length,j=0;j<B;j++){var Y=P.restrictions[j],G=Y.restriction,z=Y.message;if(!G(H,m))return console.error("".concat(C," ").concat(E," invalid value: ").concat(z)),!1}return P.restriction&&!P.restriction(H,m)?(console.error("".concat(C," ").concat(E," invalid value: ").concat(P.message)),!1):P.validValues&&P.validValues.indexOf(H)===-1?(console.error("".concat(C," ").concat(E," invalid value: must be among ").concat(JSON.stringify(P.validValues),', "').concat(H,'" provided')),!1):!(P.children&&!d(H,P.children,"[Validate ".concat(E,"]")))});return S||R.push.apply(R,o(Object.keys(w).map(function(E){var H=w[E];if(typeof H=="string"&&(H={type:H}),H.mandatory){var P=H.mandatory;if(typeof P=="function"&&(P=P(m)),P&&m[E]===void 0)return console.error("".concat(C,' Missing mandatory key "').concat(E,'"')),!1}return!0}))),R.reduce(function(E,H){return E&&H},!0)}function g(m){return d(m,u,"[Validate format]")}i.exports={validate:function(m,w){var C=h(m),S=g(w);return C&&S},validateFormat:g,validateInput:h,validateLanguage:function(m){return d(m,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(GA);var o7=GA.exports;const da=oN(o7),s7="numeric";function KA(t,e){if(Hn(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!da.languages()[i]){const o=i.replace("-",""),s=da.allLanguages?da.allLanguages[i]:da[o];s&&da.registerLanguage(s)}da.setLanguage(i),t=da(t).format(r||"0")}return t}function d0(t,e,n,i,r,o,s){let a=o;if(Hn(a)){const l=s.className||"",u=l.length?l.split(" "):[];a=KA(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}is(t,e,n,i,r,a,s)}d0.RENDERER_TYPE=s7;const a7="password";function f0(t,e,n,i,r,o,s){is.apply(this,[t,e,n,i,r,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";Ce(a-1,()=>{u+=l}),gl(e,u)}f0.RENDERER_TYPE=a7;const l7="select";function g0(t,e,n,i,r,o,s){is.apply(this,[t,e,n,i,r,o,s])}g0.RENDERER_TYPE=l7;const u7="time";function m0(t,e,n,i,r,o,s){is.apply(this,[t,e,n,i,r,o,s]),e.dir="ltr"}m0.RENDERER_TYPE=u7;function c7(){gi(ku),gi(Td),gi(u0),gi(l0),gi(h0),gi(a0),gi(d0),gi(f0),gi(g0),gi(is),gi(m0)}const h7="autocomplete";function Yw(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,KM(n,e)):KM(n,e)(this.source):e(!0)}Yw.VALIDATOR_TYPE=h7;function KM(t,e){const n=t;return function(i){let r=!1;for(let o=0,s=i.length;o<s;o++)if(n===i[o]){r=!0;break}e(r)}}function XA(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const d7=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:XA},Symbol.toStringTag,{value:"Module"})),f7="date";function p0(t,e){const n=vx(VA,this.instance);let i=t,r=!0;i==null&&(i="");let o=q(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=q(new Date(i)).isValid()||o;if(this.allowEmpty&&i===""&&(s=!0,o=!0),s||(r=!1),!s&&o&&(r=!0),s&&!o)if(this.correctFormat===!0){const a=g7(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),r=!0}else r=!1;e(r)}p0.VALIDATOR_TYPE=f7;function g7(t,e){const n=q(XA(t)),i=q(t,e),r=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?o=n:o=i,o.format(e)}const m7="dropdown";function w0(t,e){Yw.apply(this,[t,e])}w0.VALIDATOR_TYPE=m7;const p7="numeric";function v0(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Hn(t))}v0.VALIDATOR_TYPE=p7;const w7=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],v7="time";function C0(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const o=/^\d{1,2}$/.test(r);o&&(r+=":00");const s=q(r,w7,!0).isValid()?q(r):q(r,n);let a=s.isValid(),l=q(r,n,!0).isValid()&&!o;if(this.allowEmpty&&r===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),i=!0}else i=!1;e(i)}C0.VALIDATOR_TYPE=v7;function C7(){Va(Yw),Va(w0),Va(p0),Va(v0),Va(C0)}const y7="autocomplete",b7={CELL_TYPE:y7,editor:r0,renderer:ku,validator:Yw},S7="checkbox",R7={CELL_TYPE:S7,editor:FA,renderer:u0},E7="date";function qA(t,e,n,i,r,o,s){ku.apply(this,[t,e,n,i,r,o,s])}qA.RENDERER_TYPE=E7;const T7="date",M7={CELL_TYPE:T7,editor:WA,renderer:qA,validator:p0},_7="dropdown",I7={CELL_TYPE:_7,editor:s0,renderer:l0,validator:w0},P7="handsontable",O7={CELL_TYPE:P7,editor:i0,renderer:h0},x7="numeric",A7={CELL_TYPE:x7,editor:BA,renderer:d0,validator:v0,dataType:"number"},H7="password",N7={CELL_TYPE:H7,editor:jA,renderer:f0,copyable:!1},D7="select",L7={CELL_TYPE:D7,editor:UA,renderer:g0},$7="time",k7={CELL_TYPE:$7,editor:zA,renderer:m0,validator:C0};function F7(){Ai(b7),Ai(R7),Ai(M7),Ai(I7),Ai(O7),Ai(A7),Ai(N7),Ai(L7),Ai(AA),Ai(k7)}function V7(t,e){ZA(t,e),e.add(t)}function W7(t,e,n){ZA(t,e),e.set(t,n)}function ZA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xl(t,e,n){return(e=B7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B7(t){var e=j7(t,"string");return typeof e=="symbol"?e:e+""}function j7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Al(t,e){return t.get(QA(t,e))}function QA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const XM=new Map([["plugin",W2],["cell-type",RA],["editor",wx],["renderer",Tx],["validator",Mx]]),U7="base",_C=[];let Nr=null;var fa=new WeakMap,qM=new WeakSet;class st{static get PLUGIN_KEY(){return U7}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){V7(this,qM),xl(this,"eventManager",new Yi(this)),xl(this,"pluginName",null),xl(this,"pluginsInitializedCallbacks",[]),xl(this,"isPluginsReady",!1),xl(this,"enabled",!1),xl(this,"initialized",!1),W7(this,fa,{}),go(this,"hot",e,{writable:!1}),Nr=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!XM.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);XM.get(s)(a)||r.push(` - ${a} (${s})`)}),r.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");_C.push(o)}}if(Nr||(Nr=bR()),Nr.indexOf("UndoRedo")>=0&&Nr.splice(Nr.indexOf("UndoRedo"),1),Nr.indexOf(this.pluginName)>=0&&Nr.splice(Nr.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Nr.length===0){if(_C.length>0){const r=[`${_C.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n,i){Al(fa,this)[e]=Al(fa,this)[e]||[];const r=Al(fa,this)[e];this.hot.addHook(e,n,i),r.push(n),Al(fa,this)[e]=r}removeHooks(e){M(Al(fa,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Al(fa,this);Fe(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){M(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=QA(qM,this,z7).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Fe(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function z7(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ga(t,e,n){return(e=Y7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y7(t){var e=G7(t,"string");return typeof e=="symbol"?e:e+""}function G7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let K7=class{constructor(e){ga(this,"hot",null),ga(this,"container",null),ga(this,"injected",!1),ga(this,"rows",[]),ga(this,"columns",[]),ga(this,"samples",null),ga(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),M(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i)-1)})}getWidths(e){this.injected||this.injectTable(),M(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{M(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(o=>{M(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),i.appendChild(c)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{M(r.strings,o=>{const s=o.col,a=e.createElement("th");i.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),M(i,r=>{const[o,s]=r;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{M(r.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),i.appendChild(c)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(r>1)for(let s=e+1;s<e+r;s++)o+=this.hot.getColWidth(s);return i.style.width=`${o}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&s.appendChild(l),r.appendChild(s),X(r,e),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const y0=K7;function Hf(t,e,n){return(e=X7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X7(t){var e=q7(t,"string");return typeof e=="symbol"?e:e+""}function q7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b0{static get SAMPLE_COUNT(){return 3}constructor(e){Hf(this,"samples",null),Hf(this,"dataFactory",null),Hf(this,"customSampleCount",null),Hf(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:b0.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:o,to:s}=typeof i=="number"?{from:i,to:i}:i;return Ce(o,s,a=>{const l=this.generateSample(e,n,a);r.set(a,l)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,o=e==="row"?"col":"row",s=[];return Ce(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(i,a):this.dataFactory(a,i);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:ke(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${zt(u).length}`,r.has(d)||r.set(d,{needed:this.getSampleCount(),strings:[]});const g=r.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),r}}const JA=b0;function Z7(t,e){e1(t,e),e.add(t)}function ZM(t,e,n){e1(t,e),e.set(t,n)}function e1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wc(t,e,n){return(e=Q7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q7(t){var e=J7(t,"string");return typeof e=="symbol"?e:e+""}function J7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ja(t,e){return t.get(qr(t,e))}function S0(t,e,n){return t.set(qr(t,e),n),n}function qr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("modifyAutoColumnSizeSeed");const vc="autoColumnSize",e5=10,t5="autoColumnSize";var iu=new WeakMap,Iu=new WeakMap,Po=new WeakSet;class ah extends st{static get PLUGIN_KEY(){return vc}static get PLUGIN_PRIORITY(){return e5}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Z7(this,Po),wc(this,"ghostTable",new y0(this.hot)),wc(this,"samplesGenerator",new JA((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,i);let a="";s.spanned||(a=this.hot.getDataAtCell(n,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),wc(this,"inProgress",!1),wc(this,"measuredColumns",0),wc(this,"columnWidthsMap",new qs),ZM(this,iu,[]),ZM(this,Iu,[]),this.hot.columnIndexMapper.registerMap(t5,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>qr(Po,this,QM).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[vc]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[vc];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return qr(Po,e,r5).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return qr(Po,e,o5).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return qr(Po,e,a5).call(e,...r)}),this.addHook("beforeRender",()=>qr(Po,this,i5).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>qr(Po,this,s5).call(this)),super.enablePlugin()}updatePlugin(){S0(Iu,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>qr(Po,this,QM).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;Ce(r.from,r.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(s,o).forEach((u,c)=>this.ghostTable.addColumn(c,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Ah(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+ah.CALCULATION_STEP,r)},e,n),i=i+ah.CALCULATION_STEP+1,i<r?o=Mp(s):(Ah(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),i=a+1),i<r?s():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[vc],n=e&&$t(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&$t(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[vc];let n=ah.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return ke(e)&&(n=e.syncLimit,XS(n)?n=CR(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,Pp))),r}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,o)=>{const s=ja(iu,this).length;return(s-1<o||ja(iu,this)[o]!==r)&&i.push(this.hot.toVisualColumn(o)),s-1<o?ja(iu,this).push(r):ja(iu,this)[o]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function n5(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(n,e).forEach((o,s)=>this.ghostTable.addColumn(s,o)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,i)=>{const r=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function i5(){this.calculateVisibleColumnsWidth(),this.inProgress||(qr(Po,this,n5).call(this,ja(Iu,this)),S0(Iu,this,[]))}function r5(t,e){e||this.recalculateAllColumnsWidth()}function o5(t){const e=t.reduce((n,i)=>{let[,r]=i;const o=this.hot.propToCol(r);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);ja(Iu,this).push(...e)}function QM(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function s5(){S0(iu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function a5(t){const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);ja(Iu,this).push(...e)}const Ua={horizontal:"horizontal",vertical:"vertical"};function l5(t,e,n){let i,r,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:o,startOfDragCoords:i,endOfDragCoords:r}}function u5(t){const e={};return t===!0?(e.directions=Object.keys(Ua),e.autoInsertRow=!0):ke(t)?(fe(t.autoInsertRow)?t.direction===Ua.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,fe(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ua)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function c5(t,e){h5(t,e),e.add(t)}function h5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hl(t,e,n){return(e=d5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d5(t){var e=f5(t,"string");return typeof e=="symbol"?e:e+""}function f5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("modifyAutofillRange");de.getSingleton().register("beforeAutofill");de.getSingleton().register("afterAutofill");const JM="autofill",g5=20,m5=["fillHandle"],p5="insert_row_below",w5=200;var Nl=new WeakSet;class v5 extends st{constructor(){super(...arguments),c5(this,Nl),Hl(this,"addingStarted",!1),Hl(this,"mouseDownOnCellCorner",!1),Hl(this,"mouseDragOutside",!1),Hl(this,"handleDraggedCells",0),Hl(this,"directions",[]),Hl(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return JM}static get PLUGIN_PRIORITY(){return g5}static get SETTING_KEYS(){return[JM,...m5]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Cc(Nl,this,y5).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Cc(Nl,this,C5).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Cc(Nl,this,b5).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:i,endRow:r,endCol:o}]),a=[],l=[],u=[];return M(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),M(a,c=>{const h=[];M(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,i),Math.max(a.col,r)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=l5(l,u,(g,m)=>this.hot._createCellCoords(g,m));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),m=o.clone(),w=this.hot._createCellRange(h,h,d),C=this.hot.runHooks("beforeAutofill",g,m,w,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=C;const R=C;if(["up","left"].indexOf(c)>-1&&!(R.length===1&&R[0].length===0))if(S=[],c==="up"){const E=d.row-h.row+1,H=E%R.length;for(let P=0;P<E;P++)S.push(R[(P+(R.length-H))%R.length])}else{const E=d.col-h.col+1,H=E%R[0].length;for(let P=0;P<R.length;P++){S.push([]);for(let B=0;B<E;B++)S[P].push(R[P][(B+(R[P].length-H))%R[P].length])}}this.hot.populateFromArray(h.row,h.col,S,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",S,m,w,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(Ua.vertical)&&this.directions.includes(Ua.horizontal)){const o=n.getTopStartCorner();(i.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(Ua.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(Ua.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(p5,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},w5)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let o=e[2]+1;o<i;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Yt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Yt(s)||!Yt(a))&&(r=o)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ke(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=fn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Zt(this.hot.table),r=fn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+_t(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Cc(Nl,this,S5).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Cc(Nl,this,R5).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=u5(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function C5(){this.selectAdjacent()&&this.fillIn()}function y5(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function b5(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function S5(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function R5(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function E5(t,e){t1(t,e),e.add(t)}function T5(t,e,n){t1(t,e),e.set(t,n)}function t1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dl(t,e,n){return(e=M5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M5(t){var e=_5(t,"string");return typeof e=="symbol"?e:e+""}function _5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function I5(t,e,n){return t.set(Zr(t,e),n),n}function R0(t,e){return t.get(Zr(t,e))}function Zr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Nf="autoRowSize",P5=40,O5="autoRowSize";var Yh=new WeakMap,Oo=new WeakSet;class lh extends st{static get PLUGIN_KEY(){return Nf}static get PLUGIN_PRIORITY(){return P5}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),E5(this,Oo),Dl(this,"headerHeight",null),Dl(this,"ghostTable",new y0(this.hot)),Dl(this,"samplesGenerator",new JA((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,i):n===-1&&(s=this.hot.getColHeader(i)),{value:s}})),Dl(this,"inProgress",!1),Dl(this,"measuredRows",0),Dl(this,"rowHeightsMap",new qs),T5(this,Yh,[]),this.hot.rowIndexMapper.registerMap(O5,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>Zr(Oo,this,e_).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[Nf];return e===!0||ke(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Zr(Oo,e,H5).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Zr(Oo,e,N5).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Zr(Oo,e,L5).call(e,...i)}),this.addHook("beforeRender",()=>Zr(Oo,this,A5).call(this)),this.addHook("modifyRowHeight",(n,i)=>this.getRowHeight(i,n)),this.addHook("init",()=>Zr(Oo,this,D5).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,i)=>Zr(Oo,this,e_).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}Ce(r.from,r.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Ah(o),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+lh.CALCULATION_STEP,r)},e,n),i=i+lh.CALCULATION_STEP+1,i<r?o=Mp(s):(Ah(o),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),i=a+1),i<r?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[Nf],n=e&&$t(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&$t(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Nf];let n=lh.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return ke(e)&&(n=e.syncLimit,XS(n)?n=CR(i,n):n>>=0),Math.min(n,i)}getRowHeight(e,n){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=n;return i!==null&&i>(n||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.view.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.view.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ce(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function x5(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,o)=>this.ghostTable.addRow(o,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function A5(){this.calculateVisibleRowsHeight(),this.inProgress||(Zr(Oo,this,x5).call(this,R0(Yh,this)),I5(Yh,this,[]))}function e_(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function H5(t,e){e||this.recalculateAllRowsHeight()}function N5(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);R0(Yh,this).push(...e)}function D5(){this.recalculateAllRowsHeight()}function L5(t){const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);R0(Yh,this).push(...e)}const{getListWithInsertedItems:$5,getListWithRemovedItems:k5}=oA("physicallyIndexed");class F5 extends ml{constructor(){super(e=>e)}insert(e,n){const i=GR(this.indexedValues,n);this.indexedValues=$5(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=k5(this.indexedValues,e);this.indexedValues=YR(n,e),super.remove(e)}}const V5=F5,{getListWithInsertedItems:W5,getListWithRemovedItems:B5}=oA("physicallyIndexed");class j5 extends ml{constructor(){super(e=>e)}insert(e,n){this.indexedValues=W5(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=B5(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const U5=j5;function z5(t,e){Y5(t,e),e.add(t)}function Y5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function G5(t,e,n){return(e=K5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K5(t){var e=X5(t,"string");return typeof e=="symbol"?e:e+""}function X5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IC="bindRowsWithHeaders",Z5=210,Q5="loose",J5=new Map([["loose",V5],["strict",U5]]);var t_=new WeakSet;class eZ extends st{constructor(){super(...arguments),z5(this,t_),G5(this,"headerIndexes",null)}static get PLUGIN_KEY(){return IC}static get PLUGIN_PRIORITY(){return Z5}isEnabled(){return!!this.hot.getSettings()[IC]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[IC];typeof e!="string"&&(e=Q5);const n=J5.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>q5(t_,this,tZ).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function tZ(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function nZ(t,e){n1(t,e),e.add(t)}function iZ(t,e,n){n1(t,e),e.set(t,n)}function n1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function n_(t,e,n){return(e=rZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rZ(t){var e=oZ(t,"string");return typeof e=="symbol"?e:e+""}function oZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i_(t,e){return t.get(cu(t,e))}function PC(t,e,n){return t.set(cu(t,e),n),n}function cu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bg="collapsibleColumns",sZ=290,aZ=["nestedHeaders"],Cu="collapsibleIndicator",r_=Bg,o_=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Ll=new WeakMap,yc=new WeakSet;class lZ extends st{constructor(){super(...arguments),nZ(this,yc),n_(this,"nestedHeadersPlugin",null),n_(this,"headerStateManager",null),iZ(this,Ll,null)}static get PLUGIN_KEY(){return Bg}static get PLUGIN_PRIORITY(){return sZ}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Bg,...aZ]}isEnabled(){return!!this.hot.getSettings()[Bg]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||ft("You need to configure the Nested Headers plugin in order to use collapsible headers."),PC(Ll,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>cu(yc,this,hZ).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return cu(yc,e,dZ).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return cu(yc,e,uZ).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,o)=>cu(yc,this,cZ).call(this,i,r,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),PC(Ll,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:r_,relativeToGroup:Zs,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(r_)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};Ce(0,e-1,s=>{const a=n.childNodes[s],l=i.childNodes[s],u=r?r.childNodes[s]:null;Ce(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Cu}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Cu}`),o(h)),r&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Cu}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=i;if(r===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!o_.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=Xo(e,g=>{let{row:m}=g;return m<0});let r=i.length>0;M(i,g=>{var m;let{row:w,col:C}=g;const{collapsible:S,isCollapsed:R}=(m=this.headerStateManager.getHeaderSettings(w,C))!==null&&m!==void 0?m:{};if(!S||R&&n==="collapse"||!R&&n==="expand")return r=!1,!1});const o=[],s=[];r&&M(i,g=>{let{row:m,col:w}=g;const{colspanCompensation:C,affectedColumns:S,rollbackModification:R}=this.headerStateManager.triggerNodeModification(n,m,w);C>0&&(s.push(...S),o.push(R))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=GS([...a,...s]):n==="expand"&&(l=Xo(a,g=>!s.includes(g)));const u=o_.get(n);if(this.hot.runHooks(u.beforeHook,a,l,r)===!1){M(o,g=>{g()});return}this.hot.batchExecution(()=>{M(s,g=>{i_(Ll,this).setValueAtIndex(this.hot.toPhysicalColumn(g),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:g,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(g)||this.hot.columnIndexMapper.isHidden(m))&&s.includes(m)){const C=g>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(g,1,!0):g,S=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;C!==null&&S!==null&&this.hot.selectCell(C,S)}}this.hot.runHooks(u.afterHook,a,l,r,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return i_(Ll,this).getHiddenIndexes()}destroy(){PC(Ll,this,null),super.destroy()}}function uZ(t,e,n){var i;const{collapsible:r,origColspan:o,isCollapsed:s}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},a=r&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Cu}`);if(fl(e,[ji("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),X(u,Cu),e.querySelector("div:first-child").appendChild(u)),xe(u,["collapsed","expanded"]),s?(X(u,"collapsed"),Us(u,"+"),l&&Me(e,...ji(!1))):(X(u,"expanded"),Us(u,"-"),l&&Me(e,...ji(!0))),l&&Me(u,...dl());else{var c;(c=u)===null||c===void 0||c.remove()}}function cZ(t,e){_e(t.target,Cu)&&(_e(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):_e(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Xi(t))}function hZ(){this.updatePlugin()}function dZ(t,e){e||this.updatePlugin()}function ma(t,e,n){return(e=fZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fZ(t){var e=gZ(t,"string");return typeof e=="symbol"?e:e+""}function gZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mZ=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],pZ=!1,wZ=!0,vZ=!0;class CZ{constructor(e,n){ma(this,"hot",void 0),ma(this,"sortingStates",new Ap),ma(this,"sortEmptyCells",pZ),ma(this,"indicator",wZ),ma(this,"headerAction",vZ),ma(this,"compareFunctionFactory",void 0),ma(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){ke(e)&&Fe(e,(n,i)=>{mZ.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return ke(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(fe(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function i1(t,e,n){const i=e.locale;return function(r,o){const{sortEmptyCells:s}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof o=="string"&&(o=o.toLocaleLowerCase(i)),r===o?ro:Yt(r)?Yt(o)?ro:s&&t==="asc"?jt:Ut:Yt(o)?s&&t==="asc"?Ut:jt:isNaN(r)&&!isNaN(o)?t==="asc"?Ut:jt:!isNaN(r)&&isNaN(o)||(isNaN(r)||isNaN(o)||(r=parseFloat(r),o=parseFloat(o)),r<o)?t==="asc"?jt:Ut:r>o?t==="asc"?Ut:jt:ro}}const r1="default";function yZ(t,e,n){return function(i,r){const o=parseFloat(i),s=parseFloat(r),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return ro;if(a){if(Yt(i))return t==="asc"?jt:Ut;if(Yt(r))return t==="asc"?Ut:jt}return isNaN(o)?Ut:isNaN(s)?jt:o<s?t==="asc"?jt:Ut:o>s?t==="asc"?Ut:jt:ro}}const bZ="numeric";function SZ(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Yt(s),u=Yt(a),c=l?r:s,h=u?r:a,d=c===r||c===i,g=h===r||h===i;if(o===!1){if(l&&u===!1)return Ut;if(l===!1&&u)return jt}return d===!1&&g?t==="asc"?jt:Ut:d&&g===!1?t==="asc"?Ut:jt:d===!1&&g===!1?i1(t,e,n)(s,a):c===r&&h===i?t==="asc"?jt:Ut:c===i&&h===r?t==="asc"?Ut:jt:ro}}const RZ="checkbox";function EZ(t,e,n){return c1(t,e.dateFormat,n)}const TZ="date";function MZ(t,e,n){return c1(t,e.timeFormat,n)}const _Z="time",{register:Md,getItem:s_,hasItem:IZ}=Mr("sorting.compareFunctionFactory"),{register:o1,getItem:PZ}=Mr("sorting.mainSortComparator");function s1(t){return IZ(t)?s_(t):s_(r1)}Md(RZ,SZ);Md(TZ,EZ);Md(r1,i1);Md(bZ,yZ);Md(_Z,MZ);const ro=0,jt=-1,Ut=1;function OZ(t,e){const n=PZ(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];t.sort(n(...r))}const Rm="asc",Em="desc",a1="colHeader";function xZ(t){if(ke(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Rm,Em].includes(n)}function AZ(t){if(t.some(n=>xZ(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function a_(t){if(t!==Em)return t===Rm?Em:Rm}function l1(t){return t.querySelector(`.${a1}`)}function u1(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function E0(t,e,n){return t===-1&&e>=0&&zs(n)===!1}function c1(t,e,n){return function(i,r){const{sortEmptyCells:o}=n;if(i===r)return ro;if(Yt(i))return Yt(r)?ro:o&&t==="asc"?jt:Ut;if(Yt(r))return o&&t==="asc"?Ut:jt;const s=q(i,e),a=q(r,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?jt:Ut:a.isBefore(s)?t==="asc"?Ut:jt:ro:jt:Ut}}const HZ="ascending",NZ="descending",h1="indicatorDisabled",d1="columnSorting",f1="sortAction",g1=new Map([[Rm,HZ],[Em,NZ]]);function DZ(t,e,n,i){const r=[d1];if(i&&r.push(f1),n===!1)return r.push(h1),r;const o=t.getSortOrderOfColumn(e);return fe(o)&&r.push(g1.get(o)),r}function LZ(){return Array.from(g1.values()).concat(f1,h1,d1)}function $Z(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:s1(u.type))(l,u,d)(c,h)}(0)}}function kZ(t,e){FZ(t,e),e.add(t)}function FZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Df(t,e,n){return(e=VZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VZ(t){var e=WZ(t,"string");return typeof e=="symbol"?e:e+""}function WZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ru(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Tm="columnSorting",BZ=50,Mm="append",jZ="replace",l_=Tm;o1(Tm,$Z);de.getSingleton().register("beforeColumnSort");de.getSingleton().register("afterColumnSort");var ka=new WeakSet;class m1 extends st{constructor(){super(...arguments),kZ(this,ka),Df(this,"columnStatesManager",null),Df(this,"columnMetaCache",null),Df(this,"pluginKey",Tm),Df(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Tm}static get PLUGIN_PRIORITY(){return BZ}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new CZ(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new qs(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>ru(ka,this,UZ).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ru(ka,e,YZ).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>ru(ka,this,kb).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ru(ka,e,zZ).call(e,...i)}),this.hot.view&&ru(ka,this,kb).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=l1(i);u1(n,i)===!1||r===null||this.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Zs,position:"before",group:l_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(l_)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new sA),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return fe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return AZ(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:o,...s}=r;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ke(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:o,...s}=r;return{column:this.hot.toVisualColumn(o),...s}};return fe(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ke(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(fe(n)){const r=a_(n);return fe(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:a_()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mm;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(r){if(Mt(s))return[...o.slice(0,i),...o.slice(i+1)];if(n===Mm)return[...o.slice(0,i),...o.slice(i+1),s];if(n===jZ)return[...o.slice(0,i),s,...o.slice(i+1)]}return fe(s)?o.concat(s):o}getPluginColumnConfig(e){if(ke(e)){const n=e[this.pluginKey];if(ke(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns[e])):Et(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=u=>Ke(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(i);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(r(u)));const o=Ke(n,u=>u[0]);OZ(n,this.pluginKey,Ke(e,u=>u.sortOrder),Ke(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<i;u+=1)n.push([u].concat(r(u)));const s=Ke(n,u=>u[0]),a=new Map(Ke(o,(u,c)=>[u,s[c]])),l=Ke(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(ke(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||ke(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(xe(e,LZ()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];X(e,DZ(...i))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),fe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&_e(e.target,a1)}onAfterOnCellMouseDown(e,n){if(E0(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function kb(){const t=this.getAllSavedSortSettings();if(ke(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function UZ(t,e){const n=l1(e);if(u1(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,o=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Me(e,...gY(s?`${s}ending`:"none"))}}function zZ(t){t===!0&&this.hot.view&&ru(ka,this,kb).call(this)}function YZ(t,e,n,i){E0(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function pa(t,e,n){return(e=GZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GZ(t){var e=KZ(t,"string");return typeof e=="symbol"?e:e+""}function KZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XZ{constructor(e,n){pa(this,"plugin",void 0),pa(this,"hot",void 0),pa(this,"endpoints",[]),pa(this,"settings",void 0),pa(this,"settingsType","array"),pa(this,"currentEndpoint",null),pa(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),M(i,r=>{const o={};this.assignSetting(r,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,o,"reversedRowCoords",!1),this.assignSetting(r,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"sourceColumn",r.destinationColumn),this.assignSetting(r,o,"type","sum"),this.assignSetting(r,o,"forceNumeric",!1),this.assignSetting(r,o,"suppressDataTypeErrors",!0),this.assignSetting(r,o,"customFunction",null),this.assignSetting(r,o,"readOnly",!0),this.assignSetting(r,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();M(o,s=>{r==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=i:e==="remove_row"&&(s.alterRowOffset=-1*i)),r==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=i:e==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,i,r,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;M(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(u,!c),c?M(u,d=>{this.extendEndpointRanges(d,h,r[0],r.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):M(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){M(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=r:i<o[0]&&(o[0]-=r):i>=o[0]&&i<=o[1]&&(o[1]-=r,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];M(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));r.push(s)}),M(r,o=>{let s=[];M(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),i.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),i.push(s))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,M(e.ranges,i=>{M(i,(r,o)=>{r>=n&&(i[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const o=r.alterRowOffset||0,s=r.alterColumnOffset||0;return r.destinationRow+o>=this.hot.countRows()||r.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],M(e,r=>{this.resetEndpointValue(r,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],M(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],M(e,(i,r,o)=>{`${i[2]||""}`!=`${i[3]}`&&M(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[r][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),M(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){ft("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const qZ=XZ;function OC(t){return t==null||isNaN(t)}function ZZ(t,e){QZ(t,e),e.add(t)}function QZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JZ(t,e,n){return(e=eQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eQ(t){var e=tQ(t,"string");return typeof e=="symbol"?e:e+""}function tQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xC="columnSummary",nQ=220;var bc=new WeakSet;class iQ extends st{constructor(){super(...arguments),ZZ(this,bc),JZ(this,"endpoints",null)}static get PLUGIN_KEY(){return xC}static get PLUGIN_PRIORITY(){return nQ}isEnabled(){return!!this.hot.getSettings()[xC]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[xC],this.endpoints=new qZ(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Lf(bc,e,rQ).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Lf(bc,e,sQ).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Lf(bc,e,oQ).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Lf(bc,e,aQ).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Fe(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(r,n),o=OC(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}i+=o||0,r-=1}while(r>=e[0]);return Math.round(i*10**s)/10**s}calculateMinMax(e,n){let i=null;return Fe(e.ranges,r=>{const o=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&o!==null&&(i=o),o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=OC(s)?null:s,r===null)r=s;else if(s!==null)switch(i){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}o-=1}while(o>=e[0]);return r}countEmpty(e,n){let i,r=0,o=e[1]||e[0];do i=this.getCellValue(o,n),i=OC(i)?null:i,i===null&&(r+=1),o-=1;while(o>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return Fe(i,r=>{const o=r[1]===void 0?1:r[1]-r[0]+1,s=this.countEmpty(r,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(i!==null&&r!==null&&(s=this.hot.getCellMeta(i,r).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(gt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function rQ(){this.endpoints.initEndpoints()}function oQ(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function sQ(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function aQ(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function lQ(t,e){p1(t,e),e.add(t)}function AC(t,e,n){p1(t,e),e.set(t,n)}function p1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ou(t,e){return t.get(T0(t,e))}function Fb(t,e,n){return t.set(T0(t,e),n),n}function T0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _m=new WeakMap,$f=new WeakMap,kf=new WeakMap,u_=new WeakSet;class w1{constructor(){lQ(this,u_),AC(this,_m,!0),AC(this,$f,null),AC(this,kf,new ResizeObserver(e=>T0(u_,this,uQ).call(this,e)))}setObservedElement(e){Fb($f,this,e)}unobserve(){ou(kf,this).unobserve(ou($f,this))}observe(){Fb(_m,this,!0),ou(kf,this).observe(ou($f,this))}destroy(){ou(kf,this).disconnect()}}function uQ(t){if(ou(_m,this)||!Array.isArray(t)||!t.length){Fb(_m,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}mt(w1,kn);function wa(t,e,n){cQ(t,e),e.set(t,n)}function cQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yt(t,e){return t.get(v1(t,e))}function Eo(t,e,n){return t.set(v1(t,e),n),n}function v1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var va=new WeakMap,HC=new WeakMap,To=new WeakMap,Ca=new WeakMap,ss=new WeakMap,Ff=new WeakMap,$l=new WeakMap;class za{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var i=this;wa(this,va,void 0),wa(this,HC,!1),wa(this,To,null),wa(this,Ca,void 0),wa(this,ss,void 0),wa(this,Ff,!0),wa(this,$l,new w1),Eo(va,this,e),Eo(HC,this,n),Eo(Ca,this,this.createEditor()),Eo(ss,this,yt(Ca,this).style),yt($l,this).setObservedElement(this.getInputElement()),yt($l,this).addLocalHook("resize",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){yt(ss,this).left=`${e}px`,yt(ss,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:_t(this.getInputElement()),height:Zt(this.getInputElement())}}observeSize(){yt($l,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){yt(ss,this).display="block",Eo(Ff,this,!1)}hide(){yt($l,this).unobserve(),yt(Ff,this)||(yt(ss,this).display="none"),Eo(Ff,this,!0)}isVisible(){return yt(ss,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return yt(va,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=yt(va,this).createElement("div"),n=yt(va,this).createElement("textarea");return e.style.display="none",Eo(To,this,yt(va,this).createElement("div")),yt(To,this).setAttribute("dir",yt(HC,this)?"rtl":"ltr"),X(yt(To,this),za.CLASS_EDITOR_CONTAINER),yt(va,this).body.appendChild(yt(To,this)),X(e,za.CLASS_EDITOR),X(n,za.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),yt(To,this).appendChild(e),e}getInputElement(){return yt(Ca,this).querySelector(`.${za.CLASS_INPUT}`)}destroy(){const e=yt(To,this)?yt(To,this).parentNode:null;yt(Ca,this).parentNode.removeChild(yt(Ca,this)),Eo(Ca,this,null),Eo(ss,this,null),yt($l,this).destroy(),e&&e.removeChild(yt(To,this))}}mt(za,kn);const hQ=za;function NC(t,e,n){return(e=dQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dQ(t){var e=fQ(t,"string");return typeof e=="symbol"?e:e+""}function fQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gQ=250,mQ=250;class C1{constructor(e){NC(this,"wasLastActionShow",!0),NC(this,"showDebounced",null),NC(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},mQ)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gQ;this.showDebounced=Rp(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}mt(C1,kn);const pQ=C1;function wQ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function vQ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function ya(t,e){const n={};return M(t,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&(n[r]||(n[r]=[]),n[r][o]=e(r,o))})}),n}function Cs(t,e,n,i,r){M(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&CQ(s,a,e,n,i,r)})})}function CQ(t,e,n,i,r,o){const s=r(t,e);let a=i;s.className&&(n==="vertical"?a=wQ(s.className,i):a=vQ(s.className,i)),o(t,e,"className",a)}function Ho(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function uh(t,e){let n=!1;return Array.isArray(t)&&M(t,i=>(i.forAll((r,o)=>{if(r>=0&&o>=0&&e(r,o))return n=!0,!1}),n)),n}function Gw(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:o}=i.getBoundingClientRect();n.top=r,n.left=o}return n}function yQ(t){return function(e,n){const i=this.getCellMeta(e,n).className;return i&&i.indexOf(t)!==-1}}function Qn(t,e){return uh(t.getSelectedRange(),yQ(e).bind(t))}const Be="---------";function bQ(){return{name:Be}}const Di="alignment";function SQ(){return{key:Di,name(){return this.getTranslatedPhrase(tw)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Di}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase($h)},ariaChecked(){return Qn(this,"htLeft")},name(){let t=this.getTranslatedPhrase($h);return Qn(this,"htLeft")&&(t=Ho(t)),t},callback(){const t=this.getSelectedRange(),e=ya(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),Cs(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(kh)},ariaChecked(){return Qn(this,"htCenter")},name(){let t=this.getTranslatedPhrase(kh);return Qn(this,"htCenter")&&(t=Ho(t)),t},callback(){const t=this.getSelectedRange(),e=ya(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),Cs(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Fh)},ariaChecked(){return Qn(this,"htRight")},name(){let t=this.getTranslatedPhrase(Fh);return Qn(this,"htRight")&&(t=Ho(t)),t},callback(){const t=this.getSelectedRange(),e=ya(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),Cs(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Vh)},ariaChecked(){return Qn(this,"htJustify")},name(){let t=this.getTranslatedPhrase(Vh);return Qn(this,"htJustify")&&(t=Ho(t)),t},callback(){const t=this.getSelectedRange(),e=ya(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),Cs(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{name:Be},{key:`${Di}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Wh)},ariaChecked(){return Qn(this,"htTop")},name(){let t=this.getTranslatedPhrase(Wh);return Qn(this,"htTop")&&(t=Ho(t)),t},callback(){const t=this.getSelectedRange(),e=ya(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),Cs(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Bh)},ariaChecked(){return Qn(this,"htMiddle")},name(){let t=this.getTranslatedPhrase(Bh);return Qn(this,"htMiddle")&&(t=Ho(t)),t},callback(){const t=this.getSelectedRange(),e=ya(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),Cs(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Di}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(jh)},ariaChecked(){return Qn(this,"htBottom")},name(){let t=this.getTranslatedPhrase(jh);return Qn(this,"htBottom")&&(t=Ho(t)),t},callback(){const t=this.getSelectedRange(),e=ya(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),Cs(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1}]}}}const Kw="clear_column";function RQ(){return{key:Kw,name(){return this.getTranslatedPhrase(Wp)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const _d="col_left";function EQ(){return{key:_d,name(){return this.getTranslatedPhrase(Dp)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Id="col_right";function TQ(){return{key:Id,name(){return this.getTranslatedPhrase(Lp)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Pd="make_read_only";function MQ(){return{key:Pd,checkable:!0,ariaChecked(){return uh(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Lh)},name(){let t=this.getTranslatedPhrase(Lh);return uh(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=Ho(t)),t},callback(){const t=this.getSelectedRange(),e=uh(t,(n,i)=>this.getCellMeta(n,i).readOnly);M(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Xw="redo";function _Q(){return{key:Xw,name(){return this.getTranslatedPhrase(Vp)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Od="remove_col";function IQ(){return{key:Od,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(kp,e)},callback(){this.alter("remove_col",T4(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const qw="remove_row";function PQ(){return{key:qw,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase($p,e)},callback(){this.alter("remove_row",M4(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Zw="row_above";function OQ(){return{key:Zw,name(){return this.getTranslatedPhrase(Hp)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Qw="row_below";function xQ(){return{key:Qw,name(){return this.getTranslatedPhrase(Np)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Gh="no_items";function AQ(){return{key:Gh,name(){return this.getTranslatedPhrase(XR)},disabled:!0,isCommand:!1}}const Jw="undo";function HQ(){return{key:Jw,name(){return this.getTranslatedPhrase(Fp)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const NQ=[Zw,Qw,_d,Id,Kw,qw,Od,Jw,Xw,Pd,Di,Be,Gh],DQ={[Be]:bQ,[Gh]:AQ,[Zw]:OQ,[Qw]:xQ,[_d]:EQ,[Id]:TQ,[Kw]:RQ,[qw]:PQ,[Od]:IQ,[Jw]:HQ,[Xw]:_Q,[Pd]:MQ,[Di]:SQ};function y1(){const t={};return Fe(DQ,(e,n)=>{t[n]=e()}),t}function LQ(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(Qp):this.getTranslatedPhrase(Zp)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function $Q(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Jp)},callback(){this.getSelectedRangeLast().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function kQ(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(ew);return uh(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,jg))?Ho(e):e},callback(){this.getSelectedRangeLast().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,jg);t.updateCommentMeta(n,i,{[jg]:!r})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function FQ(t,e){b1(t,e),e.add(t)}function kl(t,e,n){b1(t,e),e.set(t,n)}function b1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VQ(t,e,n){return(e=WQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WQ(t){var e=BQ(t,"string");return typeof e=="symbol"?e:e+""}function BQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hs(t,e,n){return t.set(ur(t,e),n),n}function Ge(t,e){return t.get(ur(t,e))}function ur(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ch="comments",jQ=60,No="comment",qc="value",S1="style",jg="readOnly",Vf=ch,Vb=`plugin:${ch}`;var St=new WeakMap,Gr=new WeakMap,ev=new WeakMap,Ug=new WeakMap,Wb=new WeakMap,Im=new WeakMap,Dr=new WeakSet;class UQ extends st{constructor(){super(...arguments),FQ(this,Dr),VQ(this,"range",{}),kl(this,St,null),kl(this,Gr,null),kl(this,ev,!1),kl(this,Ug,!1),kl(this,Wb,null),kl(this,Im,"")}static get PLUGIN_KEY(){return ch}static get PLUGIN_PRIORITY(){return jQ}isEnabled(){return!!this.hot.getSettings()[ch]}enablePlugin(){var e=this;this.enabled||(Ge(St,this)||(Hs(St,this,new hQ(this.hot.rootDocument,this.hot.isRtl())),Ge(St,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ur(Dr,e,ZQ).call(e,...i)})),Ge(Gr,this)||Hs(Gr,this,new pQ(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,o,s,a)=>ur(Dr,this,KQ).call(this,n,a)),this.addHook("afterScroll",()=>ur(Dr,this,JQ).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>ur(Dr,this,QQ).call(this,n)),Ge(Gr,this).addLocalHook("hide",()=>this.hide()),Ge(Gr,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ge(Gr,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(Vb);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeLast();Hs(Ug,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(Vb),this.hot._registerTimeout(()=>{Hs(Ug,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isCell())&&!Ge(St,this).isVisible()},group:Vf}),i.addShortcut({keys:[["Escape"]],callback:()=>{Ge(St,this).setValue(Ge(Im,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ge(St,this).isVisible()&&Ge(St,this).isFocused(),group:Vf}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ge(St,this).isVisible()&&Ge(St,this).isFocused(),group:Vf})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Vf)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>ur(Dr,this,YQ).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>ur(Dr,this,zQ).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>ur(Dr,this,GQ).call(this)),this.eventManager.addEventListener(n,"focus",()=>ur(Dr,this,qQ).call(this)),this.eventManager.addEventListener(n,"blur",()=>ur(Dr,this,XQ).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=js(e.target,"TD","TBODY");return!!(n&&_e(n,"htCommentCell")&&js(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Ge(St,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,{[qc]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,No),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,qc)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,qc)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:i}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ge(Gr,this).cancelHiding(),Ge(St,this).setValue((e=r[No]?r[No][qc]:null)!==null&&e!==void 0?e:""),Ge(St,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Ge(St,this).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Ge(St,this).isVisible()))return;const{rowIndexMapper:r,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=r.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;Ge(St,this).setPosition(0,0),l===null&&(l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:g,view:{_wt:m}}=this.hot,{wtTable:w}=m,C=m.getCell({row:l,col:u},!0),S=this.getCommentMeta(s,a,S1);S?Ge(St,this).setSize(S.width,S.height):Ge(St,this).resetSize();const R=d?0:w.getStretchedColumnWidth(u),E=c&&!h?Zt(C):0,{left:H,top:P,width:B,height:j}=C.getBoundingClientRect(),{width:Y,height:G}=Ge(St,this).getSize(),{innerWidth:z,innerHeight:J}=this.hot.rootWindow,Z=this.hot.rootDocument.documentElement;let re=H+g.scrollX+R,pe=P+g.scrollY+E;this.hot.isRtl()&&(re-=Y+R),this.hot.isLtr()&&H+B+Y>z?re=H+g.scrollX-Y-1:this.hot.isRtl()&&re<-(Z.scrollWidth-Z.clientWidth)&&(re=H+g.scrollX+R+1),P+G>J&&(pe-=G-j+1),Ge(St,this).setPosition(re,pe),Ge(St,this).setReadOnlyState(this.getCommentMeta(s,a,jg)),Ge(St,this).observeSize()}focusEditor(){Ge(St,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[No];let o;r?(o=$n(r),vd(o,i)):o=i,this.hot.setCellMeta(e,n,No,o)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[No])return r[No][i]}addToContextMenu(e){e.items.push({name:Be},LQ(this),$Q(this),kQ(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[ch];if(ke(e))return e.displayDelay}getEditorInputElement(){return Ge(St,this).getInputElement()}destroy(){var e,n;(e=Ge(St,this))===null||e===void 0||e.destroy(),(n=Ge(Gr,this))===null||n===void 0||n.destroy(),super.destroy()}}function zQ(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Ge(ev,this)&&!this.targetIsCommentTextArea(t)){const e=js(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function YQ(t){const{rootDocument:e}=this.hot;if(!(Ge(ev,this)||Ge(St,this).isFocused()||_e(t.target,"wtBorder")||Ge(Wb,this)===t.target||!Ge(St,this)))if(Hs(Wb,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Ge(Gr,this).show(n)}else $s(t.target,e)&&!this.targetIsCommentTextArea(t)&&Ge(Gr,this).hide()}function GQ(){Hs(ev,this,!1)}function KQ(t,e){e[No]&&e[No][qc]&&X(t,e.commentedCellClassName)}function XQ(){Hs(Im,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function qQ(){Hs(Im,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Vb)}function ZQ(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[S1]:{width:t,height:e}})}function QQ(t){Ge(St,this).isVisible()&&Xi(t)}function JQ(){Ge(Ug,this)||this.hide()}var c_=np,eJ=TypeError,tJ=function(t,e){if(!delete t[e])throw new eJ("Cannot delete property "+c_(e)+" of "+c_(t))},nJ=Mn,iJ=rd,rJ=ad,oJ=dP,sJ=tJ,aJ=fP,lJ=[].unshift(0)!==1,uJ=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},cJ=lJ||!uJ();nJ({target:"Array",proto:!0,arity:1,forced:cJ},{unshift:function(e){var n=iJ(this),i=rJ(n),r=arguments.length;if(r){aJ(i+r);for(var o=i;o--;){var s=o+r;o in n?n[s]=n[o]:sJ(n,s)}for(var a=0;a<r;a++)n[a]=arguments[a]}return oJ(n,i+r)}});function DC(t,e,n){return(e=hJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hJ(t){var e=dJ(t,"string");return typeof e=="symbol"?e:e+""}function dJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R1{constructor(e){DC(this,"hot",void 0),DC(this,"commands",{}),DC(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=fJ(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||$t(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),i.unshift(o.join(":")),M(u,c=>c.apply(this.hot,i))}}function fJ(t,e){let n;return M(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function LC(t,e,n){return(e=gJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gJ(t){var e=mJ(t,"string");return typeof e=="symbol"?e:e+""}function mJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;LC(this,"hot",void 0),LC(this,"predefinedItems",y1()),LC(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Fe(e,(i,r)=>{let o="";i.name===Be?(n[Be]=i,o=Be):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,o=i.key):(n[i.key]=i,o=i.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return pJ(e,this.defaultOrderPattern,this.predefinedItems)}}function pJ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),ke(r)?Fe(r,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),ke(o)?tn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),i.push(a)}):M(r,(o,s)=>{let a=n[o];!a&&NQ.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),ke(o)&&tn(a,o),a.key===void 0&&(a.key=s),i.push(a))}),i}function as(t,e,n){return(e=wJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wJ(t){var e=vJ(t,"string");return typeof e=="symbol"?e:e+""}function vJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CJ{constructor(e,n){as(this,"top",void 0),as(this,"topRelative",void 0),as(this,"left",void 0),as(this,"leftRelative",void 0),as(this,"scrollTop",void 0),as(this,"scrollLeft",void 0),as(this,"cellHeight",void 0),as(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=i,a+=r):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-i,l=a-r),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Sc(t,e,n){yJ(t,e),e.set(t,n)}function yJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){return t.get(T1(t,e))}function Wf(t,e,n){return t.set(T1(t,e),n),n}function T1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vn=new WeakMap,ls=new WeakMap,Jn=new WeakMap,$C=new WeakMap,Fl=new WeakMap;class bJ{constructor(e){Sc(this,Vn,void 0),Sc(this,ls,void 0),Sc(this,Jn,void 0),Sc(this,$C,!1),Sc(this,Fl,{above:0,below:0,left:0,right:0}),Wf($C,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return qe(Fl,this)[e]=n,this}setElement(e){return Wf(Vn,this,e),this}setParentElement(e){return Wf(ls,this,e),this}updatePosition(e){Wf(Jn,this,new CJ(e,qe(Vn,this).ownerDocument.defaultView)),qe($C,this)?(qe(Jn,this).fitsBelow(qe(Vn,this))?this.setPositionBelowCursor():qe(Jn,this).fitsAbove(qe(Vn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){qe(Vn,this).dir==="rtl"?qe(Jn,this).fitsOnLeft(qe(Vn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():qe(Jn,this).fitsOnRight(qe(Vn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=qe(Fl,this).above+qe(Jn,this).top-qe(Vn,this).offsetHeight;qe(ls,this)&&(e=qe(Jn,this).top+qe(Jn,this).cellHeight-qe(Vn,this).offsetHeight+3),qe(Vn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=qe(Fl,this).below+qe(Jn,this).top+1;qe(ls,this)&&(e=qe(Jn,this).top-1),qe(Vn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=qe(Jn,this).left;if(qe(ls,this)){const n=Number.parseInt(getComputedStyle(qe(ls,this).querySelector(".htCore")).borderRightWidth,10);e+=qe(Jn,this).cellWidth+n}else e+=qe(Fl,this).right;qe(Vn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=qe(Fl,this).left+qe(Jn,this).left-qe(Vn,this).offsetWidth;if(qe(ls,this)){const n=Number.parseInt(getComputedStyle(qe(ls,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}qe(Vn,this).style.left=`${e}px`}}function M1(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const o=new Set;let s=dt(e,-1,m()-1);function a(C,S){const R=m()-1;return C<0&&(C=R),C>R&&(C=0),o.has(C)?-1:(o.add(C),i(C,!1)===!1&&(C=a(S===1?++C:--C,S)),C)}function l(C){C>-1&&C<m()&&i(C,!0)!==!1&&(s=C)}function u(){return s}function c(){m()>0&&(o.clear(),s=a(0,1))}function h(){m()>0&&(o.clear(),s=a(m()-1,-1))}function d(){m()>0&&(o.clear(),s=a(++s,1))}function g(){m()>0&&(o.clear(),s=a(--s,-1))}function m(){return Math.max(n(),0)}function w(){o.clear(),s=e,r()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:g,getSize:m,clear:w}}function SJ(t){return Ke(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Bb(t){return $t(t,"submenu")}function jb(t){return new RegExp(Be,"i").test(t.name)}function zg(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function h_(t){return $t(t,"disableSelection")}function RJ(t){return _e(t,"htSeparator")}function EJ(t){return _e(t,"htSubmenu")}function TJ(t){return _e(t,"htDisabled")}function MJ(t){return _e(t,"htSelectionDisabled")}function _J(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function _1(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function IJ(t,e){let n=t.slice(0);return n.reverse(),n=_1(n,e),n.reverse(),n}function PJ(t){const e=[];return M(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function OJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Be,n=t.slice(0);return n=_1(n,e),n=IJ(n,e),n=PJ(n),n}function xJ(t){return t.checkable===!0}function AJ(t){return M1({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||RJ(i)||TJ(i)||MJ(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function HJ(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(i):o.tabMoves;r.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=n.getSelectedLast();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedLast();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const I1="menu",d_=I1;function NJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(HJ(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;r(c,h)});function i(u,c){a(c).addShortcuts(u,{group:I1})}function r(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),i(u,c)}function o(){return[...n]}function s(u){return u?`${d_}:${u}`:d_}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:r,getCustomShortcuts:o,getContext:a,listen:l}}function DJ(t){return(e,n,i,r,o,s)=>{const a=e.getSourceDataAtRow(i),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(yr(n),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!zg(a,t)&&!h_(a)&&!jb(a);Me(n,[...xJ(a)?[oY(),hm(c),HO(h)]:[rY(),hm(u)],...d?[Hu(-1)]:[],...zg(a,t)?[dY()]:[],...Bb(a)?[ji(!1)]:[]])}n.className="",n.appendChild(l),jb(a)?X(n,"htSeparator"):typeof a.renderer=="function"?(X(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,i,r,o,u))):gl(l,u),zg(a,t)?X(n,"htDisabled"):h_(a)?X(n,"htSelectionDisabled"):Bb(a)&&X(n,"htSubmenu")}}function kC(t,e,n){LJ(t,e),e.set(t,n)}function LJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lr(t,e,n){return(e=$J(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $J(t){var e=kJ(t,"string");return typeof e=="symbol"?e:e+""}function kJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FC(t,e,n){return t.set(P1(t,e),n),n}function ba(t,e){return t.get(P1(t,e))}function P1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const f_=215;var Rc=new WeakMap,Bf=new WeakMap,jf=new WeakMap;class Fu{get tableBorderWidth(){return ba(jf,this)===void 0&&this.hotMenu&&FC(jf,this,parseInt(so(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ba(jf,this)}constructor(e,n){var i=this;Lr(this,"hot",void 0),Lr(this,"options",void 0),Lr(this,"eventManager",new Yi(this)),Lr(this,"container",void 0),Lr(this,"positioner",void 0),Lr(this,"hotMenu",null),Lr(this,"hotSubMenus",{}),Lr(this,"parentMenu",void 0),Lr(this,"menuItems",null),Lr(this,"origOutsideClickDeselects",null),kC(this,Rc,void 0),kC(this,Bf,void 0),kC(this,jf,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:f_,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new bJ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Za(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ba(Rc,this)}getKeyboardShortcutsCtrl(){return ba(Bf,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Rp(a=>this.openSubMenu(a),300),n=this.options.minWidth||f_;let i=!1,r=Xo(this.menuItems,a=>(a.key===Gh&&(i=!0),_J(a,this.hot)));if(r.length<1&&!i)r.push(y1()[Gh]);else if(r.length===0)return;r=OJ(r,Be);let o=!1;const s={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return fe(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:DJ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{ba(Rc,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>r[a].name===Be?1:void 0,afterOnCellContextMenu:a=>{a.preventDefault(),mb()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!mb()||!zs(a))&&o&&this.hasSelectedItem()&&(Wo()||dR()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),FC(Rc,this,AJ(this.hotMenu)),FC(Bf,this,NJ(this)),ba(Bf,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ba(Rc,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);Me(i,[ji(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!EJ(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new Fu(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&Me(n,[ji(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Me(r,[ji(!1)])}}closeAllSubMenus(){M(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?SJ(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||jb(e)||zg(e,this.hot)||Bb(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=e.hider.style,r=e.holder.style,o=parseInt(i.width,10),s=nn(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?Zt(this.hotMenu.getCell(u,0)):0;return a+(l.name===Be?1:h)},0);r.width=`${o+3}px`,r.height=`${s+3}px`,i.height=r.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(Et(i)&&(i=i.call(this.hot),i===null||Mt(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),X(r,`htMenu ${this.options.className}`),i&&X(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Me(this.hotMenu.rootElement,[iY(),Hu(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!$s(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!$s(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&_e(e.target,"htCore")&&$s(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}mt(Fu,kn);function FJ(t,e){VJ(t,e),e.add(t)}function VJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VC(t,e,n){return(e=WJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WJ(t){var e=BJ(t,"string");return typeof e=="symbol"?e:e+""}function BJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zc="contextMenu",jJ=70,g_=Zc;de.getSingleton().register("afterContextMenuDefaultOptions");de.getSingleton().register("beforeContextMenuShow");de.getSingleton().register("afterContextMenuShow");de.getSingleton().register("afterContextMenuHide");de.getSingleton().register("afterContextMenuExecute");var Ec=new WeakSet;class tv extends st{constructor(){super(...arguments),FJ(this,Ec),VC(this,"commandExecutor",new R1(this.hot)),VC(this,"itemsFactory",null),VC(this,"menu",null)}static get PLUGIN_KEY(){return Zc}static get PLUGIN_PRIORITY(){return jJ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Zw,Qw,Be,_d,Id,Be,qw,Od,Be,Jw,Xw,Be,Pd,Be,Di]}isEnabled(){return!!this.hot.getSettings()[Zc]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Zc];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Fu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Uf(Ec,this,zJ).call(this)),this.menu.addLocalHook("afterOpen",()=>Uf(Ec,this,YJ).call(this)),this.menu.addLocalHook("afterClose",()=>Uf(Ec,this,GJ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>Uf(Ec,this,UJ).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=Gw(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:g_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(g_)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(i.below+=1,i.right+=1,i.above-=1,i.left-=1),Fe(i,(o,s)=>{this.menu.setOffset(s,o)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new E1(this.hot,tv.DEFAULT_ITEMS);const e=this.hot.getSettings()[Zc],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),M(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function UJ(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),_e(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(o)&&!(_e(o,"current")&&_e(o,"wtBorder"))))return;const s=Gw(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function zJ(){this.hot.runHooks("beforeContextMenuShow",this)}function YJ(){this.hot.runHooks("afterContextMenuShow",this)}function GJ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}tv.SEPARATOR={name:Be};function KJ(t){return{key:"copy",name(){return this.getTranslatedPhrase(Bp)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function XJ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?dt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(zp,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function qJ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?dt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Up,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ZJ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?dt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(jp,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function QJ(t){return{key:"cut",name(){return this.getTranslatedPhrase(Yp)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class JJ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class eee{constructor(){this.clipboardData=new JJ}preventDefault(){}}function tee(t,e){O1(t,e),e.add(t)}function Vl(t,e,n){O1(t,e),e.set(t,n)}function O1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jn(t,e){return t.get(hu(t,e))}function Wl(t,e,n){return t.set(hu(t,e),n),n}function hu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var us=new WeakMap,WC=new WeakMap,Tc=new WeakMap,Ub=new WeakMap,zb=new WeakMap,Mc=new WeakMap,_c=new WeakSet;class nee{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:o,countColumnHeaders:s}=e;tee(this,_c),Vl(this,us,void 0),Vl(this,WC,void 0),Vl(this,Tc,void 0),Vl(this,Ub,void 0),Vl(this,zb,void 0),Vl(this,Mc,void 0),Wl(WC,this,n),Wl(Tc,this,i),Wl(Ub,this,r),Wl(zb,this,o),Wl(Mc,this,s)}setSelectedRange(e){Wl(us,this,e)}getCellsRange(){if(jn(WC,this).call(this)===0||jn(Tc,this).call(this)===0)return null;const{row:e,col:n}=jn(us,this).getTopStartCorner(),{row:i,col:r}=jn(us,this).getBottomEndCorner(),o=hu(_c,this,iee).call(this,e,i),s=hu(_c,this,BC).call(this,n,r);return{isRangeTrimmed:i!==o||r!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(jn(Tc,this).call(this)===0||jn(Mc,this).call(this)===0)return null;const{col:e}=jn(us,this).getTopStartCorner(),{col:n}=jn(us,this).getBottomEndCorner(),i=hu(_c,this,BC).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(jn(Tc,this).call(this)===0||jn(Mc,this).call(this)===0)return null;const{col:e}=jn(us,this).getTopStartCorner(),{col:n}=jn(us,this).getBottomEndCorner(),i=hu(_c,this,BC).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-jn(Mc,this).call(this),startCol:e,endRow:-1,endCol:i}}}function BC(t,e){return Math.min(e,Math.max(t+jn(zb,this).call(this)-1,t))}function iee(t,e){return Math.min(e,Math.max(t+jn(Ub,this).call(this)-1,t))}function x1(t){const e=[],n=[];return M(t,i=>{const r=Math.min(i.startRow,i.endRow),o=Math.max(i.startRow,i.endRow);Ce(r,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);Ce(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function ree(t,e){A1(t,e),e.add(t)}function cs(t,e,n){A1(t,e),e.set(t,n)}function A1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ic(t,e,n){return(e=oee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=see(t,"string");return typeof e=="symbol"?e:e+""}function see(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function si(t,e){return t.get(ai(t,e))}function lr(t,e,n){return t.set(ai(t,e),n),n}function ai(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("afterCopyLimit");de.getSingleton().register("modifyCopyableRange");de.getSingleton().register("beforeCut");de.getSingleton().register("afterCut");de.getSingleton().register("beforePaste");de.getSingleton().register("afterPaste");de.getSingleton().register("beforeCopy");de.getSingleton().register("afterCopy");const zf="copyPaste",aee=80,lee=["fragmentSelection"],m_=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Yb=new WeakMap,Gb=new WeakMap,Kb=new WeakMap,Bl=new WeakMap,Yf=new WeakMap,Gf=new WeakMap,jl=new WeakMap,Pm=new WeakMap,pi=new WeakSet;class uee extends st{constructor(){super(...arguments),ree(this,pi),Ic(this,"columnsLimit",1/0),Ic(this,"rowsLimit",1/0),Ic(this,"pasteMode","overwrite"),Ic(this,"uiContainer",this.hot.rootDocument.body),cs(this,Yb,!1),cs(this,Gb,!1),cs(this,Kb,!1),cs(this,Bl,"cells-only"),cs(this,Yf,!1),cs(this,Gf,!1),cs(this,jl,new nee({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),cs(this,Pm,!1),Ic(this,"copyableRanges",[])}static get PLUGIN_KEY(){return zf}static get SETTING_KEYS(){return[zf,...lee]}static get PLUGIN_PRIORITY(){return aee}isEnabled(){return!!this.hot.getSettings()[zf]}enablePlugin(){var e=this;if(this.enabled)return;const{[zf]:n}=this.hot.getSettings();if(typeof n=="object"){var i,r;this.pasteMode=(i=n.pasteMode)!==null&&i!==void 0?i:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,lr(Yb,this,!!n.copyColumnHeaders),lr(Gb,this,!!n.copyColumnGroupHeaders),lr(Kb,this,!!n.copyColumnHeadersOnly),this.uiContainer=(r=n.uiContainer)!==null&&r!==void 0?r:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>ai(pi,this,dee).call(this,o)),this.addHook("afterSelection",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return ai(pi,e,fee).call(e,...s)}),this.addHook("afterSelectionEnd",()=>ai(pi,this,gee).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),cR()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return ai(pi,e,mee).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return ai(pi,e,pee).call(e,...s)}),this.addHook("afterSelection",()=>ai(pi,this,wee).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";lr(Bl,this,e),lr(Yf,this,!0),ai(pi,this,p_).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){lr(Gf,this,!0),ai(pi,this,p_).call(this,"cut")}getRangedCopyableData(e){return sh(this.getRangedData(e))}getRangedData(e){const n=[],{rows:i,columns:r}=x1(e);return M(i,o=>{const s=[];M(r,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new eee;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}si(jl,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);si(Bl,this)==="column-headers-only"?n.set("headers",si(jl,this).getMostBottomColumnHeadersRange()):(si(Bl,this)==="with-column-headers"?n.set("headers",si(jl,this).getMostBottomColumnHeadersRange()):si(Bl,this)==="with-column-group-headers"&&n.set("headers",si(jl,this).getAllColumnHeadersRange()),n.set("cells",si(jl,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=r;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:o,endRow:s,endCol:a}=i;this.hot.runHooks("afterCopyLimit",s-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,r=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,g=a;for(;o.length<i||c<=l;){const{skipRowOnPaste:m,visualRow:w}=this.hot.getCellMeta(c,a);if(c=w+1,m===!0)continue;d=w,h=a;const C=[],S=o.length%i;for(;C.length<r||h<=u;){const{skipColumnOnPaste:R,visualCol:E}=this.hot.getCellMeta(s,h);if(h=E+1,R===!0)continue;g=E;const H=C.length%r;C.push(e[S][H])}o.push(C)}return lr(Pm,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,g]}onCopy(e){var n;const i=this.hot.getFocusManager().getRefocusElement(),r=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!si(Yf,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(r&&e.target!==i||!r&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),lr(Yf,this,!1);const o=this.getRangedData(this.copyableRanges),s=ai(pi,this,cee).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=sh(o);if(e&&e.clipboardData){const u=Rb(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[m_,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}lr(Bl,this,"cells-only")}onCut(e){var n;const i=this.hot.getFocusManager().getRefocusElement(),r=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!si(Gf,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(r&&e.target!==i||!r&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),lr(Gf,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=sh(o);if(e&&e.clipboardData){const l=Rb(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[m_,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){var n;const i=this.hot.getFocusManager().getRefocusElement(),r=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(r&&e.target!==i||!r&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=wp(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=bx(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=A4(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function p_(t){if(cR()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&GO(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function cee(t){const{rows:e}=x1(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function hee(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&oR(i)}}}function H1(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&sR(i)}}}function dee(t){t.items.push({name:"---------"},KJ(this)),si(Yb,this)&&t.items.push(ZJ(this)),si(Gb,this)&&t.items.push(qJ(this)),si(Kb,this)&&t.items.push(XJ(this)),t.items.push(QJ(this))}function fee(t,e,n,i,r){si(Pm,this)&&(r.value=!0),lr(Pm,this,!1)}function gee(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function mee(){ai(pi,this,H1).call(this)}function pee(){ai(pi,this,hee).call(this)}function wee(){ai(pi,this,H1).call(this)}function N1(t,e){return`border_row${t}col${e}`}function Qc(){return{width:1,color:"#000"}}function Bo(){return{hide:!0}}function vee(){return{width:1,color:"#000",cornerVisible:!1}}function jC(t){if(fe(t.start)||fe(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(fe(t.end)||fe(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Pc(t){return fe(t.start)&&(t.left=t.start),fe(t.end)&&(t.right=t.end),t}function UC(t,e){return{id:N1(t,e),border:vee(),row:t,col:e,top:Bo(),bottom:Bo(),start:Bo(),end:Bo()}}function Cee(t,e){return $t(e,"border")&&e.border&&(t.border=e.border),$t(e,"top")&&fe(e.top)&&(e.top?(ke(e.top)||(e.top=Qc()),t.top=e.top):(e.top=Bo(),t.top=e.top)),$t(e,"bottom")&&fe(e.bottom)&&(e.bottom?(ke(e.bottom)||(e.bottom=Qc()),t.bottom=e.bottom):(e.bottom=Bo(),t.bottom=e.bottom)),$t(e,"start")&&fe(e.start)&&(e.start?(ke(e.start)||(e.start=Qc()),t.start=e.start):(e.start=Bo(),t.start=e.start)),$t(e,"end")&&fe(e.end)&&(e.end?(ke(e.end)||(e.end=Qc()),t.end=e.end):(e.end=Bo(),t.end=e.end)),t}function qo(t,e){let n=!1;return M(t.getSelectedRange(),i=>{i.forAll((r,o)=>{if(r<0||o<0)return;const s=t.getCellMeta(r,o).borders;if(s)if(e){if(!$t(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function nv(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function yee(t){return t.some(e=>fe(e.left)||fe(e.right))}function bee(t){return t.some(e=>fe(e.start)||fe(e.end))}const See=new Map([["left","start"],["right","end"]]);function Ree(t){var e;return(e=See.get(t))!==null&&e!==void 0?e:t}function Eee(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(ow);return qo(this,"bottom")&&(e=nv(e)),e},callback(e,n){const i=qo(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function Tee(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(sw);return qo(this,e)&&(n=nv(n)),n},callback(n,i){const r=qo(this,e);t.prepareBorder(i,e,r)}}}function Mee(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(aw)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!qo(this)}}}function _ee(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(rw);return qo(this,e)&&(n=nv(n)),n},callback(n,i){const r=qo(this,e);t.prepareBorder(i,e,r)}}}function Iee(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(iw);return qo(this,"top")&&(e=nv(e)),e},callback(e,n){const i=qo(this,"top");t.prepareBorder(n,"top",i)}}}function Pee(t,e){Oee(t,e),e.add(t)}function Oee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xee(t,e,n){return(e=Aee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aee(t){var e=Hee(t,"string");return typeof e=="symbol"?e:e+""}function Hee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function w_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yg="customBorders",Nee=90;var zC=new WeakSet;class Dee extends st{constructor(){super(...arguments),Pee(this,zC),xee(this,"savedBorders",[])}static get PLUGIN_KEY(){return Yg}static get PLUGIN_PRIORITY(){return Nee}isEnabled(){return!!this.hot.getSettings()[Yg]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>w_(zC,this,Lee).call(this,e)),this.addHook("init",()=>w_(zC,this,$ee).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=jC(n));const o=Tu(e),s=zh(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});M(e,a=>{s(a).forAll((l,u)=>{M(i,c=>{this.prepareBorderFromCustomAdded(l,u,r,Ree(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Tu(e),i=zh(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return M(e,o=>{i(o).forAll((s,a)=>{M(this.savedBorders,l=>{l.row===s&&l.col===a&&r.push(Pc(l))})})}),r}clearBorders(e){e?this.setBorders(e):(M(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=UC(e,n);i&&(a=Cee(a,i),M(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Pc(a)),this.insertBorderIntoSettings(a,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);Ce(e.from.row,i,o=>{Ce(e.from.col,r,s=>{const a=UC(o,s);let l=0;o===e.from.row&&$t(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&$t(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&$t(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&$t(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Pc(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const i=N1(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=UC(e,n):o=jC(o),r?(o[i]=Bo(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Pc(o)))):(o[i]=Qc(),this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Pc(o)))}prepareBorder(e,n,i){M(e,r=>{let{start:o,end:s}=r;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,i);else switch(n){case"noBorders":Ce(o.col,s.col,a=>{Ce(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Ce(o.col,s.col,a=>{this.setBorder(o.row,a,n,i)});break;case"bottom":Ce(o.col,s.col,a=>{this.setBorder(s.row,a,n,i)});break;case"start":Ce(o.row,s.row,a=>{this.setBorder(a,o.col,n,i)});break;case"end":Ce(o.row,s.row,a=>{this.setBorder(a,s.col,n,i)});break}})}createCustomBorders(e){M(e,n=>{const i=jC(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:o}=e;return nn([n,i,r,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ke(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){M(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){M(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ke(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):M(this.savedBorders,(r,o)=>{if(e.id===r.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return M(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return M(s,a=>{a.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let o=!1;return r===4?(this.removeAllBorders(e.row,e.col),o=!0):M(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);M(a,l=>{l.changeBorderStyle(i,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Yg];if(Array.isArray(e)){const n=$n(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=yee(e),i=bee(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Lee(t){this.hot.getSettings()[Yg]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(nw)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Iee(this),_ee(this),Eee(this),Tee(this),Mee(this)]}})}function $ee(){this.changeBorderSettings()}function kee(t,e){Fee(t,e),e.add(t)}function Fee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YC(t,e,n){return(e=Vee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vee(t){var e=Wee(t,"string");return typeof e=="symbol"?e:e+""}function Wee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const C_="dragToScroll",Bee=100;var GC=new WeakSet;class jee extends st{constructor(){super(...arguments),kee(this,GC),YC(this,"boundaries",null),YC(this,"callback",null),YC(this,"listening",!1)}static get PLUGIN_KEY(){return C_}static get PLUGIN_PRIORITY(){return Bee}isEnabled(){return!!this.hot.getSettings()[C_]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>v_(GC,this,y_).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>v_(GC,this,y_).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=Za(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function y_(t){if(zs(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,o;const s=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(i)*20)}),this.listen()}function Uee(t,e){D1(t,e),e.add(t)}function zee(t,e,n){D1(t,e),e.set(t,n)}function D1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KC(t,e,n){return(e=Yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:e+""}function Gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kee(t,e){return t.get(Li(t,e))}function L1(t,e,n){return t.set(Li(t,e),n),n}function Li(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("afterDropdownMenuDefaultOptions");de.getSingleton().register("beforeDropdownMenuShow");de.getSingleton().register("afterDropdownMenuShow");de.getSingleton().register("afterDropdownMenuHide");de.getSingleton().register("afterDropdownMenuExecute");const Gg="dropdownMenu",Xee=230,Kh="changeType",XC=Gg;var iv=new WeakMap,cr=new WeakSet;class rv extends st{static get PLUGIN_KEY(){return Gg}static get PLUGIN_PRIORITY(){return Xee}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[_d,Id,Be,Od,Be,Kw,Be,Pd,Be,Di]}constructor(e){super(e),Uee(this,cr),KC(this,"commandExecutor",new R1(this.hot)),KC(this,"itemsFactory",null),KC(this,"menu",null),zee(this,iv,!1),this.hot.addHook("afterGetColHeader",(n,i)=>Li(cr,this,Zee).call(this,n,i))}isEnabled(){return this.hot.getSettings()[Gg]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new E1(this.hot,rv.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Li(cr,e,ite).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Li(cr,e,nte).call(e,...o)});const n=this.hot.getSettings()[Gg],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Fu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>Li(cr,this,Qee).call(this)),this.menu.addLocalHook("afterOpen",()=>Li(cr,this,Jee).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Li(cr,this,ete).call(this,o)),this.menu.addLocalHook("afterClose",()=>Li(cr,this,tte).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),M(r,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeLast(),o=Gw(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,r.col,!0).querySelector(`.${Kh}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:XC},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:XC}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(XC)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Li(cr,this,qee).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Fe(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function $1(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function qee(t){if(_e(t.target,Kh)){const e=Gw(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),L1(iv,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Zee(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const o=e.querySelector(`.${Kh}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Kh,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Me(s,[dl(),hm(" ")]),Me(e,[OO("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Qee(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Jee(){this.hot.runHooks("afterDropdownMenuShow",this),Li(cr,this,$1).call(this,this.menu)}function ete(t){Li(cr,this,$1).call(this,t)}function tte(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function nte(t){return Kee(iv,this)?null:t}function ite(t){_e(t.target,Kh)&&L1(iv,this,!0)}rv.SEPARATOR={name:Be};function b_(t,e,n){return(e=rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rte(t){var e=ote(t,"string");return typeof e=="symbol"?e:e+""}function ote(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ste{constructor(e){b_(this,"hot",void 0),b_(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),o=this.options,s=[];return Ce(e,i,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(Ce(n,r,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();Ce(n,i,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(r[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();Ce(n,i,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(r[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,o=n,s=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:i,startCol:r,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const ate=ste;function S_(t,e,n){return(e=lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lte(t){var e=ute(t,"string");return typeof e=="symbol"?e:e+""}function ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M0{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){S_(this,"dataProvider",void 0),S_(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=br(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=tn(br(M0.DEFAULT_OPTIONS),n),n=tn(n,e),n.filename=qS(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}const cte=M0,hte=String.fromCharCode(13),dte=String.fromCharCode(34),fte=String.fromCharCode(10);class gte extends cte{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return r&&(i=Ke(i,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),M(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=zt(e);return i!==""&&(n||i.indexOf(hte)>=0||i.indexOf(dte)>=0||i.indexOf(fte)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}}const mte=gte,pte="csv",Xb={[pte]:mte};function wte(t,e,n){return typeof Xb[t]=="function"?new Xb[t](e,n):null}const vte="exportFile",Cte=240;class yte extends st{static get PLUGIN_KEY(){return vte}static get PLUGIN_PRIORITY(){return Cte}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=r.URL||r.webkitURL,l=i.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Xb[e])throw new Error(`Export format type "${e}" is not supported.`);return wte(e,new ate(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ul(t,e,n){return(e=bte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bte(t){var e=Ste(t,"string");return typeof e=="symbol"?e:e+""}function Ste(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xd{constructor(e,n){let{id:i,stateless:r=!0}=n;Ul(this,"hot",void 0),Ul(this,"id",void 0),Ul(this,"elements",[]),Ul(this,"hidden",!1),Ul(this,"stateId",""),Ul(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ap)}getElements(){return this.elements}reset(){M(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),M(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}mt(xd,kn);const Xh={};function Ys(t,e){if(!Xh[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=Xh[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(o){return n.apply(o.meta.instance,[].concat([o],[r]))}}function Ya(t){if(!Xh[t])throw Error(`Filter condition "${t}" does not exist.`);return Xh[t].descriptor}function rn(t,e,n){n.key=t,Xh[t]={condition:e,descriptor:n}}const yn="none";function Rte(){return!0}rn(yn,Rte,{name:Rd,inputsCount:0,showOperators:!1});const hh="empty";function Ete(t){return Yt(t.value)}rn(hh,Ete,{name:gw,inputsCount:0,showOperators:!0});const Kg="not_empty";function Tte(t,e){return!Ys(hh,e)(t)}rn(Kg,Tte,{name:mw,inputsCount:0,showOperators:!0});const dh="eq";function Mte(t,e){let[n]=e;return zt(t.value).toLocaleLowerCase(t.meta.locale)===zt(n)}rn(dh,Mte,{name:pw,inputsCount:1,showOperators:!0});const Xg="neq";function _te(t,e){return!Ys(dh,e)(t)}rn(Xg,_te,{name:ww,inputsCount:1,showOperators:!0});const k1="gt";function Ite(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}rn(k1,Ite,{name:Sw,inputsCount:1,showOperators:!0});const F1="gte";function Pte(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}rn(F1,Pte,{name:Rw,inputsCount:1,showOperators:!0});const V1="lt";function Ote(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}rn(V1,Ote,{name:Ew,inputsCount:1,showOperators:!0});const W1="lte";function xte(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}rn(W1,xte,{name:Tw,inputsCount:1,showOperators:!0});const _0="date_after";function Ate(t,e){let[n]=e;const i=q(t.value,t.meta.dateFormat),r=q(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}rn(_0,Ate,{name:Iw,inputsCount:1,showOperators:!0});const I0="date_before";function Hte(t,e){let[n]=e;const i=q(t.value,t.meta.dateFormat),r=q(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}rn(I0,Hte,{name:Pw,inputsCount:1,showOperators:!0});const Om="between";function Nte(t,e){let[n,i]=e,r=n,o=i;if(t.meta.type==="numeric"){const s=parseFloat(r,10),a=parseFloat(o,10);r=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Ys(I0,[o]),a=Ys(_0,[r]);return s(t)&&a(t)}return t.value>=r&&t.value<=o}rn(Om,Nte,{name:Mw,inputsCount:2,showOperators:!0});const B1="not_between";function Dte(t,e){return!Ys(Om,e)(t)}rn(B1,Dte,{name:_w,inputsCount:2,showOperators:!0});const j1="begins_with";function Lte(t,e){let[n]=e;return zt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(zt(n))}rn(j1,Lte,{name:vw,inputsCount:1,showOperators:!0});const U1="ends_with";function $te(t,e){let[n]=e;return zt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(zt(n))}rn(U1,$te,{name:Cw,inputsCount:1,showOperators:!0});const P0="contains";function kte(t,e){let[n]=e;return zt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(zt(n))>=0}rn(P0,kte,{name:yw,inputsCount:1,showOperators:!0});const z1="not_contains";function Fte(t,e){return!Ys(P0,e)(t)}rn(z1,Fte,{name:bw,inputsCount:1,showOperators:!0});const Y1="date_tomorrow";function Vte(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().subtract(-1,"days").startOf("day"),"d"):!1}rn(Y1,Vte,{name:xw,inputsCount:0});const G1="date_today";function Wte(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().startOf("day"),"d"):!1}rn(G1,Wte,{name:Ow,inputsCount:0});const K1="date_yesterday";function Bte(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().subtract(1,"days").startOf("day"),"d"):!1}rn(K1,Bte,{name:Aw,inputsCount:0});nx();function jte(t,e){let n=t;return n===""&&(n=`(${e})`),n}const qb=new Set([1]).has(1),Ute=qb&&typeof Array.from=="function";function Ad(t){let e=t;return qb&&(e=new Set(e)),function(n){let i;return qb?i=e.has(n):i=!!~e.indexOf(n),i}}function X1(t){return t??""}function Zb(t){let e=t;return Ute?e=Array.from(new Set(e)):e=GS(e),e=e.sort((n,i)=>typeof n=="number"&&typeof i=="number"?n-i:n===i?0:n>i?1:-1),e}function R_(t,e,n,i){const r=[],o=t===e;let s;return o||(s=Ad(e)),M(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:jte(a,n)};i&&i(u),r.push(u)}),r}const Ga="by_value";function zte(t,e){let[n]=e;return n(t.value)}rn(Ga,zte,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Ad(e)]},showOperators:!1});const qh={};function Yte(t){if(!qh[t])throw Error(`Operation with id "${t}" does not exist.`);const e=qh[t].func;return function(n,i){return e(n,i)}}function Gte(t){return qh[t].name}function O0(t,e,n){qh[t]={name:e,func:n}}const Ws="conjunction",Kte=Dw;function Xte(t,e){return t.every(n=>n.func(e))}O0(Ws,Kte,Xte);const xm="disjunction",qte=Ed;function Zte(t,e){return t.some(n=>n.func(e))}O0(xm,qte,Zte);const x0="disjunctionWithExtraCondition",Qte=Ed;function Jte(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}O0(x0,Qte,Jte);const ene="numeric",q1="text",tne="date",E_={[ene]:[yn,Be,hh,Kg,Be,dh,Xg,Be,k1,F1,V1,W1,Om,B1],[q1]:[yn,Be,hh,Kg,Be,dh,Xg,Be,j1,U1,Be,P0,z1],[tne]:[yn,Be,hh,Kg,Be,dh,Xg,Be,I0,_0,Om,Be,Y1,G1,K1]};function nne(t){const e=[];let n=t;return E_[n]||(n=q1),M(E_[n],i=>{let r;i===Be?r={name:Be}:r=br(Ya(i)),e.push(r)}),e}function Oc(t,e,n){return(e=ine(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ine(t){var e=rne(t,"string");return typeof e=="symbol"?e:e+""}function rne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qC="built",ZC="building",T_=["click","input","keydown","keypress","keyup","focus","blur","change"];let wr=class Z1{static get DEFAULTS(){return br({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Oc(this,"hot",void 0),Oc(this,"eventManager",new Yi(this)),Oc(this,"options",void 0),Oc(this,"_element",void 0),Oc(this,"buildState",void 0),this.hot=e,this.options=tn(Z1.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===ZC?this._element:this.buildState===qC?(this.update(),this._element):(this.buildState=ZC,this.build(),this.buildState=qC,this._element)}isBuilt(){return this.buildState===qC}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Kn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=ZC),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&X(this._element,this.options.className),this.options.children.length)M(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Fe(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),M(T_,i=>e(n,i))}else M(T_,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mt(wr,kn);function one(t,e){Q1(t,e),e.add(t)}function sne(t,e,n){Q1(t,e),e.set(t,n)}function Q1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kf(t,e){return t.get(A0(t,e))}function ane(t,e,n){return t.set(A0(t,e),n),n}function A0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zl=new WeakMap,M_=new WeakSet;class Bs extends wr{static get DEFAULTS(){return br({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,tn(Bs.DEFAULTS,n)),one(this,M_),sne(this,zl,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>A0(M_,this,lne).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");ane(zl,this,this._element.firstChild),X(this._element,"htUIInput"),X(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Kf(zl,this).type=this.options.type,Kf(zl,this).placeholder=this.translateIfPossible(this.options.placeholder),Kf(zl,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Kf(zl,this).focus()}}function lne(t){this.options.value=t.target.value}function une(t,e){J1(t,e),e.add(t)}function xc(t,e,n){J1(t,e),e.set(t,n)}function J1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yl(t,e,n){return t.set(fh(t,e),n),n}function Ft(t,e){return t.get(fh(t,e))}function fh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cn=new WeakMap,Xf=new WeakMap,qf=new WeakMap,QC=new WeakMap,Zf=new WeakMap,Qf=new WeakSet;class Zh extends wr{static get DEFAULTS(){return br({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,tn(Zh.DEFAULTS,n)),une(this,Qf),xc(this,cn,null),xc(this,Xf,[]),xc(this,qf,void 0),xc(this,QC,void 0),xc(this,Zf,void 0),this.registerHooks()}getMenu(){return Ft(cn,this)}registerHooks(){this.addLocalHook("click",()=>fh(Qf,this,dne).call(this))}setItems(e){Yl(Xf,this,this.translateNames(e)),Ft(cn,this)&&Ft(cn,this).setMenuItems(Ft(Xf,this))}translateNames(e){return M(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Yl(cn,this,new Fu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ft(cn,this).setMenuItems(Ft(Xf,this));const e=new wr(this.hot,{className:"htUISelectCaption"}),n=new wr(this.hot,{className:"htUISelectDropdown"});Yl(qf,this,e),Yl(QC,this,e.element),Yl(Zf,this,n),this.hot.getSettings().ariaTags&&(Me(n.element,[dl()]),Me(this._element,[PO()])),M([e,n],i=>this._element.appendChild(i.element)),Ft(cn,this).addLocalHook("select",i=>fh(Qf,this,cne).call(this,i)),Ft(cn,this).addLocalHook("afterClose",()=>fh(Qf,this,hne).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ft(cn,this).hot.getTranslatedPhrase(Rd),Ft(QC,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ft(cn,this)&&(Ft(cn,this).open(),Ft(cn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ft(cn,this).getNavigator().toFirstItem(),Ft(cn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ft(cn,this)&&Ft(cn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ft(cn,this)&&(Ft(cn,this).destroy(),Yl(cn,this,null)),Ft(qf,this)&&Ft(qf,this).destroy(),Ft(Zf,this)&&Ft(Zf,this).destroy(),super.destroy()}}function cne(t){t.name!==Be&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function hne(){this.runLocalHooks("afterClose")}function dne(){this.openOptions()}function fne(t,e){gne(t,e),e.add(t)}function gne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function __(t,e,n){return(e=mne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mne(t){var e=pne(t,"string");return typeof e=="symbol"?e:e+""}function pne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function I_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var JC=new WeakSet;class Qb extends xd{constructor(e,n){super(e,{id:n.id,stateless:!1}),fne(this,JC),__(this,"name",""),__(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Zh(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Bs(this.hot,{placeholder:Ww})),this.elements.push(new Bs(this.hot,{placeholder:Bw})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>I_(JC,this,wne).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),M(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>I_(JC,this,vne).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=br(e.command);n.name.startsWith(Gt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),M(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const o=this.getInputElement(r);o.setValue(i),o[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Ya(yn),n=[];return M(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=Ya(e?e.name:yn);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||M(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Zh)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Bs)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{X(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&X(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Ya(yn)];if(e!==null){const{visualIndex:i}=e;n=nne(this.hot.getDataType(0,i,this.hot.countRows(),i))}M(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function wne(t){M(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function vne(t){Du(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Xi(t))}function P_(t,e,n){Cne(t,e),e.set(t,n)}function Cne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ac(t,e){return t.get(eH(t,e))}function O_(t,e,n){return t.set(eH(t,e),n),n}function eH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gl=new WeakMap,ey=new WeakMap;class Am extends wr{static get DEFAULTS(){return br({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,tn(Am.DEFAULTS,n)),P_(this,Gl,void 0),P_(this,ey,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),O_(ey,this,e),O_(Gl,this,this._element.firstChild),Ac(Gl,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Ac(ey,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Ac(Gl,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Ac(Gl,this).checked=e)}focus(){this.isBuilt()&&Ac(Gl,this).focus()}}function yne(t,e){bne(t,e),e.add(t)}function bne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sne(t,e,n){return(e=Rne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rne(t){var e=Ene(t,"string");return typeof e=="symbol"?e:e+""}function Ene(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tne(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const x_=0;var A_=new WeakSet;class Mne extends xd{constructor(e,n){super(e,{id:n.id,stateless:!1}),yne(this,A_),Sne(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuOperators"),M(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[Ws,xm];M(e,n=>{const i=new Am(this.hot,{name:"operator",label:{htmlFor:n,textContent:Gte(n)},value:n,checked:n===e[x_],id:n});i.addLocalHook("change",r=>Tne(A_,this,_ne).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(gt`Radio button with index ${e} doesn't exist.`);M(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Am&&n.isChecked());return e?e.getValue():Ws}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&M(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ws,n=arguments.length>1?arguments[1]:void 0,i=e;i===x0&&(i=xm),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(x_)}}function _ne(t){this.setState(t.target.value)}function Ine(t,e,n){Pne(t,e),e.set(t,n)}function Pne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ty(t,e){return t.get(tH(t,e))}function One(t,e,n){return t.set(tH(t,e),n),n}function tH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hc=new WeakMap;class Qh extends wr{static get DEFAULTS(){return br({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,tn(Qh.DEFAULTS,n)),Ine(this,Hc,void 0)}build(){super.build(),One(Hc,this,this._element.firstChild)}update(){this.isBuilt()&&(ty(Hc,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&ty(Hc,this).focus()}activate(){ty(Hc,this).click()}}function xne(t,e){nH(t,e),e.add(t)}function Kl(t,e,n){nH(t,e),e.set(t,n)}function nH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Le(t,e){return t.get(du(t,e))}function rr(t,e,n){return t.set(du(t,e),n),n}function du(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const H_="multipleSelect.itemBox";var hr=new WeakMap,Jt=new WeakMap,ny=new WeakMap,Mo=new WeakMap,hs=new WeakMap,ds=new WeakMap,Nc=new WeakSet;class Jh extends wr{static get DEFAULTS(){return br({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,tn(Jh.DEFAULTS,n)),xne(this,Nc),Kl(this,hr,[]),Kl(this,Jt,void 0),Kl(this,ny,void 0),Kl(this,Mo,void 0),Kl(this,hs,void 0),Kl(this,ds,void 0),rr(Mo,this,new Bs(this.hot,{placeholder:Vw,className:"htUIMultipleSelectSearch"})),rr(hs,this,new Qh(this.hot,{textContent:Lw,className:"htUISelectAll"})),rr(ds,this,new Qh(this.hot,{textContent:$w,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Le(Jt,this)}registerHooks(){Le(Mo,this).addLocalHook("keydown",e=>du(Nc,this,Hne).call(this,e)),Le(Mo,this).addLocalHook("input",e=>du(Nc,this,Ane).call(this,e)),Le(hs,this).addLocalHook("click",e=>du(Nc,this,Nne).call(this,e)),Le(ds,this).addLocalHook("click",e=>du(Nc,this,Dne).call(this,e))}setItems(e){var n;rr(hr,this,e),(n=Le(Jt,this))===null||n===void 0||n.loadData(Le(hr,this))}setLocale(e){rr(ny,this,e)}getLocale(){return Le(ny,this)}getItems(){return[...Le(hr,this)]}getValue(){return $ne(Le(hr,this))}getSearchInputElement(){return Le(Mo,this)}getSelectAllElement(){return Le(hs,this)}getClearAllElement(){return Le(ds,this)}isSelectedAllValues(){return Le(hr,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),i=new wr(this.hot,{className:"htUISelectionControls",children:[Le(hs,this),Le(ds,this)]});this._element.appendChild(Le(Mo,this).element),this._element.appendChild(i.element),this._element.appendChild(n);const r=o=>{var s;if(!this._element)return;(s=Le(Jt,this))===null||s===void 0||s.destroy(),X(o,"htUIMultipleSelectHot"),rr(Jt,this,new this.hot.constructor(o,{data:Le(hr,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,g,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Le(Jt,this).listen()},colWidths:()=>Le(Jt,this).container.scrollWidth-mn(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Le(Jt,this).init();const l=Le(Jt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:H_}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Le(Jt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:H_})};r(n),this.hot._registerTimeout(()=>r(n),100)}focus(){this.isBuilt()&&Le(Jt,this).listen()}reset(){Le(Mo,this).reset(),Le(hs,this).reset(),Le(ds,this).reset()}update(){this.isBuilt()&&(Le(Jt,this).loadData(Lne(Le(hr,this),this.options.value)),super.update())}destroy(){var e;(e=Le(Jt,this))===null||e===void 0||e.destroy(),Le(Mo,this).destroy(),Le(ds,this).destroy(),Le(hs,this).destroy(),rr(Mo,this,null),rr(ds,this,null),rr(hs,this,null),rr(Jt,this,null),rr(hr,this,null),super.destroy()}}function Ane(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Le(hr,this)]:n=Le(hr,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Le(Jt,this).loadData(n)}function Hne(t){this.runLocalHooks("keydown",t,this),aR(Du,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Xi(t),Le(Jt,this).listen(),Le(Jt,this).selectCell(0,0))}function Nne(t){const e=[];t.preventDefault(),Le(Jt,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(WR(n,i)[0])}),Le(Jt,this).setSourceDataAtCell(e)}function Dne(t){const e=[];t.preventDefault(),Le(Jt,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(WR(n,i)[0])}),Le(Jt,this).setSourceDataAtCell(e)}function Lne(t,e){const n=Ad(e);return t.map(i=>(i.checked=n(i.value),i))}function $ne(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function kne(t,e){Fne(t,e),e.add(t)}function Fne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vne(t,e,n){return(e=Wne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wne(t){var e=Bne(t,"string");return typeof e=="symbol"?e:e+""}function Bne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Dc=new WeakSet;class jne extends xd{constructor(e,n){super(e,{id:n.id,stateless:!1}),kne(this,Dc),Vne(this,"name",""),this.name=n.name,this.elements.push(new Jh(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Jf(Dc,this,Une).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Jf(Dc,this,zne).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ga){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?yn:Ga},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,o,s,a)=>{const[l]=Xo(r,h=>h.name===Ga),u={},c=this.hot.getTranslatedPhrase(Uh);if(l){const h=s(i,a),d=Ke(h,R=>R.value),g=new Map(h.map(R=>[R.value,this.hot.getCellMeta(R.meta.visualRow,R.meta.visualCol)])),m=Zb(d);o&&(l.args[0]=o);const w=[],C=R_(m,l.args[0],c,R=>{R.checked&&w.push(R.value),Jf(Dc,this,N_).call(this,R,g)}),S=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,S).locale,u.args=[w],u.command=Ya(Ga),u.itemsSnapshot=C}else u.args=[],u.command=Ya(yn);this.state.setValueAtIndex(i,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Jh)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{X(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return X(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Uh),n=this._getColumnVisibleValues(),i=n.map(l=>l.value),r=new Map(n.map(l=>[l.value,l.meta])),o=Zb(i),s=R_(o,o,e,l=>{Jf(Dc,this,N_).call(this,l,r)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ke(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:X1(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function Une(t){Du(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Xi(t))}function N_(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function zne(t,e){switch(e.type){case"numeric":return KA(t,e);default:return t}}var iH;function Yne(t,e){Gne(t,e),e.add(t)}function Gne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kne(t,e,n){return(e=Xne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xne(t){var e=qne(t,"string");return typeof e=="symbol"?e:e+""}function qne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zne(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var D_=new WeakSet;class ed extends xd{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Yne(this,D_),Kne(this,"name",""),this.name=n.name,this.elements.push(new Bs(this.hot,{type:"button",value:kw,className:"htUIButton htUIButtonOK",identifier:ed.BUTTON_OK})),this.elements.push(new Bs(this.hot,{type:"button",value:Fw,className:"htUIButton htUIButtonCancel",identifier:ed.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){M(this.elements,e=>{e.addLocalHook("click",(n,i)=>Zne(D_,this,Qne).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(X(n.parentNode,"htFiltersMenuActionBar"),M(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}iH=ed;function Qne(t,e){e.options.identifier===iH.BUTTON_OK?this.accept():this.cancel()}function eg(t,e,n){return(e=Jne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jne(t){var e=eie(t,"string");return typeof e=="symbol"?e:e+""}function eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const L_="ConditionCollection.filteringStates";class rH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;eg(this,"hot",void 0),eg(this,"isMapRegistrable",void 0),eg(this,"filteringStates",new Ap),eg(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(L_,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),o=(i=r==null?void 0:r.conditions)!==null&&i!==void 0?i:[],s=r==null?void 0:r.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ws;return e.length?Yte(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ws,r=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ke(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(gt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Mt(qh[i]))throw new Error(gt`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:s,func:Ys(a,s)}]},r):u.push({name:a,args:s,func:Ys(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return nn(this.filteringStates.getEntries(),(e,n)=>{let[i,{operation:r,conditions:o}]=n;return e.push({column:i,operation:r,conditions:Ke(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),M(e,n=>{M(n.conditions,i=>this.addCondition(n.column,i))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(L_),this.filteringStates=null,this.clearLocalHooks()}}mt(rH,kn);const oH=rH;function $_(t,e,n){return(e=tie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tie(t){var e=nie(t,"string");return typeof e=="symbol"?e:e+""}function nie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iie{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];$_(this,"conditionCollection",void 0),$_(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return M(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return M(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return M(n,r=>{const o=r.meta.visualRow;e[o]!==void 0&&(i[o]=e[o])}),i}}const sH=iie;function rie(t,e){oie(t,e),e.add(t)}function oie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sa(t,e,n){return(e=sie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sie(t){var e=aie(t,"string");return typeof e=="symbol"?e:e+""}function aie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tg=new WeakSet;class aH{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];rie(this,tg),Sa(this,"hot",void 0),Sa(this,"conditionCollection",void 0),Sa(this,"columnDataFactory",void 0),Sa(this,"changes",[]),Sa(this,"grouping",!1),Sa(this,"latestEditedColumnPosition",-1),Sa(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>iy(tg,this,lie).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>iy(tg,this,uie).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>iy(tg,this,cie).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,M(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===e&&a.shift();const l=XO(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new oH(i.hot,!1),m=[].concat(c,d);g.importAllConditions(m);const w=i.columnDataFactory(h);let C;g.isEmpty()?C=w:C=new sH(g,R=>i.columnDataFactory(R)).filter(),C=Ke(C,R=>R.meta.visualRow);const S=Ad(C);return g.destroy(),Xo(w,R=>S(R.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Fe(this,(e,n)=>{this[n]=null})}}function lie(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function uie(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function cie(){M(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}mt(aH,kn);const hie=aH;function die(t){return M1({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof Jh)return i;if(r.element&&!Qa(r.element))return!1;r.focus()}})}const Lc="filters";function fie(t,e){let n=-1;const i=die(e),r=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Lc),i.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof wr&&(l.addLocalHook("click",r(l)),l.addLocalHook("focus",r(l)),l.addLocalHook("afterClose",r(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||i.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();i.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Lc),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Lc)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const d=t.getNavigator();d.getCurrentPage()>-1&&(n=d.getCurrentPage()),d.clear(),h.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const d=e[i.getCurrentPage()];d instanceof Zh&&(d.openOptions(),h.preventDefault()),d instanceof Qh&&(d.activate(),h.preventDefault()),d instanceof wr||h.preventDefault()}}],Lc)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Lc)}function a(){return n}return{...i,listen:s,getLastMenuPage:a}}function gie(t,e){lH(t,e),e.add(t)}function mie(t,e,n){lH(t,e),e.set(t,n)}function lH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $c(t,e,n){return(e=pie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pie(t){var e=wie(t,"string");return typeof e=="symbol"?e:e+""}function wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vie(t,e,n){return t.set(mi(t,e),n),n}function kc(t,e){return t.get(mi(t,e))}function mi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jb="filters",Cie=250,k_=Jb;var Ra=new WeakMap,xi=new WeakSet;class yie extends st{static get PLUGIN_KEY(){return Jb}static get PLUGIN_PRIORITY(){return Cie}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),gie(this,xi),$c(this,"dropdownMenuPlugin",null),$c(this,"conditionCollection",null),$c(this,"conditionUpdateObserver",null),$c(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),$c(this,"filtersRowsMap",null),mie(this,Ra,void 0),this.hot.addHook("afterGetColHeader",(n,i)=>mi(xi,this,Mie).call(this,n,i))}isEnabled(){return!!this.hot.getSettings()[Jb]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Sd),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,i=s=>(s.addLocalHook("accept",()=>mi(xi,this,F_).call(this,"accept")),s.addLocalHook("cancel",()=>mi(xi,this,F_).call(this,"cancel")),s.addLocalHook("change",a=>mi(xi,this,Tie).call(this,s,a)),s),r=()=>`${this.hot.getTranslatedPhrase(Hw)}:`,o=()=>`${this.hot.getTranslatedPhrase(Nw)}:`;if(!this.components.get("filter_by_condition")){const s=new Qb(this.hot,{id:"filter_by_condition",name:r,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>mi(xi,this,V_).call(this)),this.components.set("filter_by_condition",i(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Mne(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new Qb(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>mi(xi,this,V_).call(this)),this.components.set("filter_by_condition2",i(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new jne(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new ed(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new oH(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new hie(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>mi(xi,this,_ie).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>mi(xi,this,Eie).call(this,s)),this.addHook("afterDropdownMenuShow",()=>mi(xi,this,Sie).call(this)),this.addHook("afterDropdownMenuHide",()=>mi(xi,this,Rie).call(this)),this.addHook("afterChange",s=>mi(xi,this,bie).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!kc(Ra,this)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=kc(Ra,this).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];vie(Ra,this,fie(s,a));const l=u=>{kc(Ra,this).listen(),u.preventDefault(),Du(u.keyCode,"TAB")&&(u.shiftKey?kc(Ra,this).toPreviousItem():kc(Ra,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:k_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(k_)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ws;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o,this.conditionCollection.previousConditionStack)!==!1)if(i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=Ke(n.filter(),u=>u.meta.visualRow);const l=Ad(r);Ce(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),M(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!r.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return M(this.hot.getSourceDataAtCol(n),(r,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:g,locale:m}=this.hot.getCellMeta(o,n),w=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:r;i.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:g,locale:m},value:X1(w)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=Zb(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let o=e;return o===xm&&n.command.key!==yn&&i.command.key!==yn&&r.command.key!==yn?o=x0:r.command.key!==yn&&(n.command.key===yn||i.command.key===yn)&&(o=Ws),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new sH(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return M(r,s=>{M(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function bie(t){t&&M(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function Sie(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Rie(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Eie(t){t.items.push({name:Be}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function F_(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(r);u===-1&&(u=void 0),this.conditionCollection.removeConditions(r),o.command.key!==yn&&(this.conditionCollection.addCondition(r,o,l,u),s.command.key!==yn&&this.conditionCollection.addCondition(r,s,l,u)),a.command.key!==yn&&this.conditionCollection.addCondition(r,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(r)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Tie(t,e){this.updateDependentComponentsVisibility(),t.constructor===Qb&&!e.inputsCount&&this.setListeningDropdownMenu()}function V_(){this.setListeningDropdownMenu()}function Mie(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?X(e,"htFiltersActive"):xe(e,"htFiltersActive")}function _ie(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i}}=t,r=n.filter(s=>s.name===Ga),o=n.filter(s=>s.name!==Ga);if(r.length>=2||o.length>=3)ft(gt`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(o[0],i),this.components.get("filter_by_condition2").updateState(o[1],i),this.components.get("filter_operators").updateState(s,i),this.components.get("filter_by_value").updateState(t)}}const uH="internal-use-in-handsontable",eS={licenseKey:uH,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function cH(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Nn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function hH(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Iie(t){var e;const n=t[Nn],i=hH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=cH(t);return{...eS,...i,...r}}function Pie(t){var e;const n=t[Nn],i=hH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=cH(t);return{...i,...r}}function Oie(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function ov(){const t="engine_relationship",e=Mr(Nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function H0(){const t="shared_engine_usage",e=Mr(Nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function xie(t){const e=t.getSettings(),n=e[Nn],i=n==null?void 0:n.engine;if(n===!0||Mt(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return Aie((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&Mt(i.hyperformula)){const o=ov(),s=H0().get(i);return o.has(i)||o.set(i,[]),o.get(i).push(t),s&&s.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:uH}),(i.getConfig().leapYear1900!==eS.leapYear1900||Ep(i.getConfig().nullDate,eS.nullDate)===!1)&&ft(gt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function Aie(t,e,n){const i=e[Nn],r=Iie(e),o=ov(),s=H0();Hie(t,i.functions),Nie(t,i.language);const a=t.buildEmpty(r);return o.set(a,[n]),s.set(a,[n.guid]),Die(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function W_(t){var e;const n=ov(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function B_(t,e){if(t){const n=ov(),i=n.get(t),r=H0(),o=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(r.delete(t),t.destroy()))}}function Hie(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:o}=n;try{t.registerFunction(i,r,o)}catch(s){ft(s.message)}})}function Nie(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){ft(i.message)}}}function Die(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:o,options:s}=n;try{t.addNamedExpression(i,r,o,s)}catch(a){ft(a.message)}}),t.resumeEvaluation())}function Lie(t,e){return(Mt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const dH="DD/MM/YYYY";function fH(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function $ie(t){return fH(t)?t.substr(1):t}function kie(t){return typeof t=="string"&&t.startsWith("=")}function N0(t,e){return typeof t=="string"&&e==="date"}function gH(t,e){return q(t,e,!0).isValid()}function mH(t,e){return q(t,e,!0).format(dH)}function Fie(t,e){return q(t,dH,!0).format(e)}function pH(t,e){const i=new Date(Date.UTC(0,0,t+-1));return q(i).format(e)}function Vie(t,e,n){const i=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function Wie(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=r.from;o.from>r.from&&a&&s&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function Bie(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const o=r.from<r.to;r.from>e.from&&o&&(r.from-=1)})}),t}function D0(t,e,n){const i=Wie(t,Vie(t,e,n));return Bie(i)}function Ea(t,e,n){jie(t,e),e.set(t,n)}function jie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xt(t,e){return t.get(wH(t,e))}function fs(t,e,n){return t.set(wH(t,e),n),n}function wH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fc=new WeakMap,gs=new WeakMap,hi=new WeakMap,ng=new WeakMap,ry=new WeakMap,oy=new WeakMap,ig=new WeakMap;class Uie{constructor(e,n,i){Ea(this,Fc,void 0),Ea(this,gs,void 0),Ea(this,hi,void 0),Ea(this,ng,[]),Ea(this,ry,[]),Ea(this,oy,void 0),Ea(this,ig,[]),fs(Fc,this,e),fs(gs,this,n),fs(hi,this,i)}setRemovedHfIndexes(e){return fs(ig,this,e.map(n=>{const i=xt(gs,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),xt(ig,this)}getRemovedHfIndexes(){return xt(ig,this)}getHfIndexFromVisualIndex(e){const n=xt(gs,this).getIndexesSequence(),i=xt(gs,this).getNotTrimmedIndexes();return n.indexOf(i[e])}syncMoves(e){const i=`move${Ln(xt(Fc,this))}s`;xt(hi,this).getEngine().batch(()=>{e.forEach(r=>{const o=r.from!==r.to,s=r.from+1!==r.to;o&&s&&xt(hi,this).getEngine()[i](xt(hi,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(fs(ry,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),fs(oy,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(xt(hi,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=D0(xt(ry,this),xt(oy,this),xt(gs,this).getNumberOfIndexes());xt(hi,this).getSheetId()===null?xt(hi,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Ln(xt(Fc,this))}Order`;return n=>{if(xt(hi,this).isPerformingUndoRedo())return;const i=xt(gs,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=xt(ng,this).map(l=>i.indexOf(l)),o=xt(hi,this).getEngine().getSheetDimensions(xt(hi,this).getSheetId());let s;xt(Fc,this)==="row"?s=o.height:s=o.width;const a=r.length;for(let l=a;l<s;l+=1)r.push(l);xt(hi,this).getEngine()[e](xt(hi,this).getSheetId(),r)}fs(ng,this,i)}}init(){fs(ng,this,xt(gs,this).getIndexesSequence())}}const j_=Uie;function Ta(t,e,n){zie(t,e),e.set(t,n)}function zie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _o(t,e){return t.get(vH(t,e))}function Ma(t,e,n){return t.set(vH(t,e),n),n}function vH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rg=new WeakMap,og=new WeakMap,sy=new WeakMap,ay=new WeakMap,ly=new WeakMap,uy=new WeakMap,cy=new WeakMap;class Yie{constructor(e,n,i){Ta(this,rg,void 0),Ta(this,og,void 0),Ta(this,sy,void 0),Ta(this,ay,!1),Ta(this,ly,!1),Ta(this,uy,null),Ta(this,cy,null),Ma(rg,this,new j_("row",e,this)),Ma(og,this,new j_("column",n,this)),Ma(sy,this,i)}getForAxis(e){return e==="row"?_o(rg,this):_o(og,this)}setPerformUndo(e){Ma(ay,this,e)}setPerformRedo(e){Ma(ly,this,e)}isPerformingUndoRedo(){return _o(ay,this)||_o(ly,this)}getSheetId(){return _o(cy,this)}getEngine(){return _o(uy,this)}getPostponeAction(){return _o(sy,this)}setupSyncEndpoint(e,n){Ma(uy,this,e),Ma(cy,this,n),_o(rg,this).init(),_o(og,this).init()}}const Gie=Yie;function Kie(t,e){CH(t,e),e.add(t)}function Xl(t,e,n){return(e=Xie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xie(t){var e=qie(t,"string");return typeof e=="symbol"?e:e+""}function qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hy(t,e,n){CH(t,e),e.set(t,n)}function CH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gs(t,e,n){return t.set(vt(t,e),n),n}function yu(t,e){return t.get(vt(t,e))}function vt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Nn="formulas",Zie=["maxRows","maxColumns","language"],Qie=260;de.getSingleton().register("afterNamedExpressionAdded");de.getSingleton().register("afterNamedExpressionRemoved");de.getSingleton().register("afterSheetAdded");de.getSingleton().register("afterSheetRemoved");de.getSingleton().register("afterSheetRenamed");de.getSingleton().register("afterFormulasValuesUpdate");const Vu=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Zo=new WeakMap,L0=new WeakMap,Vc=new WeakMap,bt=new WeakSet;class Jie extends st{constructor(){var e;super(...arguments),e=this,Kie(this,bt),hy(this,Zo,!1),hy(this,L0,!1),hy(this,Vc,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vt(bt,e,mre).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vt(bt,e,pre).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vt(bt,e,wre).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vt(bt,e,vre).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vt(bt,e,Cre).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return vt(bt,e,yre).call(e,...i)}]]),Xl(this,"staticRegister",Mr("formulas")),Xl(this,"engine",null),Xl(this,"sheetName",null),Xl(this,"indexSyncer",null),Xl(this,"rowAxisSyncer",null),Xl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Nn}static get PLUGIN_PRIORITY(){return Qie}static get SETTING_KEYS(){return[Nn,...Zie]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Nn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=xie(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){ft("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,U_).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,z_).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,U_).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,z_).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,ire).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,rre).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,ere).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,ore).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,Y_).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,Y_).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,sre).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,are).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,cre).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,hre).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,lre).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,ure).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,dre).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,fre).call(n,...r)}),this.indexSyncer=new Gie(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,o,s)=>{this.rowAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("beforeColumnMove",(i,r,o,s)=>{this.columnAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("afterRowMove",(i,r,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(i,r,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,nre).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,gre).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return vt(bt,n,tre).call(n,...r)}),yu(Vc,this).forEach(i=>{let[r,o]=i;return this.engine.on(r,o)}),super.enablePlugin()}}disablePlugin(){yu(Vc,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),B_(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Pie(this.hot.getSettings());Oie(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[Nn];if(fe(i)&&fe(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[Nn].sheetName;r&&this.engine.doesSheetExist(r)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(r??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){yu(Vc,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),Gs(Vc,this,null),B_(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(fe(n)&&!iA(n))return ft("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return ft("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return ft(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){mR(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Ln(Nn)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return r!==null&&o!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var o;const s=r==null||(o=r.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(i.has(s)||i.add(s))}),W_(this.engine).forEach((r,o)=>{if((n||o!==this.sheetId)&&i.has(o)){var s;r.render(),(s=r.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return fe(u)?`${u}:${a}x${l}`:""},r=new Set(n.map(o=>i(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(fe(l)===!1||fe(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=i(o);if(c!==void 0&&!r.has(h)){const d=W_(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){ft(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const o=this.hot.getCellMeta(e,n);return N0(i,o.type)&&(gH(i,o.dateFormat)?i=mH(i,o.dateFormat):kie(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function ere(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(e,i);let s=this.engine.getCellValue(r);return o.type==="date"&&Hn(s)&&(s=pH(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function tre(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const g=this.engine.getFillRangeData(h,d),{row:m,col:w}=h.start,{row:C,col:S}=h.end,R=C-m+1,E=S-w+1;for(let H=0;H<g.length;H+=1)for(let P=0;P<g[H].length;P+=1){const B=g[H][P],j=m+H%R,Y=w+P%E,G=this.hot.getCellMeta(j,Y);N0(B,G.type)&&(B.startsWith("'")?g[H][P]=B.slice(1):this.isFormulaCellType(j,Y,this.sheetId)===!1&&(g[H][P]=Fie(B,G.dateFormat)))}return g}function U_(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Ln(Nn))||Gs(L0,this,Mt(this.hot.getSettings().data))}function nre(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,i)=>{n.forEach((r,o)=>{const s=this.hot.getCellMeta(i,o),a=s.dateFormat;N0(r,s.type)&&(e=!0,gH(r,a)?t[i][o]=mH(r,a):this.isFormulaCellType(i,o)===!1&&(t[i][o]=`'${r}`))})}),e===!0&&(Gs(Zo,this,!0),this.engine.setSheetContent(this.sheetId,t),Gs(Zo,this,!1))}function z_(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Ln(Nn)))if(this.sheetName=Lie(this.engine,this.hot.getSettings()[Nn].sheetName),yu(L0,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Gs(Zo,this,!0);const r=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(r),Gs(Zo,this,!1)}}}function ire(t,e,n,i){if(i!=="get"||yu(Zo,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t);if(r===null||e===null)return;if(!this.isFormulaCellType(r,e)&&this.getCellType(r,e)!=="ARRAY"){fH(n.value)&&(n.value=$ie(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s),l=this.hot.getCellsMeta().find(c=>c.visualRow===r&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Hn(a)&&(a=pH(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function rre(t,e,n,i){if(i!=="get"||yu(Zo,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(r===null||o===null||!this.isFormulaCellType(r,o)&&this.getCellType(r,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function Y_(t,e){if(Vu(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),i.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function ore(t,e){if(Vu(e))return;const n=[],i=[];t.forEach(r=>{let[o,s,,a]=r;const l=this.hot.propToCol(s);if(!Hn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){ft(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}i.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function sre(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function are(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function lre(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function ure(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function cre(t,e,n){if(Vu(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function hre(t,e,n){if(Vu(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function dre(t,e,n,i){if(Vu(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function fre(t,e,n,i){if(Vu(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function gre(t,e,n){var i;Gs(Zo,this,!0);const r=this.hot.getSourceDataArray(n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Gs(Zo,this,!1),r.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function mre(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function pre(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function wre(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function vre(t){this.hot.runHooks("afterSheetAdded",t)}function Cre(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function yre(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function bre(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(cw,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Sre(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(hw,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-r+1===this.countCols()||this.selectColumns(r,o)},disabled:!1,hidden(){const n=Ke(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().col,o=i.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const g=u.slice(r,o+1);c.push(...g.filter(m=>n.includes(m)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Rre(t,e){yH(t,e),e.add(t)}function G_(t,e,n){yH(t,e),e.set(t,n)}function yH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bi(t,e){return t.get(bs(t,e))}function Wc(t,e,n){return t.set(bs(t,e),n),n}function bs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("beforeHideColumns");de.getSingleton().register("afterHideColumns");de.getSingleton().register("beforeUnhideColumns");de.getSingleton().register("afterUnhideColumns");const dy="hiddenColumns",Ere=310;var io=new WeakMap,$r=new WeakMap,_a=new WeakSet;class Tre extends st{constructor(){super(...arguments),Rre(this,_a),G_(this,io,{}),G_(this,$r,null)}static get PLUGIN_KEY(){return dy}static get PLUGIN_PRIORITY(){return Ere}isEnabled(){return!!this.hot.getSettings()[dy]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[dy];ke(n)&&(Wc(io,this,n),Mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Wc($r,this,new xp),bi($r,this).addLocalHook("init",()=>bs(_a,this,xre).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,bi($r,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return bs(_a,e,Ore).call(e,...r)}),this.addHook("afterGetCellMeta",(i,r,o)=>bs(_a,this,_re).call(this,i,r,o)),this.addHook("modifyColWidth",(i,r)=>bs(_a,this,Mre).call(this,i,r),2),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return bs(_a,e,Pre).call(e,...r)}),this.addHook("modifyCopyableRange",i=>bs(_a,this,Ire).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Wc(io,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const o=bi($r,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));M(l,u=>{o[u]=!1}),r=nn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&s)!==!1&&(i&&s&&bi($r,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&s,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{bi($r,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return Ke(bi($r,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return bi($r,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Wc(io,this,null),Wc($r,this,null),super.destroy()}}function Mre(t,e){if(this.isHidden(e))return 0;if(bi(io,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function _re(t,e,n){if(bi(io,this).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Ire(t){if(bi(io,this).copyPasteEnabled)return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return M(t,i=>{let r=!0,o=0;Ce(i.startCol,i.endCol,s=>{this.isHidden(s)?(r||n(i.startRow,i.endRow,o,s-1),r=!0):(r&&(o=s),s===i.endCol&&n(i.startRow,i.endRow,o,s),r=!1)})}),e}function Pre(t,e){if(!bi(io,this).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),X(e,n)}function Ore(t){t.items.push({name:Be},bre(this),Sre(this))}function xre(){Array.isArray(bi(io,this).columns)&&this.hideColumns(bi(io,this).columns)}function Are(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(dw,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Hre(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(fw,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-r+1===this.countRows()||this.selectRows(r,o)},disabled:!1,hidden(){const n=Ke(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().row,o=i.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const g=u.slice(r,o+1);c.push(...g.filter(m=>n.includes(m)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Nre(t,e){bH(t,e),e.add(t)}function K_(t,e,n){bH(t,e),e.set(t,n)}function bH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ki(t,e){return t.get(Ss(t,e))}function Bc(t,e,n){return t.set(Ss(t,e),n),n}function Ss(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("beforeHideRows");de.getSingleton().register("afterHideRows");de.getSingleton().register("beforeUnhideRows");de.getSingleton().register("afterUnhideRows");const fy="hiddenRows",Dre=320;var jo=new WeakMap,kr=new WeakMap,Ia=new WeakSet;class Lre extends st{constructor(){super(...arguments),Nre(this,Ia),K_(this,jo,{}),K_(this,kr,null)}static get PLUGIN_KEY(){return fy}static get PLUGIN_PRIORITY(){return Dre}isEnabled(){return!!this.hot.getSettings()[fy]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[fy];ke(n)&&(Bc(jo,this,n),Mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Bc(kr,this,new xp),ki(kr,this).addLocalHook("init",()=>Ss(Ia,this,Bre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ki(kr,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ss(Ia,e,Wre).call(e,...r)}),this.addHook("afterGetCellMeta",(i,r,o)=>Ss(Ia,this,kre).call(this,i,r,o)),this.addHook("modifyRowHeight",(i,r)=>Ss(Ia,this,$re).call(this,i,r)),this.addHook("afterGetRowHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ss(Ia,e,Vre).call(e,...r)}),this.addHook("modifyCopyableRange",i=>Ss(Ia,this,Fre).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Bc(jo,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const o=ki(kr,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));M(l,u=>{o[u]=!1}),r=nn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&s)!==!1&&(i&&s&&ki(kr,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,r,i&&s,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{ki(kr,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return Ke(ki(kr,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return ki(kr,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Bc(jo,this,null),Bc(kr,this,null),super.destroy()}}function $re(t,e){return this.isHidden(e)?0:t}function kre(t,e,n){if(ki(jo,this).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Fre(t){if(ki(jo,this).copyPasteEnabled)return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return M(t,i=>{let r=!0,o=0;Ce(i.startRow,i.endRow,s=>{this.isHidden(s)?(r||n(o,s-1,i.startCol,i.endCol),r=!0):(r&&(o=s),s===i.endRow&&n(o,s,i.startCol,i.endCol),r=!1)})}),e}function Vre(t,e){if(!ki(jo,this).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),X(e,n)}function Wre(t){t.items.push({name:Be},Are(this),Hre(this))}function Bre(){Array.isArray(ki(jo,this).rows)&&this.hideRows(ki(jo,this).rows)}function jre(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Gp)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Ure(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Kp)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function zre(t,e){SH(t,e),e.add(t)}function Yre(t,e,n){SH(t,e),e.set(t,n)}function SH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tS(t,e){return t.get(Hm(t,e))}function gy(t,e,n){return t.set(Hm(t,e),n),n}function Hm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("beforeColumnFreeze");de.getSingleton().register("afterColumnFreeze");de.getSingleton().register("beforeColumnUnfreeze");de.getSingleton().register("afterColumnUnfreeze");const X_="manualColumnFreeze",Gre=110;var Fa=new WeakMap,my=new WeakSet;class Kre extends st{constructor(){super(...arguments),zre(this,my),Yre(this,Fa,!1)}static get PLUGIN_KEY(){return X_}static get PLUGIN_PRIORITY(){return Gre}isEnabled(){return!!this.hot.getSettings()[X_]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Hm(my,this,Xre).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Hm(my,this,qre).call(this,e,n)),super.enablePlugin())}disablePlugin(){gy(Fa,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;tS(Fa,this)||gy(Fa,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;tS(Fa,this)||gy(Fa,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function Xre(t){t.items.push({name:"---------"},jre(this),Ure(this))}function qre(t,e){if(tS(Fa,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function sg(t,e,n){return(e=Zre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zre(t){var e=Qre(t,"string");return typeof e=="symbol"?e:e+""}function Qre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const py=0,q_=1,Z_=2,ql="px";let Jre=class{constructor(e){sg(this,"hot",void 0),sg(this,"_element",null),sg(this,"state",py),sg(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=Z_}build(){this.state===py&&(this._element=this.hot.rootDocument.createElement("div"),this.state=q_)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=py}isAppended(){return this.state===Z_}isBuilt(){return this.state>=q_}setPosition(e,n){Hn(e)&&(this._element.style.top=e+ql),Hn(n)&&(this._element.style[this.inlineProperty]=n+ql)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Hn(e)&&(this._element.style.width=e+ql),Hn(n)&&(this._element.style.height=n+ql)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Hn(e)&&(this._element.style.marginTop=e+ql),Hn(n)&&(this._element.style[`margin${Ln(this.inlineProperty)}`]=n+ql)}getOffset(){const e=this._element.style,n=`margin${Ln(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const RH=Jre,eoe="ht__manualColumnMove--backlight";let toe=class extends RH{build(){super.build(),X(this._element,eoe)}};const noe=toe,ioe="ht__manualColumnMove--guideline";let roe=class extends RH{build(){super.build(),X(this._element,ioe)}};const ooe=roe;function soe(t,e){EH(t,e),e.add(t)}function or(t,e,n){EH(t,e),e.set(t,n)}function EH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function li(t,e,n){return t.set(Rs(t,e),n),n}function me(t,e){return t.get(Rs(t,e))}function Rs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("beforeColumnMove");de.getSingleton().register("afterColumnMove");const wy="manualColumnMove",aoe=120,Q_="ht__manualColumnMove",Nm="show-ui",nS="on-moving--columns",iS="after-selection--columns";var zn=new WeakMap,_s=new WeakMap,Uo=new WeakMap,qg=new WeakMap,Ns=new WeakMap,Un=new WeakMap,ag=new WeakMap,Hi=new WeakMap,su=new WeakMap,Dm=new WeakMap,gh=new WeakMap,Pa=new WeakSet;class loe extends st{constructor(){super(...arguments),soe(this,Pa),or(this,zn,new noe(this.hot)),or(this,_s,new ooe(this.hot)),or(this,Uo,[]),or(this,qg,0),or(this,Ns,!1),or(this,Un,{}),or(this,ag,void 0),or(this,Hi,void 0),or(this,su,void 0),or(this,Dm,void 0),or(this,gh,void 0)}static get PLUGIN_KEY(){return wy}static get PLUGIN_PRIORITY(){return aoe}isEnabled(){return!!this.hot.getSettings()[wy]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rs(Pa,e,uoe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rs(Pa,e,hoe).call(e,...i)}),this.addHook("afterScrollVertically",()=>Rs(Pa,this,foe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rs(Pa,e,goe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,Q_),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){xe(this.hot.rootElement,Q_),this.unregisterEvents(),me(zn,this).destroy(),me(_s,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=me(ag,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(li(ag,this,void 0),o===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return li(ag,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=nn(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let o=e;o<=n;o+=1){const s=i.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[wy];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return Ce(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(me(Hi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,me(Hi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=me(zn,this).getOffset().start,u=me(zn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,w=_t(this.hot.rootElement),C=m.innerWidth-me(su,this)-w;h=m.innerWidth-me(Un,this).eventPageX-C-(i.scrollX===void 0?r:0)}else h=me(Un,this).eventPageX-(me(su,this)-(i.scrollX===void 0?r:0));if(me(Dm,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(me(Hi,this))&&(o+=r),o+=c,me(Hi,this)<0)me(gh,this)>0?me(Un,this).col=0:me(Un,this).col=e>0?e-1:e;else if(me(Un,this).TD.offsetWidth/2+o<=h){const m=me(Hi,this)>=me(qg,this)?me(qg,this)-1:me(Hi,this);me(Un,this).col=m+1,o+=me(Un,this).TD.offsetWidth}else me(Un,this).col=me(Hi,this);let d=h,g=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?g=s-1:g===0?g=1:i.scrollX!==void 0&&me(Hi,this)<me(gh,this)&&(g-=me(su,this)<=i.scrollX?me(su,this):0),me(zn,this).setPosition(null,d),me(_s,this).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Rs(Pa,this,coe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Rs(Pa,this,doe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){me(zn,this).build(),me(_s,this).build()}destroy(){me(zn,this).destroy(),me(_s,this).destroy(),super.destroy()}}function uoe(t,e,n,i){const r=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=_e(t.target,"sortAction");if(!s||!o||me(Ns,this)||t.button!==0||a){li(Ns,this,!1),me(Uo,this).length=0,xe(this.hot.rootElement,[nS,Nm]);return}const l=me(_s,this).isBuilt()&&!me(_s,this).isAppended(),u=me(zn,this).isBuilt()&&!me(zn,this).isAppended();l&&u&&(me(_s,this).appendTo(r.hider),me(zn,this).appendTo(r.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),g=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=g){i.column=!0,li(Ns,this,!0);const m=n.firstChild?hx(t,n.firstChild).x:t.offsetX;me(Un,this).eventPageX=t.pageX,li(Hi,this,e.col),me(Un,this).TD=n,me(Un,this).col=e.col,li(Uo,this,this.prepareColumnsToMoving(d,g)),li(Dm,this,!!this.hot.getSettings().rowHeaders),li(qg,this,this.hot.countCols()),li(gh,this,this.hot.getSettings().fixedColumnsStart),li(su,this,fn(this.hot.rootElement).left);const w=me(Dm,this)?-1:0,C=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,S=e.col<me(gh,this),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),E=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),H=this.getColumnsWidth(d,e.col-1)+E,P=this.getColumnsWidth(w,d-1)+(S?R:0)+H;me(zn,this).setPosition(C,P),me(zn,this).setSize(this.getColumnsWidth(d,g),r.hider.offsetHeight-C),me(zn,this).setOffset(null,-H),X(this.hot.rootElement,nS)}else xe(this.hot.rootElement,iS),li(Ns,this,!1),me(Uo,this).length=0}function coe(t){me(Ns,this)&&(me(Un,this).eventPageX=t.pageX,this.refreshPositions())}function hoe(t,e,n,i){!this.hot.getSelectedRangeLast()||!me(Ns,this)||(me(Uo,this).indexOf(e.col)>-1?xe(this.hot.rootElement,Nm):X(this.hot.rootElement,Nm),i.row=!0,i.column=!0,i.cell=!0,li(Hi,this,e.col),me(Un,this).TD=n)}function doe(){const t=me(Un,this).col,e=me(Uo,this).length;if(li(Hi,this,void 0),li(Ns,this,!1),xe(this.hot.rootElement,[nS,Nm,iS]),this.hot.selection.isSelectedByColumnHeader()&&X(this.hot.rootElement,iS),e<1||t===void 0)return;const n=me(Uo,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(me(Uo,this),t);if(me(Uo,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(i),s=o+e-1;this.hot.selectColumns(o,s)}}function foe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;me(zn,this).setPosition(i),me(zn,this).setSize(null,t.hider.offsetHeight-i)}function goe(){this.moveBySettingsOrLoad()}function moe(t,e){TH(t,e),e.add(t)}function On(t,e,n){TH(t,e),e.set(t,n)}function TH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e,n){return t.set(dr(t,e),n),n}function ae(t,e){return t.get(dr(t,e))}function dr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lm="manualColumnResize",poe=130,J_="manualColumnWidths";var Do=new WeakMap,lg=new WeakMap,vi=new WeakMap,$m=new WeakMap,eo=new WeakMap,woe=new WeakMap,bu=new WeakMap,ug=new WeakMap,ni=new WeakMap,xo=new WeakMap,il=new WeakMap,km=new WeakMap,mh=new WeakMap,ph=new WeakMap,yi=new WeakMap,wh=new WeakMap,Fr=new WeakSet;class voe extends st{static get PLUGIN_KEY(){return Lm}static get PLUGIN_PRIORITY(){return poe}constructor(e){super(e),moe(this,Fr),On(this,Do,null),On(this,lg,null),On(this,vi,[]),On(this,$m,null),On(this,eo,null),On(this,woe,null),On(this,bu,null),On(this,ug,null),On(this,ni,this.hot.rootDocument.createElement("DIV")),On(this,xo,this.hot.rootDocument.createElement("DIV")),On(this,il,null),On(this,km,!1),On(this,mh,0),On(this,ph,null),On(this,yi,void 0),On(this,wh,void 0),X(ae(ni,this),"manualColumnResizer"),X(ae(xo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Lm]}enablePlugin(){this.enabled||(qt(yi,this,new qs),ae(yi,this).addLocalHook("init",()=>dr(Fr,this,Coe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ae(yi,this)),this.addHook("modifyColWidth",(e,n)=>dr(Fr,this,Toe).call(this,e,n),1),this.addHook("beforeStretchingColumnWidth",(e,n)=>dr(Fr,this,Moe).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,i)=>dr(Fr,this,_oe).call(this,e,n,i)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){qt(wh,this,ae(yi,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",J_,ae(yi,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",J_,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return ae(yi,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ae(yi,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;qt(Do,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(ae(Do,this)),r=i.col;if(r<0)return;const o=Zt(ae(Do,this)),s=ae(Do,this).getBoundingClientRect(),a=r<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(Do,this),i.row,i.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ae(Do,this),i.row,i.col)),qt(lg,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),qt(vi,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();M(c,h=>{const d=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;Ce(d,g,m=>{ae(vi,this).includes(m)||ae(vi,this).push(m)})})}ae(vi,this).includes(ae(lg,this))||qt(vi,this,[ae(lg,this)]),qt(ug,this,l.start-6),qt(bu,this,parseInt(s.width,10)),ae(ni,this).style.top=`${l.top}px`,ae(ni,this).style[this.inlineDir]=`${ae(ug,this)+ae(bu,this)}px`,ae(ni,this).style.height=`${o}px`,this.hot.rootElement.appendChild(ae(ni,this))}refreshHandlePosition(){ae(ni,this).style[this.inlineDir]=`${ae(ug,this)+ae($m,this)}px`}setupGuidePosition(){const e=parseInt(Zt(ae(ni,this)),10),n=parseInt(ae(ni,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);X(ae(ni,this),"active"),X(ae(xo,this),"active"),ae(xo,this).style.top=`${n}px`,this.refreshGuidePosition(),ae(xo,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(ae(xo,this))}refreshGuidePosition(){ae(xo,this).style[this.inlineDir]=ae(ni,this).style[this.inlineDir]}hideHandleAndGuide(){xe(ae(ni,this),"active"),xe(ae(xo,this),"active")}checkIfColumnHeader(e){const n=js(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const o=this.hot.runHooks("beforeColumnResize",ae(eo,this),i,!0);o!==void 0&&qt(eo,this,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(i):this.setManualSize(i,ae(eo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(eo,this),i,!0),r&&e()};ae(mh,this)>=2&&(ae(vi,this).length>1?(M(ae(vi,this),r=>{n(r)}),e()):M(ae(vi,this),r=>{n(r,!0)})),qt(mh,this,0),qt(ph,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>dr(Fr,this,yoe).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>dr(Fr,this,boe).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>dr(Fr,this,Soe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>dr(Fr,this,Roe).call(this)),this.eventManager.addEventListener(ae(ni,this),"contextmenu",()=>dr(Fr,this,Eoe).call(this))}destroy(){super.destroy()}}function Coe(){const t=this.hot.getSettings()[Lm],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{ae(yi,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{ae(yi,this).setValueAtIndex(i,n)})},!0),qt(wh,this,t)):t===!0&&Array.isArray(ae(wh,this))&&this.hot.batchExecution(()=>{ae(wh,this).forEach((n,i)=>{ae(yi,this).setValueAtIndex(i,n)})},!0)}function yoe(t){if(!rR(t.target)&&ae(km,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ae(il,this)||this.setupHandlePosition(e))}}function boe(t){t.target.parentNode===this.hot.rootElement&&_e(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ae(Do,this)),this.setupGuidePosition(),qt(il,this,!0),ae(ph,this)===null&&(qt(ph,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(ph,this))),qt(mh,this,ae(mh,this)+1),this.startX=t.pageX,qt(eo,this,ae(bu,this)))}function Soe(t){if(ae(il,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();qt($m,this,ae(bu,this)+e),M(ae(vi,this),n=>{qt(eo,this,this.setManualSize(n,ae($m,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Roe(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",ae(eo,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(eo,this),n,!1)};ae(il,this)&&(this.hideHandleAndGuide(),qt(il,this,!1),ae(eo,this)!==ae(bu,this)&&(ae(vi,this).length>1?(M(ae(vi,this),i=>{e(i)}),t()):M(ae(vi,this),i=>{e(i,!0)})),this.setupHandlePosition(ae(Do,this)))}function Eoe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(ni,this)),this.hot.rootElement.removeChild(ae(xo,this)),qt(il,this,!1),qt(km,this,!0),this.hot._registerImmediate(()=>{qt(km,this,!1)})}function Toe(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=ae(yi,this).getValueAtIndex(i);this.hot.getSettings()[Lm]&&r&&(n=r)}return n}function Moe(t,e){let n=ae(yi,this).getValueAtIndex(e);return n===null&&(n=t),n}function _oe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function vy(t,e,n){return(e=Ioe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ioe(t){var e=Poe(t,"string");return typeof e=="symbol"?e:e+""}function Poe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Cy=0,eI=1,tI=2,Zl="px";let Ooe=class{constructor(e){vy(this,"hot",void 0),vy(this,"_element",null),vy(this,"state",Cy),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=tI}build(){this.state===Cy&&(this._element=this.hot.rootDocument.createElement("div"),this.state=eI)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Cy}isAppended(){return this.state===tI}isBuilt(){return this.state>=eI}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Zl),n!==void 0&&(this._element.style.left=n+Zl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Zl),n&&(this._element.style.height=n+Zl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Zl),n&&(this._element.style.marginLeft=n+Zl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const MH=Ooe,xoe="ht__manualRowMove--backlight";class Aoe extends MH{build(){super.build(),X(this._element,xoe)}}const Hoe=Aoe,Noe="ht__manualRowMove--guideline";class Doe extends MH{build(){super.build(),X(this._element,Noe)}}const Loe=Doe;function $oe(t,e){_H(t,e),e.add(t)}function Ql(t,e,n){_H(t,e),e.set(t,n)}function _H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ka(t,e,n){return t.set(Es(t,e),n),n}function He(t,e){return t.get(Es(t,e))}function Es(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("beforeRowMove");de.getSingleton().register("afterRowMove");const yy="manualRowMove",koe=140,nI="ht__manualRowMove",Fm="show-ui",rS="on-moving--rows",oS="after-selection--rows";var Yn=new WeakMap,Is=new WeakMap,zo=new WeakMap,Ds=new WeakMap,ui=new WeakMap,cg=new WeakMap,Oa=new WeakSet;class Foe extends st{constructor(){super(...arguments),$oe(this,Oa),Ql(this,Yn,new Hoe(this.hot)),Ql(this,Is,new Loe(this.hot)),Ql(this,zo,[]),Ql(this,Ds,void 0),Ql(this,ui,{}),Ql(this,cg,void 0)}static get PLUGIN_KEY(){return yy}static get PLUGIN_PRIORITY(){return koe}isEnabled(){return!!this.hot.getSettings()[yy]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Es(Oa,e,Voe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Es(Oa,e,Boe).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>Es(Oa,this,Uoe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Es(Oa,e,zoe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),X(this.hot.rootElement,nI),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){xe(this.hot.rootElement,nI),this.unregisterEvents(),He(Yn,this).destroy(),He(Is,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=He(cg,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,i,r);if(Ka(cg,this,void 0),o===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return Ka(cg,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=nn(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let o=e;o<=n;o++){const s=i.getRenderableFromVisualIndex(o);s!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[yy];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:i,to:r}=e,o=Math.min(i.row,r.row),s=Math.max(i.row,r.row);return Ce(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=He(ui,this).coords,n=this.hot.view.getFirstFullyVisibleRow(),i=this.hot.view.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=He(ui,this).TD,a=this.hot.rootElement,l=fn(a),u=Ja(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,g=He(ui,this).eventPageY-d+c,m=o.hider.offsetHeight,w=o.TBODY.offsetTop,C=He(Yn,this).getOffset().top,S=He(Yn,this).getSize().height,R=s.offsetHeight/2,E=s.offsetHeight;let H=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=g>=H+R;this.isFixedRowTop(e.row)&&(H+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?He(ui,this).row=n>0?n-1:n:P?(He(ui,this).row=e.row+1,H+=e.row===0?E-1:E):He(ui,this).row=e.row;let B=g,j=H;g+S+C>=m?B=m-S-C:g+C<w&&(B=w+Math.abs(C)),H>=m-1&&(j=m-1),He(Yn,this).setPosition(B),He(Is,this).setPosition(j)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Es(Oa,this,Woe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Es(Oa,this,joe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){He(Yn,this).build(),He(Is,this).build()}destroy(){He(Yn,this).destroy(),He(Is,this).destroy(),super.destroy()}}function Voe(t,e,n,i){const{wtTable:r,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||He(Ds,this)||t.button!==0){Ka(Ds,this,!1),He(zo,this).length=0,xe(this.hot.rootElement,[rS,Fm]);return}const l=He(Is,this).isBuilt()&&!He(Is,this).isAppended(),u=He(Yn,this).isBuilt()&&!He(Yn,this).isAppended();l&&u&&(He(Is,this).appendTo(r.hider),He(Yn,this).appendTo(r.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),g=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=g){i.row=!0,Ka(Ds,this,!0),He(ui,this).eventPageY=t.pageY,He(ui,this).coords=e,He(ui,this).TD=n,Ka(zo,this,this.prepareRowsToMoving());const m=r.holder.scrollLeft+o.getRowHeaderWidth(),w=this.getRowsHeight(d,e.row-1)+t.offsetY;He(Yn,this).setPosition(null,m),He(Yn,this).setSize(r.hider.offsetWidth-m,this.getRowsHeight(d,g)),He(Yn,this).setOffset(-w,null),X(this.hot.rootElement,rS),this.refreshPositions()}else xe(this.hot.rootElement,oS),Ka(Ds,this,!1),He(zo,this).length=0}function Woe(t){He(Ds,this)&&(He(ui,this).eventPageY=t.pageY,this.refreshPositions())}function Boe(t,e,n,i){!this.hot.getSelectedRangeLast()||!He(Ds,this)||(He(zo,this).indexOf(e.row)>-1?xe(this.hot.rootElement,Fm):X(this.hot.rootElement,Fm),i.row=!0,i.column=!0,i.cell=!0,He(ui,this).coords=e,He(ui,this).TD=n)}function joe(){const t=He(ui,this).row,e=He(zo,this).length;if(Ka(Ds,this,!1),xe(this.hot.rootElement,[rS,Fm,oS]),this.hot.selection.isSelectedByRowHeader()&&X(this.hot.rootElement,oS),e<1||t===void 0)return;const n=He(zo,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(He(zo,this),t);if(He(zo,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(i),s=o+e-1;this.hot.selectRows(o,s)}}function Uoe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;He(Yn,this).setPosition(null,i),He(Yn,this).setSize(t.hider.offsetWidth-i)}function zoe(){this.moveBySettingsOrLoad()}function Yoe(t,e){IH(t,e),e.add(t)}function xn(t,e,n){IH(t,e),e.set(t,n)}function IH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(t,e,n){return t.set(Lo(t,e),n),n}function se(t,e){return t.get(Lo(t,e))}function Lo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vm="manualRowResize",Goe=30,iI="manualRowHeights";var Kr=new WeakMap,hg=new WeakMap,Ci=new WeakMap,vh=new WeakMap,Ps=new WeakMap,$0=new WeakMap,Su=new WeakMap,dg=new WeakMap,Bn=new WeakMap,Yr=new WeakMap,rl=new WeakMap,Wm=new WeakMap,Ch=new WeakMap,yh=new WeakMap,fr=new WeakMap,bh=new WeakMap,ms=new WeakSet;class Koe extends st{static get PLUGIN_KEY(){return Vm}static get PLUGIN_PRIORITY(){return Goe}constructor(e){super(e),Yoe(this,ms),xn(this,Kr,null),xn(this,hg,null),xn(this,Ci,[]),xn(this,vh,null),xn(this,Ps,null),xn(this,$0,null),xn(this,Su,null),xn(this,dg,null),xn(this,Bn,this.hot.rootDocument.createElement("DIV")),xn(this,Yr,this.hot.rootDocument.createElement("DIV")),xn(this,rl,!1),xn(this,Wm,!1),xn(this,Ch,0),xn(this,yh,null),xn(this,fr,void 0),xn(this,bh,void 0),X(se(Bn,this),"manualRowResizer"),X(se(Yr,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Vm]}enablePlugin(){this.enabled||(Bt(fr,this,new qs),se(fr,this).addLocalHook("init",()=>Lo(ms,this,tse).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,se(fr,this)),this.addHook("modifyRowHeight",(e,n)=>Lo(ms,this,ese).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Bt(bh,this,se(fr,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",iI,se(fr,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",iI,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,Ox);return se(fr,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return se(vh,this)}setupHandlePosition(e){Bt(Kr,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(se(Kr,this)),o=r.row;if(o<0)return;const s=_t(se(Kr,this)),a=se(Kr,this).getBoundingClientRect(),l=o<i.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let c;l?c=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(Kr,this),r.row,r.col):u&&(c=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(se(Kr,this),r.row,r.col)),c||(c=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(se(Kr,this),r.row,r.col)),Bt(hg,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Bt(Ci,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();M(d,g=>{const m=g.getTopStartCorner().row,w=g.getBottomStartCorner().row;Ce(m,w,C=>{se(Ci,this).includes(C)||se(Ci,this).push(C)})})}se(Ci,this).includes(se(hg,this))||Bt(Ci,this,[se(hg,this)]),Bt(dg,this,c.top-6),Bt(Su,this,parseInt(a.height,10)),se(Bn,this).style.top=`${se(dg,this)+se(Su,this)}px`,se(Bn,this).style[this.inlineDir]=`${c.start}px`,se(Bn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(se(Bn,this))}refreshHandlePosition(){se(Bn,this).style.top=`${se(dg,this)+se(vh,this)}px`}setupGuidePosition(){const e=parseInt(_t(se(Bn,this)),10),n=parseInt(se(Bn,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);X(se(Bn,this),"active"),X(se(Yr,this),"active"),se(Yr,this).style.top=se(Bn,this).style.top,se(Yr,this).style[this.inlineDir]=`${n}px`,se(Yr,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(se(Yr,this))}refreshGuidePosition(){se(Yr,this).style.top=se(Bn,this).style.top}hideHandleAndGuide(){xe(se(Bn,this),"active"),xe(se(Yr,this),"active")}checkIfRowHeader(e){const n=js(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&se(Ps,this)<n?n:se(Ps,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);o!==void 0&&Bt(Ps,this,o),this.setManualSize(i,se(Ps,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};se(Ch,this)>=2&&(se(Ci,this).length>1?(M(se(Ci,this),r=>{n(r)}),e()):M(se(Ci,this),r=>{n(r,!0)})),Bt(Ch,this,0),Bt(yh,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Lo(ms,this,Xoe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Lo(ms,this,qoe).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>Lo(ms,this,Zoe).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>Lo(ms,this,Qoe).call(this)),this.eventManager.addEventListener(se(Bn,this),"contextmenu",()=>Lo(ms,this,Joe).call(this))}destroy(){super.destroy()}}function Xoe(t){if(!rR(t.target)&&se(Wm,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(se(rl,this)||this.setupHandlePosition(e))}}function qoe(t){_e(t.target,"manualRowResizer")&&(this.setupHandlePosition(se(Kr,this)),this.setupGuidePosition(),Bt(rl,this,!0),se(yh,this)===null&&(Bt(yh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(yh,this))),Bt(Ch,this,se(Ch,this)+1),Bt($0,this,t.pageY),Bt(Ps,this,se(Su,this)))}function Zoe(t){se(rl,this)&&(Bt(vh,this,se(Su,this)+(t.pageY-se($0,this))),M(se(Ci,this),e=>{Bt(Ps,this,this.setManualSize(e,se(vh,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Qoe(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};se(rl,this)&&(this.hideHandleAndGuide(),Bt(rl,this,!1),se(Ps,this)!==se(Su,this)&&(se(Ci,this).length>1?(M(se(Ci,this),i=>{e(i)}),t()):M(se(Ci,this),i=>{e(i,!0)})),this.setupHandlePosition(se(Kr,this)))}function Joe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(Bn,this)),this.hot.rootElement.removeChild(se(Yr,this)),Bt(rl,this,!1),Bt(Wm,this,!0),this.hot._registerImmediate(()=>{Bt(Wm,this,!1)})}function ese(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),r=se(fr,this).getValueAtIndex(i);this.hot.getSettings()[Vm]&&r&&(n=r)}return n}function tse(){const t=this.hot.getSettings()[Vm],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{se(fr,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{se(fr,this).setValueAtIndex(i,n)}),Bt(bh,this,t)):t===!0&&Array.isArray(se(bh,this))&&se(bh,this).forEach((n,i)=>{se(fr,this).setValueAtIndex(i,n)})},!0)}function nse(t,e,n){ise(t,e),e.set(t,n)}function ise(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xa(t,e,n){return(e=rse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rse(t){var e=ose(t,"string");return typeof e=="symbol"?e:e+""}function ose(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rI(t,e){return t.get(PH(t,e))}function fg(t,e,n){return t.set(PH(t,e),n),n}function PH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Aa=new WeakMap;class sse{constructor(e,n,i,r,o,s){xa(this,"row",void 0),xa(this,"col",void 0),xa(this,"rowspan",void 0),xa(this,"colspan",void 0),xa(this,"removed",!1),xa(this,"cellCoordsFactory",void 0),xa(this,"cellRangeFactory",void 0),nse(this,Aa,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return gt`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return gt`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return gt`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return gt`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return n<0||i<0||r<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),fg(Aa,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,r),l=Math.max(n,r),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=i),i>0)n<=c&&n>u&&(this[o]+=i);else if(i<0){if(a<=u&&l>=c)return this.removed=!0,fg(Aa,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(u<=a&&c>=l)this[o]+=i;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return fg(Aa,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return rI(Aa,this)||fg(Aa,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),rI(Aa,this)}}const Xr=sse;function ase(t,e){lse(t,e),e.add(t)}function lse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gg(t,e,n){return(e=use(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function use(t){var e=cse(t,"string");return typeof e=="symbol"?e:e+""}function cse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ha(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ps=new WeakSet;class Bm{constructor(e){ase(this,ps),gg(this,"plugin",void 0),gg(this,"mergedCells",[]),gg(this,"mergedCellsMatrix",new Map),gg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return gt`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){let n=!1;return M(this.mergedCells,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(n=i,n):!0),n}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const g=`r${h},c${d}`;if(n.has(g)){ft(Bm.IS_OVERLAPPING_WARNING(r)),c=!0;break}u.add(g)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=i;l<=o;l++)for(let u=r;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,o=e.rowspan,s=e.colspan,a=new Xr(i,r,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,r),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Ha(ps,this,oI).call(this,a),a):(ft(Bm.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),Ha(ps,this,hse).call(this,i),i):!1}clear(){M(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:o}=e;Ce(n,n+r,s=>{Ce(i,i+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,o)}getStartMostColumnIndex(e,n){const i=Ha(ps,this,mg).call(this,e,"col",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getEndMostColumnIndex(e,n){const i=Ha(ps,this,mg).call(this,e,"col",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}getTopMostRowIndex(e,n){const i=Ha(ps,this,mg).call(this,e,"row",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getBottomMostRowIndex(e,n){const i=Ha(ps,this,mg).call(this,e,"row",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const o=[];this.mergedCells.forEach(s=>{s.shift(r,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Ha(ps,this,oI).call(this,s)})}}function mg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=r.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=r.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),i.has(l)||i.set(l,new Set),i.get(l).add(c)}return Array.from(new Set(Array.from(i.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function oI(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function hse(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}const dse=Bm;function by(t,e,n){return(e=fse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fse(t){var e=gse(t,"string");return typeof e=="symbol"?e:e+""}function gse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mse{constructor(e){by(this,"plugin",void 0),by(this,"mergedCellsCollection",void 0),by(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const o=n.slice(0),s=this.getAutofillSize(e,n,i),[a,l,u,c]=e,d=["up","down"].indexOf(i)>-1?u-a+1:c-l+1,g=Math.floor(s/d)*d,m=s-g,w=this.getFarthestCollection(e,n,i,r);if(w){if(i==="down"){const C=w.row+w.rowspan-a-m;o[2]+C>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?C:0}else if(i==="right"){const C=w.col+w.colspan-l-m;o[3]+C>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?C:0}else if(i==="up"){const C=u-m-w.row+1;o[0]+C<0?o[0]+=m:o[0]-=m?C:0}else if(i==="left"){const C=c-m-w.col+1;o[1]+C<0?o[1]+=m:o[1]-=m?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),tn(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return r-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return[l,u,r-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[r,a+1,c,h];default:return null}}getFarthestCollection(e,n,i,r){const[o,s,a,l]=e,u=["up","down"].indexOf(i)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,i),g=u?a-o+1:l-s+1,m=Math.floor(d/g)*g,w=d-m;let C=null,S=null,R=null;switch(i){case"up":C="includesVertically",R=c-w+1;break;case"left":C="includesHorizontally",R=c-w+1;break;case"down":C="includesVertically",R=h+w-1;break;case"right":C="includesHorizontally",R=h+w-1;break}return M(r,E=>{E[C](R)&&E.isFarther(S,i)&&(S=E)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=(u,c)=>{switch(r){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<i.length;u+=1){if(a=i[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===i.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return M(e,r=>{const o=r[0],s=this.plugin.hot.propToCol(r[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[o,s,a,l]=r,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return this.mergedCellsCollection.getWithinRange(h,!0).length>0}}const pse=mse;function Sy(t,e,n){return(e=wse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wse(t){var e=vse(t,"string");return typeof e=="symbol"?e:e+""}function vse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cse{constructor(e){Sy(this,"plugin",void 0),Sy(this,"hot",void 0),Sy(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let o=0;o<e.colspan;o+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+o));for(let r=0;r<i.length;r+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(i[r]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const yse=Cse;function bse(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(qp)}return this.getTranslatedPhrase(Xp)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?Xr.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Sh(t,e,n){return(e=Sse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sse(t){var e=Rse(t,"string");return typeof e=="symbol"?e:e+""}function Rse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sI{constructor(e){Sh(this,"data",void 0),Sh(this,"next",null),Sh(this,"prev",null),this.data=e}}class Ese{constructor(){Sh(this,"first",null),Sh(this,"last",null)}push(e){const n=new sI(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new sI(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}const pg=Ese;function Tse(t,e){OH(t,e),e.add(t)}function Na(t,e,n){OH(t,e),e.set(t,n)}function OH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ct(t,e){return t.get(jm(t,e))}function di(t,e,n){return t.set(jm(t,e),n),n}function jm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vr=new WeakMap,Wr=new WeakMap,Br=new WeakMap,jr=new WeakMap,sS=new WeakMap,wg=new WeakMap,vg=new WeakMap,Ry=new WeakSet;class Mse{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;Tse(this,Ry),Na(this,Vr,new pg),Na(this,Wr,new pg),Na(this,Br,null),Na(this,jr,null),Na(this,sS,null),Na(this,wg,null),Na(this,vg,null),di(sS,this,n),di(wg,this,i),di(vg,this,r)}getCurrentVerticalNode(){return ct(jr,this).data}getFirstVerticalNode(){return ct(Wr,this).first.data}getNextVerticalNode(){return ct(jr,this).next.data}getPrevVerticalNode(){return ct(jr,this).prev.data}getCurrentHorizontalNode(){return ct(Br,this).data}getFirstHorizontalNode(){return ct(Vr,this).first.data}getNextHorizontalNode(){return ct(Br,this).next.data}getPrevHorizontalNode(){return ct(Br,this).prev.data}setPrevNodeAsActive(){di(jr,this,ct(jr,this).prev),di(Br,this,ct(Br,this).prev)}setNextNodeAsActive(){di(jr,this,ct(jr,this).next),di(Br,this,ct(Br,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),i=e.getBottomEndCorner(),r=new WeakSet;di(Vr,this,new pg);for(let s=n.row;s<=i.row;s++)if(!ct(wg,this).isHidden(s))for(let a=n.col;a<=i.col;a++){if(ct(vg,this).isHidden(a))continue;const l=jm(Ry,this,aI).call(this,e,ct(Vr,this),r,s,a);l&&di(Br,this,l)}ct(Vr,this).first&&(ct(Vr,this).first.prev=ct(Vr,this).last,ct(Vr,this).last.next=ct(Vr,this).first);const o=new WeakSet;di(Wr,this,new pg);for(let s=n.col;s<=i.col;s++)if(!ct(vg,this).isHidden(s))for(let a=n.row;a<=i.row;a++){if(ct(wg,this).isHidden(a))continue;const l=jm(Ry,this,aI).call(this,e,ct(Wr,this),o,a,s);l&&di(jr,this,l)}ct(Wr,this).first&&(ct(Wr,this).first.prev=ct(Wr,this).last,ct(Wr,this).last.next=ct(Wr,this).first)}setActiveNode(e,n){return ct(Vr,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:s,colEnd:a}=i.data;if(e>=r&&e<=o&&n>=s&&n<=a)return di(Br,this,i),!1}),ct(Wr,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:s,colEnd:a}=i.data;if(e>=r&&e<=o&&n>=s&&n<=a)return di(jr,this,i),!1}),this}}function aI(t,e,n,i,r){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=ct(sS,this).call(this,i,r);if(l&&n.has(l))return null;const u={colStart:r,colEnd:r,rowStart:i,rowEnd:i};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return i===a.row&&r===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function _se(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e;function r(){}function o(s,a,l){const u=t.mergedCellsCollection.get(a,l);if(!ke(u)){s.removeAttribute("rowspan"),s.removeAttribute("colspan"),s.style.display="";return}const{row:c,col:h,colspan:d,rowspan:g}=u,[m,w]=t.translateMergedCellToRenderable(c,g,h,d),C=n.getRenderableFromVisualIndex(a),S=i.getRenderableFromVisualIndex(l),R=m-C+1,E=w-S+1,H=n.getNearestNotHiddenIndex(c,1),P=i.getNearestNotHiddenIndex(h,1),B=Math.min(g,R),j=Math.min(d,E);H===a&&P===l?(s.setAttribute("rowspan",B),s.setAttribute("colspan",j)):(s.removeAttribute("rowspan"),s.removeAttribute("colspan"),s.style.display="none")}return{before:r,after:o}}function Ise(t,e){xH(t,e),e.add(t)}function Cg(t,e,n){xH(t,e),e.set(t,n)}function xH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ey(t,e,n){return(e=Pse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pse(t){var e=Ose(t,"string");return typeof e=="symbol"?e:e+""}function Ose(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function td(t,e,n){return t.set(ht(t,e),n),n}function Tt(t,e){return t.get(ht(t,e))}function ht(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("beforeMergeCells");de.getSingleton().register("afterMergeCells");de.getSingleton().register("beforeUnmergeCells");de.getSingleton().register("afterUnmergeCells");const Rh="mergeCells",xse=150,lI=Rh;var Vi=new WeakMap,Wi=new WeakMap,to=new WeakMap,uI=new WeakMap,wt=new WeakSet;class Ase extends st{constructor(){super(...arguments),Ise(this,wt),Ey(this,"mergedCellsCollection",null),Ey(this,"autofillCalculations",null),Ey(this,"selectionCalculations",null),Cg(this,Vi,null),Cg(this,Wi,{row:0,col:0}),Cg(this,to,new Mse({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Cg(this,uI,_se(this))}static get PLUGIN_KEY(){return Rh}static get PLUGIN_PRIORITY(){return xse}isEnabled(){return!!this.hot.getSettings()[Rh]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new dse(this),this.autofillCalculations=new pse(this),this.selectionCalculations=new yse(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Hse).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Dse).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Lse).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,$se).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,kse).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,cI).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,cI).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Wse).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Bse).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,jse).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Fse).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Nse).call(e,...i)}),this.addHook("afterRenderer",function(){return Tt(uI,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Vse).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Use).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,zse).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Yse).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Gse).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Kse).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Xse).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,qse).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Zse).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Qse).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,Jse).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,eae).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,tae).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,nae).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(wt,e,iae).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Rh];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!uR())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:o}=i;for(let s=r+1;s<r+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(r);s&&(s.style.background=Ru(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=Ru(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Xr.containsNegativeValues(e)?(ft(Xr.NEGATIVE_VALUES_WARNING(e)),!1):Xr.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(ft(Xr.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Xr.isSingleCell(e)?(ft(Xr.IS_SINGLE_CELL(e)),!1):Xr.containsZeroSpan(e)?(ft(Xr.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const n=e.filter(o=>this.validateSetting(o)),i=this.mergedCellsCollection.filterOverlappingMergeCells(n),r=[];i.forEach(o=>{const{row:s,col:a,rowspan:l,colspan:u}=o,c=this.hot._createCellCoords(s,a),h=this.hot._createCellCoords(s+l-1,a+u-1),d=this.hot._createCellRange(c,c,h);this.mergeRange(d,!0,!0);for(let g=s;g<s+l;g++)for(let m=a;m<a+u;m++)(g!==s||m!==a)&&r.push([g,m,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:r.row,col:r.col,rowspan:o.row-r.row+1,colspan:o.col-r.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),Ce(0,s.rowspan-1,c=>{Ce(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(i?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),M(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),Ce(0,r.rowspan-1,o=>{Ce(0,r.colspan-1,s=>{this.hot.removeCellMeta(r.row+o,r.col+s,"hidden"),this.hot.removeCellMeta(r.row+o,r.col+s,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:lI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lI)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(ke(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(ke(s)){const a=s.row+s.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(ke(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(ke(s)){const a=s.col+s.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),r===0?l=s.getNearestNotHiddenIndex(i,1):l=s.getNearestNotHiddenIndex(i+r-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=i>=0?s.getRenderableFromVisualIndex(l):i;return[u,c]}}function Hse(){this.generateFromSettings(this.hot.getSettings()[Rh]),this.hot.render()}function Nse(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(i.row===e[o].row&&i.col===e[o].col&&r.row===e[o].row+e[o].rowspan-1&&r.col===e[o].col+e[o].colspan-1)return!1}return t}function Dse(t){Tt(Wi,this).row=t.row,Tt(Wi,this).col=t.col}function Lse(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;Tt(Vi,this)&&(r.getRenderableFromVisualIndex(Tt(Vi,this).row)!==null&&(n.row=Tt(Vi,this).row),i.getRenderableFromVisualIndex(Tt(Vi,this).col)!==null&&(n.col=Tt(Vi,this).col),td(Vi,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=i.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=r.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function $se(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=r.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=r.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function kse(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){td(Vi,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);td(Vi,this,e.clone()),n&&e.assign(n)}function Fse(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:i,col:r,colspan:o,rowspan:s}=n;return[i,r,i+s-1,r+o-1]}function Vse(t){t.items.push({name:"---------"},bse(this))}function cI(){td(Vi,this,null)}function Wse(){if(Tt(Vi,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=Tt(Vi,this).clone().normalize();Tt(to,this).setActiveNode(i.row,i.col),Tt(Wi,this).row>0||Tt(Wi,this).col>0?Tt(to,this).setPrevNodeAsActive():(n==="E-W"&&Tt(Wi,this).col<0||e==="S-N"&&Tt(Wi,this).row<0)&&Tt(to,this).setNextNodeAsActive()}function Bse(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;let o=null,s=null;if(Tt(Wi,this).col<0){const{rowEnd:a,colEnd:l}=Tt(to,this).getPrevHorizontalNode();s=i.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1)}else if(Tt(Wi,this).col>0){const{rowStart:a,colStart:l}=Tt(to,this).getNextHorizontalNode();s=i.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1)}else if(Tt(Wi,this).row<0){const{rowEnd:a,colEnd:l}=Tt(to,this).getPrevVerticalNode();s=i.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1)}else if(Tt(Wi,this).row>0){const{rowStart:a,colStart:l}=Tt(to,this).getNextVerticalNode();s=i.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}Tt(to,this).setActiveNode(t,e),td(Wi,this,{row:0,col:0})}function jse(){this.hot.getSelectedRangeLast().isHeader()||Tt(to,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Use(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function zse(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Yse(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Gse(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let i=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,i,n))return i=e,i;const r=this.hot._createCellCoords(e[0],e[1]),o=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(r,r,o),a=this.mergedCellsCollection.getWithinRange(s);return a.length===0||(i=this.autofillCalculations.snapDragArea(e,i,n,a)),i}function Kse(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Xse(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function qse(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Zse(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Qse(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Jse(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(n);M(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function eae(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function tae(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function nae(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(r);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(s,s,a))}function iae(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.view.getFirstRenderedVisibleColumn(),r=this.hot.view.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const s=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,r),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l),c=u.reduce((d,g)=>{let{rowspan:m}=g;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{var g;let{rowspan:m}=d,w=0;n==="top"||n==="top_inline_start_corner"?w=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):w=m-h,t=Math.max((g=t)!==null&&g!==void 0?g:0,ht(wt,this,rae).call(this,e,w))}),t}function rae(t,e){const n=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),i=this.hot.getPlugin("autoRowSize");let r=0;for(let s=t;s<t+e;s++)if(!this.hot.rowIndexMapper.isHidden(s)){var o;r+=(o=i==null?void 0:i.getRowHeight(s))!==null&&o!==void 0?o:n}return r}function oae(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function s(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:s1(u.type))(l,u,d)(c,h);if(m===ro){const w=a+1;if(typeof e[w]<"u")return s(w)}return m}(0)}}function hI(){ft(gt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const AH="sort";function sae(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${AH}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function aae(t){const e=t.className.split(" "),n=new RegExp(`^${AH}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function lae(t,e,n){return(e=uae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uae(t){var e=cae(t,"string");return typeof e=="symbol"?e:e+""}function cae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Um="multiColumnSorting",hae=170,Ty="columnSorting",dI=Um;o1(Um,oae);class dae extends m1{constructor(){super(...arguments),lae(this,"pluginKey",Um)}static get PLUGIN_KEY(){return Um}static get PLUGIN_PRIORITY(){return hae}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Ty]&&(hI(),this.hot.getPlugin(Ty).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Mm)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Zs,position:"before",group:dI})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dI)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),xe(e,aae(e)),this.enabled!==!1&&X(e,sae(...i))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Ty]&&hI(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){E0(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Mm))):this.sort(this.getColumnNextConfig(n.col)))}}function fI(t,e,n){return(e=fae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fae(t){var e=gae(t,"string");return typeof e=="symbol"?e:e+""}function gae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mae="multipleSelectionHandles",pae=160;class wae extends st{constructor(){super(...arguments),fI(this,"dragged",[]),fI(this,"lastSetCell",null)}static get PLUGIN_KEY(){return mae}static get PLUGIN_PRIORITY(){return pae}isEnabled(){return Wo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(r);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let o;if(_e(r.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1;if(_e(r.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(_e(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(_e(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(r){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function aS(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:o,crossHiddenColumns:r,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function HH(){return{label:"",isPlaceholder:!0}}function vae(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;M(t,r=>{const o=[];let s=0;n.push(o),M(r,a=>{const l=aS();if(ke(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=zt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=zt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(HH());return!u})});const i=Math.max(...Ke(n,r=>r.length));return M(n,r=>{if(r.length<i){const o=Ke(new Array(i-r.length),()=>aS());r.splice(r.length,0,...o)}}),n}function My(t,e,n){Cae(t,e),e.set(t,n)}function Cae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e){return t.get(NH(t,e))}function jc(t,e,n){return t.set(NH(t,e),n),n}function NH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gI=["label","collapsible"];var Io=new WeakMap,Da=new WeakMap,_y=new WeakMap;class yae{constructor(){My(this,Io,[]),My(this,Da,0),My(this,_y,1/0)}setColumnsLimit(e){jc(_y,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];jc(Io,this,vae(e,sr(_y,this))),jc(Da,this,sr(Io,this).length)}getData(){return sr(Io,this)}mergeWith(e){M(e,n=>{let{row:i,col:r,...o}=n;const s=this.getHeaderSettings(i,r);s!==null&&tn(s,o,gI)})}map(e){M(sr(Io,this),n=>{M(n,i=>{const r=e({...i});ke(r)&&tn(i,r,gI)})})}getHeaderSettings(e,n){var i;if(e>=sr(Da,this)||e<0)return null;const r=sr(Io,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=sr(Da,this)||e<0)return r;const o=sr(Io,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return sr(Da,this)}getColumnsCount(){return sr(Da,this)>0?sr(Io,this)[0].length:0}clear(){jc(Io,this,[]),jc(Da,this,0)}}function Iy(t,e,n){return(e=bae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bae(t){var e=Sae(t,"string");return typeof e=="symbol"?e:e+""}function Sae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DH="DF-pre-order";function LH(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=LH.call(this.childs[i],t,e)}return n}const Rae="DF-post-order";function $H(t,e){for(let n=0;n<this.childs.length;n++)if($H.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const kH="BF";function Eae(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const Tae=kH,mI=new Map([[DH,LH],[Rae,$H],[kH,Eae]]);class zm{constructor(e){Iy(this,"data",{}),Iy(this,"parent",null),Iy(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new zm({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tae;if(!mI.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);mI.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function Py(t,e,n){Mae(t,e),e.set(t,n)}function Mae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wn(t,e){return t.get(FH(t,e))}function _ae(t,e,n){return t.set(FH(t,e),n),n}function FH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jl=new WeakMap,La=new WeakMap,eu=new WeakMap;class Iae{constructor(e){Py(this,Jl,new Map),Py(this,La,new Map),Py(this,eu,null),_ae(eu,this,e)}getRoots(){return Array.from(Wn(Jl,this).values())}getRootByColumn(e){let n;return Wn(La,this).has(e)&&(n=Wn(Jl,this).get(Wn(La,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-Wn(La,this).get(n);let o=0,s;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(r>=o&&r<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Wn(La,this).clear(),M(Wn(Jl,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)Wn(La,this).set(r,e);e+=i})}buildTree(){this.clear();const e=Wn(eu,this).getColumnsCount();let n=0;for(;n<e;){const i=Wn(eu,this).getHeaderSettings(0,n),r=new zm;Wn(Jl,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Wn(eu,this).getHeadersSettings(i,n,r);i+=1,M(o,s=>{const a={...s,headerLevel:i-1,columnIndex:n};let l;i===1?(e.data=a,l=e):(l=new zm(a),e.addChild(l)),i<Wn(eu,this).getLayersCount()&&this.buildLeaves(l,n,i,s.origColspan),n+=s.origColspan})}clear(){Wn(Jl,this).clear(),Wn(La,this).clear()}}function VH(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let o=1;o<i.colspan;o++)e(i.columnIndex+o)})}function Ym(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Gm(t){return Ym(t,"origColspan")===t.data.origColspan}function k0(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Gm(t))return k0(n[0]);e.isCollapsed=!1;const r=n.slice(1),o=new Set;let s=0;if(r.length>0)M(r,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,VH(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Gm(a)&&(l.isCollapsed=Ym(a,"isCollapsed"))}),{rollbackModification:()=>F0(t),affectedColumns:Array.from(o),colspanCompensation:s}}function F0(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Gm(t))return F0(i[0]);n.isCollapsed=!0;const o=i.slice(1),s=new Set;if(o.length>0)M(o,l=>{VH(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Ym(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Gm(l)&&(u.isCollapsed=Ym(l,"isCollapsed"))}),{rollbackModification:()=>k0(t),affectedColumns:Array.from(s),colspanCompensation:a}}function Pae(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(gt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function Oae(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(gt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const pI=new Map([["collapse",F0],["expand",k0],["hide-column",Pae],["show-column",Oae]]);function xae(t,e,n){if(!pI.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return pI.get(t)(e,n)}function yg(t){const e=[];return M(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=r,u=Hae(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(HH());else{const g=Aae(r);g.isRoot=!0,u.push(g),c=!0}})}),e}function Aae(t){const{crossHiddenColumns:e,...n}=aS(t);return n}function Hae(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function Oy(t,e,n){Nae(t,e),e.set(t,n)}function Nae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uc(t,e,n){return t.set(WH(t,e),n),n}function Vt(t,e){return t.get(WH(t,e))}function WH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ur=new WeakMap,ei=new WeakMap,$a=new WeakMap;class Dae{constructor(){Oy(this,Ur,new yae),Oy(this,ei,new Iae(Vt(Ur,this))),Oy(this,$a,[[]])}setState(e){Vt(Ur,this).setData(e);let n=!1;try{Vt(ei,this).buildTree()}catch{Vt(ei,this).clear(),Vt(Ur,this).clear(),n=!0}return Uc($a,this,yg(Vt(ei,this).getRoots())),n}setColumnsLimit(e){Vt(Ur,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ke(e,i=>{let{row:r,...o}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...o}});Vt(Ur,this).mergeWith(n),Vt(ei,this).buildTree(),Uc($a,this,yg(Vt(ei,this).getRoots()))}mapState(e){Vt(Ur,this).map(e),Vt(ei,this).buildTree(),Uc($a,this,yg(Vt(ei,this).getRoots()))}mapNodes(e){return nn(Vt(ei,this).getRoots(),(n,i)=>(i.walkDown(r=>{const o=e(r.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=Vt(ei,this).getNode(n,i);let o;return r&&(o=xae(e,r,i),Uc($a,this,yg(Vt(ei,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=Vt($a,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Vt(ei,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=i-e+1;let o=!1,s=null;for(let a=e;a<=i;a++){const l=Vt(ei,this).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:g}=u.data;g||d<=r&&c>=e&&c+d-1<=i&&(s===null||h<s)&&(s=h)},DH)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:o}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Vt(Ur,this).getLayersCount()}getColumnsCount(){return Vt(Ur,this).getColumnsCount()}clear(){Uc($a,this,[]),Vt(Ur,this).clear(),Vt(ei,this).clear()}}function zc(t,e,n){return(e=Lae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lae(t){var e=$ae(t,"string");return typeof e=="symbol"?e:e+""}function $ae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kae{constructor(e,n){zc(this,"hot",void 0),zc(this,"nestedHeaderSettingsGetter",void 0),zc(this,"layersCount",0),zc(this,"container",void 0),zc(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let i=0;i<n;i++){const r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(r);this.widthsMap.setValueAtIndex(o,e[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=i.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),g=this.nestedHeaderSettingsGetter(l,h);if(g&&(!g.isPlaceholder||g.isHidden)){let m=g.label;s&&(m+='<button class="changeType"></button>'),gl(d,m),d.colSpan=g.colspan,u.appendChild(d)}}o.appendChild(u)}r.appendChild(o),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}const Fae=kae;function Vae(t,e){BH(t,e),e.add(t)}function wI(t,e,n){return(e=Wae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wae(t){var e=Bae(t,"string");return typeof e=="symbol"?e:e+""}function Bae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bg(t,e,n){BH(t,e),e.set(t,n)}function BH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(t,e,n){return t.set(Wt(t,e),n),n}function et(t,e){return t.get(Wt(t,e))}function Wt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vI="nestedHeaders",jae=280;var Ct=new WeakMap,ws=new WeakMap,Eh=new WeakMap,sv=new WeakMap,Kt=new WeakSet;class Uae extends st{constructor(){super(...arguments),Vae(this,Kt),bg(this,Ct,new Dae),bg(this,ws,null),bg(this,Eh,null),bg(this,sv,!1),wI(this,"ghostTable",new Fae(this.hot,(e,n)=>this.getHeaderSettings(e,n))),wI(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return vI}static get PLUGIN_PRIORITY(){return jae}isEnabled(){return!!this.hot.getSettings()[vI]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&ft(gt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Wt(Kt,this,sle).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,ale).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,Kae).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,Xae).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,qae).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,Zae).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,Qae).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,Jae).call(e,...r)}),this.addHook("afterSelection",()=>Wt(Kt,this,Sg).call(this)),this.addHook("afterSelectionFocusSet",()=>Wt(Kt,this,Sg).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,zae).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>Wt(Kt,this,tle).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,ile).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,rle).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,Yae).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,Gae).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,ele).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,nle).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Wt(Kt,e,ole).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Wt(Kt,this,Sg).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Wt(Kt,this,Sg).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();et(Ct,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=et(Ct,this).setState(e)),this.detectedOverlappedHeaders&&ft(gt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";et(Ct,this).triggerColumnModification(r,i)}),!et(ws,this)&&this.enabled&&Xa(ws,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:o,newValue:s}=i;if(r==="replace"){const a=s===!0?"hide-column":"show-column";et(Ct,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),et(Ct,this).clear(),et(ws,this).unsubscribe(),Xa(ws,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return et(Ct,this)}getLayersCount(){return et(Ct,this).getLayersCount()}getHeaderSettings(e,n){return et(Ct,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=i.childNodes[s];if(!a)break;const l=r.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),xe(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),xe(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),xe(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(r);u===null&&(u=r),o.removeAttribute("colspan"),xe(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:g}=(s=et(Ct,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(d||h)X(o,"hiddenHeader");else if(c>1){var m,w;const{wtOverlays:C}=l._wt,S=(m=C.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),R=(w=C.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o),E=S||R?Math.min(c,i-r):c;E>1&&o.setAttribute("colspan",E)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const C=o.querySelector("div.relative");C&&g&&g.length>0&&(xe(C,this.hot.getColumnMeta(u).headerClassName),X(C,g))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:o}=(i=et(Ct,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return o||r?"":this.hot.getColHeader(e,n)}destroy(){Xa(Ct,this,null),et(ws,this)!==null&&(et(ws,this).unsubscribe(),Xa(ws,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return et(Ct,this).getHeaderTreeNodeData(e.row,e.col)}}function Sg(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const r=et(Ct,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=r,o.visualCellRange.from.col=r,o.visualCellRange.to.col=r,o.commit()}}function zae(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const r=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=et(Ct,this).findLeftMostColumnIndex(n.row,n.col),a=et(Ct,this).findRightMostColumnIndex(n.row,n.col);return s<r&&a>o?t:s<r?s:a}function Yae(t,e,n){const i=et(Ct,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=et(Ct,this).getHeaderSettings(e,t);if(o===xR){if(!a)return i.columnIndex}else if(o===Gx&&(l>s-r||!a))return null;return t}function Gae(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let g=s;g<=l;g++){var r;const m=c+g,w=d-a;if(w===0)continue;((r=et(Ct,this).getHeaderTreeNodeData(g,d))===null||r===void 0?void 0:r.isRoot)===!1&&(t[m][w]="")}}}function Kae(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function Xae(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Xa(Eh,this,e.clone()),Xa(sv,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?o.push(r.getTopEndCorner().col,s,e.row):e.col>r.from.col?o.push(r.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(_p(t)||zs(t)&&l||cx(t))&&o.push(s,s+a-1,e.row),i.selectColumns(...o)}function qae(t,e,n,i){if(!this.hot.view.isMouseDown())return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:o,origColspan:s}=r,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;i.column=!0,i.cell=!0;const h=[],d=dt(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Zae(){Xa(sv,this,!1)}function Qae(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!et(sv,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:o}=et(Ct,this).getHeaderTreeNodeData(et(Eh,this).row,et(Eh,this).col);if(e.setHighlight(et(Eh,this)),o>e.getWidth()||r<n||r+o-1>i){const s=et(Ct,this).findTopMostEntireHeaderLevel(dt(n,r,r+o-1),dt(i,r,r+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Jae(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=et(Ct,this).findLeftMostColumnIndex(n.row,n.col),o=et(Ct,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=r&&e.col<=o?r-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=r&&e.col<=o?o+1:r,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function ele(t,e){const n=t.row,i=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),r=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),r&&(e.col=r.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),r&&(e.col=r.columnIndex+r.origColspan-1))}function tle(t){t.length=0;for(let e=0;e<et(Ct,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function nle(t){const e=et(Ct,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const o=et(Ct,this).findLeftMostColumnIndex(r,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),Hn(s)&&s<t.startColumn){n=s;break}}t.startColumn=i?et(Ct,this).getHeaderTreeNodeData(0,n).columnIndex:n}function ile(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function rle(t,e,n){var i;const{label:r}=(i=et(Ct,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function ole(t,e){if(t<0)return this.hot.getCell(t,et(Ct,this).findLeftMostColumnIndex(t,e),!0)}function sle(){this.updatePlugin()}function ale(t,e){e||this.updatePlugin()}function Yc(t,e,n){return(e=lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lle(t){var e=ule(t,"string");return typeof e=="symbol"?e:e+""}function ule(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cle{constructor(e,n){Yc(this,"hot",void 0),Yc(this,"data",null),Yc(this,"plugin",void 0),Yc(this,"parentReference",new WeakMap),Yc(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&M(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),i!=null&&s===i?{result:a,end:!0}:r!=null&&a===r?{result:s,end:!0}:(s+=1,a.__children&&M(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,i,r),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Fe(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(M(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();const s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,o;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);r=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(Ce(e[0],e[2],d=>{const g=this.translateTrimmedRow(d);r.push(this.getDataObject(g))}),Ce(0,r.length-2,d=>{this.detachFromParent(r[d],!1)}),i=r[r.length-1]):i=e;const o=this.getRowIndex(i),s=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),u.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];M(i,o=>{r.push(this.getDataObject(o))}),M(r,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let o=null,s=e;r&&r.__children&&r.__children.length===0?(o=r,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?i?o.__children.splice(s,n,...i):o.__children.splice(s,n):i?this.data.splice(s,n,...i):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||i||r?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const hle=cle;function CI(t,e,n){return(e=dle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dle(t){var e=fle(t,"string");return typeof e=="symbol"?e:e+""}function fle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gle{constructor(e,n){CI(this,"hot",void 0),CI(this,"plugin",void 0),this.hot=n,this.plugin=e}}const V0=gle;class $o extends V0{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(i),o=this.dataManager.getDataObject(i),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(M(l,c=>{c&&s.removeChild(c)}),X(n,$o.CSS_CLASSES.indicatorContainer),r){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",Ce(0,r-1,()=>{const d=c.createElement("SPAN");X(d,$o.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Me(c,[dl()]),X(n,$o.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(X(c,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.expandButton}`),u&&Me(n,[ji(!1)])):(X(c,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.collapseButton}`),u&&Me(n,[ji(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const jH=$o;class mle extends V0{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),M(i.lastCollapsedRows,(a,l)=>{a>=r&&a<o&&(i.lastCollapsedRows[l]=a+s)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,o)=>{Ce(r,r+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&M(o.__children,l=>{r.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(r,!0,!1),i&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];M(e,o=>{r.push(...this.collapseChildren(o,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return M(e,o=>{r.push(o),n&&this.collapseChildRows(o,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);M(r.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return M(e,o=>{r.push(o),n&&this.expandChildRows(o,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);M(r.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&M(o.__children,l=>{const u=this.dataManager.getRowIndex(l);r.push(u)}),a=this.expandRows(r,!0,!1),i&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];M(e,o=>{r.push(...this.expandChildren(o,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];M(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];M(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&M(n.__children,r=>{const o=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);_e(e.target,jH.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),Xi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const ple=mle;function wle(t,e,n){vle(t,e),e.set(t,n)}function vle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cle(t,e,n){return(e=yle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yle(t){var e=ble(t,"string");return typeof e=="symbol"?e:e+""}function ble(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sle(t,e){return t.get(Rle(t,e))}function Rle(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yI=new WeakMap;class Ele extends V0{constructor(){super(...arguments),Cle(this,"dataManager",this.plugin.dataManager),wle(this,yI,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(lw)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(uw)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,e.items.length-1,i=>{if(i===0)return M(n,(r,o)=>{e.items.splice(i+o,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Ce(0,e.items.length-1,n=>{const i=Sle(yI,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}const Tle=Ele;function Rg(t,e,n){return(e=Mle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mle(t){var e=_le(t,"string");return typeof e=="symbol"?e:e+""}function _le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ile{constructor(e){Rg(this,"plugin",void 0),Rg(this,"hot",void 0),Rg(this,"dataManager",void 0),Rg(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const s=i===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const u=e.map(m=>{if(!l)return!1;const w=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(w,a),w}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),g=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,g),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:o}=e;let s=!1;return Mt(r)&&(ft(gt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(o=>{i.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[i-1]<n?l=this.dataManager.translateTrimmedRow(n-i):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);r=this.dataManager.untranslateTrimmedRow(c),o=r}else e[i-1]<n?(o=n-1,r=o-i+1):(r=n,o=r+i-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(r,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function Ple(t,e){UH(t,e),e.add(t)}function bI(t,e,n){UH(t,e),e.set(t,n)}function UH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xy(t,e,n){return(e=Ole(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ole(t){var e=xle(t,"string");return typeof e=="symbol"?e:e+""}function xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zg(t,e){return t.get(dn(t,e))}function Km(t,e,n){return t.set(dn(t,e),n),n}function dn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xm="nestedRows",Ale=300,SI=Xm,Hle="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var av=new WeakMap,tu=new WeakMap,vn=new WeakSet;class Nle extends st{constructor(){super(...arguments),Ple(this,vn),xy(this,"dataManager",null),xy(this,"headersUI",null),xy(this,"collapsedRowsMap",null),bI(this,av,!1),bI(this,tu,!1)}static get PLUGIN_KEY(){return Xm}static get PLUGIN_PRIORITY(){return Ale}isEnabled(){return!!this.hot.getSettings()[Xm]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Sd),this.dataManager=new hle(this,this.hot),this.collapsingUI=new ple(this,this.hot),this.headersUI=new jH(this,this.hot),this.contextMenuUI=new Tle(this,this.hot),this.rowMoveController=new Ile(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Kle).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Xle).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,$le).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,kle).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Fle).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Lle).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Ble).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Wle).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,jle).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Ule).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,zle).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Yle).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Vle).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Gle).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dn(vn,e,Dle).call(e,...i)}),this.addHook("beforeLoadData",n=>dn(vn,this,RI).call(this,n)),this.addHook("beforeUpdateData",n=>dn(vn,this,RI).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:SI,relativeToGroup:Zs,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SI)}disableCoreAPIModifiers(){Km(tu,this,!0)}enableCoreAPIModifiers(){Km(tu,this,!1)}onModifyRowData(e){if(!Zg(tu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Zg(tu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return Zg(tu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function Dle(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function Lle(t,e,n){this.collapsingUI.toggleState(t,e,n)}function $le(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Km(av,this,!0),this.dataManager.getData().slice()}function kle(t){return this.contextMenuUI.appendOptions(t)}function Fle(t,e){this.headersUI.appendLevelIndicators(t,e)}function Vle(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Wle(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{Km(av,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Ble(t,e,n){const i=Array.from(n.reduce((r,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return r.add(o),Array.isArray(s)&&s.forEach(a=>r.add(this.dataManager.getRowIndex(a))),r}return r.add(o)},new Set));n.length=0,n.push(...i)}function jle(){this.collapsingUI.collapsedRowsStash.stash()}function Ule(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function zle(){this.collapsingUI.collapsedRowsStash.stash()}function Yle(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Gle(){this.dataManager.rewriteCache()}function Kle(){this.headersUI.updateRowHeaderWidth()}function Xle(t,e){Zg(av,this)&&(e.skipRender=!0)}function RI(t){if(!rA(t)){mR(Hle),this.hot.getSettings()[Xm]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function Ay(t,e,n){return(e=qle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qle(t){var e=Zle(t,"string");return typeof e=="symbol"?e:e+""}function Zle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qle{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Ay(this,"rootWindow",void 0),Ay(this,"prefix",void 0),Ay(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){M(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Jle=Qle;function eue(t,e,n){return(e=tue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tue(t){var e=nue(t,"string");return typeof e=="symbol"?e:e+""}function nue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}de.getSingleton().register("persistentStateSave");de.getSingleton().register("persistentStateLoad");de.getSingleton().register("persistentStateReset");const EI="persistentState",iue=0;class rue extends st{constructor(){super(...arguments),eue(this,"storage",void 0)}static get PLUGIN_KEY(){return EI}static get PLUGIN_PRIORITY(){return iue}isEnabled(){return!!this.hot.getSettings()[EI]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Jle(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function oue(t,e){sue(t,e),e.add(t)}function sue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hy(t,e,n){return(e=aue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aue(t){var e=lue(t,"string");return typeof e=="symbol"?e:e+""}function lue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ny="search",uue=190,cue="htSearchResult",hue=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},due=function(t,e,n){return Mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Mt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var Dy=new WeakSet;class fue extends st{constructor(){super(...arguments),oue(this,Dy),Hy(this,"callback",hue),Hy(this,"queryMethod",due),Hy(this,"searchResultClass",cue)}static get PLUGIN_KEY(){return Ny}static get PLUGIN_PRIORITY(){return uue}isEnabled(){return this.hot.getSettings()[Ny]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Ny];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return TI(Dy,e,MI).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return TI(Dy,e,MI).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return Ce(0,r-1,l=>{Ce(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||i)(e,c,h);if(m){const w={row:l,col:u,data:c};s.push(w)}d&&d(a,l,u,c,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){ke(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function MI(t,e,n,i,r,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function gue(t,e){mue(t,e),e.add(t)}function mue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eg(t,e,n){return(e=pue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pue(t){var e=wue(t,"string");return typeof e=="symbol"?e:e+""}function wue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ly(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vue="touchScroll",Cue=200;var Tg=new WeakSet;class yue extends st{constructor(){super(...arguments),gue(this,Tg),Eg(this,"scrollbars",[]),Eg(this,"clones",[]),Eg(this,"lockedCollection",!1),Eg(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return vue}static get PLUGIN_PRIORITY(){return Cue}static get SETTING_KEYS(){return!0}isEnabled(){return lR()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Ly(Tg,this,bue).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Ly(Tg,this,Sue).call(this)),this.addHook("afterMomentumScroll",()=>Ly(Tg,this,Rue).call(this))}}function bue(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function Sue(){this.freezeOverlays=!0,M(this.clones,t=>{X(t,"hide-tween")})}function Rue(){this.freezeOverlays=!1,M(this.clones,t=>{xe(t,"hide-tween"),X(t,"show-tween")}),this.hot._registerTimeout(()=>{M(this.clones,t=>{xe(t,"show-tween")})},400),M(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Eue(t,e){Tue(t,e),e.add(t)}function Tue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mue(t,e,n){return(e=_ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ue(t){var e=Iue(t,"string");return typeof e=="symbol"?e:e+""}function Iue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pue(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qg="trimRows",Oue=330;var _I=new WeakSet;class xue extends st{constructor(){super(...arguments),Eue(this,_I),Mue(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Qg}static get PLUGIN_PRIORITY(){return Oue}isEnabled(){return!!this.hot.getSettings()[Qg]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Sd),this.trimmedRowsMap.addLocalHook("init",()=>Pue(_I,this,Aue).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Qg];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),M(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;i&&s&&(M(e,l=>{o[l]=!1}),r=nn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&s)!==!1&&(i&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,r,i&&s,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function Aue(){const t=this.hot.getSettings()[Qg];Array.isArray(t)&&this.hot.batchExecution(()=>{M(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var zH={},Hue=Ks,Nue=zH,Due=Hue("iterator"),Lue=Array.prototype,$ue=function(t){return t!==void 0&&(Nue.Array===t||Lue[Due]===t)},kue=sP,II=ip,Fue=Qm,Vue=zH,Wue=Ks,Bue=Wue("iterator"),YH=function(t){if(!Fue(t))return II(t,Bue)||II(t,"@@iterator")||Vue[kue(t)]},jue=Rr,Uue=id,zue=Qo,Yue=np,Gue=YH,Kue=TypeError,Xue=function(t,e){var n=arguments.length<2?Gue(t):e;if(Uue(n))return zue(jue(n,t));throw new Kue(Yue(t)+" is not iterable")},que=SP,Zue=Rr,Que=Qo,Jue=np,ece=$ue,tce=ad,PI=ep,nce=Xue,ice=YH,OI=bS,rce=TypeError,Jg=function(t,e){this.stopped=t,this.result=e},xI=Jg.prototype,oce=function(t,e,n){var i=n&&n.that,r=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=que(e,i),u,c,h,d,g,m,w,C=function(R){return u&&OI(u,"normal",R),new Jg(!0,R)},S=function(R){return r?(Que(R),a?l(R[0],R[1],C):l(R[0],R[1])):a?l(R,C):l(R)};if(o)u=t.iterator;else if(s)u=t;else{if(c=ice(t),!c)throw new rce(Jue(t)+" is not iterable");if(ece(c)){for(h=0,d=tce(t);d>h;h++)if(g=S(t[h]),g&&PI(xI,g))return g;return new Jg(!1)}u=nce(t,c)}for(m=o?t.next:u.next;!(w=Zue(m,u)).done;){try{g=S(w.value)}catch(R){OI(u,"throw",R)}if(typeof g=="object"&&g&&PI(xI,g))return g}return new Jg(!1)},sce=Sr,ace=Xs,lce=Zm,uce=function(t,e,n){sce?ace.f(t,e,lce(0,n)):t[e]=n},cce=Mn,hce=oce,dce=uce;cce({target:"Object",stat:!0},{fromEntries:function(e){var n={};return hce(e,function(i,r){dce(n,i,r)},{AS_ENTRIES:!0}),n}});const GH="undoRedo",fce="undoRedo";function ie(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(i,r){const o=i&&i.length;if(!o||!i.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=i.reduce((c,h)=>(c.push([...h]),c),[]);M(l,c=>{c[1]=t.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new ie.ChangeAction(l,u)};e.done(a,r)}),t.addHook("afterCreateRow",(i,r,o)=>{e.done(()=>new ie.CreateRowAction(i,r),o)});const n=(i,r,o,s)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return Ce(o,s,c=>{Ce(i,r,h=>{const d=t.getCellMeta(h,c);if(Object.keys(d).length!==l){const g=Object.fromEntries(Object.entries(d).filter(m=>{let[w]=m;return a.includes(w)===!1}));u.push([d.visualRow,d.visualCol,g])}})}),u};t.addHook("beforeRemoveRow",(i,r,o,s)=>{const a=()=>{const l=t.toPhysicalRow(i),u=l+r-1,c=$n(e.instance.getSourceData(l,0,l+r-1,e.instance.countSourceCols()-1));return new ie.RemoveRowAction(l,c,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(l,u,0,t.countCols()-1))};e.done(a,s)}),t.addHook("afterCreateCol",(i,r,o)=>{e.done(()=>new ie.CreateColumnAction(i,r),o)}),t.addHook("beforeRemoveCol",(i,r,o,s)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+i)%e.instance.countCols(),c=u+r-1,h=[],d=[],g=[];Ce(l.length-1,C=>{const S=[],R=l[C];Ce(u,c,E=>{S.push(R[t.toPhysicalColumn(E)])}),h.push(S)}),Ce(r-1,C=>{g.push(t.toPhysicalColumn(u+C))}),Array.isArray(t.getSettings().colHeaders)&&Ce(r-1,C=>{d.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+C)]||null)});const m=t.columnIndexMapper.getIndexesSequence(),w=t.rowIndexMapper.getIndexesSequence();return new ie.RemoveColumnAction(u,g,h,d,m,w,t.getSettings().fixedColumnsStart,n(0,t.countRows(),u,c))};e.done(a,s)}),t.addHook("beforeCellAlignment",(i,r,o,s)=>{e.done(()=>new ie.CellAlignmentAction(i,r,o,s))}),t.addHook("beforeFilter",(i,r)=>{e.done(()=>new ie.FiltersAction(i,r))}),t.addHook("beforeRowMove",(i,r)=>{i!==!1&&e.done(()=>new ie.RowMoveAction(i,r))}),t.addHook("beforeColumnMove",(i,r)=>{i!==!1&&e.done(()=>new ie.ColumnMoveAction(i,r))}),t.addHook("beforeMergeCells",(i,r)=>{r||e.done(()=>new ie.MergeCellsAction(t,i))}),t.addHook("afterUnmergeCells",(i,r)=>{r||e.done(()=>new ie.UnmergeCellsAction(t,i))}),t.addHook("beforeColumnSort",(i,r,o)=>{o&&e.done(()=>new ie.ColumnSortAction(i,r))}),t.addHook("afterInit",()=>{e.init()})}ie.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const i=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",i,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};ie.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=$n(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const r=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{r.ignoreNewActions=!1,r.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};ie.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=$n(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const r=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{r.ignoreNewActions=!1,r.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};ie.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ie.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ie.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ie.prototype.isEnabled=function(){return this.enabled};ie.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,pce(t),this.registerShortcuts(),t.addHook("afterChange",KH)};ie.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,wce(t),this.unregisterShortcuts(),t.removeHook("afterChange",KH)};ie.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ie.Action=function(){};ie.Action.prototype.undo=function(){};ie.Action.prototype.redo=function(){};ie.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Tr(ie.ChangeAction,ie.Action);ie.ChangeAction.prototype.undo=function(t,e){const n=$n(this.changes),i=t.countEmptyRows(!0),r=t.countEmptyCols(!0);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let s=0,a=n.length;s<a;s++){const[l,u]=n[s];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&i===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&u+1+t.getSettings().minSpareCols===t.countCols()&&r===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(u+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const o=t.getSelectedLast();if(o!==void 0){const[s,a]=n[0],[l,u]=o,c=t.view.getFirstFullyVisibleRow(),h=t.view.getFirstFullyVisibleColumn(),d=s>=c,g=a>=h;if((d&&g)===!1&&(l!==s||u!==a)===!0){const C={row:s,col:a};d===!1&&(C.verticalSnap="top"),g===!1&&(C.horizontalSnap="start"),t.scrollViewportTo(C)}}t.selectCells(this.selected,!1,!1)};ie.ChangeAction.prototype.redo=function(t,e){const n=$n(this.changes);for(let i=0,r=n.length;i<r;i++)n[i].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};ie.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Tr(ie.CreateRowAction,ie.Action);ie.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),i=t.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ie.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ie.RemoveRowAction=function(t,e,n,i,r,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=i,this.rowIndexesSequence=r,this.removedCellMetas=o};Tr(ie.RemoveRowAction,ie.Action);ie.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((r,o)=>{Object.keys(r).forEach(s=>{const a=parseInt(s,10);i.push([this.index+o,isNaN(a)?s:a,r[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(r=>{let[o,s,a]=r;t.setCellMetaObject(o,s,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ie.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ie.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Tr(ie.CreateColumnAction,ie.Action);ie.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ie.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ie.RemoveColumnAction=function(t,e,n,i,r,o,s,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=i,this.columnPositions=r.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a};Tr(ie.RemoveColumnAction,ie.Action);ie.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),r=(u,c,h)=>h[this.indexes.indexOf(i[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ke(this.data[u],r));const a=Ke(this.headers,r),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),M(t.getSourceDataArray(),(u,c)=>{M(i,(h,d)=>{u[h]=s[c][d],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&M(a,(u,c)=>{t.getSettings().colHeaders[i[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;t.setCellMetaObject(c,h,d)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};ie.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ie.CellAlignmentAction=function(t,e,n,i){this.stateBefore=t,this.range=e,this.type=n,this.alignment=i};ie.CellAlignmentAction.prototype.undo=function(t,e){M(this.range,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&t.setCellMeta(i,r,"className",this.stateBefore[i][r]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};ie.CellAlignmentAction.prototype.redo=function(t,e){Cs(this.range,this.type,this.alignment,(n,i)=>t.getCellMeta(n,i),(n,i,r,o)=>t.setCellMeta(n,i,r,o)),t.addHookOnce("afterViewRender",e),t.render()};ie.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"};Tr(ie.FiltersAction,ie.Action);ie.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&n.conditionCollection.importAllConditions(this.previousConditionsStack),n.filter()};ie.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class gce extends ie.Action{constructor(e,n){super(),this.cellRange=n;const i=this.cellRange.getTopStartCorner(),r=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(i.row,i.col,r.row,r.col)}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}ie.MergeCellsAction=gce;class mce extends ie.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}ie.UnmergeCellsAction=mce;ie.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};Tr(ie.RowMoveAction,ie.Action);ie.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),D0(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(r=>{let{from:o,to:s}=r;o<s&&(s-=1),n.moveRow(s,o)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ie.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};ie.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Tr(ie.ColumnMoveAction,ie.Action);ie.ColumnMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),D0(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(r=>{let{from:o,to:s}=r;o<s&&(s-=1),n.moveColumn(s,o)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};ie.ColumnMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),n.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};ie.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e};Tr(ie.ColumnSortAction,ie.Action);ie.ColumnSortAction.prototype.undo=function(t,e){const n=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting"),r=i.isEnabled()?i:n;this.previousSortState.length?r.sort(this.previousSortState):r.clearSort(),e()};ie.ColumnSortAction.prototype.redo=function(t,e){const n=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),e()};ie.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ie.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),i={runOnlyIf:r=>!r.altKey,group:GH};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)};ie.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(GH)};function KH(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function pce(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function wce(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Hd=de.getSingleton();Hd.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Hd.register("beforeUndo");Hd.register("afterUndo");Hd.register("beforeRedo");Hd.register("afterRedo");ie.PLUGIN_KEY=fce;ie.SETTING_KEYS=!0;function vce(){it(ah),it(v5),it(lh),it(eZ),it(lZ),it(m1),it(iQ),it(UQ),it(tv),it(uee),it(Dee),it(jee),it(rv),it(yte),it(yie),it(Jie),it(Tre),it(Lre),it(Kre),it(loe),it(voe),it(Foe),it(Koe),it(Ase),it(dae),it(wae),it(Uae),it(Nle),it(rue),it(fue),it(yue),it(xue),it(ie)}function Cce(){Y8(),c7(),C7(),F7(),vce()}function yce(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const i=this.first();let r=i.data("handsontable");if(typeof n!="string"){const u=n||{};return r?r.updateSettings(u):(r=new t.Core(i[0],u),i.data("handsontable",r),r.init()),i}let o;if(r)if(typeof r[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=r[n].call(r,...a),n==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var $y,ky,Fy,Vy,Wy;Cce();yce(oe);oe.__GhostTable=y0;oe._getListenersCounter=VG;oe._getRegisteredMapsCounter=_q;oe.EventManager=Yi;const bce=[Yz,eG,fq,d7,ZY,NY,qz,x2,qY,Qz,iG,O2],Sce=[OY,rG];oe.helper={};oe.dom={};M(bce,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(oe.helper[e]=t[e])})});M(Sce,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(oe.dom[e]=t[e])})});oe.cellTypes=($y=oe.cellTypes)!==null&&$y!==void 0?$y:{};M(k4(),t=>{oe.cellTypes[t]=n0(t)});oe.cellTypes.registerCellType=Ai;oe.cellTypes.getCellType=n0;oe.editors=(ky=oe.editors)!==null&&ky!==void 0?ky:{};M(HG(),t=>{oe.editors[`${Ln(t)}Editor`]=fm(t)});oe.editors.registerEditor=ri;oe.editors.getEditor=fm;oe.renderers=(Fy=oe.renderers)!==null&&Fy!==void 0?Fy:{};M(Y2(),t=>{const e=gm(t);t==="base"&&(oe.renderers.cellDecorator=e),oe.renderers[`${Ln(t)}Renderer`]=e});oe.renderers.registerRenderer=gi;oe.renderers.getRenderer=gm;oe.validators=(Vy=oe.validators)!==null&&Vy!==void 0?Vy:{};M(X2(),t=>{oe.validators[`${Ln(t)}Validator`]=SR(t)});oe.validators.registerValidator=Va;oe.validators.getValidator=SR;oe.plugins=(Wy=oe.plugins)!==null&&Wy!==void 0?Wy:{};M(bR(),t=>{oe.plugins[t]=Cd(t)});oe.plugins[`${Ln(st.PLUGIN_KEY)}Plugin`]=st;oe.plugins.registerPlugin=it;oe.plugins.getPlugin=Cd;/**
 * @preserve
 * Authors: soakit, HChenZi
 * Last updated: Mar 09, 2023
 *
 * Description: Definition file for Chinese - China language-country.
 */const Rce={languageCode:"zh-CN",[Hp]:"ä¸æ¹æå¥è¡",[Np]:"ä¸æ¹æå¥è¡",[Dp]:"å·¦æ¹æå¥å",[Lp]:"å³æ¹æå¥å",[$p]:["ç§»é¤è¯¥è¡","ç§»é¤å¤è¡"],[kp]:["ç§»é¤è¯¥å","ç§»é¤å¤å"],[Fp]:"æ¤é",[Vp]:"æ¢å¤",[Lh]:"åªè¯»",[Wp]:"æ¸ç©ºè¯¥å",[tw]:"å¯¹é½",[$h]:"å·¦å¯¹é½",[kh]:"æ°´å¹³å±ä¸­",[Fh]:"å³å¯¹é½",[Vh]:"ä¸¤ç«¯å¯¹é½",[Wh]:"é¡¶ç«¯å¯¹é½",[Bh]:"åç´å±ä¸­",[jh]:"åºç«¯å¯¹é½",[Gp]:"å»ç»è¯¥å",[Kp]:"åæ¶å»ç»",[nw]:"è¾¹æ¡",[iw]:"ä¸",[rw]:"å³",[ow]:"ä¸",[sw]:"å·¦",[aw]:"ç§»é¤è¾¹æ¡",[Zp]:"æå¥æ¹æ³¨",[Qp]:"ç¼è¾æ¹æ³¨",[Jp]:"å é¤æ¹æ³¨",[ew]:"åªè¯»æ¹æ³¨",[Xp]:"åå¹¶",[qp]:"åæ¶åå¹¶",[Bp]:"å¤å¶",[jp]:"å¸¦æ é¢çå¤å¶",[Up]:"å¸¦æ é¢ç»çå¤å¶",[zp]:"ä»å¤å¶æ é¢",[Yp]:"åªå",[lw]:"æå¥å­è¡",[uw]:"ä¸æ¯è¡åç¦»",[cw]:["éèè¯¥å","éèå¤å"],[hw]:["æ¾ç¤ºè¯¥å","æ¾ç¤ºå¤å"],[dw]:["éèè¯¥è¡","éèå¤è¡"],[fw]:["æ¾ç¤ºè¯¥è¡","æ¾ç¤ºå¤è¡"],[Rd]:"æ ",[gw]:"ä¸ºç©º",[mw]:"ä¸ä¸ºç©º",[pw]:"ç­äº",[ww]:"ä¸ç­äº",[vw]:"å¼å¤´æ¯",[Cw]:"ç»å°¾æ¯",[yw]:"åå«",[bw]:"ä¸åå«",[Sw]:"å¤§äº",[Rw]:"å¤§äºæç­äº",[Ew]:"å°äº",[Tw]:"å°äºæç­äº",[Mw]:"å¨æ­¤èå´",[_w]:"ä¸å¨æ­¤èå´",[Iw]:"ä¹å",[Pw]:"ä¹å",[Ow]:"ä»å¤©",[xw]:"æå¤©",[Aw]:"æ¨å¤©",[Uh]:"ç©ºç½ååæ ¼",[Hw]:"ææ¡ä»¶è¿æ»¤",[Nw]:"æå¼è¿æ»¤",[Dw]:"ä¸",[Ed]:"æ",[Lw]:"å¨é",[$w]:"æ¸é¤",[kw]:"ç¡®è®¤",[Fw]:"åæ¶",[Vw]:"æç´¢",[Ww]:"å¼",[Bw]:"ç¬¬äºå¼"},Ece=Rce;JR(Ece);const Tce=function(t,e,n,i,r,o,s){if(oe.renderers.getRenderer("text")(t,e,n,i,r,o,s),s.style){const a=e.style;Object.assign(a,s.style)}};oe.renderers.registerRenderer("styleRender",Tce);const Mce=t=>{const e=fu(!0),n=t(),i={emit:(a,l)=>{e.value=!0,n==null||n.postMessage({type:a,payload:l})}},r={},o=[],s=[];return n==null||n.addEventListener("message",a=>{const{type:l,payload:u}=a.data,c=r[l];c!=null&&c.length&&c.forEach(h=>h(u)),o.forEach(h=>h(a))}),n==null||n.addEventListener("error",a=>{console.error(a),s.forEach(l=>l(a))}),QH(()=>{n==null||n.terminate()}),{loading:e,worker:i,onWorkerMessage:a=>o.push(a),onWorkerError:a=>s.push(a),onWorkerEvent:(a,l)=>{let u=r[a];u||(u=r[a]=[]),u.push(l)},mapEvents:a=>Array.isArray(a)?a.reduce((l,u)=>(l[u]=c=>i.emit(u,c),l),{}):Object.keys(a).reduce((l,u)=>{const c=a[u];return l[c]=h=>i.emit(u,h),l},{})}},_ce=JH({__name:"XlsxTable",props:{data:null,type:null},setup(t){const e=t,n=fu(null),i=fu([]),r=fu(0);let o;const s={language:"zh-CN",colHeaders:!0,rowHeaders:!0,autoRowSize:!1,autoColumnSize:!1,height:"100%",cells(m,w){const C=o==null?void 0:o.cell;return C&&Object.keys(C).length?C[w8(m,w)]:{}},columns(m){const w=o==null?void 0:o.columns;return w!=null&&w.length?w[m]:{}},colWidths(m){const w=o==null?void 0:o.colWidths;return typeof w=="number"?w:w&&w[m]||(o==null?void 0:o.defaults.colWidth)},rowHeights(m){const w=o==null?void 0:o.rowHeights;return typeof w=="number"?w:w&&w[m]||(o==null?void 0:o.defaults.rowHeight)},outsideClickDeselects:!1,licenseKey:"non-commercial-and-evaluation"},a=eN(()=>{var m;return(m=n.value)==null?void 0:m.hotInstance}),l=()=>e.type==="binary"?C8.create():v8.create(),{loading:u,worker:c,onWorkerEvent:h}=Mce(l),d=m=>{r.value!==m&&(r.value=m,c.emit("parseSheet",{sheet:r.value??i.value[0].id}))},g=()=>iN(()=>{setTimeout(()=>{var m;(m=a.value)==null||m.updateSettings({data:o==null?void 0:o.data,mergeCells:o==null?void 0:o.merge})},0)});return h("sheets",({sheets:m})=>{if(i.value=m,m.length){const[{id:w}]=m;r.value=w,c.emit("parseSheet",{sheet:r.value})}}),h("parseSheet",({sheetData:m})=>{o=m,g()}),tN(()=>e.data,()=>{c.emit("parseWorkbook",{workbook:e.data})}),nN(()=>{var m;(m=a.value)==null||m.addHook("afterUpdateSettings",()=>u.value=!1),c.emit("parseWorkbook",{workbook:e.data})}),{__sfc:!0,props:e,table:n,sheets:i,sheetIndex:r,sheetData:o,hotSettings:s,tableInstance:a,compositeWorkerFactory:l,loading:u,worker:c,onWorkerEvent:h,handleSheet:d,updateTable:g,HotTable:n8}}}),Ice=""+new URL("xlsx-08add3c8.png",import.meta.url).href,Pce=""+new URL("loading-43b144a3.gif",import.meta.url).href;var Oce=function(){var e=this,n=e._self._c,i=e._self._setupProxy;return n("div",{staticClass:"excel-wrapper"},[i.loading?n("div",{staticClass:"loading"},[n("img",{staticClass:"lg",attrs:{src:Ice,alt:"xlsx"}}),n("img",{staticClass:"sm",attrs:{src:Pce,alt:"loading"}}),e._v(" å è½½ä¸­ï¼è¯·èå¿ç­å¾... ")]):e._e(),n("div",{staticClass:"table-wrapper"},[n(i.HotTable,{ref:"table",attrs:{settings:i.hotSettings}})],1),n("div",{staticClass:"btn-group"},e._l(i.sheets,function(r){return n("button",{key:r.id,class:{active:i.sheetIndex===r.id},staticStyle:{padding:"0 30px"},on:{click:function(o){return i.handleSheet(r.id)}}},[e._v(" "+e._s(r.name)+" ")])}),0)])},xce=[],Ace=rN(_ce,Oce,xce,!1,null,"d33b0ee8",null,null);const Zce=Ace.exports;export{Zce as default};
