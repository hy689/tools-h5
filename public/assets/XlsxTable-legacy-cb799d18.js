!function(){const t=["activeHeaderClassName"],e=["areaCornerVisible"],n=["columnClassName"],o=["cellCornerVisible"],i=["border","visualCellRange"],r=["headerClassName"],s=["rowClassName"],l=["column"],a=["column"],h=["row","col"],c=["crossHiddenColumns"],u=["row"];let d,g,f,p,m,w,b,v,y,C,S,R,x,E,M,T,k,A,H,I,O,_,P,N,D,L,V,F,W,B,j=t=>t;function z(t){if(null==t)throw new TypeError("Cannot destructure "+t)}function U(t,e){if(null==t)return{};var n,o,i=function(t,e){if(null==t)return{};var n={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.includes(o))continue;n[o]=t[o]}return n}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(o=0;o<r.length;o++)n=r[o],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(n),!0).forEach((function(e){G(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function G(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}System.register(["./index-legacy-c19e608d.js","./worker-ref-legacy-1aabaeb5.js","./_commonjs-dynamic-modules-legacy-57769aa1.js"],(function(Y,G){"use strict";var K,X,q,Z,Q,J,tt,et,nt,ot,it,rt,st;return{setters:[t=>{K=t.c,X=t.V,q=t.r,Z=t.g,Q=t.a,J=t.d,tt=t.b,et=t.w,nt=t.o,ot=t.e,it=t.n},t=>{rt=t.r},t=>{st=t.c}],execute:function(){var lt=document.createElement("style");lt.textContent='/*!\n * Copyright (c) HANDSONCODE sp. z o. o.\n *\n * HANDSONTABLE is a software distributed by HANDSONCODE sp. z o. o., a Polish corporation based in\n * Gdynia, Poland, at Aleja Zwyciestwa 96-98, registered by the District Court in Gdansk under number\n * 538651, EU tax ID number: PL5862294002, share capital: PLN 62,800.00.\n *\n * This software is protected by applicable copyright laws, including international treaties, and dual-\n * licensed - depending on whether your use for commercial purposes, meaning intended for or\n * resulting in commercial advantage or monetary compensation, or not.\n *\n * If your use is strictly personal or solely for evaluation purposes, meaning for the purposes of testing\n * the suitability, performance, and usefulness of this software outside the production environment,\n * you agree to be bound by the terms included in the "handsontable-non-commercial-license.pdf" file.\n *\n * Your use of this software for commercial purposes is subject to the terms included in an applicable\n * license agreement.\n *\n * In any case, you must not make any such use of this software as to develop software which may be\n * considered competitive with this software.\n *\n * UNLESS EXPRESSLY AGREED OTHERWISE, HANDSONCODE PROVIDES THIS SOFTWARE ON AN "AS IS"\n * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, AND IN NO EVENT AND UNDER NO\n * LEGAL THEORY, SHALL HANDSONCODE BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY DIRECT,\n * INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING FROM\n * USE OR INABILITY TO USE THIS SOFTWARE.\n *\n * Version: 14.6.1\n * Release date: 17/10/2024 (built at 17/10/2024 09:16:26)\n */.handsontable .table td,.handsontable .table th{border-top:none}.handsontable tr{background:#fff}.handsontable td{background-color:inherit}.handsontable .table caption+thead tr:first-child td,.handsontable .table caption+thead tr:first-child th,.handsontable .table colgroup+thead tr:first-child td,.handsontable .table colgroup+thead tr:first-child th,.handsontable .table thead:first-child tr:first-child td,.handsontable .table thead:first-child tr:first-child th{border-top:1px solid #ccc}.handsontable .table-bordered{border:0;border-collapse:separate}.handsontable .table-bordered td,.handsontable .table-bordered th{border-left:none}.handsontable .table-bordered td:first-child,.handsontable .table-bordered th:first-child{border-left:1px solid #ccc}.handsontable .table>tbody>tr>td,.handsontable .table>tbody>tr>th,.handsontable .table>tfoot>tr>td,.handsontable .table>tfoot>tr>th,.handsontable .table>thead>tr>td,.handsontable .table>thead>tr>th{line-height:21px;padding:0}.col-lg-1.handsontable,.col-lg-10.handsontable,.col-lg-11.handsontable,.col-lg-12.handsontable,.col-lg-2.handsontable,.col-lg-3.handsontable,.col-lg-4.handsontable,.col-lg-5.handsontable,.col-lg-6.handsontable,.col-lg-7.handsontable,.col-lg-8.handsontable,.col-lg-9.handsontable,.col-md-1.handsontable,.col-md-10.handsontable,.col-md-11.handsontable,.col-md-12.handsontable,.col-md-2.handsontable,.col-md-3.handsontable,.col-md-4.handsontable,.col-md-5.handsontable,.col-md-6.handsontable,.col-md-7.handsontable,.col-md-8.handsontable,.col-md-9.handsontable .col-sm-1.handsontable,.col-sm-10.handsontable,.col-sm-11.handsontable,.col-sm-12.handsontable,.col-sm-2.handsontable,.col-sm-3.handsontable,.col-sm-4.handsontable,.col-sm-5.handsontable,.col-sm-6.handsontable,.col-sm-7.handsontable,.col-sm-8.handsontable,.col-sm-9.handsontable .col-xs-1.handsontable,.col-xs-10.handsontable,.col-xs-11.handsontable,.col-xs-12.handsontable,.col-xs-2.handsontable,.col-xs-3.handsontable,.col-xs-4.handsontable,.col-xs-5.handsontable,.col-xs-6.handsontable,.col-xs-7.handsontable,.col-xs-8.handsontable,.col-xs-9.handsontable{padding-left:0;padding-right:0}.handsontable .table-striped>tbody>tr:nth-of-type(2n){background-color:#fff}.handsontable{position:relative}.handsontable .hide{display:none}.handsontable .relative{position:relative}.handsontable .wtHider{width:0}.handsontable .wtSpreader{height:auto;position:relative;width:0}.handsontable div,.handsontable input,.handsontable table,.handsontable tbody,.handsontable td,.handsontable textarea,.handsontable th,.handsontable thead{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.handsontable input,.handsontable textarea{min-height:auto}.handsontable table.htCore{border-collapse:separate;border-spacing:0;border-width:0;cursor:default;margin:0;max-height:none;max-width:none;outline-width:0;table-layout:fixed;width:0}.handsontable col,.handsontable col.rowHeader{width:50px}.handsontable td,.handsontable th{background-color:#fff;border-bottom:1px solid #ccc;border-left-width:0;border-right:1px solid #ccc;border-top-width:0;empty-cells:show;height:22px;line-height:21px;outline:none;outline-width:0;overflow:hidden;padding:0 4px;vertical-align:top;white-space:pre-wrap}[dir=rtl].handsontable td,[dir=rtl].handsontable th{border-left:1px solid #ccc;border-right-width:0}.handsontable th:last-child{border-bottom:1px solid #ccc;border-left:none;border-right:1px solid #ccc}[dir=rtl].handsontable th:last-child{border-left:1px solid #ccc;border-right:none}.handsontable td:first-of-type,.handsontable th:first-child{border-left:1px solid #ccc}[dir=rtl].handsontable td:first-of-type,[dir=rtl].handsontable th:first-child{border-right:1px solid #ccc}.handsontable .ht_clone_top th:nth-child(2){border-left-width:0;border-right:1px solid #ccc}[dir=rtl].handsontable .ht_clone_top th:nth-child(2){border-left:1px solid #ccc;border-right-width:0}.handsontable.htRowHeaders thead tr th:nth-child(2){border-left:1px solid #ccc}[dir=rtl].handsontable.htRowHeaders thead tr th:nth-child(2){border-right:1px solid #ccc}.handsontable tr:first-child td,.handsontable tr:first-child th{border-top:1px solid #ccc}.ht_master:not(.innerBorderInlineStart):not(.emptyColumns) tbody tr th,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns) thead tr th:first-child,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.htGhostTable) tbody tr th,.ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top):not(.htGhostTable) thead tr th:first-child{border-left:1px solid #ccc;border-right-width:0}[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns) tbody tr th,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns) thead tr th:first-child,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.htGhostTable) tbody tr th,[dir=rtl].ht_master:not(.innerBorderInlineStart):not(.emptyColumns)~.handsontable:not(.ht_clone_top):not(.htGhostTable) thead tr th:first-child{border-left-width:0;border-right:1px solid #ccc}.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom) thead tr:last-child th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr.lastChild th,.ht_master:not(.innerBorderTop):not(.innerBorderBottom)~.handsontable thead tr:last-child th{border-bottom-width:0}.handsontable th{background-color:#f0f0f0;color:#222;font-weight:400;text-align:center;white-space:nowrap}.handsontable thead th{padding:0}.handsontable th.active{background-color:#ccc}.handsontable thead th .relative{padding:2px 4px}.handsontable span.colHeader{display:inline-block;line-height:1.1}.handsontable .wtBorder{font-size:0;position:absolute}.handsontable .wtBorder.hidden{display:none!important}.handsontable .wtBorder.current{z-index:10}.handsontable .wtBorder.area{z-index:8}.handsontable .wtBorder.fill{z-index:6}.handsontable .wtBorder.corner{cursor:crosshair;font-size:0}.ht_clone_master{z-index:100}.ht_clone_inline_start{z-index:120}.ht_clone_bottom{z-index:130}.ht_clone_bottom_inline_start_corner{z-index:150}.ht_clone_top{z-index:160}.ht_clone_top_inline_start_corner{z-index:180}.handsontable col.hidden{width:0!important}.handsontable tr.hidden,.handsontable tr.hidden td,.handsontable tr.hidden th{display:none}.ht_clone_bottom,.ht_clone_inline_start,.ht_clone_top,.ht_master{overflow:hidden}.ht_master .wtHolder{overflow:auto}.handsontable .ht_clone_inline_start table.htCore>thead,.handsontable .ht_master table.htCore>tbody>tr>th,.handsontable .ht_master table.htCore>thead{visibility:hidden}.ht_clone_bottom .wtHolder,.ht_clone_inline_start .wtHolder,.ht_clone_top .wtHolder{overflow:hidden}.handsontable{color:#373737;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;font-size:13px;font-weight:400;touch-action:manipulation}.handsontable a{color:#104acc}.handsontable.htAutoSize{left:-99000px;position:absolute;top:-99000px;visibility:hidden}.handsontable td.htInvalid{background-color:#ffbeba!important}.handsontable td.htNoWrap{white-space:nowrap}.handsontable td.invisibleSelection,.handsontable th.invisibleSelection{outline:none}.handsontable td.invisibleSelection::selection,.handsontable th.invisibleSelection::selection{background:hsla(0,0%,100%,0)}.hot-display-license-info{color:#373737;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;font-size:10px;font-weight:400;padding:5px 0 3px;text-align:left}.hot-display-license-info a{color:#104acc;font-size:10px}.handsontable .htFocusCatcher{border:0;height:0;margin:0;opacity:0;padding:0;position:absolute;width:0;z-index:-1}.handsontable .manualColumnResizer{cursor:col-resize;height:25px;position:absolute;top:0;width:5px;z-index:210}.handsontable .manualRowResizer{cursor:row-resize;height:5px;left:0;position:absolute;width:50px;z-index:210}.handsontable .manualColumnResizer.active,.handsontable .manualColumnResizer:hover,.handsontable .manualRowResizer.active,.handsontable .manualRowResizer:hover{background-color:#34a9db}.handsontable .manualColumnResizerGuide{background-color:#34a9db;border-left:none;border-right:1px dashed #777;display:none;margin-left:5px;margin-right:unset;position:absolute;right:unset;top:0;width:0}[dir=rtl].handsontable .manualColumnResizerGuide{border-left:1px dashed #777;border-right:none;left:unset;margin-left:unset;margin-right:5px}.handsontable .manualRowResizerGuide{background-color:#34a9db;border-bottom:1px dashed #777;bottom:0;display:none;height:0;left:0;margin-top:5px;position:absolute}.handsontable .manualColumnResizerGuide.active,.handsontable .manualRowResizerGuide.active{display:block;z-index:209}.handsontable td.area,.handsontable td.area-1,.handsontable td.area-2,.handsontable td.area-3,.handsontable td.area-4,.handsontable td.area-5,.handsontable td.area-6,.handsontable td.area-7{position:relative}.handsontable td.area-1:before,.handsontable td.area-2:before,.handsontable td.area-3:before,.handsontable td.area-4:before,.handsontable td.area-5:before,.handsontable td.area-6:before,.handsontable td.area-7:before,.handsontable td.area:before{background:#005eff;bottom:0;content:"";left:0;position:absolute;right:0;top:0}.handsontable td.area:before{opacity:.1}.handsontable td.area-1:before{opacity:.2}.handsontable td.area-2:before{opacity:.27}.handsontable td.area-3:before{opacity:.35}.handsontable td.area-4:before{opacity:.41}.handsontable td.area-5:before{opacity:.47}.handsontable td.area-6:before{opacity:.54}.handsontable td.area-7:before{opacity:.58}.handsontable tbody th.current,.handsontable thead th.current{box-shadow:inset 0 0 0 2px #4b89ff}.handsontable tbody th.ht__highlight,.handsontable thead th.ht__highlight{background-color:#dcdcdc}.handsontable tbody th.ht__active_highlight,.handsontable thead th.ht__active_highlight{background-color:#8eb0e7;color:#000}.handsontableInput{background-color:#fff;border:none;border-radius:0;box-shadow:inset 0 0 0 2px #5292f7;color:#000;display:block;font-family:inherit;font-size:inherit;line-height:21px;margin:0;outline-width:0;padding:1px 5px 0;resize:none}.handsontableInput:focus{outline:none}.handsontableInputHolder{left:0;position:absolute;top:0}.htSelectEditor{-webkit-appearance:menulist-button!important;border:2px solid #4b89ff;position:absolute;width:auto}.htSelectEditor:focus{outline:none}.handsontable .htDimmed{color:#777}.handsontable .htSubmenu{position:relative}.handsontable .htSubmenu :after{color:#777;content:"▶";font-size:9px;position:absolute;right:5px}[dir=rtl].handsontable .htSubmenu :after{content:""}[dir=rtl].handsontable .htSubmenu :before{color:#777;content:"◀";font-size:9px;left:5px;position:absolute}.handsontable .htLeft{text-align:left}.handsontable .htCenter{text-align:center}.handsontable .htRight{text-align:right}.handsontable .htJustify{text-align:justify}.handsontable .htTop{vertical-align:top}.handsontable .htMiddle{vertical-align:middle}.handsontable .htBottom{vertical-align:bottom}.handsontable .htPlaceholder{color:#999}.handsontable.listbox{margin:0}.handsontable.listbox .ht_master table{background:#fff;border:1px solid #ccc;border-collapse:separate}.handsontable.listbox td,.handsontable.listbox th,.handsontable.listbox tr:first-child td,.handsontable.listbox tr:first-child th,.handsontable.listbox tr:last-child th{border-color:transparent!important}.handsontable.listbox td,.handsontable.listbox th{text-overflow:ellipsis;white-space:nowrap}.handsontable.listbox td.htDimmed{color:inherit;cursor:default;font-style:inherit}.handsontable.listbox .wtBorder{visibility:hidden}.handsontable.listbox tr td.current,.handsontable.listbox tr:hover td{background:#eee}.ht_editor_hidden{z-index:-1}.ht_editor_visible{z-index:200}.handsontable td.htSearchResult{background:#fcedd9;color:#583707}.handsontable.mobile,.handsontable.mobile .wtHolder{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch}.handsontable.mobile .handsontableInput:focus{-webkit-appearance:none;-webkit-box-shadow:inset 0 0 0 2px #5292f7;-moz-box-shadow:inset 0 0 0 2px #5292f7;box-shadow:inset 0 0 0 2px #5292f7}.handsontable .bottomSelectionHandle,.handsontable .bottomSelectionHandle-HitArea,.handsontable .topSelectionHandle,.handsontable .topSelectionHandle-HitArea{left:-10000px;right:unset;top:-10000px;z-index:9999}[dir=rtl].handsontable .bottomSelectionHandle,[dir=rtl].handsontable .bottomSelectionHandle-HitArea,[dir=rtl].handsontable .topSelectionHandle,[dir=rtl].handsontable .topSelectionHandle-HitArea{left:unset;right:-10000px}.handsontable.hide-tween{-webkit-animation:opacity-hide .3s;animation:opacity-hide .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}.handsontable.show-tween{-webkit-animation:opacity-show .3s;animation:opacity-show .3s;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards}/*!\n * Pikaday\n * Copyright © 2014 David Bushell | BSD & MIT license | https://dbushell.com/\n */.pika-single{background:#fff;border:1px solid;border-color:#ccc #ccc #bbb;color:#333;display:block;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;position:relative;z-index:9999}.pika-single:after,.pika-single:before{content:" ";display:table}.pika-single:after{clear:both}.pika-single.is-hidden{display:none}.pika-single.is-bound{box-shadow:0 5px 15px -5px rgba(0,0,0,.5);position:absolute}.pika-lendar{float:left;margin:8px;width:240px}.pika-title{position:relative;text-align:center}.pika-label{background-color:#fff;display:inline-block;font-size:14px;font-weight:700;line-height:20px;margin:0;overflow:hidden;padding:5px 3px;position:relative;z-index:9999}.pika-title select{cursor:pointer;left:0;margin:0;opacity:0;position:absolute;top:5px;z-index:9998}.pika-next,.pika-prev{background-color:transparent;background-position:50%;background-repeat:no-repeat;background-size:75% 75%;border:0;cursor:pointer;display:block;height:30px;opacity:.5;outline:none;overflow:hidden;padding:0;position:relative;text-indent:20px;white-space:nowrap;width:20px}.pika-next:hover,.pika-prev:hover{opacity:1}.is-rtl .pika-next,.pika-prev{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==);float:left}.is-rtl .pika-prev,.pika-next{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=);float:right}.pika-next.is-disabled,.pika-prev.is-disabled{cursor:default;opacity:.2}.pika-select{display:inline-block}.pika-table{border:0;border-collapse:collapse;border-spacing:0;width:100%}.pika-table td,.pika-table th{padding:0;width:14.2857142857%}.pika-table th{color:#999;font-weight:700;line-height:25px}.pika-button,.pika-table th{font-size:12px;text-align:center}.pika-button{background:#f5f5f5;border:0;box-sizing:border-box;-moz-box-sizing:border-box;color:#666;cursor:pointer;display:block;height:auto;line-height:15px;margin:0;outline:none;padding:5px;width:100%}.pika-week{color:#999;font-size:11px}.is-today .pika-button{color:#3af;font-weight:700}.has-event .pika-button,.is-selected .pika-button{background:#3af;border-radius:3px;box-shadow:inset 0 1px 3px #178fe5;color:#fff;font-weight:700}.has-event .pika-button{background:#005da9;box-shadow:inset 0 1px 3px #0076c9}.is-disabled .pika-button,.is-inrange .pika-button{background:#d5e9f7}.is-startrange .pika-button{background:#6cb31d;border-radius:3px;box-shadow:none;color:#fff}.is-endrange .pika-button{background:#3af;border-radius:3px;box-shadow:none;color:#fff}.is-disabled .pika-button{color:#999;cursor:default;opacity:.3;pointer-events:none}.is-outside-current-month .pika-button{color:#999;opacity:.3}.is-selection-disabled{cursor:default;pointer-events:none}.pika-button:hover,.pika-row.pick-whole-week:hover .pika-button{background:#ff8000;border-radius:3px;box-shadow:none;color:#fff}.pika-table abbr{border-bottom:none;cursor:help}.handsontable .htAutocompleteArrow{color:#bbb;cursor:default;float:right;font-size:10px;text-align:center;width:16px}[dir=rtl].handsontable .htAutocompleteArrow{float:left}.handsontable td.htInvalid .htAutocompleteArrow{color:#555}.handsontable td.htInvalid .htAutocompleteArrow:hover{color:#1a1a1a}.handsontable td .htAutocompleteArrow:hover{color:#777}.handsontable td.area .htAutocompleteArrow{color:#d3d3d3}.handsontable .htCheckboxRendererInput{display:inline-block}.handsontable .htCheckboxRendererInput.noValue{opacity:.5}.handsontable .htCheckboxRendererLabel{cursor:pointer;display:inline-block;font-size:inherit;vertical-align:middle}.handsontable .htCheckboxRendererLabel.fullWidth{width:100%}.handsontable .collapsibleIndicator{background:#eee;border:1px solid #a6a6a6;border-radius:10px;-webkit-box-shadow:0 0 0 6px #eee;-moz-box-shadow:0 0 0 6px #eee;box-shadow:0 0 0 3px #eee;color:#222;cursor:pointer;font-size:10px;height:10px;left:unset;line-height:8px;position:absolute;right:5px;text-align:center;top:50%;transform:translateY(-50%);width:10px}[dir=rtl].handsontable .collapsibleIndicator{left:5px;right:unset}.handsontable[dir=ltr] thead th:has(.collapsibleIndicator) div.htRight span.colHeader{margin-right:20px}.handsontable[dir=rtl] thead th:has(.collapsibleIndicator) div.htLeft span.colHeader{margin-left:20px}.handsontable .columnSorting{position:relative}.handsontable[dir=ltr] div.htRight span[class*=ascending],.handsontable[dir=ltr] div.htRight span[class*=descending]{margin-left:-10px;margin-right:10px}.handsontable[dir=rtl] div.htLeft span[class*=ascending],.handsontable[dir=rtl] div.htLeft span[class*=descending]{margin-left:10px;margin-right:-10px}.handsontable[dir=ltr] div.htRight span[class*=ascending]:only-child,.handsontable[dir=ltr] div.htRight span[class*=descending]:only-child{margin-left:-15px;margin-right:15px}.handsontable[dir=rtl] div.htLeft span[class*=ascending]:only-child,.handsontable[dir=rtl] div.htLeft span[class*=descending]:only-child{margin-left:15px;margin-right:-15px}.handsontable .columnSorting.sortAction:hover{cursor:pointer;text-decoration:underline}.handsontable span.colHeader.columnSorting:before{background-position-x:right;background-repeat:no-repeat;background-size:contain;content:"";height:10px;left:unset;margin-top:-6px;padding-left:8px;padding-right:0;position:absolute;right:-9px;top:50%;width:5px}[dir=rtl].handsontable span.colHeader.columnSorting:before{background-position-x:left;left:-9px;padding-left:0;padding-right:8px;right:unset}.handsontable span.colHeader.columnSorting.ascending:before{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC)}.handsontable span.colHeader.columnSorting.descending:before{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII=)}.htGhostTable .htCore span.colHeader.columnSorting:not(.indicatorDisabled):before{content:"*";display:inline-block;padding-right:20px;position:relative}.handsontable .htCommentCell{position:relative}.handsontable .htCommentCell:after{border-left:6px solid transparent;border-right:none;border-top:6px solid #000;content:"";left:unset;position:absolute;right:0;top:0}[dir=rtl].handsontable .htCommentCell:after{border-left:none;border-right:6px solid transparent;left:0;right:unset}.htCommentsContainer .htComments{display:none;position:absolute;z-index:1059}.htCommentsContainer .htCommentTextArea{-webkit-appearance:none;background-color:#fff;border:none;border-left:3px solid #ccc;box-shadow:0 1px 3px rgba(0,0,0,.118),0 1px 2px rgba(0,0,0,.24);-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;font-size:12px;height:90px;outline:0!important;padding:5px;width:215px}[dir=rtl].htCommentsContainer .htCommentTextArea{border-left:none;border-right:3px solid #ccc}.htCommentsContainer .htCommentTextArea:focus{border-left:3px solid #5292f7;border-right:none;box-shadow:0 1px 3px rgba(0,0,0,.118),0 1px 2px rgba(0,0,0,.24),inset 0 0 0 1px #5292f7}[dir=rtl].htCommentsContainer .htCommentTextArea:focus{border-left:none;border-right:3px solid #5292f7}/*!\n * Handsontable ContextMenu\n */.htContextMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htContextMenu .ht_clone_bottom,.htContextMenu .ht_clone_bottom_inline_start_corner,.htContextMenu .ht_clone_inline_start,.htContextMenu .ht_clone_top,.htContextMenu .ht_clone_top_inline_start_corner{display:none}.htContextMenu .ht_master table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htContextMenu .ht_master table.htCore{border-left-width:2px;border-right-width:1px}.htContextMenu.handsontable:focus{outline:none}.htContextMenu .wtBorder{visibility:hidden}.htContextMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htContextMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htContextMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htContextMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htContextMenu table tbody tr td.current{background:#f3f3f3}.htContextMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htContextMenu table tbody tr td.htDisabled{color:#999;cursor:default}.htContextMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htContextMenu table tbody tr.htHidden{display:none}.htContextMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:6px}[dir=rtl].htContextMenu table tbody tr td .htItemWrapper{margin-left:6px;margin-right:10px}.htContextMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute;right:0}[dir=rtl].htContextMenu table tbody tr td div span.selected{left:0;right:4px}.htContextMenu .ht_master .wtHolder{overflow:hidden}textarea.HandsontableCopyPaste{opacity:0;outline:0 none!important;overflow:hidden;position:fixed!important;right:100%!important;top:0!important}/*!\n * Handsontable DropdownMenu\n */.handsontable .changeType{background:#eee;border:1px solid #bbb;border-radius:2px;color:#bbb;float:right;font-size:9px;line-height:9px;margin:3px 1px 0 5px;padding:2px}[dir=rtl].handsontable .changeType{float:left}.handsontable[dir=rtl] .changeType{margin:3px 5px 0 1px}.handsontable .changeType:before{content:"▼ "}.handsontable .changeType:hover{border:1px solid #777;color:#777;cursor:pointer}.htDropdownMenu:not(.htGhostTable){display:none;position:absolute;z-index:1060}.htDropdownMenu .ht_clone_bottom,.htDropdownMenu .ht_clone_bottom_inline_start_corner,.htDropdownMenu .ht_clone_inline_start,.htDropdownMenu .ht_clone_top,.htDropdownMenu .ht_clone_top_inline_start_corner{display:none}.htDropdownMenu table.htCore{border-color:#ccc;border-style:solid;border-width:1px 2px 2px 1px}[dir=rtl].htDropdownMenu table.htCore{border-left-width:2px;border-right-width:1px}.htDropdownMenu.handsontable:focus{outline:none}.htDropdownMenu .wtBorder{visibility:hidden}.htDropdownMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htDropdownMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htDropdownMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htDropdownMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htDropdownMenu table tbody tr td.current{background:#e9e9e9}.htDropdownMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;cursor:default;height:0;padding:0}.htDropdownMenu table tbody tr td.htDisabled{color:#999}.htDropdownMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htDropdownMenu:not(.htGhostTable) table tbody tr.htHidden{display:none}.htDropdownMenu table tbody tr td .htItemWrapper,[dir=rtl].htDropdownMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htDropdownMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute;right:0}[dir=rtl].htDropdownMenu table tbody tr td div span.selected{left:0;right:4px}.htDropdownMenu .ht_master .wtHolder{overflow:hidden}/*!\n * Handsontable Filters\n */.htFiltersConditionsMenu:not(.htGhostTable){display:none;position:absolute;z-index:1070}.htFiltersConditionsMenu .ht_clone_bottom,.htFiltersConditionsMenu .ht_clone_bottom_inline_start_corner,.htFiltersConditionsMenu .ht_clone_inline_start,.htFiltersConditionsMenu .ht_clone_top,.htFiltersConditionsMenu .ht_clone_top_inline_start_corner{display:none}.htFiltersConditionsMenu table.htCore{border-color:#bbb;border-style:solid;border-width:1px 2px 2px 1px}.htFiltersConditionsMenu .wtBorder{visibility:hidden}.htFiltersConditionsMenu table tbody tr td{background:#fff;border-width:0;cursor:pointer;overflow:hidden;padding:4px 6px 0;text-overflow:ellipsis;white-space:nowrap}.htFiltersConditionsMenu table tbody tr td:first-child{border-width:0}[dir=rtl].htFiltersConditionsMenu table tbody tr td:first-child{border-left-width:0;border-right-width:0}.htFiltersConditionsMenu table tbody tr td.htDimmed{color:#323232;font-style:normal}.htFiltersConditionsMenu table tbody tr td.current{background:#e9e9e9}.htFiltersConditionsMenu table tbody tr td.htSeparator{border-top:1px solid #e6e6e6;height:0;padding:0}.htFiltersConditionsMenu table tbody tr td.htDisabled{color:#999}.htFiltersConditionsMenu table tbody tr td.htDisabled:hover{background:#fff;color:#999;cursor:default}.htFiltersConditionsMenu table tbody tr td .htItemWrapper{margin-left:10px;margin-right:10px}.htFiltersConditionsMenu table tbody tr td div span.selected{left:4px;margin-top:-2px;position:absolute}.htFiltersConditionsMenu .ht_master .wtHolder{overflow:hidden}.handsontable .htMenuFiltering{border-bottom:1px dotted #ccc;height:135px;overflow:hidden}.handsontable .ht_master table td.htCustomMenuRenderer{background-color:#fff;cursor:auto}.handsontable .htFiltersMenuLabel{font-size:.75em}.handsontable .htFiltersMenuActionBar{padding-bottom:3px;padding-top:10px;text-align:center}.handsontable .htFiltersMenuCondition.border{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuCondition .htUIInput{padding:0 0 5px}.handsontable .htFiltersMenuValue{border-bottom:1px dotted #ccc!important}.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch{padding:0}.handsontable .htFiltersMenuCondition .htUIInput input,.handsontable .htFiltersMenuValue .htUIMultipleSelectSearch input{box-sizing:border-box;font-family:inherit;font-size:.75em;padding:4px;width:100%}.htUIMultipleSelect .ht_master .wtHolder{overflow-y:scroll}.handsontable .htFiltersActive .changeType{background-color:#d2e0d9;border:1px solid #509272;color:#18804e}.handsontable .htUISelectAll{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUISelectAll{margin-left:10px;margin-right:0}.handsontable .htUIClearAll,.handsontable .htUISelectAll{display:inline-block}.handsontable .htUIClearAll a,.handsontable .htUISelectAll a{font-size:.75em}.handsontable .htUISelectionControls{text-align:right}[dir=rtl].handsontable .htUISelectionControls{text-align:left}.handsontable .htCheckboxRendererInput{height:1em;margin:0 5px 0 0;vertical-align:middle}[dir=rtl].handsontable .htCheckboxRendererInput{margin-left:5px;margin-right:0}.handsontable .htUIInput{padding:3px 0 7px;position:relative;text-align:center}.handsontable .htUIInput input{border:1px solid #d2d1d1;border-radius:2px}.handsontable .htUIInputIcon{position:absolute}.handsontable .htUIInput.htUIButton{cursor:pointer;display:inline-block}.handsontable .htUIInput.htUIButton input{background-color:#eee;color:#000;cursor:pointer;font-family:inherit;font-size:.75em;font-weight:700;height:19px;min-width:64px}.handsontable .htUIInput.htUIButton input:hover{border-color:#b9b9b9}.handsontable .htUIInput.htUIButtonOK{margin-left:0;margin-right:10px}[dir=rtl].handsontable .htUIInput.htUIButtonOK{margin-left:10px;margin-right:0}.handsontable .htUIInput.htUIButtonOK input{background-color:#0f9d58;border-color:#18804e;color:#fff}.handsontable .htUIInput.htUIButtonOK input:focus-visible{background-color:#92dd8d;border-color:#7cb878;color:#000}.handsontable .htUIInput.htUIButtonOK input:hover{border-color:#1a6f46}.handsontable .htUISelect{cursor:pointer;margin-bottom:7px;position:relative}.handsontable .htUISelectCaption{background-color:#e8e8e8;border:1px solid #d2d1d1;border-radius:2px;font-family:inherit;font-size:.75em;font-weight:700;overflow:hidden;padding:3px 20px 3px 10px;text-overflow:ellipsis;white-space:nowrap}.handsontable .htUISelectCaption:hover{background-color:#e8e8e8;border:1px solid #b9b9b9}.handsontable .htUISelectDropdown:after{content:"▲";font-size:7px;position:absolute;right:10px;top:0}.handsontable .htUISelectDropdown:before{content:"▼";font-size:7px;position:absolute;right:10px;top:8px}.handsontable .htUIMultipleSelect .handsontable .htCore{border:none}.handsontable .htUIMultipleSelect .handsontable .htCore td:hover{background-color:#f5f5f5}.handsontable .htUIMultipleSelectSearch input{border:1px solid #d2d1d1;border-radius:2px;padding:3px}.handsontable .htUIRadio{display:inline-block;height:100%;margin-left:0;margin-right:5px}[dir=rtl].handsontable .htUIRadio{margin-left:5px;margin-right:0}.handsontable .htUIRadio:last-child{margin-right:0}.handsontable .htUIRadio>input[type=radio]{margin-left:0;margin-right:.5ex}[dir=rtl].handsontable .htUIRadio>input[type=radio]{margin-left:.5ex;margin-right:0}.handsontable .htUIRadio label{vertical-align:middle}.handsontable .htFiltersMenuOperators{padding-bottom:5px}.handsontable th.beforeHiddenColumn{position:relative}.handsontable th.afterHiddenColumn:before,.handsontable th.beforeHiddenColumn:after{color:#bbb;font-size:5pt;position:absolute;top:50%;transform:translateY(-50%)}.handsontable th.afterHiddenColumn{position:relative}.handsontable[dir=ltr] th.afterHiddenColumn div.htLeft{margin-left:10px}.handsontable[dir=ltr] th.beforeHiddenColumn div.htRight,.handsontable[dir=rtl] th.afterHiddenColumn div.htRight{margin-right:10px}.handsontable[dir=rtl] th.beforeHiddenColumn div.htLeft{margin-left:10px}.handsontable th.beforeHiddenColumn:after{content:"◀";right:1px}[dir=rtl].handsontable th.beforeHiddenColumn:after{content:"▶";left:1px;right:auto}.handsontable th.afterHiddenColumn:before{content:"▶";left:1px}[dir=rtl].handsontable th.afterHiddenColumn:before{content:"◀";left:auto;right:1px}/*!\n * Handsontable HiddenRows\n */.handsontable th.afterHiddenRow:after,.handsontable th.beforeHiddenRow:before{color:#bbb;font-size:6pt;left:2px;line-height:6pt;position:absolute}.handsontable th.afterHiddenRow,.handsontable th.beforeHiddenRow{position:relative}.handsontable th.beforeHiddenRow:before{bottom:2px;content:"▲"}.handsontable th.afterHiddenRow:after{content:"▼";top:2px}.handsontable.ht__selection--rows tbody th.afterHiddenRow.ht__highlight:after,.handsontable.ht__selection--rows tbody th.beforeHiddenRow.ht__highlight:before{color:#eee}.handsontable td.afterHiddenRow.firstVisibleRow,.handsontable th.afterHiddenRow.firstVisibleRow{border-top:1px solid #ccc}.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_inline_start td:first-of-type,.htRowHeaders .ht_master.innerBorderInlineStart~.ht_clone_top_inline_start_corner th:nth-child(2){border-left:0}.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight{cursor:move;cursor:-moz-grab;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualColumnMove.on-moving--columns *,.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight{cursor:move;cursor:-moz-grabbing;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer{display:none}.handsontable .ht__manualColumnMove--backlight,.handsontable .ht__manualColumnMove--guideline{display:none;height:100%;position:absolute}.handsontable .ht__manualColumnMove--guideline{background:#757575;margin-inline-end:0;margin-inline-start:-1px;top:0;width:2px;z-index:205}.handsontable .ht__manualColumnMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;pointer-events:none;z-index:205}.handsontable.on-moving--columns .ht__manualColumnMove--backlight,.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline{display:block}.handsontable .wtHider{position:relative}.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight{cursor:move;cursor:-moz-grab;cursor:-webkit-grab;cursor:grab}.handsontable.ht__manualRowMove.on-moving--rows *,.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight{cursor:move;cursor:-moz-grabbing;cursor:-webkit-grabbing;cursor:grabbing}.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer{display:none}.handsontable .ht__manualRowMove--backlight,.handsontable .ht__manualRowMove--guideline{display:none;position:absolute;width:100%}.handsontable .ht__manualRowMove--guideline{background:#757575;height:2px;left:0;margin-top:-1px;z-index:205}.handsontable .ht__manualRowMove--backlight{background:#343434;background:rgba(52,52,52,.25);display:none;pointer-events:none;z-index:205}.handsontable.on-moving--rows .ht__manualRowMove--backlight,.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline{display:block}.handsontable tbody td[rowspan][class*=area][class*=highlight]:not([class*=fullySelectedMergedCell]):before{opacity:0}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-0]:before,.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-multiple]:before{opacity:.1}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-1]:before{opacity:.2}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-2]:before{opacity:.27}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-3]:before{opacity:.35}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-4]:before{opacity:.41}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-5]:before{opacity:.47}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-6]:before{opacity:.54}.handsontable tbody td[rowspan][class*=area][class*=highlight][class*=fullySelectedMergedCell-7]:before{opacity:.58}.handsontable[dir=ltr] div.htRight span[class*=sort-]{margin-left:-15px;margin-right:15px}.handsontable[dir=rtl] div.htLeft span[class*=sort-]{margin-left:15px;margin-right:-15px}.handsontable[dir=ltr] div.htRight span[class*=sort-]:only-child{margin-left:-20px;margin-right:20px}.handsontable[dir=rtl] div.htLeft span[class*=sort-]:only-child{margin-left:20px;margin-right:-20px}.handsontable span.colHeader.columnSorting:after{font-size:8px;height:8px;left:unset;line-height:1.1;margin-top:-2px;padding-left:5px;padding-right:unset;position:absolute;right:-15px;text-decoration:underline;top:50%}[dir=rtl].handsontable span.colHeader.columnSorting:after{left:-15px;padding-left:unset;padding-right:5px;right:unset}.handsontable span.colHeader.columnSorting:after{text-decoration:none}.handsontable span.colHeader.columnSorting[class*=" sort-"]:after,.handsontable span.colHeader.columnSorting[class^=sort-]:after{content:"+"}.handsontable span.colHeader.columnSorting.sort-1:after{content:"1"}.handsontable span.colHeader.columnSorting.sort-2:after{content:"2"}.handsontable span.colHeader.columnSorting.sort-3:after{content:"3"}.handsontable span.colHeader.columnSorting.sort-4:after{content:"4"}.handsontable span.colHeader.columnSorting.sort-5:after{content:"5"}.handsontable span.colHeader.columnSorting.sort-6:after{content:"6"}.handsontable span.colHeader.columnSorting.sort-7:after{content:"7"}.htGhostTable th div button.changeType+span.colHeader.columnSorting:not(.indicatorDisabled){padding-right:5px}.handsontable thead th.hiddenHeader:not(:first-of-type){display:none}.handsontable th.ht_nestingLevels{padding-left:7px;text-align:left}[dir=rtl].handsontable th.ht_nestingLevels{padding-right:7px;text-align:right}.handsontable th div.ht_nestingLevels{display:inline-block;left:11px;position:absolute;right:unset}[dir=rtl].handsontable th div.ht_nestingLevels{left:unset;right:11px}.handsontable.innerBorderInlineStart th div.ht_nestingLevels,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:unset;right:10px}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingLevels,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingLevels{left:10px;right:unset}.handsontable th span.ht_nestingLevel{display:inline-block}.handsontable th span.ht_nestingLevel_empty{display:inline-block;float:left;height:1px;width:10px}[dir=rtl].handsontable th span.ht_nestingLevel_empty{float:right}.handsontable th span.ht_nestingLevel:after{bottom:3px;content:"┐";display:inline-block;font-size:9px;position:relative}.handsontable th div.ht_nestingButton{cursor:pointer;display:inline-block;left:unset;position:absolute;right:-2px}[dir=rtl].handsontable th div.ht_nestingButton{left:-2px;right:unset}.handsontable th div.ht_nestingButton.ht_nestingExpand:after{content:"+"}.handsontable th div.ht_nestingButton.ht_nestingCollapse:after{content:"-"}.handsontable.innerBorderInlineStart th div.ht_nestingButton,.handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:unset;right:0}[dir=rtl].handsontable.innerBorderInlineStart th div.ht_nestingButton,[dir=rtl].handsontable.innerBorderInlineStart~.handsontable th div.ht_nestingButton{left:0;right:unset}.handsontable{font-size:13px;color:#222}.excel-wrapper[data-v-d33b0ee8]{position:relative;width:100%;height:100%}.excel-wrapper img[data-v-d33b0ee8]{height:auto;display:block}.excel-wrapper img.lg[data-v-d33b0ee8]{width:200px;margin:20px auto}.excel-wrapper img.sm[data-v-d33b0ee8]{width:80px;margin:2px auto}.table-wrapper[data-v-d33b0ee8]{position:relative;width:100%;height:calc(100% - 25px)}.loading[data-v-d33b0ee8]{position:absolute;left:0;top:0;display:flex;text-align:center;justify-content:center;flex-direction:column;margin:0 auto;width:100%;height:100%;background:white;font-size:18px;font-weight:700;z-index:999;color:#0c9d0c}.sheet-btn.active[data-v-d33b0ee8]{background-color:#7fffd4}.btn-group[data-v-d33b0ee8]{margin-top:5px;display:block;border-bottom:1px solid grey;background-color:#d3d3d3}.btn-group button[data-v-d33b0ee8]{outline:0;border:0;border-top-left-radius:5px;border-top-right-radius:5px;color:#0c9d0c;border-left:1px solid slategrey}.btn-group button[data-v-d33b0ee8]:last-child{border-right:1px solid grey}.btn-group button.active[data-v-d33b0ee8]{background:#0c9d0c;color:#fff}.table-tool[data-v-d33b0ee8]{padding:8px 0;border-top:1px solid black}\n',document.head.appendChild(lt);var at=function(t){return t&&t.Math===Math&&t},ht=at("object"==typeof globalThis&&globalThis)||at("object"==typeof window&&window)||at("object"==typeof self&&self)||at("object"==typeof K&&K)||at("object"==typeof K&&K)||function(){return this}()||Function("return this")(),ct={},ut=function(t){try{return!!t()}catch(Yb){return!0}},dt=!ut((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),gt=!ut((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),ft=gt,pt=Function.prototype.call,mt=ft?pt.bind(pt):function(){return pt.apply(pt,arguments)},wt={},bt={}.propertyIsEnumerable,vt=Object.getOwnPropertyDescriptor,yt=vt&&!bt.call({1:2},1);wt.f=yt?function(t){var e=vt(this,t);return!!e&&e.enumerable}:bt;var Ct,St,Rt=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},xt=gt,Et=Function.prototype,Mt=Et.call,Tt=xt&&Et.bind.bind(Mt,Mt),kt=xt?Tt:function(t){return function(){return Mt.apply(t,arguments)}},At=kt,Ht=At({}.toString),It=At("".slice),Ot=function(t){return It(Ht(t),8,-1)},_t=ut,Pt=Ot,Nt=Object,Dt=kt("".split),Lt=_t((function(){return!Nt("z").propertyIsEnumerable(0)}))?function(t){return"String"===Pt(t)?Dt(t,""):Nt(t)}:Nt,Vt=function(t){return null==t},Ft=Vt,Wt=TypeError,Bt=function(t){if(Ft(t))throw new Wt("Can't call method on "+t);return t},jt=Lt,zt=Bt,Ut=function(t){return jt(zt(t))},Yt="object"==typeof document&&document.all,$t=void 0===Yt&&void 0!==Yt?function(t){return"function"==typeof t||t===Yt}:function(t){return"function"==typeof t},Gt=$t,Kt=function(t){return"object"==typeof t?null!==t:Gt(t)},Xt=ht,qt=$t,Zt=function(t,e){return arguments.length<2?(n=Xt[t],qt(n)?n:void 0):Xt[t]&&Xt[t][e];var n},Qt=kt({}.isPrototypeOf),Jt=ht.navigator,te=Jt&&Jt.userAgent,ee=te?String(te):"",ne=ht,oe=ee,ie=ne.process,re=ne.Deno,se=ie&&ie.versions||re&&re.version,le=se&&se.v8;le&&(St=(Ct=le.split("."))[0]>0&&Ct[0]<4?1:+(Ct[0]+Ct[1])),!St&&oe&&(!(Ct=oe.match(/Edge\/(\d+)/))||Ct[1]>=74)&&(Ct=oe.match(/Chrome\/(\d+)/))&&(St=+Ct[1]);var ae=St,he=ut,ce=ht.String,ue=!!Object.getOwnPropertySymbols&&!he((function(){var t=Symbol("symbol detection");return!ce(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ae&&ae<41})),de=ue&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ge=Zt,fe=$t,pe=Qt,me=Object,we=de?function(t){return"symbol"==typeof t}:function(t){var e=ge("Symbol");return fe(e)&&pe(e.prototype,me(t))},be=String,ve=function(t){try{return be(t)}catch(Yb){return"Object"}},ye=$t,Ce=ve,Se=TypeError,Re=function(t){if(ye(t))return t;throw new Se(Ce(t)+" is not a function")},xe=Re,Ee=Vt,Me=function(t,e){var n=t[e];return Ee(n)?void 0:xe(n)},Te=mt,ke=$t,Ae=Kt,He=TypeError,Ie={exports:{}},Oe=ht,_e=Object.defineProperty,Pe=function(t,e){try{_e(Oe,t,{value:e,configurable:!0,writable:!0})}catch(Yb){Oe[t]=e}return e},Ne=ht,De=Pe,Le="__core-js_shared__",Ve=Ie.exports=Ne[Le]||De(Le,{});(Ve.versions||(Ve.versions=[])).push({version:"3.39.0",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Fe=Ie.exports,We=Fe,Be=function(t,e){return We[t]||(We[t]=e||{})},je=Bt,ze=Object,Ue=function(t){return ze(je(t))},Ye=Ue,$e=kt({}.hasOwnProperty),Ge=Object.hasOwn||function(t,e){return $e(Ye(t),e)},Ke=kt,Xe=0,qe=Math.random(),Ze=Ke(1..toString),Qe=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Ze(++Xe+qe,36)},Je=Be,tn=Ge,en=Qe,nn=ue,on=de,rn=ht.Symbol,sn=Je("wks"),ln=on?rn.for||rn:rn&&rn.withoutSetter||en,an=function(t){return tn(sn,t)||(sn[t]=nn&&tn(rn,t)?rn[t]:ln("Symbol."+t)),sn[t]},hn=mt,cn=Kt,un=we,dn=Me,gn=function(t,e){var n,o;if("string"===e&&ke(n=t.toString)&&!Ae(o=Te(n,t)))return o;if(ke(n=t.valueOf)&&!Ae(o=Te(n,t)))return o;if("string"!==e&&ke(n=t.toString)&&!Ae(o=Te(n,t)))return o;throw new He("Can't convert object to primitive value")},fn=TypeError,pn=an("toPrimitive"),mn=function(t,e){if(!cn(t)||un(t))return t;var n,o=dn(t,pn);if(o){if(void 0===e&&(e="default"),n=hn(o,t,e),!cn(n)||un(n))return n;throw new fn("Can't convert object to primitive value")}return void 0===e&&(e="number"),gn(t,e)},wn=we,bn=function(t){var e=mn(t,"string");return wn(e)?e:e+""},vn=Kt,yn=ht.document,Cn=vn(yn)&&vn(yn.createElement),Sn=function(t){return Cn?yn.createElement(t):{}},Rn=Sn,xn=!dt&&!ut((function(){return 7!==Object.defineProperty(Rn("div"),"a",{get:function(){return 7}}).a})),En=dt,Mn=mt,Tn=wt,kn=Rt,An=Ut,Hn=bn,In=Ge,On=xn,_n=Object.getOwnPropertyDescriptor;ct.f=En?_n:function(t,e){if(t=An(t),e=Hn(e),On)try{return _n(t,e)}catch(Yb){}if(In(t,e))return kn(!Mn(Tn.f,t,e),t[e])};var Pn={},Nn=dt&&ut((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Dn=Kt,Ln=String,Vn=TypeError,Fn=function(t){if(Dn(t))return t;throw new Vn(Ln(t)+" is not an object")},Wn=dt,Bn=xn,jn=Nn,zn=Fn,Un=bn,Yn=TypeError,$n=Object.defineProperty,Gn=Object.getOwnPropertyDescriptor,Kn="enumerable",Xn="configurable",qn="writable";Pn.f=Wn?jn?function(t,e,n){if(zn(t),e=Un(e),zn(n),"function"==typeof t&&"prototype"===e&&"value"in n&&qn in n&&!n[qn]){var o=Gn(t,e);o&&o[qn]&&(t[e]=n.value,n={configurable:Xn in n?n[Xn]:o[Xn],enumerable:Kn in n?n[Kn]:o[Kn],writable:!1})}return $n(t,e,n)}:$n:function(t,e,n){if(zn(t),e=Un(e),zn(n),Bn)try{return $n(t,e,n)}catch(Yb){}if("get"in n||"set"in n)throw new Yn("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Zn=Pn,Qn=Rt,Jn=dt?function(t,e,n){return Zn.f(t,e,Qn(1,n))}:function(t,e,n){return t[e]=n,t},to={exports:{}},eo=dt,no=Ge,oo=Function.prototype,io=eo&&Object.getOwnPropertyDescriptor,ro=no(oo,"name"),so={EXISTS:ro,PROPER:ro&&"something"===function(){}.name,CONFIGURABLE:ro&&(!eo||eo&&io(oo,"name").configurable)},lo=$t,ao=Fe,ho=kt(Function.toString);lo(ao.inspectSource)||(ao.inspectSource=function(t){return ho(t)});var co,uo,go,fo=ao.inspectSource,po=$t,mo=ht.WeakMap,wo=po(mo)&&/native code/.test(String(mo)),bo=Qe,vo=Be("keys"),yo=function(t){return vo[t]||(vo[t]=bo(t))},Co={},So=wo,Ro=ht,xo=Kt,Eo=Jn,Mo=Ge,To=Fe,ko=yo,Ao=Co,Ho="Object already initialized",Io=Ro.TypeError,Oo=Ro.WeakMap;if(So||To.state){var _o=To.state||(To.state=new Oo);_o.get=_o.get,_o.has=_o.has,_o.set=_o.set,co=function(t,e){if(_o.has(t))throw new Io(Ho);return e.facade=t,_o.set(t,e),e},uo=function(t){return _o.get(t)||{}},go=function(t){return _o.has(t)}}else{var Po=ko("state");Ao[Po]=!0,co=function(t,e){if(Mo(t,Po))throw new Io(Ho);return e.facade=t,Eo(t,Po,e),e},uo=function(t){return Mo(t,Po)?t[Po]:{}},go=function(t){return Mo(t,Po)}}var No={set:co,get:uo,has:go,enforce:function(t){return go(t)?uo(t):co(t,{})},getterFor:function(t){return function(e){var n;if(!xo(e)||(n=uo(e)).type!==t)throw new Io("Incompatible receiver, "+t+" required");return n}}},Do=kt,Lo=ut,Vo=$t,Fo=Ge,Wo=dt,Bo=so.CONFIGURABLE,jo=fo,zo=No.enforce,Uo=No.get,Yo=String,$o=Object.defineProperty,Go=Do("".slice),Ko=Do("".replace),Xo=Do([].join),qo=Wo&&!Lo((function(){return 8!==$o((function(){}),"length",{value:8}).length})),Zo=String(String).split("String"),Qo=to.exports=function(t,e,n){"Symbol("===Go(Yo(e),0,7)&&(e="["+Ko(Yo(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Fo(t,"name")||Bo&&t.name!==e)&&(Wo?$o(t,"name",{value:e,configurable:!0}):t.name=e),qo&&n&&Fo(n,"arity")&&t.length!==n.arity&&$o(t,"length",{value:n.arity});try{n&&Fo(n,"constructor")&&n.constructor?Wo&&$o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(Yb){}var o=zo(t);return Fo(o,"source")||(o.source=Xo(Zo,"string"==typeof e?e:"")),t};Function.prototype.toString=Qo((function(){return Vo(this)&&Uo(this).source||jo(this)}),"toString");var Jo=to.exports,ti=$t,ei=Pn,ni=Jo,oi=Pe,ii={},ri=Math.ceil,si=Math.floor,li=Math.trunc||function(t){var e=+t;return(e>0?si:ri)(e)},ai=function(t){var e=+t;return e!=e||0===e?0:li(e)},hi=ai,ci=Math.max,ui=Math.min,di=ai,gi=Math.min,fi=function(t){var e=di(t);return e>0?gi(e,9007199254740991):0},pi=function(t){return fi(t.length)},mi=Ut,wi=function(t,e){var n=hi(t);return n<0?ci(n+e,0):ui(n,e)},bi=pi,vi=function(t){return function(e,n,o){var i=mi(e),r=bi(i);if(0===r)return!t&&-1;var s,l=wi(o,r);if(t&&n!=n){for(;r>l;)if((s=i[l++])!=s)return!0}else for(;r>l;l++)if((t||l in i)&&i[l]===n)return t||l||0;return!t&&-1}},yi={includes:vi(!0),indexOf:vi(!1)},Ci=Ge,Si=Ut,Ri=yi.indexOf,xi=Co,Ei=kt([].push),Mi=function(t,e){var n,o=Si(t),i=0,r=[];for(n in o)!Ci(xi,n)&&Ci(o,n)&&Ei(r,n);for(;e.length>i;)Ci(o,n=e[i++])&&(~Ri(r,n)||Ei(r,n));return r},Ti=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ki=Mi,Ai=Ti.concat("length","prototype");ii.f=Object.getOwnPropertyNames||function(t){return ki(t,Ai)};var Hi={};Hi.f=Object.getOwnPropertySymbols;var Ii=Zt,Oi=ii,_i=Hi,Pi=Fn,Ni=kt([].concat),Di=Ii("Reflect","ownKeys")||function(t){var e=Oi.f(Pi(t)),n=_i.f;return n?Ni(e,n(t)):e},Li=Ge,Vi=Di,Fi=ct,Wi=Pn,Bi=function(t,e,n){for(var o=Vi(e),i=Wi.f,r=Fi.f,s=0;s<o.length;s++){var l=o[s];Li(t,l)||n&&Li(n,l)||i(t,l,r(e,l))}},ji=ut,zi=$t,Ui=/#|\.prototype\./,Yi=function(t,e){var n=Gi[$i(t)];return n===Xi||n!==Ki&&(zi(e)?ji(e):!!e)},$i=Yi.normalize=function(t){return String(t).replace(Ui,".").toLowerCase()},Gi=Yi.data={},Ki=Yi.NATIVE="N",Xi=Yi.POLYFILL="P",qi=Yi,Zi=ht,Qi=ct.f,Ji=Jn,tr=function(t,e,n,o){o||(o={});var i=o.enumerable,r=void 0!==o.name?o.name:e;if(ti(n)&&ni(n,r,o),o.global)i?t[e]=n:oi(e,n);else{try{o.unsafe?t[e]&&(i=!0):delete t[e]}catch(Yb){}i?t[e]=n:ei.f(t,e,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return t},er=Pe,nr=Bi,or=qi,ir=function(t,e){var n,o,i,r,s,l=t.target,a=t.global,h=t.stat;if(n=a?Zi:h?Zi[l]||er(l,{}):Zi[l]&&Zi[l].prototype)for(o in e){if(r=e[o],i=t.dontCallGetSet?(s=Qi(n,o))&&s.value:n[o],!or(a?o:l+(h?".":"#")+o,t.forced)&&void 0!==i){if(typeof r==typeof i)continue;nr(r,i)}(t.sham||i&&i.sham)&&Ji(r,"sham",!0),tr(n,o,r,t)}},rr=gt,sr=Function.prototype,lr=sr.apply,ar=sr.call,hr="object"==typeof Reflect&&Reflect.apply||(rr?ar.bind(lr):function(){return ar.apply(lr,arguments)}),cr=kt,ur=Re,dr=function(t,e,n){try{return cr(ur(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(Yb){}},gr=Kt,fr=function(t){return gr(t)||null===t},pr=String,mr=TypeError,wr=dr,br=Kt,vr=Bt,yr=function(t){if(fr(t))return t;throw new mr("Can't set "+pr(t)+" as a prototype")},Cr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=wr(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(Yb){}return function(n,o){return vr(n),yr(o),br(n)?(e?t(n,o):n.__proto__=o,n):n}}():void 0),Sr=Pn.f,Rr=$t,xr=Kt,Er=Cr,Mr={};Mr[an("toStringTag")]="z";var Tr="[object z]"===String(Mr),kr=$t,Ar=Ot,Hr=an("toStringTag"),Ir=Object,Or="Arguments"===Ar(function(){return arguments}()),_r=Tr?Ar:function(t){var e,n,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(Yb){}}(e=Ir(t),Hr))?n:Or?Ar(e):"Object"===(o=Ar(e))&&kr(e.callee)?"Arguments":o},Pr=_r,Nr=String,Dr=function(t){if("Symbol"===Pr(t))throw new TypeError("Cannot convert a Symbol value to a string");return Nr(t)},Lr=Dr,Vr=Kt,Fr=Jn,Wr=Error,Br=kt("".replace),jr=String(new Wr("zxcasd").stack),zr=/\n\s*at [^:]*:[^\n]*/,Ur=zr.test(jr),Yr=Rt,$r=!ut((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",Yr(1,7)),7!==t.stack)})),Gr=Jn,Kr=function(t,e){if(Ur&&"string"==typeof t&&!Wr.prepareStackTrace)for(;e--;)t=Br(t,zr,"");return t},Xr=$r,qr=Error.captureStackTrace,Zr=Zt,Qr=Ge,Jr=Jn,ts=Qt,es=Cr,ns=Bi,os=function(t,e,n){n in t||Sr(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})},is=function(t,e,n){var o,i;return Er&&Rr(o=e.constructor)&&o!==n&&xr(i=o.prototype)&&i!==n.prototype&&Er(t,i),t},rs=function(t,e){return void 0===t?arguments.length<2?"":e:Lr(t)},ss=function(t,e){Vr(e)&&"cause"in e&&Fr(t,"cause",e.cause)},ls=function(t,e,n,o){Xr&&(qr?qr(t,e):Gr(t,"stack",Kr(n,o)))},as=dt,hs=ir,cs=hr,us=function(t,e,n,o){var i="stackTraceLimit",r=o?2:1,s=t.split("."),l=s[s.length-1],a=Zr.apply(null,s);if(a){var h=a.prototype;if(Qr(h,"cause")&&delete h.cause,!n)return a;var c=Zr("Error"),u=e((function(t,e){var n=rs(o?e:t,void 0),i=o?new a(t):new a;return void 0!==n&&Jr(i,"message",n),ls(i,u,i.stack,2),this&&ts(h,this)&&is(i,this,u),arguments.length>r&&ss(i,arguments[r]),i}));u.prototype=h,"Error"!==l?es?es(u,c):ns(u,c,{name:!0}):as&&i in a&&(os(u,a,i),os(u,a,"prepareStackTrace")),ns(u,a);try{h.name!==l&&Jr(h,"name",l),h.constructor=u}catch(Yb){}return u}},ds="WebAssembly",gs=ht[ds],fs=7!==new Error("e",{cause:7}).cause,ps=function(t,e){var n={};n[t]=us(t,e,fs),hs({global:!0,constructor:!0,arity:1,forced:fs},n)},ms=function(t,e){if(gs&&gs[t]){var n={};n[t]=us(ds+"."+t,e,fs),hs({target:ds,stat:!0,constructor:!0,arity:1,forced:fs},n)}};ps("Error",(function(t){return function(e){return cs(t,this,arguments)}})),ps("EvalError",(function(t){return function(e){return cs(t,this,arguments)}})),ps("RangeError",(function(t){return function(e){return cs(t,this,arguments)}})),ps("ReferenceError",(function(t){return function(e){return cs(t,this,arguments)}})),ps("SyntaxError",(function(t){return function(e){return cs(t,this,arguments)}})),ps("TypeError",(function(t){return function(e){return cs(t,this,arguments)}})),ps("URIError",(function(t){return function(e){return cs(t,this,arguments)}})),ms("CompileError",(function(t){return function(e){return cs(t,this,arguments)}})),ms("LinkError",(function(t){return function(e){return cs(t,this,arguments)}})),ms("RuntimeError",(function(t){return function(e){return cs(t,this,arguments)}}));var ws=Ot,bs=Array.isArray||function(t){return"Array"===ws(t)},vs=dt,ys=bs,Cs=TypeError,Ss=Object.getOwnPropertyDescriptor,Rs=vs&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(Yb){return Yb instanceof TypeError}}(),xs=Rs?function(t,e){if(ys(t)&&!Ss(t,"length").writable)throw new Cs("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Es=TypeError,Ms=function(t){if(t>9007199254740991)throw Es("Maximum allowed index exceeded");return t},Ts=ir,ks=Ue,As=pi,Hs=xs,Is=Ms,Os=ut((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(Yb){return Yb instanceof TypeError}}();Ts({target:"Array",proto:!0,arity:1,forced:Os},{push:function(t){var e=ks(this),n=As(e),o=arguments.length;Is(n+o);for(var i=0;i<o;i++)e[n]=arguments[i],n++;return Hs(e,n),n}});var _s=kt,Ps=Set.prototype,Ns={Set:Set,add:_s(Ps.add),has:_s(Ps.has),remove:_s(Ps.delete),proto:Ps},Ds=Ns.has,Ls=function(t){return Ds(t),t},Vs=mt,Fs=function(t,e,n){for(var o,i,r=n?t:t.iterator,s=t.next;!(o=Vs(s,r)).done;)if(void 0!==(i=e(o.value)))return i},Ws=kt,Bs=Fs,js=Ns.Set,zs=Ns.proto,Us=Ws(zs.forEach),Ys=Ws(zs.keys),$s=Ys(new js).next,Gs=function(t,e,n){return n?Bs({iterator:Ys(t),next:$s},e):Us(t,e)},Ks=Gs,Xs=Ns.Set,qs=Ns.add,Zs=function(t){var e=new Xs;return Ks(t,(function(t){qs(e,t)})),e},Qs=dr(Ns.proto,"size","get")||function(t){return t.size},Js=Re,tl=Fn,el=mt,nl=ai,ol=function(t){return{iterator:t,next:t.next,done:!1}},il="Invalid size",rl=RangeError,sl=TypeError,ll=Math.max,al=function(t,e){this.set=t,this.size=ll(e,0),this.has=Js(t.has),this.keys=Js(t.keys)};al.prototype={getIterator:function(){return ol(tl(el(this.keys,this.set)))},includes:function(t){return el(this.has,this.set,t)}};var hl=function(t){tl(t);var e=+t.size;if(e!=e)throw new sl(il);var n=nl(e);if(n<0)throw new rl(il);return new al(t,n)},cl=Ls,ul=Zs,dl=Qs,gl=hl,fl=Gs,pl=Fs,ml=Ns.has,wl=Ns.remove,bl=Zt,vl=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},yl=function(t){var e=bl("Set");try{(new e)[t](vl(0));try{return(new e)[t](vl(-1)),!1}catch(n){return!0}}catch(Yb){return!1}},Cl=function(t){var e=cl(this),n=gl(t),o=ul(e);return dl(e)<=n.size?fl(e,(function(t){n.includes(t)&&wl(o,t)})):pl(n.getIterator(),(function(t){ml(e,t)&&wl(o,t)})),o};ir({target:"Set",proto:!0,real:!0,forced:!yl("difference")},{difference:Cl});var Sl=Ls,Rl=Qs,xl=hl,El=Gs,Ml=Fs,Tl=Ns.Set,kl=Ns.add,Al=Ns.has,Hl=ut,Il=function(t){var e=Sl(this),n=xl(t),o=new Tl;return Rl(e)>n.size?Ml(n.getIterator(),(function(t){Al(e,t)&&kl(o,t)})):El(e,(function(t){n.includes(t)&&kl(o,t)})),o};ir({target:"Set",proto:!0,real:!0,forced:!yl("intersection")||Hl((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:Il});var Ol=mt,_l=Fn,Pl=Me,Nl=function(t,e,n){var o,i;_l(t);try{if(!(o=Pl(t,"return"))){if("throw"===e)throw n;return n}o=Ol(o,t)}catch(Yb){i=!0,o=Yb}if("throw"===e)throw n;if(i)throw o;return _l(o),n},Dl=Ls,Ll=Ns.has,Vl=Qs,Fl=hl,Wl=Gs,Bl=Fs,jl=Nl,zl=function(t){var e=Dl(this),n=Fl(t);if(Vl(e)<=n.size)return!1!==Wl(e,(function(t){if(n.includes(t))return!1}),!0);var o=n.getIterator();return!1!==Bl(o,(function(t){if(Ll(e,t))return jl(o,"normal",!1)}))};ir({target:"Set",proto:!0,real:!0,forced:!yl("isDisjointFrom")},{isDisjointFrom:zl});var Ul=Ls,Yl=Qs,$l=Gs,Gl=hl,Kl=function(t){var e=Ul(this),n=Gl(t);return!(Yl(e)>n.size)&&!1!==$l(e,(function(t){if(!n.includes(t))return!1}),!0)};ir({target:"Set",proto:!0,real:!0,forced:!yl("isSubsetOf")},{isSubsetOf:Kl});var Xl=Ls,ql=Ns.has,Zl=Qs,Ql=hl,Jl=Fs,ta=Nl,ea=function(t){var e=Xl(this),n=Ql(t);if(Zl(e)<n.size)return!1;var o=n.getIterator();return!1!==Jl(o,(function(t){if(!ql(e,t))return ta(o,"normal",!1)}))};ir({target:"Set",proto:!0,real:!0,forced:!yl("isSupersetOf")},{isSupersetOf:ea});var na=Ls,oa=Zs,ia=hl,ra=Fs,sa=Ns.add,la=Ns.has,aa=Ns.remove,ha=function(t){var e=na(this),n=ia(t).getIterator(),o=oa(e);return ra(n,(function(t){la(e,t)?aa(o,t):sa(o,t)})),o};ir({target:"Set",proto:!0,real:!0,forced:!yl("symmetricDifference")},{symmetricDifference:ha});var ca=Ls,ua=Ns.add,da=Zs,ga=hl,fa=Fs,pa=function(t){var e=ca(this),n=ga(t).getIterator(),o=da(e);return fa(n,(function(t){ua(o,t)})),o};ir({target:"Set",proto:!0,real:!0,forced:!yl("union")},{union:pa});var ma,wa,ba,va,ya=Ot,Ca=kt,Sa=function(t){if("Function"===ya(t))return Ca(t)},Ra=Re,xa=gt,Ea=Sa(Sa.bind),Ma=function(t,e){return Ra(t),void 0===e?t:xa?Ea(t,e):function(){return t.apply(e,arguments)}},Ta=Zt("document","documentElement"),ka=kt([].slice),Aa=TypeError,Ha=function(t,e){if(t<e)throw new Aa("Not enough arguments");return t},Ia=/(?:ipad|iphone|ipod).*applewebkit/i.test(ee),Oa=ht,_a=ee,Pa=Ot,Na=function(t){return _a.slice(0,t.length)===t},Da=Na("Bun/")?"BUN":Na("Cloudflare-Workers")?"CLOUDFLARE":Na("Deno/")?"DENO":Na("Node.js/")?"NODE":Oa.Bun&&"string"==typeof Bun.version?"BUN":Oa.Deno&&"object"==typeof Deno.version?"DENO":"process"===Pa(Oa.process)?"NODE":Oa.window&&Oa.document?"BROWSER":"REST",La=ht,Va=hr,Fa=Ma,Wa=$t,Ba=Ge,ja=ut,za=Ta,Ua=ka,Ya=Sn,$a=Ha,Ga=Ia,Ka="NODE"===Da,Xa=La.setImmediate,qa=La.clearImmediate,Za=La.process,Qa=La.Dispatch,Ja=La.Function,th=La.MessageChannel,eh=La.String,nh=0,oh={},ih="onreadystatechange";ja((function(){ma=La.location}));var rh=function(t){if(Ba(oh,t)){var e=oh[t];delete oh[t],e()}},sh=function(t){return function(){rh(t)}},lh=function(t){rh(t.data)},ah=function(t){La.postMessage(eh(t),ma.protocol+"//"+ma.host)};Xa&&qa||(Xa=function(t){$a(arguments.length,1);var e=Wa(t)?t:Ja(t),n=Ua(arguments,1);return oh[++nh]=function(){Va(e,void 0,n)},wa(nh),nh},qa=function(t){delete oh[t]},Ka?wa=function(t){Za.nextTick(sh(t))}:Qa&&Qa.now?wa=function(t){Qa.now(sh(t))}:th&&!Ga?(va=(ba=new th).port2,ba.port1.onmessage=lh,wa=Fa(va.postMessage,va)):La.addEventListener&&Wa(La.postMessage)&&!La.importScripts&&ma&&"file:"!==ma.protocol&&!ja(ah)?(wa=ah,La.addEventListener("message",lh,!1)):wa=ih in Ya("script")?function(t){za.appendChild(Ya("script"))[ih]=function(){za.removeChild(this),rh(t)}}:function(t){setTimeout(sh(t),0)});var hh={set:Xa,clear:qa},ch=hh.clear;ir({global:!0,bind:!0,enumerable:!0,forced:ht.clearImmediate!==ch},{clearImmediate:ch});var uh=ht,dh=hr,gh=$t,fh=Da,ph=ee,mh=ka,wh=Ha,bh=uh.Function,vh=/MSIE .\./.test(ph)||"BUN"===fh&&function(){var t=uh.Bun.version.split(".");return t.length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2])}(),yh=ir,Ch=ht,Sh=hh.set,Rh=function(t,e){var n=e?2:1;return vh?function(o,i){var r=wh(arguments.length,1)>n,s=gh(o)?o:bh(o),l=r?mh(arguments,n):[],a=r?function(){dh(s,this,l)}:s;return e?t(a,i):t(a)}:t},xh=Ch.setImmediate?Rh(Sh,!1):Sh;/*! @license DOMPurify 2.5.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.8/LICENSE */function Eh(t){return Eh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eh(t)}function Mh(t,e){return Mh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Mh(t,e)}function Th(t,e,n){return Th=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&Mh(i,n.prototype),i},Th.apply(null,arguments)}function kh(t){return function(t){if(Array.isArray(t))return Ah(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ah(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ah(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ah(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}yh({global:!0,bind:!0,enumerable:!0,forced:Ch.setImmediate!==xh},{setImmediate:xh});var Hh=Object.hasOwnProperty,Ih=Object.setPrototypeOf,Oh=Object.isFrozen,_h=Object.getPrototypeOf,Ph=Object.getOwnPropertyDescriptor,Nh=Object.freeze,Dh=Object.seal,Lh=Object.create,Vh="undefined"!=typeof Reflect&&Reflect,Fh=Vh.apply,Wh=Vh.construct;Fh||(Fh=function(t,e,n){return t.apply(e,n)}),Nh||(Nh=function(t){return t}),Dh||(Dh=function(t){return t}),Wh||(Wh=function(t,e){return Th(t,kh(e))});var Bh,jh=Jh(Array.prototype.forEach),zh=Jh(Array.prototype.pop),Uh=Jh(Array.prototype.push),Yh=Jh(String.prototype.toLowerCase),$h=Jh(String.prototype.toString),Gh=Jh(String.prototype.match),Kh=Jh(String.prototype.replace),Xh=Jh(String.prototype.indexOf),qh=Jh(String.prototype.trim),Zh=Jh(RegExp.prototype.test),Qh=(Bh=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Wh(Bh,e)});function Jh(t){return function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return Fh(t,e,o)}}function tc(t,e,n){var o;n=null!==(o=n)&&void 0!==o?o:Yh,Ih&&Ih(t,null);for(var i=e.length;i--;){var r=e[i];if("string"==typeof r){var s=n(r);s!==r&&(Oh(e)||(e[i]=s),r=s)}t[r]=!0}return t}function ec(t){var e,n=Lh(null);for(e in t)!0===Fh(Hh,t,[e])&&(n[e]=t[e]);return n}function nc(t,e){for(;null!==t;){var n=Ph(t,e);if(n){if(n.get)return Jh(n.get);if("function"==typeof n.value)return Jh(n.value)}t=_h(t)}return function(t){return console.warn("fallback value for",t),null}}var oc=Nh(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ic=Nh(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),rc=Nh(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),sc=Nh(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),lc=Nh(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ac=Nh(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),hc=Nh(["#text"]),cc=Nh(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),uc=Nh(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),dc=Nh(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),gc=Nh(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),fc=Dh(/\{\{[\w\W]*|[\w\W]*\}\}/gm),pc=Dh(/<%[\w\W]*|[\w\W]*%>/gm),mc=Dh(/\${[\w\W]*}/gm),wc=Dh(/^data-[\-\w.\u00B7-\uFFFF]+$/),bc=Dh(/^aria-[\-\w]+$/),vc=Dh(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yc=Dh(/^(?:\w+script|data):/i),Cc=Dh(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Sc=Dh(/^html$/i),Rc=Dh(/^[a-z][.\w]*(-[.\w]+)+$/i),xc=function(){return"undefined"==typeof window?null:window};var Ec,Mc,Tc=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xc(),n=function(e){return t(e)};if(n.version="2.5.8",n.removed=[],!e||!e.document||9!==e.document.nodeType)return n.isSupported=!1,n;var o=e.document,i=e.document,r=e.DocumentFragment,s=e.HTMLTemplateElement,l=e.Node,a=e.Element,h=e.NodeFilter,c=e.NamedNodeMap,u=void 0===c?e.NamedNodeMap||e.MozNamedAttrMap:c,d=e.HTMLFormElement,g=e.DOMParser,f=e.trustedTypes,p=a.prototype,m=nc(p,"cloneNode"),w=nc(p,"nextSibling"),b=nc(p,"childNodes"),v=nc(p,"parentNode");if("function"==typeof s){var y=i.createElement("template");y.content&&y.content.ownerDocument&&(i=y.content.ownerDocument)}var C=function(t,e){if("object"!==Eh(t)||"function"!=typeof t.createPolicy)return null;var n=null,o="data-tt-policy-suffix";e.currentScript&&e.currentScript.hasAttribute(o)&&(n=e.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(r){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(f,o),S=C?C.createHTML(""):"",R=i,x=R.implementation,E=R.createNodeIterator,M=R.createDocumentFragment,T=R.getElementsByTagName,k=o.importNode,A={};try{A=ec(i).documentMode?i.documentMode:{}}catch(Gt){}var H={};n.isSupported="function"==typeof v&&x&&void 0!==x.createHTMLDocument&&9!==A;var I,O,_=fc,P=pc,N=mc,D=wc,L=bc,V=yc,F=Cc,W=Rc,B=vc,j=null,z=tc({},[].concat(kh(oc),kh(ic),kh(rc),kh(lc),kh(hc))),U=null,Y=tc({},[].concat(kh(cc),kh(uc),kh(dc),kh(gc))),$=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),G=null,K=null,X=!0,q=!0,Z=!1,Q=!0,J=!1,tt=!0,et=!1,nt=!1,ot=!1,it=!1,rt=!1,st=!1,lt=!0,at=!1,ht=!0,ct=!1,ut={},dt=null,gt=tc({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ft=null,pt=tc({},["audio","video","img","source","image","track"]),mt=null,wt=tc({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),bt="http://www.w3.org/1998/Math/MathML",vt="http://www.w3.org/2000/svg",yt="http://www.w3.org/1999/xhtml",Ct=yt,St=!1,Rt=null,xt=tc({},[bt,vt,yt],$h),Et=["application/xhtml+xml","text/html"],Mt=null,Tt=i.createElement("form"),kt=function(t){return t instanceof RegExp||t instanceof Function},At=function(t){Mt&&Mt===t||(t&&"object"===Eh(t)||(t={}),t=ec(t),I=I=-1===Et.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,O="application/xhtml+xml"===I?$h:Yh,j="ALLOWED_TAGS"in t?tc({},t.ALLOWED_TAGS,O):z,U="ALLOWED_ATTR"in t?tc({},t.ALLOWED_ATTR,O):Y,Rt="ALLOWED_NAMESPACES"in t?tc({},t.ALLOWED_NAMESPACES,$h):xt,mt="ADD_URI_SAFE_ATTR"in t?tc(ec(wt),t.ADD_URI_SAFE_ATTR,O):wt,ft="ADD_DATA_URI_TAGS"in t?tc(ec(pt),t.ADD_DATA_URI_TAGS,O):pt,dt="FORBID_CONTENTS"in t?tc({},t.FORBID_CONTENTS,O):gt,G="FORBID_TAGS"in t?tc({},t.FORBID_TAGS,O):{},K="FORBID_ATTR"in t?tc({},t.FORBID_ATTR,O):{},ut="USE_PROFILES"in t&&t.USE_PROFILES,X=!1!==t.ALLOW_ARIA_ATTR,q=!1!==t.ALLOW_DATA_ATTR,Z=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Q=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,J=t.SAFE_FOR_TEMPLATES||!1,tt=!1!==t.SAFE_FOR_XML,et=t.WHOLE_DOCUMENT||!1,it=t.RETURN_DOM||!1,rt=t.RETURN_DOM_FRAGMENT||!1,st=t.RETURN_TRUSTED_TYPE||!1,ot=t.FORCE_BODY||!1,lt=!1!==t.SANITIZE_DOM,at=t.SANITIZE_NAMED_PROPS||!1,ht=!1!==t.KEEP_CONTENT,ct=t.IN_PLACE||!1,B=t.ALLOWED_URI_REGEXP||B,Ct=t.NAMESPACE||yt,$=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&kt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&($.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&kt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&($.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&($.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),J&&(q=!1),rt&&(it=!0),ut&&(j=tc({},kh(hc)),U=[],!0===ut.html&&(tc(j,oc),tc(U,cc)),!0===ut.svg&&(tc(j,ic),tc(U,uc),tc(U,gc)),!0===ut.svgFilters&&(tc(j,rc),tc(U,uc),tc(U,gc)),!0===ut.mathMl&&(tc(j,lc),tc(U,dc),tc(U,gc))),t.ADD_TAGS&&(j===z&&(j=ec(j)),tc(j,t.ADD_TAGS,O)),t.ADD_ATTR&&(U===Y&&(U=ec(U)),tc(U,t.ADD_ATTR,O)),t.ADD_URI_SAFE_ATTR&&tc(mt,t.ADD_URI_SAFE_ATTR,O),t.FORBID_CONTENTS&&(dt===gt&&(dt=ec(dt)),tc(dt,t.FORBID_CONTENTS,O)),ht&&(j["#text"]=!0),et&&tc(j,["html","head","body"]),j.table&&(tc(j,["tbody"]),delete G.tbody),Nh&&Nh(t),Mt=t)},Ht=tc({},["mi","mo","mn","ms","mtext"]),It=tc({},["annotation-xml"]),Ot=tc({},["title","style","font","a","script"]),_t=tc({},ic);tc(_t,rc),tc(_t,sc);var Pt=tc({},lc);tc(Pt,ac);var Nt=function(t){Uh(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(Gt){try{t.outerHTML=S}catch(Gt){t.remove()}}},Dt=function(t,e){try{Uh(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(Gt){Uh(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!U[t])if(it||rt)try{Nt(e)}catch(Gt){}else try{e.setAttribute(t,"")}catch(Gt){}},Lt=function(t){var e,n;if(ot)t="<remove></remove>"+t;else{var o=Gh(t,/^[\r\n\t ]+/);n=o&&o[0]}"application/xhtml+xml"===I&&Ct===yt&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var r=C?C.createHTML(t):t;if(Ct===yt)try{e=(new g).parseFromString(r,I)}catch(Gt){}if(!e||!e.documentElement){e=x.createDocument(Ct,"template",null);try{e.documentElement.innerHTML=St?S:r}catch(Gt){}}var s=e.body||e.documentElement;return t&&n&&s.insertBefore(i.createTextNode(n),s.childNodes[0]||null),Ct===yt?T.call(e,et?"html":"body")[0]:et?e.documentElement:s},Vt=function(t){return E.call(t.ownerDocument||t,t,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null,!1)},Ft=function(t){return t instanceof d&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof u)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},Wt=function(t){return"object"===Eh(l)?t instanceof l:t&&"object"===Eh(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Bt=function(t,e,o){H[t]&&jh(H[t],(function(t){t.call(n,e,o,Mt)}))},jt=function(t){var e;if(Bt("beforeSanitizeElements",t,null),Ft(t))return Nt(t),!0;if(Zh(/[\u0080-\uFFFF]/,t.nodeName))return Nt(t),!0;var o=O(t.nodeName);if(Bt("uponSanitizeElement",t,{tagName:o,allowedTags:j}),t.hasChildNodes()&&!Wt(t.firstElementChild)&&(!Wt(t.content)||!Wt(t.content.firstElementChild))&&Zh(/<[/\w]/g,t.innerHTML)&&Zh(/<[/\w]/g,t.textContent))return Nt(t),!0;if("select"===o&&Zh(/<template/i,t.innerHTML))return Nt(t),!0;if(7===t.nodeType)return Nt(t),!0;if(tt&&8===t.nodeType&&Zh(/<[/\w]/g,t.data))return Nt(t),!0;if(!j[o]||G[o]){if(!G[o]&&Ut(o)){if($.tagNameCheck instanceof RegExp&&Zh($.tagNameCheck,o))return!1;if($.tagNameCheck instanceof Function&&$.tagNameCheck(o))return!1}if(ht&&!dt[o]){var i=v(t)||t.parentNode,r=b(t)||t.childNodes;if(r&&i)for(var s=r.length-1;s>=0;--s){var l=m(r[s],!0);l.__removalCount=(t.__removalCount||0)+1,i.insertBefore(l,w(t))}}return Nt(t),!0}return t instanceof a&&!function(t){var e=v(t);e&&e.tagName||(e={namespaceURI:Ct,tagName:"template"});var n=Yh(t.tagName),o=Yh(e.tagName);return!!Rt[t.namespaceURI]&&(t.namespaceURI===vt?e.namespaceURI===yt?"svg"===n:e.namespaceURI===bt?"svg"===n&&("annotation-xml"===o||Ht[o]):Boolean(_t[n]):t.namespaceURI===bt?e.namespaceURI===yt?"math"===n:e.namespaceURI===vt?"math"===n&&It[o]:Boolean(Pt[n]):t.namespaceURI===yt?!(e.namespaceURI===vt&&!It[o])&&!(e.namespaceURI===bt&&!Ht[o])&&!Pt[n]&&(Ot[n]||!_t[n]):!("application/xhtml+xml"!==I||!Rt[t.namespaceURI]))}(t)?(Nt(t),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!Zh(/<\/no(script|embed|frames)/i,t.innerHTML)?(J&&3===t.nodeType&&(e=t.textContent,e=Kh(e,_," "),e=Kh(e,P," "),e=Kh(e,N," "),t.textContent!==e&&(Uh(n.removed,{element:t.cloneNode()}),t.textContent=e)),Bt("afterSanitizeElements",t,null),!1):(Nt(t),!0)},zt=function(t,e,n){if(lt&&("id"===e||"name"===e)&&(n in i||n in Tt))return!1;if(q&&!K[e]&&Zh(D,e));else if(X&&Zh(L,e));else if(!U[e]||K[e]){if(!(Ut(t)&&($.tagNameCheck instanceof RegExp&&Zh($.tagNameCheck,t)||$.tagNameCheck instanceof Function&&$.tagNameCheck(t))&&($.attributeNameCheck instanceof RegExp&&Zh($.attributeNameCheck,e)||$.attributeNameCheck instanceof Function&&$.attributeNameCheck(e))||"is"===e&&$.allowCustomizedBuiltInElements&&($.tagNameCheck instanceof RegExp&&Zh($.tagNameCheck,n)||$.tagNameCheck instanceof Function&&$.tagNameCheck(n))))return!1}else if(mt[e]);else if(Zh(B,Kh(n,F,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==Xh(n,"data:")||!ft[t]){if(Z&&!Zh(V,Kh(n,F,"")));else if(n)return!1}else;return!0},Ut=function(t){return"annotation-xml"!==t&&Gh(t,W)},Yt=function(t){var e,o,i,r;Bt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s&&!Ft(t)){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U};for(r=s.length;r--;){var a=e=s[r],h=a.name,c=a.namespaceURI;if(o="value"===h?e.value:qh(e.value),i=O(h),l.attrName=i,l.attrValue=o,l.keepAttr=!0,l.forceKeepAttr=void 0,Bt("uponSanitizeAttribute",t,l),o=l.attrValue,!l.forceKeepAttr&&(Dt(h,t),l.keepAttr))if(Q||!Zh(/\/>/i,o)){J&&(o=Kh(o,_," "),o=Kh(o,P," "),o=Kh(o,N," "));var u=O(t.nodeName);if(zt(u,i,o))if(!at||"id"!==i&&"name"!==i||(Dt(h,t),o="user-content-"+o),tt&&Zh(/((--!?|])>)|<\/(style|title)/i,o))Dt(h,t);else{if(C&&"object"===Eh(f)&&"function"==typeof f.getAttributeType)if(c);else switch(f.getAttributeType(u,i)){case"TrustedHTML":o=C.createHTML(o);break;case"TrustedScriptURL":o=C.createScriptURL(o)}try{c?t.setAttributeNS(c,h,o):t.setAttribute(h,o),Ft(t)?Nt(t):zh(n.removed)}catch(Gt){}}}else Dt(h,t)}Bt("afterSanitizeAttributes",t,null)}},$t=function t(e){var n,o=Vt(e);for(Bt("beforeSanitizeShadowDOM",e,null);n=o.nextNode();)Bt("uponSanitizeShadowNode",n,null),jt(n),Yt(n),n.content instanceof r&&t(n.content);Bt("afterSanitizeShadowDOM",e,null)};return n.sanitize=function(t){var i,s,a,h,c,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((St=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Wt(t)){if("function"!=typeof t.toString)throw Qh("toString is not a function");if("string"!=typeof(t=t.toString()))throw Qh("dirty is not a string, aborting")}if(!n.isSupported){if("object"===Eh(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof t)return e.toStaticHTML(t);if(Wt(t))return e.toStaticHTML(t.outerHTML)}return t}if(nt||At(u),n.removed=[],"string"==typeof t&&(ct=!1),ct){if(t.nodeName){var d=O(t.nodeName);if(!j[d]||G[d])throw Qh("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(s=(i=Lt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===s.nodeName||"HTML"===s.nodeName?i=s:i.appendChild(s);else{if(!it&&!J&&!et&&-1===t.indexOf("<"))return C&&st?C.createHTML(t):t;if(!(i=Lt(t)))return it?null:st?S:""}i&&ot&&Nt(i.firstChild);for(var g=Vt(ct?t:i);a=g.nextNode();)3===a.nodeType&&a===h||(jt(a),Yt(a),a.content instanceof r&&$t(a.content),h=a);if(h=null,ct)return t;if(it){if(rt)for(c=M.call(i.ownerDocument);i.firstChild;)c.appendChild(i.firstChild);else c=i;return(U.shadowroot||U.shadowrootmod)&&(c=k.call(o,c,!0)),c}var f=et?i.outerHTML:i.innerHTML;return et&&j["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&Zh(Sc,i.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+f),J&&(f=Kh(f,_," "),f=Kh(f,P," "),f=Kh(f,N," ")),C&&st?C.createHTML(f):f},n.setConfig=function(t){At(t),nt=!0},n.clearConfig=function(){Mt=null,nt=!1},n.isValidAttribute=function(t,e,n){Mt||At({});var o=O(t),i=O(e);return zt(o,i,n)},n.addHook=function(t,e){"function"==typeof e&&(H[t]=H[t]||[],Uh(H[t],e))},n.removeHook=function(t){if(H[t])return zh(H[t])},n.removeHooks=function(t){H[t]&&(H[t]=[])},n.removeAllHooks=function(){H={}},n}();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
function kc(){return Ec.apply(null,arguments)}function Ac(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function Hc(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function Ic(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Oc(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(Ic(t,e))return!1;return!0}function _c(t){return void 0===t}function Pc(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function Nc(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function Dc(t,e){var n,o=[],i=t.length;for(n=0;n<i;++n)o.push(e(t[n],n));return o}function Lc(t,e){for(var n in e)Ic(e,n)&&(t[n]=e[n]);return Ic(e,"toString")&&(t.toString=e.toString),Ic(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Vc(t,e,n,o){return ig(t,e,n,o,!0).utc()}function Fc(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function Wc(t){var e=null,n=!1,o=t._d&&!isNaN(t._d.getTime());return o&&(e=Fc(t),n=Mc.call(e.parsedDateParts,(function(t){return null!=t})),o=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(o=o&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour)),null!=Object.isFrozen&&Object.isFrozen(t)?o:(t._isValid=o,t._isValid)}function Bc(t){var e=Vc(NaN);return null!=t?Lc(Fc(e),t):Fc(e).userInvalidated=!0,e}Mc=Array.prototype.some?Array.prototype.some:function(t){var e,n=Object(this),o=n.length>>>0;for(e=0;e<o;e++)if(e in n&&t.call(this,n[e],e,n))return!0;return!1};var jc=kc.momentProperties=[],zc=!1;function Uc(t,e){var n,o,i,r=jc.length;if(_c(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),_c(e._i)||(t._i=e._i),_c(e._f)||(t._f=e._f),_c(e._l)||(t._l=e._l),_c(e._strict)||(t._strict=e._strict),_c(e._tzm)||(t._tzm=e._tzm),_c(e._isUTC)||(t._isUTC=e._isUTC),_c(e._offset)||(t._offset=e._offset),_c(e._pf)||(t._pf=Fc(e)),_c(e._locale)||(t._locale=e._locale),r>0)for(n=0;n<r;n++)_c(i=e[o=jc[n]])||(t[o]=i);return t}function Yc(t){Uc(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===zc&&(zc=!0,kc.updateOffset(this),zc=!1)}function $c(t){return t instanceof Yc||null!=t&&null!=t._isAMomentObject}function Gc(t){!1===kc.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function Kc(t,e){var n=!0;return Lc((function(){if(null!=kc.deprecationHandler&&kc.deprecationHandler(null,t),n){var o,i,r,s=[],l=arguments.length;for(i=0;i<l;i++){if(o="","object"==typeof arguments[i]){for(r in o+="\n["+i+"] ",arguments[0])Ic(arguments[0],r)&&(o+=r+": "+arguments[0][r]+", ");o=o.slice(0,-2)}else o=arguments[i];s.push(o)}Gc(t+"\nArguments: "+Array.prototype.slice.call(s).join("")+"\n"+(new Error).stack),n=!1}return e.apply(this,arguments)}),e)}var Xc,qc={};function Zc(t,e){null!=kc.deprecationHandler&&kc.deprecationHandler(t,e),qc[t]||(Gc(e),qc[t]=!0)}function Qc(t){return"undefined"!=typeof Function&&t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function Jc(t,e){var n,o=Lc({},t);for(n in e)Ic(e,n)&&(Hc(t[n])&&Hc(e[n])?(o[n]={},Lc(o[n],t[n]),Lc(o[n],e[n])):null!=e[n]?o[n]=e[n]:delete o[n]);for(n in t)Ic(t,n)&&!Ic(e,n)&&Hc(t[n])&&(o[n]=Lc({},o[n]));return o}function tu(t){null!=t&&this.set(t)}kc.suppressDeprecationWarnings=!1,kc.deprecationHandler=null,Xc=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)Ic(t,e)&&n.push(e);return n};function eu(t,e,n){var o=""+Math.abs(t),i=e-o.length;return(t>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+o}var nu=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ou=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,iu={},ru={};function su(t,e,n,o){var i=o;"string"==typeof o&&(i=function(){return this[o]()}),t&&(ru[t]=i),e&&(ru[e[0]]=function(){return eu(i.apply(this,arguments),e[1],e[2])}),n&&(ru[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function lu(t,e){return t.isValid()?(e=au(e,t.localeData()),iu[e]=iu[e]||function(t){var e,n,o,i=t.match(nu);for(e=0,n=i.length;e<n;e++)ru[i[e]]?i[e]=ru[i[e]]:i[e]=(o=i[e]).match(/\[[\s\S]/)?o.replace(/^\[|\]$/g,""):o.replace(/\\/g,"");return function(e){var o,r="";for(o=0;o<n;o++)r+=Qc(i[o])?i[o].call(e,t):i[o];return r}}(e),iu[e](t)):t.localeData().invalidDate()}function au(t,e){var n=5;function o(t){return e.longDateFormat(t)||t}for(ou.lastIndex=0;n>=0&&ou.test(t);)t=t.replace(ou,o),ou.lastIndex=0,n-=1;return t}var hu={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function cu(t){return"string"==typeof t?hu[t]||hu[t.toLowerCase()]:void 0}function uu(t){var e,n,o={};for(n in t)Ic(t,n)&&(e=cu(n))&&(o[e]=t[n]);return o}var du={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};var gu,fu=/\d/,pu=/\d\d/,mu=/\d{3}/,wu=/\d{4}/,bu=/[+-]?\d{6}/,vu=/\d\d?/,yu=/\d\d\d\d?/,Cu=/\d\d\d\d\d\d?/,Su=/\d{1,3}/,Ru=/\d{1,4}/,xu=/[+-]?\d{1,6}/,Eu=/\d+/,Mu=/[+-]?\d+/,Tu=/Z|[+-]\d\d:?\d\d/gi,ku=/Z|[+-]\d\d(?::?\d\d)?/gi,Au=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Hu=/^[1-9]\d?/,Iu=/^([1-9]\d|\d)/;function Ou(t,e,n){gu[t]=Qc(e)?e:function(t,o){return t&&n?n:e}}function _u(t,e){return Ic(gu,t)?gu[t](e._strict,e._locale):new RegExp(Pu(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(t,e,n,o,i){return e||n||o||i}))))}function Pu(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Nu(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Du(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=Nu(e)),n}gu={};var Lu={};function Vu(t,e){var n,o,i=e;for("string"==typeof t&&(t=[t]),Pc(e)&&(i=function(t,n){n[e]=Du(t)}),o=t.length,n=0;n<o;n++)Lu[t[n]]=i}function Fu(t,e){Vu(t,(function(t,n,o,i){o._w=o._w||{},e(t,o._w,o,i)}))}function Wu(t,e,n){null!=e&&Ic(Lu,t)&&Lu[t](e,n._a,n,t)}function Bu(t){return t%4==0&&t%100!=0||t%400==0}var ju=0,zu=1,Uu=2,Yu=3,$u=4,Gu=5,Ku=6,Xu=7,qu=8;function Zu(t){return Bu(t)?366:365}su("Y",0,0,(function(){var t=this.year();return t<=9999?eu(t,4):"+"+t})),su(0,["YY",2],0,(function(){return this.year()%100})),su(0,["YYYY",4],0,"year"),su(0,["YYYYY",5],0,"year"),su(0,["YYYYYY",6,!0],0,"year"),Ou("Y",Mu),Ou("YY",vu,pu),Ou("YYYY",Ru,wu),Ou("YYYYY",xu,bu),Ou("YYYYYY",xu,bu),Vu(["YYYYY","YYYYYY"],ju),Vu("YYYY",(function(t,e){e[ju]=2===t.length?kc.parseTwoDigitYear(t):Du(t)})),Vu("YY",(function(t,e){e[ju]=kc.parseTwoDigitYear(t)})),Vu("Y",(function(t,e){e[ju]=parseInt(t,10)})),kc.parseTwoDigitYear=function(t){return Du(t)+(Du(t)>68?1900:2e3)};var Qu,Ju=td("FullYear",!0);function td(t,e){return function(n){return null!=n?(nd(this,t,n),kc.updateOffset(this,e),this):ed(this,t)}}function ed(t,e){if(!t.isValid())return NaN;var n=t._d,o=t._isUTC;switch(e){case"Milliseconds":return o?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return o?n.getUTCSeconds():n.getSeconds();case"Minutes":return o?n.getUTCMinutes():n.getMinutes();case"Hours":return o?n.getUTCHours():n.getHours();case"Date":return o?n.getUTCDate():n.getDate();case"Day":return o?n.getUTCDay():n.getDay();case"Month":return o?n.getUTCMonth():n.getMonth();case"FullYear":return o?n.getUTCFullYear():n.getFullYear();default:return NaN}}function nd(t,e,n){var o,i,r,s,l;if(t.isValid()&&!isNaN(n)){switch(o=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?o.setUTCMilliseconds(n):o.setMilliseconds(n));case"Seconds":return void(i?o.setUTCSeconds(n):o.setSeconds(n));case"Minutes":return void(i?o.setUTCMinutes(n):o.setMinutes(n));case"Hours":return void(i?o.setUTCHours(n):o.setHours(n));case"Date":return void(i?o.setUTCDate(n):o.setDate(n));case"FullYear":break;default:return}r=n,s=t.month(),l=29!==(l=t.date())||1!==s||Bu(r)?l:28,i?o.setUTCFullYear(r,s,l):o.setFullYear(r,s,l)}}function od(t,e){if(isNaN(t)||isNaN(e))return NaN;var n,o=(e%(n=12)+n)%n;return t+=(e-o)/12,1===o?Bu(t)?29:28:31-o%7%2}Qu=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},su("M",["MM",2],"Mo",(function(){return this.month()+1})),su("MMM",0,0,(function(t){return this.localeData().monthsShort(this,t)})),su("MMMM",0,0,(function(t){return this.localeData().months(this,t)})),Ou("M",vu,Hu),Ou("MM",vu,pu),Ou("MMM",(function(t,e){return e.monthsShortRegex(t)})),Ou("MMMM",(function(t,e){return e.monthsRegex(t)})),Vu(["M","MM"],(function(t,e){e[zu]=Du(t)-1})),Vu(["MMM","MMMM"],(function(t,e,n,o){var i=n._locale.monthsParse(t,o,n._strict);null!=i?e[zu]=i:Fc(n).invalidMonth=t}));var id="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),rd="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),sd=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ld=Au,ad=Au;function hd(t,e,n){var o,i,r,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],o=0;o<12;++o)r=Vc([2e3,o]),this._shortMonthsParse[o]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[o]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===e?-1!==(i=Qu.call(this._shortMonthsParse,s))?i:null:-1!==(i=Qu.call(this._longMonthsParse,s))?i:null:"MMM"===e?-1!==(i=Qu.call(this._shortMonthsParse,s))||-1!==(i=Qu.call(this._longMonthsParse,s))?i:null:-1!==(i=Qu.call(this._longMonthsParse,s))||-1!==(i=Qu.call(this._shortMonthsParse,s))?i:null}function cd(t,e){if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=Du(e);else if(!Pc(e=t.localeData().monthsParse(e)))return t;var n=e,o=t.date();return o=o<29?o:Math.min(o,od(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,o):t._d.setMonth(n,o),t}function ud(t){return null!=t?(cd(this,t),kc.updateOffset(this,!0),this):ed(this,"Month")}function dd(){function t(t,e){return e.length-t.length}var e,n,o,i,r=[],s=[],l=[];for(e=0;e<12;e++)n=Vc([2e3,e]),o=Pu(this.monthsShort(n,"")),i=Pu(this.months(n,"")),r.push(o),s.push(i),l.push(i),l.push(o);r.sort(t),s.sort(t),l.sort(t),this._monthsRegex=new RegExp("^("+l.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function gd(t,e,n,o,i,r,s){var l;return t<100&&t>=0?(l=new Date(t+400,e,n,o,i,r,s),isFinite(l.getFullYear())&&l.setFullYear(t)):l=new Date(t,e,n,o,i,r,s),l}function fd(t){var e,n;return t<100&&t>=0?((n=Array.prototype.slice.call(arguments))[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function pd(t,e,n){var o=7+e-n;return-((7+fd(t,0,o).getUTCDay()-e)%7)+o-1}function md(t,e,n,o,i){var r,s,l=1+7*(e-1)+(7+n-o)%7+pd(t,o,i);return l<=0?s=Zu(r=t-1)+l:l>Zu(t)?(r=t+1,s=l-Zu(t)):(r=t,s=l),{year:r,dayOfYear:s}}function wd(t,e,n){var o,i,r=pd(t.year(),e,n),s=Math.floor((t.dayOfYear()-r-1)/7)+1;return s<1?o=s+bd(i=t.year()-1,e,n):s>bd(t.year(),e,n)?(o=s-bd(t.year(),e,n),i=t.year()+1):(i=t.year(),o=s),{week:o,year:i}}function bd(t,e,n){var o=pd(t,e,n),i=pd(t+1,e,n);return(Zu(t)-o+i)/7}su("w",["ww",2],"wo","week"),su("W",["WW",2],"Wo","isoWeek"),Ou("w",vu,Hu),Ou("ww",vu,pu),Ou("W",vu,Hu),Ou("WW",vu,pu),Fu(["w","ww","W","WW"],(function(t,e,n,o){e[o.substr(0,1)]=Du(t)}));function vd(t,e){return t.slice(e,7).concat(t.slice(0,e))}su("d",0,"do","day"),su("dd",0,0,(function(t){return this.localeData().weekdaysMin(this,t)})),su("ddd",0,0,(function(t){return this.localeData().weekdaysShort(this,t)})),su("dddd",0,0,(function(t){return this.localeData().weekdays(this,t)})),su("e",0,0,"weekday"),su("E",0,0,"isoWeekday"),Ou("d",vu),Ou("e",vu),Ou("E",vu),Ou("dd",(function(t,e){return e.weekdaysMinRegex(t)})),Ou("ddd",(function(t,e){return e.weekdaysShortRegex(t)})),Ou("dddd",(function(t,e){return e.weekdaysRegex(t)})),Fu(["dd","ddd","dddd"],(function(t,e,n,o){var i=n._locale.weekdaysParse(t,o,n._strict);null!=i?e.d=i:Fc(n).invalidWeekday=t})),Fu(["d","e","E"],(function(t,e,n,o){e[o]=Du(t)}));var yd="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Cd="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Sd="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Rd=Au,xd=Au,Ed=Au;function Md(t,e,n){var o,i,r,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],o=0;o<7;++o)r=Vc([2e3,1]).day(o),this._minWeekdaysParse[o]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[o]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[o]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===e?-1!==(i=Qu.call(this._weekdaysParse,s))?i:null:"ddd"===e?-1!==(i=Qu.call(this._shortWeekdaysParse,s))?i:null:-1!==(i=Qu.call(this._minWeekdaysParse,s))?i:null:"dddd"===e?-1!==(i=Qu.call(this._weekdaysParse,s))||-1!==(i=Qu.call(this._shortWeekdaysParse,s))||-1!==(i=Qu.call(this._minWeekdaysParse,s))?i:null:"ddd"===e?-1!==(i=Qu.call(this._shortWeekdaysParse,s))||-1!==(i=Qu.call(this._weekdaysParse,s))||-1!==(i=Qu.call(this._minWeekdaysParse,s))?i:null:-1!==(i=Qu.call(this._minWeekdaysParse,s))||-1!==(i=Qu.call(this._weekdaysParse,s))||-1!==(i=Qu.call(this._shortWeekdaysParse,s))?i:null}function Td(){function t(t,e){return e.length-t.length}var e,n,o,i,r,s=[],l=[],a=[],h=[];for(e=0;e<7;e++)n=Vc([2e3,1]).day(e),o=Pu(this.weekdaysMin(n,"")),i=Pu(this.weekdaysShort(n,"")),r=Pu(this.weekdays(n,"")),s.push(o),l.push(i),a.push(r),h.push(o),h.push(i),h.push(r);s.sort(t),l.sort(t),a.sort(t),h.sort(t),this._weekdaysRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function kd(){return this.hours()%12||12}function Ad(t,e){su(t,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)}))}function Hd(t,e){return e._meridiemParse}su("H",["HH",2],0,"hour"),su("h",["hh",2],0,kd),su("k",["kk",2],0,(function(){return this.hours()||24})),su("hmm",0,0,(function(){return""+kd.apply(this)+eu(this.minutes(),2)})),su("hmmss",0,0,(function(){return""+kd.apply(this)+eu(this.minutes(),2)+eu(this.seconds(),2)})),su("Hmm",0,0,(function(){return""+this.hours()+eu(this.minutes(),2)})),su("Hmmss",0,0,(function(){return""+this.hours()+eu(this.minutes(),2)+eu(this.seconds(),2)})),Ad("a",!0),Ad("A",!1),Ou("a",Hd),Ou("A",Hd),Ou("H",vu,Iu),Ou("h",vu,Hu),Ou("k",vu,Hu),Ou("HH",vu,pu),Ou("hh",vu,pu),Ou("kk",vu,pu),Ou("hmm",yu),Ou("hmmss",Cu),Ou("Hmm",yu),Ou("Hmmss",Cu),Vu(["H","HH"],Yu),Vu(["k","kk"],(function(t,e,n){var o=Du(t);e[Yu]=24===o?0:o})),Vu(["a","A"],(function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t})),Vu(["h","hh"],(function(t,e,n){e[Yu]=Du(t),Fc(n).bigHour=!0})),Vu("hmm",(function(t,e,n){var o=t.length-2;e[Yu]=Du(t.substr(0,o)),e[$u]=Du(t.substr(o)),Fc(n).bigHour=!0})),Vu("hmmss",(function(t,e,n){var o=t.length-4,i=t.length-2;e[Yu]=Du(t.substr(0,o)),e[$u]=Du(t.substr(o,2)),e[Gu]=Du(t.substr(i)),Fc(n).bigHour=!0})),Vu("Hmm",(function(t,e,n){var o=t.length-2;e[Yu]=Du(t.substr(0,o)),e[$u]=Du(t.substr(o))})),Vu("Hmmss",(function(t,e,n){var o=t.length-4,i=t.length-2;e[Yu]=Du(t.substr(0,o)),e[$u]=Du(t.substr(o,2)),e[Gu]=Du(t.substr(i))}));var Id=td("Hours",!0);var Od,_d={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:id,monthsShort:rd,week:{dow:0,doy:6},weekdays:yd,weekdaysMin:Sd,weekdaysShort:Cd,meridiemParse:/[ap]\.?m?\.?/i},Pd={},Nd={};function Dd(t,e){var n,o=Math.min(t.length,e.length);for(n=0;n<o;n+=1)if(t[n]!==e[n])return n;return o}function Ld(t){return t?t.toLowerCase().replace("_","-"):t}function Vd(t){var e=null;if(void 0===Pd[t]&&void 0!==G&&G&&G.exports&&function(t){return!(!t||!t.match("^[^/\\\\]*$"))}(t))try{e=Od._abbr,require("./locale/"+t),Fd(e)}catch(n){Pd[t]=null}return Pd[t]}function Fd(t,e){var n;return t&&((n=_c(e)?Bd(t):Wd(t,e))?Od=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Od._abbr}function Wd(t,e){if(null!==e){var n,o=_d;if(e.abbr=t,null!=Pd[t])Zc("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),o=Pd[t]._config;else if(null!=e.parentLocale)if(null!=Pd[e.parentLocale])o=Pd[e.parentLocale]._config;else{if(null==(n=Vd(e.parentLocale)))return Nd[e.parentLocale]||(Nd[e.parentLocale]=[]),Nd[e.parentLocale].push({name:t,config:e}),null;o=n._config}return Pd[t]=new tu(Jc(o,e)),Nd[t]&&Nd[t].forEach((function(t){Wd(t.name,t.config)})),Fd(t),Pd[t]}return delete Pd[t],null}function Bd(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Od;if(!Ac(t)){if(e=Vd(t))return e;t=[t]}return function(t){for(var e,n,o,i,r=0;r<t.length;){for(e=(i=Ld(t[r]).split("-")).length,n=(n=Ld(t[r+1]))?n.split("-"):null;e>0;){if(o=Vd(i.slice(0,e).join("-")))return o;if(n&&n.length>=e&&Dd(i,n)>=e-1)break;e--}r++}return Od}(t)}function jd(t){var e,n=t._a;return n&&-2===Fc(t).overflow&&(e=n[zu]<0||n[zu]>11?zu:n[Uu]<1||n[Uu]>od(n[ju],n[zu])?Uu:n[Yu]<0||n[Yu]>24||24===n[Yu]&&(0!==n[$u]||0!==n[Gu]||0!==n[Ku])?Yu:n[$u]<0||n[$u]>59?$u:n[Gu]<0||n[Gu]>59?Gu:n[Ku]<0||n[Ku]>999?Ku:-1,Fc(t)._overflowDayOfYear&&(e<ju||e>Uu)&&(e=Uu),Fc(t)._overflowWeeks&&-1===e&&(e=Xu),Fc(t)._overflowWeekday&&-1===e&&(e=qu),Fc(t).overflow=e),t}var zd=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ud=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Yd=/Z|[+-]\d\d(?::?\d\d)?/,$d=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Gd=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Kd=/^\/?Date\((-?\d+)/i,Xd=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,qd={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Zd(t){var e,n,o,i,r,s,l=t._i,a=zd.exec(l)||Ud.exec(l),h=$d.length,c=Gd.length;if(a){for(Fc(t).iso=!0,e=0,n=h;e<n;e++)if($d[e][1].exec(a[1])){i=$d[e][0],o=!1!==$d[e][2];break}if(null==i)return void(t._isValid=!1);if(a[3]){for(e=0,n=c;e<n;e++)if(Gd[e][1].exec(a[3])){r=(a[2]||" ")+Gd[e][0];break}if(null==r)return void(t._isValid=!1)}if(!o&&null!=r)return void(t._isValid=!1);if(a[4]){if(!Yd.exec(a[4]))return void(t._isValid=!1);s="Z"}t._f=i+(r||"")+(s||""),ng(t)}else t._isValid=!1}function Qd(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Jd(t){var e,n,o,i,r,s,l,a,h=Xd.exec(t._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(h){if(n=h[4],o=h[3],i=h[2],r=h[5],s=h[6],l=h[7],a=[Qd(n),rd.indexOf(o),parseInt(i,10),parseInt(r,10),parseInt(s,10)],l&&a.push(parseInt(l,10)),e=a,!function(t,e,n){return!t||Cd.indexOf(t)===new Date(e[0],e[1],e[2]).getDay()||(Fc(n).weekdayMismatch=!0,n._isValid=!1,!1)}(h[1],e,t))return;t._a=e,t._tzm=function(t,e,n){if(t)return qd[t];if(e)return 0;var o=parseInt(n,10),i=o%100;return(o-i)/100*60+i}(h[8],h[9],h[10]),t._d=fd.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Fc(t).rfc2822=!0}else t._isValid=!1}function tg(t,e,n){return null!=t?t:null!=e?e:n}function eg(t){var e,n,o,i,r,s=[];if(!t._d){for(o=function(t){var e=new Date(kc.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}(t),t._w&&null==t._a[Uu]&&null==t._a[zu]&&function(t){var e,n,o,i,r,s,l,a,h;e=t._w,null!=e.GG||null!=e.W||null!=e.E?(r=1,s=4,n=tg(e.GG,t._a[ju],wd(rg(),1,4).year),o=tg(e.W,1),((i=tg(e.E,1))<1||i>7)&&(a=!0)):(r=t._locale._week.dow,s=t._locale._week.doy,h=wd(rg(),r,s),n=tg(e.gg,t._a[ju],h.year),o=tg(e.w,h.week),null!=e.d?((i=e.d)<0||i>6)&&(a=!0):null!=e.e?(i=e.e+r,(e.e<0||e.e>6)&&(a=!0)):i=r);o<1||o>bd(n,r,s)?Fc(t)._overflowWeeks=!0:null!=a?Fc(t)._overflowWeekday=!0:(l=md(n,o,i,r,s),t._a[ju]=l.year,t._dayOfYear=l.dayOfYear)}(t),null!=t._dayOfYear&&(r=tg(t._a[ju],o[ju]),(t._dayOfYear>Zu(r)||0===t._dayOfYear)&&(Fc(t)._overflowDayOfYear=!0),n=fd(r,0,t._dayOfYear),t._a[zu]=n.getUTCMonth(),t._a[Uu]=n.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=s[e]=o[e];for(;e<7;e++)t._a[e]=s[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[Yu]&&0===t._a[$u]&&0===t._a[Gu]&&0===t._a[Ku]&&(t._nextDay=!0,t._a[Yu]=0),t._d=(t._useUTC?fd:gd).apply(null,s),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Yu]=24),t._w&&void 0!==t._w.d&&t._w.d!==i&&(Fc(t).weekdayMismatch=!0)}}function ng(t){if(t._f!==kc.ISO_8601)if(t._f!==kc.RFC_2822){t._a=[],Fc(t).empty=!0;var e,n,o,i,r,s,l,a=""+t._i,h=a.length,c=0;for(l=(o=au(t._f,t._locale).match(nu)||[]).length,e=0;e<l;e++)i=o[e],(n=(a.match(_u(i,t))||[])[0])&&((r=a.substr(0,a.indexOf(n))).length>0&&Fc(t).unusedInput.push(r),a=a.slice(a.indexOf(n)+n.length),c+=n.length),ru[i]?(n?Fc(t).empty=!1:Fc(t).unusedTokens.push(i),Wu(i,n,t)):t._strict&&!n&&Fc(t).unusedTokens.push(i);Fc(t).charsLeftOver=h-c,a.length>0&&Fc(t).unusedInput.push(a),t._a[Yu]<=12&&!0===Fc(t).bigHour&&t._a[Yu]>0&&(Fc(t).bigHour=void 0),Fc(t).parsedDateParts=t._a.slice(0),Fc(t).meridiem=t._meridiem,t._a[Yu]=function(t,e,n){var o;if(null==n)return e;return null!=t.meridiemHour?t.meridiemHour(e,n):null!=t.isPM?((o=t.isPM(n))&&e<12&&(e+=12),o||12!==e||(e=0),e):e}(t._locale,t._a[Yu],t._meridiem),null!==(s=Fc(t).era)&&(t._a[ju]=t._locale.erasConvertYear(s,t._a[ju])),eg(t),jd(t)}else Jd(t);else Zd(t)}function og(t){var e=t._i,n=t._f;return t._locale=t._locale||Bd(t._l),null===e||void 0===n&&""===e?Bc({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),$c(e)?new Yc(jd(e)):(Nc(e)?t._d=e:Ac(n)?function(t){var e,n,o,i,r,s,l=!1,a=t._f.length;if(0===a)return Fc(t).invalidFormat=!0,void(t._d=new Date(NaN));for(i=0;i<a;i++)r=0,s=!1,e=Uc({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[i],ng(e),Wc(e)&&(s=!0),r+=Fc(e).charsLeftOver,r+=10*Fc(e).unusedTokens.length,Fc(e).score=r,l?r<o&&(o=r,n=e):(null==o||r<o||s)&&(o=r,n=e,s&&(l=!0));Lc(t,n||e)}(t):n?ng(t):function(t){var e=t._i;_c(e)?t._d=new Date(kc.now()):Nc(e)?t._d=new Date(e.valueOf()):"string"==typeof e?function(t){var e=Kd.exec(t._i);null===e?(Zd(t),!1===t._isValid&&(delete t._isValid,Jd(t),!1===t._isValid&&(delete t._isValid,t._strict?t._isValid=!1:kc.createFromInputFallback(t)))):t._d=new Date(+e[1])}(t):Ac(e)?(t._a=Dc(e.slice(0),(function(t){return parseInt(t,10)})),eg(t)):Hc(e)?function(t){if(!t._d){var e=uu(t._i),n=void 0===e.day?e.date:e.day;t._a=Dc([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],(function(t){return t&&parseInt(t,10)})),eg(t)}}(t):Pc(e)?t._d=new Date(e):kc.createFromInputFallback(t)}(t),Wc(t)||(t._d=null),t))}function ig(t,e,n,o,i){var r,s={};return!0!==e&&!1!==e||(o=e,e=void 0),!0!==n&&!1!==n||(o=n,n=void 0),(Hc(t)&&Oc(t)||Ac(t)&&0===t.length)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=n,s._i=t,s._f=e,s._strict=o,(r=new Yc(jd(og(s))))._nextDay&&(r.add(1,"d"),r._nextDay=void 0),r}function rg(t,e,n,o){return ig(t,e,n,o,!1)}kc.createFromInputFallback=Kc("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))})),kc.ISO_8601=function(){},kc.RFC_2822=function(){};var sg=Kc("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=rg.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Bc()})),lg=Kc("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=rg.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Bc()}));function ag(t,e){var n,o;if(1===e.length&&Ac(e[0])&&(e=e[0]),!e.length)return rg();for(n=e[0],o=1;o<e.length;++o)e[o].isValid()&&!e[o][t](n)||(n=e[o]);return n}var hg=["year","quarter","month","week","day","hour","minute","second","millisecond"];function cg(t){var e=uu(t),n=e.year||0,o=e.quarter||0,i=e.month||0,r=e.week||e.isoWeek||0,s=e.day||0,l=e.hour||0,a=e.minute||0,h=e.second||0,c=e.millisecond||0;this._isValid=function(t){var e,n,o=!1,i=hg.length;for(e in t)if(Ic(t,e)&&(-1===Qu.call(hg,e)||null!=t[e]&&isNaN(t[e])))return!1;for(n=0;n<i;++n)if(t[hg[n]]){if(o)return!1;parseFloat(t[hg[n]])!==Du(t[hg[n]])&&(o=!0)}return!0}(e),this._milliseconds=+c+1e3*h+6e4*a+1e3*l*60*60,this._days=+s+7*r,this._months=+i+3*o+12*n,this._data={},this._locale=Bd(),this._bubble()}function ug(t){return t instanceof cg}function dg(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function gg(t,e){su(t,0,0,(function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+eu(~~(t/60),2)+e+eu(~~t%60,2)}))}gg("Z",":"),gg("ZZ",""),Ou("Z",ku),Ou("ZZ",ku),Vu(["Z","ZZ"],(function(t,e,n){n._useUTC=!0,n._tzm=pg(ku,t)}));var fg=/([\+\-]|\d\d)/gi;function pg(t,e){var n,o,i=(e||"").match(t);return null===i?null:0===(o=60*(n=((i[i.length-1]||[])+"").match(fg)||["-",0,0])[1]+Du(n[2]))?0:"+"===n[0]?o:-o}function mg(t,e){var n,o;return e._isUTC?(n=e.clone(),o=($c(t)||Nc(t)?t.valueOf():rg(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+o),kc.updateOffset(n,!1),n):rg(t).local()}function wg(t){return-Math.round(t._d.getTimezoneOffset())}function bg(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}kc.updateOffset=function(){};var vg=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,yg=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Cg(t,e){var n,o,i,r=t,s=null;return ug(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Pc(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(s=vg.exec(t))?(n="-"===s[1]?-1:1,r={y:0,d:Du(s[Uu])*n,h:Du(s[Yu])*n,m:Du(s[$u])*n,s:Du(s[Gu])*n,ms:Du(dg(1e3*s[Ku]))*n}):(s=yg.exec(t))?(n="-"===s[1]?-1:1,r={y:Sg(s[2],n),M:Sg(s[3],n),w:Sg(s[4],n),d:Sg(s[5],n),h:Sg(s[6],n),m:Sg(s[7],n),s:Sg(s[8],n)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(i=function(t,e){var n;if(!t.isValid()||!e.isValid())return{milliseconds:0,months:0};e=mg(e,t),t.isBefore(e)?n=Rg(t,e):((n=Rg(e,t)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(rg(r.from),rg(r.to)),(r={}).ms=i.milliseconds,r.M=i.months),o=new cg(r),ug(t)&&Ic(t,"_locale")&&(o._locale=t._locale),ug(t)&&Ic(t,"_isValid")&&(o._isValid=t._isValid),o}function Sg(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Rg(t,e){var n={};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function xg(t,e){return function(n,o){var i;return null===o||isNaN(+o)||(Zc(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=o,o=i),Eg(this,Cg(n,o),t),this}}function Eg(t,e,n,o){var i=e._milliseconds,r=dg(e._days),s=dg(e._months);t.isValid()&&(o=null==o||o,s&&cd(t,ed(t,"Month")+s*n),r&&nd(t,"Date",ed(t,"Date")+r*n),i&&t._d.setTime(t._d.valueOf()+i*n),o&&kc.updateOffset(t,r||s))}Cg.fn=cg.prototype,Cg.invalid=function(){return Cg(NaN)};var Mg=xg(1,"add"),Tg=xg(-1,"subtract");function kg(t){return"string"==typeof t||t instanceof String}function Ag(t){return $c(t)||Nc(t)||kg(t)||Pc(t)||function(t){var e=Ac(t),n=!1;e&&(n=0===t.filter((function(e){return!Pc(e)&&kg(t)})).length);return e&&n}(t)||function(t){var e,n,o=Hc(t)&&!Oc(t),i=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s=r.length;for(e=0;e<s;e+=1)n=r[e],i=i||Ic(t,n);return o&&i}(t)||null==t}function Hg(t,e){if(t.date()<e.date())return-Hg(e,t);var n=12*(e.year()-t.year())+(e.month()-t.month()),o=t.clone().add(n,"months");return-(n+(e-o<0?(e-o)/(o-t.clone().add(n-1,"months")):(e-o)/(t.clone().add(n+1,"months")-o)))||0}function Ig(t){var e;return void 0===t?this._locale._abbr:(null!=(e=Bd(t))&&(this._locale=e),this)}kc.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",kc.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Og=Kc("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(t){return void 0===t?this.localeData():this.locale(t)}));function _g(){return this._locale}var Pg=1e3,Ng=6e4,Dg=36e5,Lg=126227808e5;function Vg(t,e){return(t%e+e)%e}function Fg(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-Lg:new Date(t,e,n).valueOf()}function Wg(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-Lg:Date.UTC(t,e,n)}function Bg(t,e){return e.erasAbbrRegex(t)}function jg(){var t,e,n,o,i,r=[],s=[],l=[],a=[],h=this.eras();for(t=0,e=h.length;t<e;++t)n=Pu(h[t].name),o=Pu(h[t].abbr),i=Pu(h[t].narrow),s.push(n),r.push(o),l.push(i),a.push(n),a.push(o),a.push(i);this._erasRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+s.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+l.join("|")+")","i")}function zg(t,e){su(0,[t,t.length],0,e)}function Ug(t,e,n,o,i){var r;return null==t?wd(this,o,i).year:(e>(r=bd(t,o,i))&&(e=r),Yg.call(this,t,e,n,o,i))}function Yg(t,e,n,o,i){var r=md(t,e,n,o,i),s=fd(r.year,0,r.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}su("N",0,0,"eraAbbr"),su("NN",0,0,"eraAbbr"),su("NNN",0,0,"eraAbbr"),su("NNNN",0,0,"eraName"),su("NNNNN",0,0,"eraNarrow"),su("y",["y",1],"yo","eraYear"),su("y",["yy",2],0,"eraYear"),su("y",["yyy",3],0,"eraYear"),su("y",["yyyy",4],0,"eraYear"),Ou("N",Bg),Ou("NN",Bg),Ou("NNN",Bg),Ou("NNNN",(function(t,e){return e.erasNameRegex(t)})),Ou("NNNNN",(function(t,e){return e.erasNarrowRegex(t)})),Vu(["N","NN","NNN","NNNN","NNNNN"],(function(t,e,n,o){var i=n._locale.erasParse(t,o,n._strict);i?Fc(n).era=i:Fc(n).invalidEra=t})),Ou("y",Eu),Ou("yy",Eu),Ou("yyy",Eu),Ou("yyyy",Eu),Ou("yo",(function(t,e){return e._eraYearOrdinalRegex||Eu})),Vu(["y","yy","yyy","yyyy"],ju),Vu(["yo"],(function(t,e,n,o){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[ju]=n._locale.eraYearOrdinalParse(t,i):e[ju]=parseInt(t,10)})),su(0,["gg",2],0,(function(){return this.weekYear()%100})),su(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),zg("gggg","weekYear"),zg("ggggg","weekYear"),zg("GGGG","isoWeekYear"),zg("GGGGG","isoWeekYear"),Ou("G",Mu),Ou("g",Mu),Ou("GG",vu,pu),Ou("gg",vu,pu),Ou("GGGG",Ru,wu),Ou("gggg",Ru,wu),Ou("GGGGG",xu,bu),Ou("ggggg",xu,bu),Fu(["gggg","ggggg","GGGG","GGGGG"],(function(t,e,n,o){e[o.substr(0,2)]=Du(t)})),Fu(["gg","GG"],(function(t,e,n,o){e[o]=kc.parseTwoDigitYear(t)})),su("Q",0,"Qo","quarter"),Ou("Q",fu),Vu("Q",(function(t,e){e[zu]=3*(Du(t)-1)})),su("D",["DD",2],"Do","date"),Ou("D",vu,Hu),Ou("DD",vu,pu),Ou("Do",(function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient})),Vu(["D","DD"],Uu),Vu("Do",(function(t,e){e[Uu]=Du(t.match(vu)[0])}));var $g=td("Date",!0);su("DDD",["DDDD",3],"DDDo","dayOfYear"),Ou("DDD",Su),Ou("DDDD",mu),Vu(["DDD","DDDD"],(function(t,e,n){n._dayOfYear=Du(t)})),su("m",["mm",2],0,"minute"),Ou("m",vu,Iu),Ou("mm",vu,pu),Vu(["m","mm"],$u);var Gg=td("Minutes",!1);su("s",["ss",2],0,"second"),Ou("s",vu,Iu),Ou("ss",vu,pu),Vu(["s","ss"],Gu);var Kg,Xg,qg=td("Seconds",!1);for(su("S",0,0,(function(){return~~(this.millisecond()/100)})),su(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),su(0,["SSS",3],0,"millisecond"),su(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),su(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),su(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),su(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),su(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),su(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),Ou("S",Su,fu),Ou("SS",Su,pu),Ou("SSS",Su,mu),Kg="SSSS";Kg.length<=9;Kg+="S")Ou(Kg,Eu);function Zg(t,e){e[Ku]=Du(1e3*("0."+t))}for(Kg="S";Kg.length<=9;Kg+="S")Vu(Kg,Zg);Xg=td("Milliseconds",!1),su("z",0,0,"zoneAbbr"),su("zz",0,0,"zoneName");var Qg=Yc.prototype;function Jg(t){return t}Qg.add=Mg,Qg.calendar=function(t,e){1===arguments.length&&(arguments[0]?Ag(arguments[0])?(t=arguments[0],e=void 0):function(t){var e,n=Hc(t)&&!Oc(t),o=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(e=0;e<i.length;e+=1)o=o||Ic(t,i[e]);return n&&o}(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||rg(),o=mg(n,this).startOf("day"),i=kc.calendarFormat(this,o)||"sameElse",r=e&&(Qc(e[i])?e[i].call(this,n):e[i]);return this.format(r||this.localeData().calendar(i,this,rg(n)))},Qg.clone=function(){return new Yc(this)},Qg.diff=function(t,e,n){var o,i,r;if(!this.isValid())return NaN;if(!(o=mg(t,this)).isValid())return NaN;switch(i=6e4*(o.utcOffset()-this.utcOffset()),e=cu(e)){case"year":r=Hg(this,o)/12;break;case"month":r=Hg(this,o);break;case"quarter":r=Hg(this,o)/3;break;case"second":r=(this-o)/1e3;break;case"minute":r=(this-o)/6e4;break;case"hour":r=(this-o)/36e5;break;case"day":r=(this-o-i)/864e5;break;case"week":r=(this-o-i)/6048e5;break;default:r=this-o}return n?r:Nu(r)},Qg.endOf=function(t){var e,n;if(void 0===(t=cu(t))||"millisecond"===t||!this.isValid())return this;switch(n=this._isUTC?Wg:Fg,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Dg-Vg(e+(this._isUTC?0:this.utcOffset()*Ng),Dg)-1;break;case"minute":e=this._d.valueOf(),e+=Ng-Vg(e,Ng)-1;break;case"second":e=this._d.valueOf(),e+=Pg-Vg(e,Pg)-1}return this._d.setTime(e),kc.updateOffset(this,!0),this},Qg.format=function(t){t||(t=this.isUtc()?kc.defaultFormatUtc:kc.defaultFormat);var e=lu(this,t);return this.localeData().postformat(e)},Qg.from=function(t,e){return this.isValid()&&($c(t)&&t.isValid()||rg(t).isValid())?Cg({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},Qg.fromNow=function(t){return this.from(rg(),t)},Qg.to=function(t,e){return this.isValid()&&($c(t)&&t.isValid()||rg(t).isValid())?Cg({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},Qg.toNow=function(t){return this.to(rg(),t)},Qg.get=function(t){return Qc(this[t=cu(t)])?this[t]():this},Qg.invalidAt=function(){return Fc(this).overflow},Qg.isAfter=function(t,e){var n=$c(t)?t:rg(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=cu(e)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())},Qg.isBefore=function(t,e){var n=$c(t)?t:rg(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=cu(e)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())},Qg.isBetween=function(t,e,n,o){var i=$c(t)?t:rg(t),r=$c(e)?e:rg(e);return!!(this.isValid()&&i.isValid()&&r.isValid())&&(("("===(o=o||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===o[1]?this.isBefore(r,n):!this.isAfter(r,n)))},Qg.isSame=function(t,e){var n,o=$c(t)?t:rg(t);return!(!this.isValid()||!o.isValid())&&("millisecond"===(e=cu(e)||"millisecond")?this.valueOf()===o.valueOf():(n=o.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))},Qg.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},Qg.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},Qg.isValid=function(){return Wc(this)},Qg.lang=Og,Qg.locale=Ig,Qg.localeData=_g,Qg.max=lg,Qg.min=sg,Qg.parsingFlags=function(){return Lc({},Fc(this))},Qg.set=function(t,e){if("object"==typeof t){var n,o=function(t){var e,n=[];for(e in t)Ic(t,e)&&n.push({unit:e,priority:du[e]});return n.sort((function(t,e){return t.priority-e.priority})),n}(t=uu(t)),i=o.length;for(n=0;n<i;n++)this[o[n].unit](t[o[n].unit])}else if(Qc(this[t=cu(t)]))return this[t](e);return this},Qg.startOf=function(t){var e,n;if(void 0===(t=cu(t))||"millisecond"===t||!this.isValid())return this;switch(n=this._isUTC?Wg:Fg,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Vg(e+(this._isUTC?0:this.utcOffset()*Ng),Dg);break;case"minute":e=this._d.valueOf(),e-=Vg(e,Ng);break;case"second":e=this._d.valueOf(),e-=Vg(e,Pg)}return this._d.setTime(e),kc.updateOffset(this,!0),this},Qg.subtract=Tg,Qg.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},Qg.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},Qg.toDate=function(){return new Date(this.valueOf())},Qg.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?lu(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Qc(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",lu(n,"Z")):lu(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},Qg.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t,e,n,o="moment",i="";return this.isLocal()||(o=0===this.utcOffset()?"moment.utc":"moment.parseZone",i="Z"),t="["+o+'("]',e=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n=i+'[")]',this.format(t+e+"-MM-DD[T]HH:mm:ss.SSS"+n)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(Qg[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Qg.toJSON=function(){return this.isValid()?this.toISOString():null},Qg.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},Qg.unix=function(){return Math.floor(this.valueOf()/1e3)},Qg.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},Qg.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},Qg.eraName=function(){var t,e,n,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t){if(n=this.clone().startOf("day").valueOf(),o[t].since<=n&&n<=o[t].until)return o[t].name;if(o[t].until<=n&&n<=o[t].since)return o[t].name}return""},Qg.eraNarrow=function(){var t,e,n,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t){if(n=this.clone().startOf("day").valueOf(),o[t].since<=n&&n<=o[t].until)return o[t].narrow;if(o[t].until<=n&&n<=o[t].since)return o[t].narrow}return""},Qg.eraAbbr=function(){var t,e,n,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t){if(n=this.clone().startOf("day").valueOf(),o[t].since<=n&&n<=o[t].until)return o[t].abbr;if(o[t].until<=n&&n<=o[t].since)return o[t].abbr}return""},Qg.eraYear=function(){var t,e,n,o,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,o=this.clone().startOf("day").valueOf(),i[t].since<=o&&o<=i[t].until||i[t].until<=o&&o<=i[t].since)return(this.year()-kc(i[t].since).year())*n+i[t].offset;return this.year()},Qg.year=Ju,Qg.isLeapYear=function(){return Bu(this.year())},Qg.weekYear=function(t){return Ug.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)},Qg.isoWeekYear=function(t){return Ug.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},Qg.quarter=Qg.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},Qg.month=ud,Qg.daysInMonth=function(){return od(this.year(),this.month())},Qg.week=Qg.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},Qg.isoWeek=Qg.isoWeeks=function(t){var e=wd(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},Qg.weeksInYear=function(){var t=this.localeData()._week;return bd(this.year(),t.dow,t.doy)},Qg.weeksInWeekYear=function(){var t=this.localeData()._week;return bd(this.weekYear(),t.dow,t.doy)},Qg.isoWeeksInYear=function(){return bd(this.year(),1,4)},Qg.isoWeeksInISOWeekYear=function(){return bd(this.isoWeekYear(),1,4)},Qg.date=$g,Qg.day=Qg.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=ed(this,"Day");return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},Qg.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},Qg.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},Qg.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},Qg.hour=Qg.hours=Id,Qg.minute=Qg.minutes=Gg,Qg.second=Qg.seconds=qg,Qg.millisecond=Qg.milliseconds=Xg,Qg.utcOffset=function(t,e,n){var o,i=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(null===(t=pg(ku,t)))return this}else Math.abs(t)<16&&!n&&(t*=60);return!this._isUTC&&e&&(o=wg(this)),this._offset=t,this._isUTC=!0,null!=o&&this.add(o,"m"),i!==t&&(!e||this._changeInProgress?Eg(this,Cg(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,kc.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:wg(this)},Qg.utc=function(t){return this.utcOffset(0,t)},Qg.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(wg(this),"m")),this},Qg.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=pg(Tu,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},Qg.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?rg(t).utcOffset():0,(this.utcOffset()-t)%60==0)},Qg.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},Qg.isLocal=function(){return!!this.isValid()&&!this._isUTC},Qg.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},Qg.isUtc=bg,Qg.isUTC=bg,Qg.zoneAbbr=function(){return this._isUTC?"UTC":""},Qg.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},Qg.dates=Kc("dates accessor is deprecated. Use date instead.",$g),Qg.months=Kc("months accessor is deprecated. Use month instead",ud),Qg.years=Kc("years accessor is deprecated. Use year instead",Ju),Qg.zone=Kc("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()})),Qg.isDSTShifted=Kc("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!_c(this._isDSTShifted))return this._isDSTShifted;var t,e={};return Uc(e,this),(e=og(e))._a?(t=e._isUTC?Vc(e._a):rg(e._a),this._isDSTShifted=this.isValid()&&function(t,e,n){var o,i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0;for(o=0;o<i;o++)(n&&t[o]!==e[o]||!n&&Du(t[o])!==Du(e[o]))&&s++;return s+r}(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}));var tf=tu.prototype;function ef(t,e,n,o){var i=Bd(),r=Vc().set(o,e);return i[n](r,t)}function nf(t,e,n){if(Pc(t)&&(e=t,t=void 0),t=t||"",null!=e)return ef(t,e,n,"month");var o,i=[];for(o=0;o<12;o++)i[o]=ef(t,o,n,"month");return i}function of(t,e,n,o){"boolean"==typeof t?(Pc(e)&&(n=e,e=void 0),e=e||""):(n=e=t,t=!1,Pc(e)&&(n=e,e=void 0),e=e||"");var i,r=Bd(),s=t?r._week.dow:0,l=[];if(null!=n)return ef(e,(n+s)%7,o,"day");for(i=0;i<7;i++)l[i]=ef(e,(i+s)%7,o,"day");return l}tf.calendar=function(t,e,n){var o=this._calendar[t]||this._calendar.sameElse;return Qc(o)?o.call(e,n):o},tf.longDateFormat=function(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(nu).map((function(t){return"MMMM"===t||"MM"===t||"DD"===t||"dddd"===t?t.slice(1):t})).join(""),this._longDateFormat[t])},tf.invalidDate=function(){return this._invalidDate},tf.ordinal=function(t){return this._ordinal.replace("%d",t)},tf.preparse=Jg,tf.postformat=Jg,tf.relativeTime=function(t,e,n,o){var i=this._relativeTime[n];return Qc(i)?i(t,e,n,o):i.replace(/%d/i,t)},tf.pastFuture=function(t,e){var n=this._relativeTime[t>0?"future":"past"];return Qc(n)?n(e):n.replace(/%s/i,e)},tf.set=function(t){var e,n;for(n in t)Ic(t,n)&&(Qc(e=t[n])?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},tf.eras=function(t,e){var n,o,i,r=this._eras||Bd("en")._eras;for(n=0,o=r.length;n<o;++n){if("string"==typeof r[n].since)i=kc(r[n].since).startOf("day"),r[n].since=i.valueOf();switch(typeof r[n].until){case"undefined":r[n].until=1/0;break;case"string":i=kc(r[n].until).startOf("day").valueOf(),r[n].until=i.valueOf()}}return r},tf.erasParse=function(t,e,n){var o,i,r,s,l,a=this.eras();for(t=t.toUpperCase(),o=0,i=a.length;o<i;++o)if(r=a[o].name.toUpperCase(),s=a[o].abbr.toUpperCase(),l=a[o].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(s===t)return a[o];break;case"NNNN":if(r===t)return a[o];break;case"NNNNN":if(l===t)return a[o]}else if([r,s,l].indexOf(t)>=0)return a[o]},tf.erasConvertYear=function(t,e){var n=t.since<=t.until?1:-1;return void 0===e?kc(t.since).year():kc(t.since).year()+(e-t.offset)*n},tf.erasAbbrRegex=function(t){return Ic(this,"_erasAbbrRegex")||jg.call(this),t?this._erasAbbrRegex:this._erasRegex},tf.erasNameRegex=function(t){return Ic(this,"_erasNameRegex")||jg.call(this),t?this._erasNameRegex:this._erasRegex},tf.erasNarrowRegex=function(t){return Ic(this,"_erasNarrowRegex")||jg.call(this),t?this._erasNarrowRegex:this._erasRegex},tf.months=function(t,e){return t?Ac(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||sd).test(e)?"format":"standalone"][t.month()]:Ac(this._months)?this._months:this._months.standalone},tf.monthsShort=function(t,e){return t?Ac(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[sd.test(e)?"format":"standalone"][t.month()]:Ac(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},tf.monthsParse=function(t,e,n){var o,i,r;if(this._monthsParseExact)return hd.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;o<12;o++){if(i=Vc([2e3,o]),n&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[o]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[o]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[o].test(t))return o;if(n&&"MMM"===e&&this._shortMonthsParse[o].test(t))return o;if(!n&&this._monthsParse[o].test(t))return o}},tf.monthsRegex=function(t){return this._monthsParseExact?(Ic(this,"_monthsRegex")||dd.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ic(this,"_monthsRegex")||(this._monthsRegex=ad),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},tf.monthsShortRegex=function(t){return this._monthsParseExact?(Ic(this,"_monthsRegex")||dd.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ic(this,"_monthsShortRegex")||(this._monthsShortRegex=ld),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},tf.week=function(t){return wd(t,this._week.dow,this._week.doy).week},tf.firstDayOfYear=function(){return this._week.doy},tf.firstDayOfWeek=function(){return this._week.dow},tf.weekdays=function(t,e){var n=Ac(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?vd(n,this._week.dow):t?n[t.day()]:n},tf.weekdaysMin=function(t){return!0===t?vd(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin},tf.weekdaysShort=function(t){return!0===t?vd(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort},tf.weekdaysParse=function(t,e,n){var o,i,r;if(this._weekdaysParseExact)return Md.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),o=0;o<7;o++){if(i=Vc([2e3,1]).day(o),n&&!this._fullWeekdaysParse[o]&&(this._fullWeekdaysParse[o]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[o]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[o]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[o]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[o]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[o].test(t))return o;if(n&&"ddd"===e&&this._shortWeekdaysParse[o].test(t))return o;if(n&&"dd"===e&&this._minWeekdaysParse[o].test(t))return o;if(!n&&this._weekdaysParse[o].test(t))return o}},tf.weekdaysRegex=function(t){return this._weekdaysParseExact?(Ic(this,"_weekdaysRegex")||Td.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ic(this,"_weekdaysRegex")||(this._weekdaysRegex=Rd),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},tf.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(Ic(this,"_weekdaysRegex")||Td.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ic(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=xd),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},tf.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(Ic(this,"_weekdaysRegex")||Td.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ic(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ed),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},tf.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},tf.meridiem=function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},Fd("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===Du(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),kc.lang=Kc("moment.lang is deprecated. Use moment.locale instead.",Fd),kc.langData=Kc("moment.langData is deprecated. Use moment.localeData instead.",Bd);var rf=Math.abs;function sf(t,e,n,o){var i=Cg(e,n);return t._milliseconds+=o*i._milliseconds,t._days+=o*i._days,t._months+=o*i._months,t._bubble()}function lf(t){return t<0?Math.floor(t):Math.ceil(t)}function af(t){return 4800*t/146097}function hf(t){return 146097*t/4800}function cf(t){return function(){return this.as(t)}}var uf=cf("ms"),df=cf("s"),gf=cf("m"),ff=cf("h"),pf=cf("d"),mf=cf("w"),wf=cf("M"),bf=cf("Q"),vf=cf("y"),yf=uf;function Cf(t){return function(){return this.isValid()?this._data[t]:NaN}}var Sf=Cf("milliseconds"),Rf=Cf("seconds"),xf=Cf("minutes"),Ef=Cf("hours"),Mf=Cf("days"),Tf=Cf("months"),kf=Cf("years");var Af=Math.round,Hf={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function If(t,e,n,o,i){return i.relativeTime(e||1,!!n,t,o)}var Of=Math.abs;function _f(t){return(t>0)-(t<0)||+t}function Pf(){if(!this.isValid())return this.localeData().invalidDate();var t,e,n,o,i,r,s,l,a=Of(this._milliseconds)/1e3,h=Of(this._days),c=Of(this._months),u=this.asSeconds();return u?(t=Nu(a/60),e=Nu(t/60),a%=60,t%=60,n=Nu(c/12),c%=12,o=a?a.toFixed(3).replace(/\.?0+$/,""):"",i=u<0?"-":"",r=_f(this._months)!==_f(u)?"-":"",s=_f(this._days)!==_f(u)?"-":"",l=_f(this._milliseconds)!==_f(u)?"-":"",i+"P"+(n?r+n+"Y":"")+(c?r+c+"M":"")+(h?s+h+"D":"")+(e||t||a?"T":"")+(e?l+e+"H":"")+(t?l+t+"M":"")+(a?l+o+"S":"")):"P0D"}var Nf=cg.prototype;function Df(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function Lf(t,e){const n=e.length;let o=0;for(;o<n;)t.push(e[o]),o+=1}function Vf(t){const e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;const n=t.length,o=t[0].length;for(let i=0;i<n;i++)for(let n=0;n<o;n++)e[n]||(e[n]=[]),e[n][i]=t[i][n];return e}function Ff(t,e,n,o){let i=-1,r=t,s=n;Array.isArray(t)||(r=Array.from(t));const l=r.length;for(o&&l&&(i+=1,s=r[i]),i+=1;i<l;)s=e(s,r[i],i,r),i+=1;return s}function Wf(t,e){let n=0,o=t;Array.isArray(t)||(o=Array.from(t));const i=o.length,r=[];let s=-1;for(;n<i;){const t=o[n];e(t,n,o)&&(s+=1,r[s]=t),n+=1}return r}function Bf(t,e){let n=0,o=t;Array.isArray(t)||(o=Array.from(t));const i=o.length,r=[];let s=-1;for(;n<i;){const t=o[n];s+=1,r[s]=e(t,n,o),n+=1}return r}function jf(t,e){let n=0,o=t;Array.isArray(t)||(o=Array.from(t));const i=o.length;for(;n<i&&!1!==e(o[n],n,o);)n+=1;return t}function zf(t){return Ff(t,((t,e)=>t+e),0)}function Uf(t){const e=[];return jf(t,(t=>{-1===e.indexOf(t)&&e.push(t)})),e}function Yf(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=[...e];let r=o;return jf(i,(t=>{r=r.filter((e=>!t.includes(e)))})),r}function $f(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}Nf.isValid=function(){return this._isValid},Nf.abs=function(){var t=this._data;return this._milliseconds=rf(this._milliseconds),this._days=rf(this._days),this._months=rf(this._months),t.milliseconds=rf(t.milliseconds),t.seconds=rf(t.seconds),t.minutes=rf(t.minutes),t.hours=rf(t.hours),t.months=rf(t.months),t.years=rf(t.years),this},Nf.add=function(t,e){return sf(this,t,e,1)},Nf.subtract=function(t,e){return sf(this,t,e,-1)},Nf.as=function(t){if(!this.isValid())return NaN;var e,n,o=this._milliseconds;if("month"===(t=cu(t))||"quarter"===t||"year"===t)switch(e=this._days+o/864e5,n=this._months+af(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(hf(this._months)),t){case"week":return e/7+o/6048e5;case"day":return e+o/864e5;case"hour":return 24*e+o/36e5;case"minute":return 1440*e+o/6e4;case"second":return 86400*e+o/1e3;case"millisecond":return Math.floor(864e5*e)+o;default:throw new Error("Unknown unit "+t)}},Nf.asMilliseconds=uf,Nf.asSeconds=df,Nf.asMinutes=gf,Nf.asHours=ff,Nf.asDays=pf,Nf.asWeeks=mf,Nf.asMonths=wf,Nf.asQuarters=bf,Nf.asYears=vf,Nf.valueOf=yf,Nf._bubble=function(){var t,e,n,o,i,r=this._milliseconds,s=this._days,l=this._months,a=this._data;return r>=0&&s>=0&&l>=0||r<=0&&s<=0&&l<=0||(r+=864e5*lf(hf(l)+s),s=0,l=0),a.milliseconds=r%1e3,t=Nu(r/1e3),a.seconds=t%60,e=Nu(t/60),a.minutes=e%60,n=Nu(e/60),a.hours=n%24,s+=Nu(n/24),l+=i=Nu(af(s)),s-=lf(hf(i)),o=Nu(l/12),l%=12,a.days=s,a.months=l,a.years=o,this},Nf.clone=function(){return Cg(this)},Nf.get=function(t){return t=cu(t),this.isValid()?this[t+"s"]():NaN},Nf.milliseconds=Sf,Nf.seconds=Rf,Nf.minutes=xf,Nf.hours=Ef,Nf.days=Mf,Nf.weeks=function(){return Nu(this.days()/7)},Nf.months=Tf,Nf.years=kf,Nf.humanize=function(t,e){if(!this.isValid())return this.localeData().invalidDate();var n,o,i=!1,r=Hf;return"object"==typeof t&&(e=t,t=!1),"boolean"==typeof t&&(i=t),"object"==typeof e&&(r=Object.assign({},Hf,e),null!=e.s&&null==e.ss&&(r.ss=e.s-1)),o=function(t,e,n,o){var i=Cg(t).abs(),r=Af(i.as("s")),s=Af(i.as("m")),l=Af(i.as("h")),a=Af(i.as("d")),h=Af(i.as("M")),c=Af(i.as("w")),u=Af(i.as("y")),d=r<=n.ss&&["s",r]||r<n.s&&["ss",r]||s<=1&&["m"]||s<n.m&&["mm",s]||l<=1&&["h"]||l<n.h&&["hh",l]||a<=1&&["d"]||a<n.d&&["dd",a];return null!=n.w&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),(d=d||h<=1&&["M"]||h<n.M&&["MM",h]||u<=1&&["y"]||["yy",u])[2]=e,d[3]=+t>0,d[4]=o,If.apply(null,d)}(this,!i,r,n=this.localeData()),i&&(o=n.pastFuture(+this,o)),n.postformat(o)},Nf.toISOString=Pf,Nf.toString=Pf,Nf.toJSON=Pf,Nf.locale=Ig,Nf.localeData=_g,Nf.toIsoString=Kc("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Pf),Nf.lang=Og,su("X",0,0,"unix"),su("x",0,0,"valueOf"),Ou("x",Mu),Ou("X",/[+-]?\d+(\.\d{1,3})?/),Vu("X",(function(t,e,n){n._d=new Date(1e3*parseFloat(t))})),Vu("x",(function(t,e,n){n._d=new Date(Du(t))})),//! moment.js
kc.version="2.30.1",Ec=rg,kc.fn=Qg,kc.min=function(){return ag("isBefore",[].slice.call(arguments,0))},kc.max=function(){return ag("isAfter",[].slice.call(arguments,0))},kc.now=function(){return Date.now?Date.now():+new Date},kc.utc=Vc,kc.unix=function(t){return rg(1e3*t)},kc.months=function(t,e){return nf(t,e,"months")},kc.isDate=Nc,kc.locale=Fd,kc.invalid=Bc,kc.duration=Cg,kc.isMoment=$c,kc.weekdays=function(t,e,n){return of(t,e,n,"weekdays")},kc.parseZone=function(){return rg.apply(null,arguments).parseZone()},kc.localeData=Bd,kc.isDuration=ug,kc.monthsShort=function(t,e){return nf(t,e,"monthsShort")},kc.weekdaysMin=function(t,e,n){return of(t,e,n,"weekdaysMin")},kc.defineLocale=Wd,kc.updateLocale=function(t,e){if(null!=e){var n,o,i=_d;null!=Pd[t]&&null!=Pd[t].parentLocale?Pd[t].set(Jc(Pd[t]._config,e)):(null!=(o=Vd(t))&&(i=o._config),e=Jc(i,e),null==o&&(e.abbr=t),(n=new tu(e)).parentLocale=Pd[t],Pd[t]=n),Fd(t)}else null!=Pd[t]&&(null!=Pd[t].parentLocale?(Pd[t]=Pd[t].parentLocale,t===Fd()&&Fd(t)):null!=Pd[t]&&delete Pd[t]);return Pd[t]},kc.locales=function(){return Xc(Pd)},kc.weekdaysShort=function(t,e,n){return of(t,e,n,"weekdaysShort")},kc.normalizeUnits=cu,kc.relativeTimeRounding=function(t){return void 0===t?Af:"function"==typeof t&&(Af=t,!0)},kc.relativeTimeThreshold=function(t,e){return void 0!==Hf[t]&&(void 0===e?Hf[t]:(Hf[t]=e,"s"===t&&(Hf.ss=e-1),!0))},kc.calendarFormat=function(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},kc.prototype=Qg,kc.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Gf=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:function(t){return t.length?zf(t)/t.length:0},arrayEach:jf,arrayFilter:Wf,arrayFlatten:function t(e){return Ff(e,((e,n)=>e.concat(Array.isArray(n)?t(n):n)),[])},arrayMap:Bf,arrayMax:function(t){return Ff(t,((t,e)=>t>e?t:e),Array.isArray(t)?t[0]:void 0)},arrayMin:function(t){return Ff(t,((t,e)=>t<e?t:e),Array.isArray(t)?t[0]:void 0)},arrayReduce:Ff,arraySum:zf,arrayUnique:Uf,extendArray:Lf,getDifferenceOfArrays:Yf,getIntersectionOfArrays:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=[...e];let r=o;return jf(i,(t=>{r=r.filter((e=>t.includes(e)))})),r},getUnionOfArrays:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=[...e],r=new Set(o);return jf(i,(t=>{jf(t,(t=>{r.has(t)||r.add(t)}))})),Array.from(r)},pivot:Vf,stringToArray:$f,to2dArray:Df},Symbol.toStringTag,{value:"Module"}));function Kf(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];const i=Ff(t,((t,e,o)=>t+e.replace(/\r?\n\s*/g,"")+(n[o]?n[o]:"")),"");return i.trim()}function Xf(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function qf(t){return void 0!==t}function Zf(t){return void 0===t}function Qf(t){return null===t||""===t||Zf(t)}function Jf(t){return"[object RegExp]"===Object.prototype.toString.call(t)}const tp="length",ep=t=>parseInt(t,16),np=t=>parseInt(t,10),op=(t,e,n)=>t.substr(e,n),ip=t=>t.codePointAt(0)-65,rp=t=>`${t}`.replace(/\-/g,"");let sp=!1;const lp={invalid:()=>Kf(d||(d=j`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`)),expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Kf(g||(g=j`
    The license key for Handsontable expired on ${0}, and is not valid for the installed\x20
    version ${0}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${0}. If you need any help, contact us at sales@handsontable.com.`),e,n,e)},missing:()=>Kf(f||(f=j`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`)),non_commercial:()=>""},ap={invalid:()=>Kf(p||(p=j`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`)),expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Kf(m||(m=j`
    The license key for Handsontable expired on ${0}, and is not valid for the installed\x20
    version ${0}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${0}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`),e,n,e)},missing:()=>Kf(w||(w=j`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`)),non_commercial:()=>""};function hp(t,e){const n=!Qf(t),o="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),i="14.6.1";let r,s="invalid",l="invalid";const a=function(t){let e=[][tp],n=e;if(t[tp]!==ip("Z"))return!1;for(let o="",i="B<H4P+".split(""),r=ip(i.shift());r;r=ip(i.shift()||"A"))--r<""[tp]?n|=(np(`${np(ep(o)+(ep(op(t,Math.abs(r),2))+[]).padStart(2,"0"))}`)%97||2)>>1:o=op(t,r,r?1===i[tp]?9:8:6);return n===e}(t=rp(t||""));if(n||o||a)if(a){const e=kc("17/10/2024","DD/MM/YYYY"),n=Math.floor(e.toDate().getTime()/864e5),o=ep(op(rp(h=t),ep("12"),ip("F")))/(ep(op(rp(h),ip("B"),~~![][tp]))||9);r=kc(864e5*(o+1),"x").format("MMMM DD, YYYY"),n>o?(s="expired",l="expired"):(s="valid",l="valid")}else o?(s="non_commercial",l="valid"):(s="invalid",l="invalid");else s="missing",l="missing";var h;if("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(s="valid",l="valid"),!sp&&"valid"!==s){lp[s]({keyValidityDate:r,hotVersion:i})&&console["non_commercial"===s?"info":"warn"](lp[s]({keyValidityDate:r,hotVersion:i})),sp=!0}if("valid"!==l&&e.parentNode){if(ap[l]({keyValidityDate:r,hotVersion:i})){const t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=ap[l]({keyValidityDate:r,hotVersion:i}),e.parentNode.insertBefore(t,e.nextSibling)}}}const cp=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:hp,isDefined:qf,isEmpty:Qf,isRegExp:Jf,isUndefined:Zf,stringify:Xf},Symbol.toStringTag,{value:"Module"}));function up(t){return t[0].toUpperCase()+t.substr(1)}function dp(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function gp(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function fp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,((t,n)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]))}function pp(t){return mp(`${t}`,{ALLOWED_TAGS:[]})}function mp(t,e){return Tc.sanitize(t,e)}const wp=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:function(){const t=[];for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];let i=n.length;for(;i;){i-=1;const e=Xf(n[i]).toLowerCase();-1===t.indexOf(e)&&t.push(e)}return 1===t.length},isPercentValue:gp,randomString:dp,sanitize:mp,stripTags:pp,substitute:fp,toUpperCaseFirst:up},Symbol.toStringTag,{value:"Module"})),bp=t=>["tabindex",t],vp=t=>["aria-label",t],yp=t=>["aria-haspopup",t],Cp=t=>["aria-rowcount",t],Sp=t=>["aria-colcount",t],Rp=t=>["aria-rowindex",t],xp=t=>["aria-colindex",t],Ep=t=>["aria-expanded",t],Mp=t=>["aria-checked",t],Tp=t=>["aria-relevant",t],kp=t=>["aria-posinset",t];function Ap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,o=null,i=t;for(;null!==i;){if(n===e){o=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return o}function Hp(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function Ip(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Op(t){return Ip(t)&&t.parent}function _p(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:o,DOCUMENT_FRAGMENT_NODE:i}=Node;let r=t;for(;null!=r&&r!==n;){const{nodeType:t,nodeName:n}=r;if(t===o&&(e.includes(n)||e.includes(r)))return r;const{host:s}=r;r=s&&t===i?s:r.parentNode}return null}function Pp(t,e,n){const o=[];let i=t;for(;i&&(i=_p(i,e,n),i&&(!n||n.contains(i)));)o.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const r=o.length;return r?o[r-1]:null}function Np(t,e){let n=t.parentNode,o=[];for("string"==typeof e?o=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):o.push(e);null!==n;){if(o.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Dp(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Lp(t,e,n){const o=n.parentElement.querySelector(`.ht_clone_${t}`);return o?o.contains(e):null}function Vp(t){return t&&t.length?t.filter((t=>!!t)):[]}function Fp(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],o=[];return o.push(...t.filter((t=>{const o=t instanceof RegExp;return o&&e&&n.push(t),!o}))),e?{regexFree:o,regexes:n}:o}function Wp(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)}function Bp(t,e){"string"==typeof e&&(e=e.split(" ")),(e=Vp(e)).length>0&&t.classList.add(...e)}function jp(t,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:o}=Fp(e,!0);n=Vp(n),n.length>0&&t.classList.remove(...n),o.forEach((e=>{t.classList.forEach((n=>{e.test(n)&&t.classList.remove(n)}))}))}function zp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach((e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)}))}function Up(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:o}=Fp(e,!0);n.forEach((e=>{""!==e&&t.removeAttribute(e)})),o.forEach((e=>{t.getAttributeNames().forEach((n=>{e.test(n)&&t.removeAttribute(n)}))}))}function Yp(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let t=e.length-1;t>=0;t--)Yp(e[t])}}function $p(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const Gp=/(<(.*)>|&(.*);)/;function Kp(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Gp.test(e)?t.innerHTML=n?mp(e):e:Xp(t,e)}function Xp(t,e){const n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=e:($p(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function qp(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return qp(n.host.impl);if(n.host)return qp(n.host);throw new Error("Lost in Web Components world")}return!1}if("none"===lm(n).display)return!1;n=n.parentNode}return!0}function Zp(t){const e=t.ownerDocument,n=e.defaultView,o=e.documentElement;let i,r,s,l=t;for(i=l.offsetLeft,r=l.offsetTop,s=l;(l=l.offsetParent)&&l!==e.body&&"offsetLeft"in l;)i+=l.offsetLeft,r+=l.offsetTop,s=l;return s&&"fixed"===s.style.position&&(i+=n.pageXOffset||o.scrollLeft,r+=n.pageYOffset||o.scrollTop),{left:i,top:r}}function Qp(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function Jp(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function tm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Qp(e):t.scrollTop}function em(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Jp(e):t.scrollLeft}function nm(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const o=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:t,overflowX:e,overflowY:r}=i.style;if([t,e,r].includes("scroll"))return i;if(({overflow:t,overflowX:e,overflowY:r}=n.getComputedStyle(i)),o.includes(t)||o.includes(e)||o.includes(r))return i;if(i.clientHeight<=i.scrollHeight+1&&(o.includes(r)||o.includes(t)))return i;if(i.clientWidth<=i.scrollWidth+1&&(o.includes(e)||o.includes(t)))return i;i=i.parentNode}return n}function om(t){return t.scrollHeight-t.clientHeight}function im(t){return t.scrollWidth-t.clientWidth}function rm(t){const e=t.ownerDocument,n=e.defaultView;let o=t.parentNode;for(;o&&o.style&&e.body!==o;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;const t=lm(o,n),e=["scroll","hidden","auto"],i=t.getPropertyValue("overflow"),r=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(i)||e.includes(r)||e.includes(s))return o;o=o.parentNode}return n}function sm(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===n)return"width"===e?`${n.innerWidth}px`:"height"===e?`${n.innerHeight}px`:void 0;const o=t.style[e];if(""!==o&&void 0!==o)return o;const i=lm(t,n);return""!==i[e]&&void 0!==i[e]?i[e]:void 0}function lm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function am(t){return t.offsetWidth}function hm(t){return t.offsetHeight}function cm(t){return t.clientHeight||t.innerHeight}function um(t){return t.clientWidth||t.innerWidth}function dm(t){return t.selectionStart?t.selectionStart:0}function gm(t){return t.selectionEnd?t.selectionEnd:0}function fm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function pm(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(o){const i=t.parentNode,r=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=r}}}let mm;function wm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===mm&&(mm=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const o=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return o===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),o-i}(t)),mm}function bm(t){return t.offsetWidth!==t.clientWidth}function vm(t){return t.offsetHeight!==t.clientHeight}function ym(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Cm(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function Sm(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function Rm(t){return Sm(t)&&!1===t.hasAttribute("data-hot-input")}function xm(t){return!t.parentNode}function Em(t,e){new IntersectionObserver(((n,o)=>{n.forEach((n=>{n.isIntersecting&&null!==t.offsetParent&&(e(),o.unobserve(t))}))}),{root:t.ownerDocument.body}).observe(t)}function Mm(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=t.ownerDocument,i=o.createRange(),r=o.defaultView.getSelection();zp(t,"contenteditable",!0),n&&zp(t,"aria-hidden","true"),e&&Bp(t,"invisibleSelection"),i.selectNodeContents(t),r.removeAllRanges(),r.addRange(i)}function Tm(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&jp(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function km(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Mm(t,n),e(),Tm(t,n)}const Am=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Gp,addClass:Bp,addEvent:function(t,e,n){t.addEventListener(e,n,!1)},clearTextSelection:fm,closest:_p,closestDown:Pp,empty:$p,fastInnerHTML:Kp,fastInnerText:Xp,getCaretPosition:dm,getComputedStyle:lm,getCssTransform:function(t){let e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:-1},getFrameElement:Ip,getMaximumScrollLeft:im,getMaximumScrollTop:om,getParent:Ap,getParentWindow:Op,getScrollLeft:em,getScrollTop:tm,getScrollableElement:nm,getScrollbarWidth:wm,getSelectionEndPosition:gm,getSelectionText:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(n=e.selection.createRange().text),n},getStyle:sm,getTrimmingContainer:rm,getWindowScrollLeft:Jp,getWindowScrollTop:Qp,hasAccessToParentWindow:function(t){return!!Object.getPrototypeOf(t.parent)},hasClass:Wp,hasHorizontalScrollbar:vm,hasVerticalScrollbar:bm,index:Dp,innerHeight:cm,innerWidth:um,isChildOf:Np,isDetached:xm,isInput:Sm,isOutsideInput:Rm,isThisHotChild:Hp,isVisible:qp,makeElementContentEditableAndSelectItsContent:Mm,matchesCSSRules:function(t,e){const{selectorText:n}=e;let o=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?o=t.msMatchesSelector(n):t.matches&&(o=t.matches(n))),o},observeVisibilityChangeOnce:Em,offset:Zp,outerHeight:hm,outerWidth:am,overlayContainsElement:Lp,removeAttribute:Up,removeClass:jp,removeContentEditableFromElementAndDeselect:Tm,removeEvent:function(t,e,n){t.removeEventListener(e,n,!1)},removeTextNodes:Yp,resetCssTransform:Cm,runWithSelectedContendEditableElement:km,selectElementIfAllowed:function(t){Rm(t.ownerDocument.activeElement)||t.select()},setAttribute:zp,setCaretPosition:pm,setOverlayPosition:ym},Symbol.toStringTag,{value:"Module"}));function Hm(t){return"function"==typeof t}function Im(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0;const o={lastCallThrottled:!0};let i=null;return function(){for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];const a=Date.now();let h=!1;o.lastCallThrottled=!0,n||(n=a,h=!0);const c=e-(a-n);return h?(o.lastCallThrottled=!1,t.apply(this,s)):(i&&clearTimeout(i),i=setTimeout((()=>{o.lastCallThrottled=!1,t.apply(this,s),n=0,i=void 0}),c)),o}}function Om(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=null;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return o&&clearTimeout(o),o=setTimeout((()=>{e=t.apply(this,r)}),n),e}}function _m(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return function(){for(var e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return t.apply(this,n.concat(o))}}function Pm(t){const e=t.length;return function n(o){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const l=o.concat(r);let a;return a=l.length>=e?t.apply(this,l):n(l),a}}([])}function Nm(t,e,n,o,i,r,s,l){return qf(l)?t.call(e,n,o,i,r,s,l):qf(s)?t.call(e,n,o,i,r,s):qf(r)?t.call(e,n,o,i,r):qf(i)?t.call(e,n,o,i):qf(o)?t.call(e,n,o):qf(n)?t.call(e,n):t.call(e)}const Dm=Object.freeze(Object.defineProperty({__proto__:null,curry:Pm,curryRight:function(t){const e=t.length;return function n(o){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const l=o.concat(r.reverse());let a;return a=l.length>=e?t.apply(this,l):n(l),a}}([])},debounce:Om,fastCall:Nm,isFunction:Hm,partial:_m,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[o,...i]=e;return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Ff(i,((t,e)=>e(t)),o.apply(this,e))}},throttle:Im,throttleAfterHits:function(t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const n=Im(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:200);let o=e;function i(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return o?(o-=1,t.apply(this,i)):n.apply(this,i)}return i.clearHits=function(){o=e},i}},Symbol.toStringTag,{value:"Module"}));var Lm=bs,Vm=$t,Fm=Ot,Wm=Dr,Bm=kt([].push),jm=ir,zm=Zt,Um=hr,Ym=mt,$m=kt,Gm=ut,Km=$t,Xm=we,qm=ka,Zm=function(t){if(Vm(t))return t;if(Lm(t)){for(var e=t.length,n=[],o=0;o<e;o++){var i=t[o];"string"==typeof i?Bm(n,i):"number"!=typeof i&&"Number"!==Fm(i)&&"String"!==Fm(i)||Bm(n,Wm(i))}var r=n.length,s=!0;return function(t,e){if(s)return s=!1,e;if(Lm(this))return e;for(var o=0;o<r;o++)if(n[o]===t)return e}}},Qm=ue,Jm=String,tw=zm("JSON","stringify"),ew=$m(/./.exec),nw=$m("".charAt),ow=$m("".charCodeAt),iw=$m("".replace),rw=$m(1..toString),sw=/[\uD800-\uDFFF]/g,lw=/^[\uD800-\uDBFF]$/,aw=/^[\uDC00-\uDFFF]$/,hw=!Qm||Gm((function(){var t=zm("Symbol")("stringify detection");return"[null]"!==tw([t])||"{}"!==tw({a:t})||"{}"!==tw(Object(t))})),cw=Gm((function(){return'"\\udf06\\ud834"'!==tw("\udf06\ud834")||'"\\udead"'!==tw("\udead")})),uw=function(t,e){var n=qm(arguments),o=Zm(e);if(Km(o)||void 0!==t&&!Xm(t))return n[1]=function(t,e){if(Km(o)&&(e=Ym(o,this,Jm(t),e)),!Xm(e))return e},Um(tw,null,n)},dw=function(t,e,n){var o=nw(n,e-1),i=nw(n,e+1);return ew(lw,t)&&!ew(aw,i)||ew(aw,t)&&!ew(lw,o)?"\\u"+rw(ow(t,0),16):t};function gw(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Rw(t,((t,n)=>{"__children"!==n&&(t&&"object"==typeof t&&!Array.isArray(t)?e[n]=gw(t):Array.isArray(t)?t.length&&"object"==typeof t[0]&&!Array.isArray(t[0])?e[n]=[gw(t[0])]:e[n]=[]:e[n]=null)}))),e}function fw(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function pw(t,e,n){const o=Array.isArray(n);return Rw(e,((e,i)=>{(!1===o||n.includes(i))&&(t[i]=e)})),t}function mw(t,e){Rw(e,((n,o)=>{e[o]&&"object"==typeof e[o]?(t[o]||(Array.isArray(e[o])?t[o]=[]:"[object Date]"===Object.prototype.toString.call(e[o])?t[o]=e[o]:t[o]={}),mw(t[o],e[o])):t[o]=e[o]}))}function ww(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function bw(t){const e={};return Rw(t,((t,n)=>{e[n]=t})),e}function vw(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return jf(n,(e=>{t.MIXINS.push(e.MIXIN_NAME),Rw(e,((e,n)=>{if(void 0!==t.prototype[n])throw new Error(`Mixin conflict. Property '${n}' already exist and cannot be overwritten.`);if("function"==typeof e)t.prototype[n]=e;else{const o=function(t,e){const n=`_${t}`;return function(){return void 0===this[n]&&(this[n]=(t=>{let e=t;return(Array.isArray(e)||Cw(e))&&(e=ww(e)),e})(e)),this[n]}},i=function(t){const e=`_${t}`;return function(t){this[e]=t}};Object.defineProperty(t.prototype,n,{get:o(n,e),set:i(n),configurable:!0})}}))})),t}function yw(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Cw(t){return"[object Object]"===Object.prototype.toString.call(t)}function Sw(t,e,n,o){o.value=n,o.writable=!1!==o.writable,o.enumerable=!1!==o.enumerable,o.configurable=!1!==o.configurable,Object.defineProperty(t,e,o)}function Rw(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}function xw(t,e){const n=e.split(".");let o=t;return Rw(n,(t=>{if(o=o[t],void 0===o)return o=void 0,!1})),o}function Ew(t,e,n){const o=e.split(".");let i=t;o.forEach(((t,e)=>{e!==o.length-1?(kw(i,t)||(i[t]={}),i=i[t]):i[t]=n}))}function Mw(t){if(!Cw(t))return 0;const e=function(t){let n=0;return Cw(t)?Rw(t,((t,o)=>{"__children"!==o&&(n+=e(t))})):n+=1,n};return e(t)}function Tw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const n=`_${e}`,o={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(o,e,{get(){return this[n]},set(t){this._touched=!0,this[n]=t},enumerable:!0,configurable:!0}),o}function kw(t,e){return Object.prototype.hasOwnProperty.call(t,e)}tw&&jm({target:"JSON",stat:!0,arity:3,forced:hw||cw},{stringify:function(t,e,n){var o=qm(arguments),i=Um(hw?uw:tw,null,o);return cw&&"string"==typeof i?iw(i,sw,dw):i}});const Aw=Object.freeze(Object.defineProperty({__proto__:null,clone:bw,createObjectPropListener:Tw,deepClone:ww,deepExtend:mw,deepObjectSize:Mw,defineGetter:Sw,duckSchema:gw,extend:pw,getProperty:xw,hasOwnProperty:kw,inherit:fw,isObject:Cw,isObjectEqual:yw,mixin:vw,objectEach:Rw,setProperty:Ew},Symbol.toStringTag,{value:"Module"}));function Hw(t){return window.requestAnimationFrame(t)}function Iw(t){window.cancelAnimationFrame(t)}function Ow(){return"ontouchstart"in window}function _w(){return"undefined"!=typeof window}let Pw;function Nw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Pw||(Pw="object"==typeof Intl?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1,Pw)}const Dw=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Iw,getComparisonFunction:Nw,isCSR:_w,isTouchSupported:Ow,requestAnimationFrame:Hw},Symbol.toStringTag,{value:"Module"})),Lw=t=>{const e={value:!1,test:(n,o)=>{e.value=t(n,o)}};return e},Vw={chrome:Lw(((t,e)=>/Chrome/.test(t)&&/Google/.test(e))),chromeWebKit:Lw((t=>/CriOS/.test(t))),edge:Lw((t=>/Edge/.test(t))),edgeWebKit:Lw((t=>/EdgiOS/.test(t))),firefox:Lw((t=>/Firefox/.test(t))),firefoxWebKit:Lw((t=>/FxiOS/.test(t))),mobile:Lw((t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t))),safari:Lw(((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e)))},Fw={mac:Lw((t=>/^Mac/.test(t))),win:Lw((t=>/^Win/.test(t))),linux:Lw((t=>/^Linux/.test(t))),ios:Lw((t=>/iPhone|iPad|iPod/i.test(t)))};function Ww(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Rw(Vw,(n=>{let{test:o}=n;o(t,e)}))}function Bw(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Rw(Fw,(e=>{let{test:n}=e;n(t)}))}function jw(){return Vw.chrome.value}function zw(){return Vw.chromeWebKit.value}function Uw(){return Vw.firefox.value}function Yw(){return Vw.firefoxWebKit.value}function $w(){return Vw.safari.value}function Gw(){return Vw.edge.value}function Kw(){return Vw.mobile.value}function Xw(){return Fw.ios.value}function qw(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&Fw.mac.value}function Zw(){return Fw.win.value}function Qw(){return Fw.mac.value}_w()&&(Ww(),Bw());const Jw=Object.freeze(Object.defineProperty({__proto__:null,isChrome:jw,isChromeWebKit:zw,isEdge:Gw,isEdgeWebKit:function(){return Vw.edgeWebKit.value},isFirefox:Uw,isFirefoxWebKit:Yw,isIOS:Xw,isIpadOS:qw,isLinuxOS:function(){return Fw.linux.value},isMacOS:Qw,isMobileBrowser:Kw,isSafari:$w,isWindowsOS:Zw,setBrowserMeta:Ww,setPlatformMeta:Bw},Symbol.toStringTag,{value:"Module"})),tb={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Uw()?182:174,AUDIO_MUTE:Uw()?181:173,AUDIO_UP:Uw()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},eb=[tb.ALT,tb.ARROW_DOWN,tb.ARROW_LEFT,tb.ARROW_RIGHT,tb.ARROW_UP,tb.AUDIO_DOWN,tb.AUDIO_MUTE,tb.AUDIO_UP,tb.BACKSPACE,tb.CAPS_LOCK,tb.DELETE,tb.END,tb.ENTER,tb.ESCAPE,tb.F1,tb.F2,tb.F3,tb.F4,tb.F5,tb.F6,tb.F7,tb.F8,tb.F9,tb.F10,tb.F11,tb.F12,tb.F13,tb.F14,tb.F15,tb.F16,tb.F17,tb.F18,tb.F19,tb.HOME,tb.INSERT,tb.MEDIA_NEXT,tb.MEDIA_PLAY_PAUSE,tb.MEDIA_PREV,tb.MEDIA_STOP,tb.NULL,tb.NUM_LOCK,tb.PAGE_DOWN,tb.PAGE_UP,tb.PAUSE,tb.SCROLL_LOCK,tb.SHIFT,tb.TAB];function nb(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function ob(t){return eb.includes(t)}function ib(t){return[tb.CONTROL,tb.COMMAND_LEFT,tb.COMMAND_RIGHT,tb.COMMAND_FIREFOX].includes(t)}function rb(t,e){const n=e.split("|");let o=!1;return jf(n,(e=>{if(t===tb[e])return o=!0,!1})),o}const sb=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:tb,isCtrlKey:function(t){const e=[];return Qw()?e.push(tb.COMMAND_LEFT,tb.COMMAND_RIGHT,tb.COMMAND_FIREFOX):e.push(tb.CONTROL),e.includes(t)},isCtrlMetaKey:ib,isFunctionKey:ob,isKey:rb,isPrintableChar:nb},Symbol.toStringTag,{value:"Module"}));function lb(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ab(t){return!1===t.isImmediatePropagationEnabled}function hb(t){return 2===t.button}function cb(t){return 0===t.button}function ub(t){return t instanceof TouchEvent}function db(t,e){const n={x:t.offsetX,y:t.offsetY};let o=t.target;if(!(e instanceof HTMLElement)||o!==e&&o.contains(e))return n;for(;o!==e;)n.x+=o.offsetLeft,n.y+=o.offsetTop,o=o.offsetParent;return n}const gb=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ab,isLeftClick:cb,isRightClick:hb,isTouchEvent:ub,offsetRelativeTo:db,stopImmediatePropagation:lb},Symbol.toStringTag,{value:"Module"}));var fb={},pb=Mi,mb=Ti,wb=Object.keys||function(t){return pb(t,mb)},bb=dt,vb=Nn,yb=Pn,Cb=Fn,Sb=Ut,Rb=wb;fb.f=bb&&!vb?Object.defineProperties:function(t,e){Cb(t);for(var n,o=Sb(e),i=Rb(e),r=i.length,s=0;r>s;)yb.f(t,n=i[s++],o[n]);return t};var xb,Eb=Fn,Mb=fb,Tb=Ti,kb=Co,Ab=Ta,Hb=Sn,Ib="prototype",Ob="script",_b=yo("IE_PROTO"),Pb=function(){},Nb=function(t){return"<"+Ob+">"+t+"</"+Ob+">"},Db=function(t){t.write(Nb("")),t.close();var e=t.parentWindow.Object;return t=null,e},Lb=function(){try{xb=new ActiveXObject("htmlfile")}catch(Yb){}var t,e,n;Lb="undefined"!=typeof document?document.domain&&xb?Db(xb):(e=Hb("iframe"),n="java"+Ob+":",e.style.display="none",Ab.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(Nb("document.F=Object")),t.close(),t.F):Db(xb);for(var o=Tb.length;o--;)delete Lb[Ib][Tb[o]];return Lb()};kb[_b]=!0;var Vb=an,Fb=Object.create||function(t,e){var n;return null!==t?(Pb[Ib]=Eb(t),n=new Pb,Pb[Ib]=null,n[_b]=t):n=Lb(),void 0===e?n:Mb.f(n,e)},Wb=Pn.f,Bb=Vb("unscopables"),jb=Array.prototype;void 0===jb[Bb]&&Wb(jb,Bb,{configurable:!0,value:Fb(null)});var zb=function(t){jb[Bb][t]=!0};function Ub(){qf(console)&&console.warn(...arguments)}function Yb(){qf(console)&&console.error(...arguments)}function $b(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}zb("flatMap");const Gb=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Kb=Kf(b||(b=j`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`)),Xb=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),qb=new Map([[]]),Zb=new WeakMap;class Qb{static getSingleton(){return Jb}constructor(){$b(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return jf(Gb,(e=>{t[e]=[],this.initOrderMap(t,e)})),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;if(Array.isArray(e))jf(e,(e=>this.add(t,e,n)));else{Xb.has(t)&&Ub(fp(Kb,{hookName:t,removedInVersion:Xb.get(t)})),qb.has(t)&&Ub(qb.get(t));const i=this.getBucket(n);if(void 0===i[t]&&(this.register(t),i[t]=[],this.initOrderMap(i,t)),e.skip=!1,-1===i[t].indexOf(e)){let n=!1;e.initialHook&&jf(i[t],((o,r)=>{if(o.initialHook)return i[t][r]=e,n=!0,!1})),n||i[t].push(e)}this.setCallbackOrderIndex(i,t,e,o),this.orderBucketByOrderIndex(i,t)}return this}once(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;Array.isArray(e)?jf(e,(e=>this.once(t,e,n))):(e.runOnce=!0,this.add(t,e,n,o))}remove(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const o=this.getBucket(n);return void 0!==o[t]&&o[t].indexOf(e)>=0&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}run(t,e,n,o,i,r,s,l){{const a=this.globalBucket[e],h=a?a.length:0;let c=0;if(h)for(;c<h;){if(!a[c]||a[c].skip){c+=1;continue}const h=Nm(a[c],t,n,o,i,r,s,l);void 0!==h&&(n=h),a[c]&&a[c].runOnce&&this.remove(e,a[c]),c+=1}}{const a=this.getBucket(t)[e],h=a?a.length:0;let c=0;if(h)for(;c<h;){if(!a[c]||a[c].skip){c+=1;continue}const h=Nm(a[c],t,n,o,i,r,s,l);void 0!==h&&(n=h),a[c]&&a[c].runOnce&&this.remove(e,a[c],t),c+=1}}return n}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Rw(this.getBucket(t),((t,e,n)=>n[e].length=0))}register(t){this.isRegistered(t)||Gb.push(t)}deregister(t){this.isRegistered(t)&&Gb.splice(Gb.indexOf(t),1)}isDeprecated(t){return qb.has(t)||Xb.has(t)}isRegistered(t){return Gb.indexOf(t)>=0}getRegistered(){return Gb}setCallbackOrderIndex(t,e,n,o){const i=Number.isInteger(o)?o:0,r=this.getCallbackOrderMap(t,e);r.set(i,[...r.get(i)||[],n])}orderBucketByOrderIndex(t,e){const n=this.getCallbackOrderMap(t,e);void 0===n||0===n.size||1===n.size&&n.has(0)||(t[e]=[...n].sort(((t,e)=>t[0]-e[0])).flatMap((t=>{let[,e]=t;return e})))}initOrderMap(t,e){Zb.has(t)||Zb.set(t,[]),Zb.get(t)[e]=new Map}getCallbackOrderMap(t,e){return Zb.get(t)[e]}}const Jb=new Qb;const tv=Qb,ev=new Map;function nv(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";ev.has(t)||ev.set(t,new Map);const e=ev.get(t);return{register:function(t,n){e.set(t,n)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return[...e.keys()]},getValues:function(){return[...e.values()]}}}const ov=new WeakMap,{register:iv,getItem:rv,hasItem:sv,getNames:lv,getValues:av}=nv("editors");function hv(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},tv.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function cv(t,e){let n;if("function"==typeof t)ov.get(t)||dv(null,t),n=ov.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=rv(t)}if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function uv(t){if("function"==typeof t)return t;if(!sv(t))throw Error(`No registered editor found under "${t}" name`);return rv(t).getConstructor()}function dv(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);const n=new hv(e);"string"==typeof t&&iv(t,n),ov.set(e,n)}function gv(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}let fv=0;const pv=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;gv(this,"context",void 0),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(t){n.call(this,function(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),lb(this)},t}(t))}return this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:i,options:o,eventManager:this}),t.addEventListener(e,i,o),fv+=1,()=>{this.removeEventListener(t,e,n)}}removeEventListener(t,e,n){let o,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.context.eventListeners.length;for(;r;)if(r-=1,o=this.context.eventListeners[r],o.event===e&&o.element===t){if(n&&n!==o.callback)continue;if(i&&o.eventManager!==this)continue;this.context.eventListeners.splice(r,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),fv-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;for(;e;){e-=1;const n=this.context.eventListeners[e];t&&n.eventManager!==this||(this.context.eventListeners.splice(e,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),fv-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let n=t.document,o=t;n||(n=t.ownerDocument?t.ownerDocument:t,o=n.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==e,view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let r;n.createEvent?(r=n.createEvent("MouseEvents"),r.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,n.body.parentNode)):r=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent(`on${e}`,r)}};function mv(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function wv(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bv(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vv=new WeakSet;class yv{constructor(t,e,n){mv(this,vv),wv(this,"hot",void 0),wv(this,"tableMeta",void 0),wv(this,"selection",void 0),wv(this,"eventManager",void 0),wv(this,"destroyed",!1),wv(this,"activeEditor",void 0),wv(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=n,this.eventManager=new pv(t),this.hot.addHook("afterDocumentKeyDown",(t=>bv(vv,this,Cv).call(this,t))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)})),this.hot.view._wt.update("onCellDblClick",((t,e,n)=>bv(vv,this,Sv).call(this,t,e,n)))}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(t=>{t&&this.prepareEditor()}));const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;const{row:n,col:o}=e,i=this.hot.runHooks("modifyGetCellCoords",n,o);let r=n,s=o;if(Array.isArray(i)&&([r,s]=i),this.cellProperties=this.hot.getCellMeta(r,s),!this.isCellEditable())return void this.clearActiveEditor();const l=this.hot.getCell(n,o,!0);if(l){const t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(s),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r),s);this.activeEditor=cv(t,this.hot),this.activeEditor.prepare(n,o,e,l,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const o=this.hot.getSelectedRangeLast();let i=this.hot.runHooks("beforeBeginEditing",o.highlight.row,o.highlight.col,t,e,n);e instanceof MouseEvent&&"boolean"!=typeof i&&(i=0===this.hot.selection.getLayerLevel()&&o.isSingle()),!1!==i?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))):this.clearActiveEditor()}closeEditor(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const t=this.hot.getSelectedRangeLast();if(!t)return!1;const e=this.hot.getCellEditor(this.cellProperties),{row:n,col:o}=t.highlight,{rowIndexMapper:i,columnIndexMapper:r}=this.hot,s=i.isHidden(this.hot.toPhysicalRow(n))||r.isHidden(this.hot.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!e||s)}moveSelectionAfterEnter(t){const e=$({},"function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(t):this.tableMeta.enterMoves);t.shiftKey&&(e.row=-e.row,e.col=-e.col),this.hot.selection.isMultiple()?this.selection.transformFocus(e.row,e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Cv(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ab(t))return;const{keyCode:n}=t,o=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(ob(n)||ib(n)||o||this.isEditorOpened()||this.openEditor("",t))}function Sv(t,e){e.isCell()&&this.openEditor(null,t,!0)}const Rv=new WeakMap;yv.getInstance=function(t,e,n){let o=Rv.get(t);return o||(o=new yv(t,e,n),Rv.set(t,o)),o};const xv=yv;function Ev(t,e,n){Mv(t,e),e.set(t,n)}function Mv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tv(t,e){return t.get(Av(t,e))}function kv(t,e,n){return t.set(Av(t,e),n),n}function Av(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hv=Object.freeze({CELL:"cell",MIXED:"mixed"});var Iv=new WeakMap,Ov=new WeakMap,_v=new WeakMap,Pv=new WeakMap,Nv=new WeakMap,Dv=new WeakSet;class Lv{constructor(t){var e,n,o=this;Mv(e=this,n=Dv),n.add(e),Ev(this,Iv,void 0),Ev(this,Ov,void 0),Ev(this,_v,1),Ev(this,Pv,null),Ev(this,Nv,new Map);const i=t.getSettings();kv(Iv,this,t),kv(Ov,this,i.imeFastEdit?Hv.MIXED:Hv.CELL),Tv(Iv,this).addHook("afterUpdateSettings",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Av(Dv,o,Bv).call(o,...e)})),Tv(Iv,this).addHook("afterSelection",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Av(Dv,o,Fv).call(o,...e)})),Tv(Iv,this).addHook("afterSelectionFocusSet",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Av(Dv,o,Fv).call(o,...e)})),Tv(Iv,this).addHook("afterSelectionEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Av(Dv,o,Wv).call(o,...e)}))}getFocusMode(){return Tv(Ov,this)}setFocusMode(t){Object.values(Hv).includes(t)?kv(Ov,this,t):Ub(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return Tv(_v,this)}setRefocusDelay(t){kv(_v,this,t)}setRefocusElementGetter(t){kv(Pv,this,t)}getRefocusElement(){return"function"==typeof Tv(Pv,this)?Tv(Pv,this).call(this):null===(t=Tv(Iv,this).getActiveEditor())||void 0===t?void 0:t.TEXTAREA;var t}focusOnHighlightedCell(t){const e=t=>{var e,n;const o=null===(e=Tv(Iv,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!o)return;let i=Tv(Iv,this).runHooks("modifyFocusedElement",o.row,o.col,t);i instanceof HTMLElement||(i=t),!i||null!==(n=Tv(Iv,this).getActiveEditor())&&void 0!==n&&n.isOpened()||i.focus({preventScroll:!0})};t?e(t):Av(Dv,this,Vv).call(this,(t=>e(t)))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tv(_v,this);const n=this.getRefocusElement();!Tv(Iv,this).getSettings().imeFastEdit||null!==(t=Tv(Iv,this).getActiveEditor())&&void 0!==t&&t.isOpened()||!n||(Tv(Nv,this).has(e)||Tv(Nv,this).set(e,Om((()=>{n.select()}),e)),Tv(Nv,this).get(e)())}}function Vv(t){var e;const n=null===(e=Tv(Iv,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!n||!Tv(Iv,this).selection.isCellVisible(n))return void t(null);const o=Tv(Iv,this).getCell(n.row,n.col,!0);null===o?Tv(Iv,this).addHookOnce("afterScroll",(()=>{t(Tv(Iv,this).getCell(n.row,n.col,!0))})):t(o)}function Fv(){Av(Dv,this,Vv).call(this,(t=>{const{activeElement:e}=Tv(Iv,this).rootDocument;e&&Rm(e)&&e.blur(),this.focusOnHighlightedCell(t)}))}function Wv(){Av(Dv,this,Vv).call(this,(t=>{this.getFocusMode()===Hv.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()}))}function Bv(t){"boolean"==typeof t.imeFastEdit&&this.setFocusMode(t.imeFastEdit?Hv.MIXED:Hv.CELL)}var jv=Kt,zv=Ot,Uv=an("match"),Yv=Fn,$v=mt,Gv=Ge,Kv=Qt,Xv=function(){var t=Yv(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},qv=RegExp.prototype,Zv=kt,Qv=Ue,Jv=Math.floor,ty=Zv("".charAt),ey=Zv("".replace),ny=Zv("".slice),oy=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,iy=/\$([$&'`]|\d{1,2})/g,ry=ir,sy=mt,ly=kt,ay=Bt,hy=$t,cy=Vt,uy=function(t){var e;return jv(t)&&(void 0!==(e=t[Uv])?!!e:"RegExp"===zv(t))},dy=Dr,gy=Me,fy=function(t){var e=t.flags;return void 0!==e||"flags"in qv||Gv(t,"flags")||!Kv(qv,t)?e:$v(Xv,t)},py=function(t,e,n,o,i,r){var s=n+t.length,l=o.length,a=iy;return void 0!==i&&(i=Qv(i),a=oy),ey(r,a,(function(r,a){var h;switch(ty(a,0)){case"$":return"$";case"&":return t;case"`":return ny(e,0,n);case"'":return ny(e,s);case"<":h=i[ny(a,1,-1)];break;default:var c=+a;if(0===c)return r;if(c>l){var u=Jv(c/10);return 0===u?r:u<=l?void 0===o[u-1]?ty(a,1):o[u-1]+ty(a,1):r}h=o[c-1]}return void 0===h?"":h}))},my=an("replace"),wy=TypeError,by=ly("".indexOf);ly("".replace);var vy=ly("".slice),yy=Math.max;ry({target:"String",proto:!0},{replaceAll:function(t,e){var n,o,i,r,s,l,a,h,c,u=ay(this),d=0,g="";if(!cy(t)){if(uy(t)&&(n=dy(ay(fy(t))),!~by(n,"g")))throw new wy("`.replaceAll` does not allow non-global regexes");if(o=gy(t,my))return sy(o,t,u,e)}for(i=dy(u),r=dy(t),(s=hy(e))||(e=dy(e)),l=r.length,a=yy(1,l),h=by(i,r);-1!==h;)c=s?dy(e(r,h,i)):py(r,i,h,[],void 0,e),g+=vy(i,d,h)+c,d=h+l,h=h+a>i.length?-1:by(i,r,h+a);return d<i.length&&(g+=vy(i,d)),g}});const Cy={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Sy=new RegExp(Object.keys(Cy).map((t=>`(${t})`)).join("|"),"gi");function Ry(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),o=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...o),r=i.length,s=r>0?i[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=n?1:0,u=e?1:0;for(let d=0;d<r;d+=1){const o=e&&0===d,r=[];for(let e=0;e<s;e+=1){const s=!o&&n&&0===e;let l="";if(o)l=`<th>${t.getColHeader(e-c)}</th>`;else if(s)l=`<th>${t.getRowHeader(d-u)}</th>`;else{const n=i[d][e],{hidden:o,rowspan:r,colspan:s}=t.getCellMeta(d-u,e-c);if(!o){const t=[];if(r&&t.push(`rowspan="${r}"`),s&&t.push(`colspan="${s}"`),Qf(n))l=`<td ${t.join(" ")}></td>`;else{const e=n.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l=`<td ${t.join(" ")}>${e}</td>`}}}r.push(l)}const l=["<tr>",...r,"</tr>"].join("");o?a.splice(1,0,l):h.splice(-1,0,l)}return l.splice(1,0,a.join(""),h.join("")),l.join("")}function xy(t){const e=t.length,n=["<table>"];for(let o=0;o<e;o+=1){const i=t[o],r=i.length,s=[];0===o&&n.push("<tbody>");for(let t=0;t<r;t+=1){const e=i[t],n=Qf(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`)).replace(/\t/gi,"&#9;");s.push(`<td>${n}</td>`)}n.push("<tr>",...s,"</tr>"),o+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function Ey(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const n={},o=e.createDocumentFragment(),i=e.createElement("div");o.appendChild(i);let r=t;if("string"==typeof r){const t=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(t=>{const e=t.match(/<td\b[^>]*?>/g)[0];return`${e}${t.substring(e.length,t.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"")}</td>`}));i.insertAdjacentHTML("afterbegin",`${t}`),r=i.querySelector("table")}if(!r||!function(t){return"TABLE"===(t&&t.nodeName||"")}(r))return;const s=i.querySelector('meta[name$="enerator"]'),l=null!==r.querySelector("tbody th"),a=r.querySelector("tr"),h=a?Array.from(a.cells).reduce(((t,e)=>t+e.colSpan),0)-(l?1:0):0,c=r.tFoot&&Array.from(r.tFoot.rows)||[],u=[];let d=!1,g=0,f=0;if(r.tHead){const t=Array.from(r.tHead.rows).filter((t=>{const e=null!==t.querySelector("td");return e&&u.push(t),!e}));g=t.length,d=g>0,g>1?n.nestedHeaders=Array.from(t).reduce(((t,e)=>{const n=Array.from(e.cells).reduce(((t,e,n)=>{if(l&&0===n)return t;const{colSpan:o,innerHTML:i}=e,r=o>1?{label:i,colspan:o}:i;return t.push(r),t}),[]);return t.push(n),t}),[]):d&&(n.colHeaders=Array.from(t[0].children).reduce(((t,e,n)=>(l&&0===n||t.push(e.innerHTML),t)),[]))}u.length&&(n.fixedRowsTop=u.length),c.length&&(n.fixedRowsBottom=c.length);const p=[...u,...Array.from(r.tBodies).reduce(((t,e)=>(t.push(...Array.from(e.rows)),t)),[]),...c];f=p.length;const m=new Array(f);for(let v=0;v<f;v++)m[v]=new Array(h);const w=[],b=[];for(let v=0;v<f;v++){const t=p[v],e=Array.from(t.cells),n=e.length;for(let o=0;o<n;o++){const t=e[o],{nodeName:n,innerHTML:i,rowSpan:r,colSpan:l}=t,a=m[v].findIndex((t=>void 0===t));if("TD"===n){if(r>1||l>1){for(let t=v;t<v+r;t++)if(t<f)for(let e=a;e<a+l;e++)m[t][e]=null;const e=t.getAttribute("style");e&&e.includes("mso-ignore:colspan")||w.push({col:a,row:v,rowspan:r,colspan:l})}let e="";e=s&&/excel/gi.test(s.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),m[v][a]=e.replace(Sy,(t=>Cy[t]))}else b.push(i)}}return w.length&&(n.mergeCells=w),b.length&&(n.rowHeaders=b),m.length&&(n.data=m),n}const My=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:xy,htmlToGridSettings:Ey,instanceToHTML:Ry},Symbol.toStringTag,{value:"Module"}));function Ty(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=typeof t;if("number"===n)return!isNaN(t)&&isFinite(t);if("string"===n){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map((t=>`\\${t}`)).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===n&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)}function ky(t){return Ty(t,[","])}function Ay(t,e,n){let o=-1;for("function"==typeof e?(n=e,e=t):o=t-1;++o<=e&&!1!==n(o););}function Hy(t,e,n){let o=t+1;for("function"==typeof e&&(n=e,e=0);--o>=e&&!1!==n(o););}function Iy(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Oy(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const _y=Object.freeze(Object.defineProperty({__proto__:null,clamp:Oy,isNumeric:Ty,isNumericLike:ky,rangeEach:Ay,rangeEachReverse:Hy,valueAccordingPercent:Iy},Symbol.toStringTag,{value:"Module"})),Py="asc",Ny=new Map([[Py,[-1,1]],["desc",[1,-1]]]),Dy=t=>`The priority '${t}' is already declared in a map.`,Ly=t=>`The priority '${t}' is not a number.`;const Vy=t=>`The id '${t}' is already declared in a map.`;function Fy(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function n(){return[...e]}function o(t){return e.has(t)}return t=Hm(t)?t:Vy,{addItem:function(n,i){if(o(n))throw new Error(t(n));e.set(n,i)},clear:function(){e.clear()},getId:function(t){const[e]=n().find((e=>{let[n,o]=e;return t===o&&n}))||[null];return e},getItem:function(t){return e.get(t)},getItems:n,hasItem:o,removeItem:function(t){return e.delete(t)}}}const Wy=t=>`'${t}' value is already declared in a unique set.`;const By=t=>`There is already registered "${t}" plugin.`,jy=function(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Map;return t=Hm(t)?t:Dy,e=Hm(e)?e:Ly,{addItem:function(o,i){if(!Ty(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,i)},getItems:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Py;const[e,o]=Ny.get(t)||Ny.get(Py);return[...n].sort(((t,n)=>t[0]<n[0]?e:o)).map((t=>t[1]))}}}({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),zy=function(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;return t=Hm(t)?t:Wy,{addItem:function(n){if(e.has(n))throw new Error(t(n));e.add(n)},clear:function(){e.clear()},getItems:function(){return[...e]}}}({errorItemExists:By}),Uy=Fy({errorIdExists:By});function Yy(){return[...jy.getItems(),...zy.getItems()]}function $y(t){const e=up(t);return Uy.getItem(e)}function Gy(t,e,n){[t,e,n]=function(t,e,n){"function"==typeof t&&(t=(e=t).PLUGIN_KEY,n=e.PLUGIN_PRIORITY);return[t,e,n]}(t,e,n),void 0===$y(t)&&function(t,e,n){const o=up(t);if(Uy.hasItem(o))throw new Error(By(o));void 0===n?zy.addItem(o):jy.addItem(n,o);Uy.addItem(o,e)}(t,e,n)}const{register:Ky,getItem:Xy,hasItem:qy,getNames:Zy,getValues:Qy}=nv("renderers");function Jy(t){if("function"==typeof t)return t;if(!qy(t))throw Error(`No registered renderer found under "${t}" name`);return Xy(t)}function tC(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),Ky(t,e)}const{register:eC,getItem:nC,hasItem:oC,getNames:iC,getValues:rC}=nv("validators");function sC(t){if("function"==typeof t)return t;if(!oC(t))throw Error(`No registered validator found under "${t}" name`);return nC(t)}function lC(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),eC(t,e)}var aC=Ue,hC=pi,cC=ai,uC=zb;ir({target:"Array",proto:!0},{at:function(t){var e=aC(this),n=hC(e),o=cC(t),i=o>=0?o:n+o;return i<0||i>=n?void 0:e[i]}}),uC("at");var dC=ir,gC=Bt,fC=ai,pC=Dr,mC=ut,wC=kt("".charAt);function bC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}dC({target:"String",proto:!0,forced:mC((function(){return"\ud842"!=="𠮷".at(-2)}))},{at:function(t){var e=pC(gC(this)),n=e.length,o=fC(t),i=o>=0?o:n+o;return i<0||i>=n?void 0:wC(e,i)}});class vC{constructor(){bC(this,"count",0),bC(this,"startColumn",null),bC(this,"endColumn",null),bC(this,"startPosition",null),bC(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedWidth:n,zeroBasedScrollOffset:o,viewportWidth:i,columnWidth:r}=e;n>=o&&n+r<=o+(o>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=t),this.endColumn=t)}finalize(t){var e;const{scrollOffset:n,viewportWidth:o,inlineStartOffset:i,zeroBasedScrollOffset:r,totalColumns:s,needReverse:l,startPositions:a,columnWidth:h}=t;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const t=a[this.endColumn]+h-a[this.startColumn-1];if(t<=o&&(this.startColumn-=1),t>=o)break}this.startPosition=null!==(e=a[this.startColumn])&&void 0!==e?e:null;const c=n+o-(r>0?o+1:o),u=null===this.startColumn?0:t.getColumnWidth(this.startColumn);c<-1*i||n>a.at(-1)||-1*n-o>-1*u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function yC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class CC{constructor(){yC(this,"count",0),yC(this,"startRow",null),yC(this,"endRow",null),yC(this,"startPosition",null),yC(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedHeight:n,zeroBasedScrollOffset:o,innerViewportHeight:i,rowHeight:r}=e;n>=o&&n+r<=i&&(null===this.startRow&&(this.startRow=t),this.endRow=t)}finalize(t){var e;const{scrollOffset:n,viewportHeight:o,horizontalScrollbarHeight:i,totalRows:r,needReverse:s,startPositions:l,rowHeight:a}=t;if(this.endRow===r-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const t=l[this.endRow]+a-l[this.startRow-1];if(t<=o-i&&(this.startRow-=1),t>=o-i)break}this.startPosition=null!==(e=l[this.startRow])&&void 0!==e?e:null;n+o-i<(null===this.startRow?0:t.getRowHeight(this.startRow))||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function SC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class RC{constructor(){SC(this,"count",0),SC(this,"startColumn",null),SC(this,"endColumn",null),SC(this,"startPosition",null),SC(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedWidth:n,zeroBasedScrollOffset:o,viewportWidth:i}=e;n<=o&&(this.startColumn=t);n>=o&&n<=o+(o>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=t)),this.endColumn=t}finalize(t){var e;const{scrollOffset:n,viewportWidth:o,inlineStartOffset:i,zeroBasedScrollOffset:r,totalColumns:s,needReverse:l,startPositions:a,columnWidth:h}=t;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const t=a[this.endColumn]+h-a[this.startColumn-1];if(this.startColumn-=1,t>o)break}this.startPosition=null!==(e=a[this.startColumn])&&void 0!==e?e:null;n+o-(r>0?o+1:o)<-1*i||n>a.at(-1)+h||-1*n-o>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function xC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class EC{constructor(){xC(this,"count",0),xC(this,"startRow",null),xC(this,"endRow",null),xC(this,"startPosition",null),xC(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedHeight:n,zeroBasedScrollOffset:o,innerViewportHeight:i}=e;n<=o&&(this.startRow=t),n>=o&&n<=i&&null===this.startRow&&(this.startRow=t),this.endRow=t}finalize(t){var e;const{scrollOffset:n,viewportHeight:o,horizontalScrollbarHeight:i,totalRows:r,needReverse:s,startPositions:l,rowHeight:a}=t;if(this.endRow===r-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const t=l[this.endRow]+a-l[this.startRow-1];if(this.startRow-=1,t>=o-i)break}this.startPosition=null!==(e=l[this.startRow])&&void 0!==e?e:null;n+o-i<0||n>l.at(-1)+a?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function MC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class TC{constructor(){MC(this,"count",0),MC(this,"startColumn",0),MC(this,"endColumn",0),MC(this,"startPosition",0),MC(this,"isVisibleInTrimmingContainer",!0)}initialize(t){let{totalColumns:e}=t;this.count=e,this.endColumn=this.count-1}process(){}finalize(){}}function kC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class AC{constructor(){kC(this,"count",0),kC(this,"startRow",0),kC(this,"endRow",0),kC(this,"startPosition",0),kC(this,"isVisibleInTrimmingContainer",!0)}initialize(t){let{totalRows:e}=t;this.count=e,this.endRow=this.count-1}process(){}finalize(){}}class HC extends RC{finalize(t){var e;super.finalize(t);const{overrideFn:n,totalColumns:o,startPositions:i}=t;null!==this.startColumn&&"function"==typeof n&&n(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(e=i[this.startColumn])&&void 0!==e?e:null,o<this.endColumn&&(this.endColumn=o-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}class IC extends EC{finalize(t){var e;super.finalize(t);const{overrideFn:n,totalRows:o,startPositions:i}=t;null!==this.startRow&&"function"==typeof n&&n(this),this.startRow<0&&(this.startRow=0),this.startPosition=null!==(e=i[this.startRow])&&void 0!==e?e:null,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function OC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class _C{constructor(t){OC(this,"calculationTypes",[]),OC(this,"calculationResults",new Map),this.calculationTypes=t}_initialize(t){this.calculationTypes.forEach((e=>{let[n,o]=e;this.calculationResults.set(n,o),o.initialize(t)}))}_process(t,e){this.calculationTypes.forEach((n=>{let[,o]=n;return o.process(t,e)}))}_finalize(t){this.calculationTypes.forEach((e=>{let[,n]=e;return n.finalize(t)}))}getResultsFor(t){return this.calculationResults.get(t)}}function PC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class NC extends _C{constructor(t){let{calculationTypes:e,viewportWidth:n,scrollOffset:o,totalColumns:i,columnWidthFn:r,overrideFn:s,inlineStartOffset:l}=t;super(e),PC(this,"viewportWidth",0),PC(this,"scrollOffset",0),PC(this,"zeroBasedScrollOffset",0),PC(this,"totalColumns",0),PC(this,"columnWidthFn",null),PC(this,"columnWidth",0),PC(this,"overrideFn",null),PC(this,"inlineStartOffset",0),PC(this,"totalCalculatedWidth",0),PC(this,"startPositions",[]),PC(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalColumns=i,this.columnWidthFn=r,this.overrideFn=s,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let t=0;t<this.totalColumns;t++)if(this.columnWidth=this.getColumnWidth(t),this._process(t,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(t){const e=this.columnWidthFn(t);return isNaN(e)?50:e}}function DC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class LC extends _C{constructor(t){let{calculationTypes:e,viewportHeight:n,scrollOffset:o,totalRows:i,rowHeightFn:r,overrideFn:s,horizontalScrollbarHeight:l}=t;super(e),DC(this,"viewportHeight",0),DC(this,"scrollOffset",0),DC(this,"zeroBasedScrollOffset",0),DC(this,"totalRows",0),DC(this,"rowHeightFn",null),DC(this,"rowHeight",0),DC(this,"overrideFn",null),DC(this,"horizontalScrollbarHeight",0),DC(this,"innerViewportHeight",0),DC(this,"totalCalculatedHeight",0),DC(this,"startPositions",[]),DC(this,"needReverse",!0),this.viewportHeight=n,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalRows=i,this.rowHeightFn=r,this.overrideFn=s,this.horizontalScrollbarHeight=null!=l?l:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let t=0;t<this.totalRows;t++)if(this.rowHeight=this.getRowHeight(t),this._process(t,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(t){const e=this.rowHeightFn(t);return isNaN(e)?23:e}}function VC(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function FC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WC(t,e){return t.get(jC(t,e))}function BC(t,e,n){return t.set(jC(t,e),n),n}function jC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zC=new WeakMap;class UC{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];FC(this,"row",null),FC(this,"col",null),VC(this,zC,!1),BC(zC,this,n),void 0!==t&&void 0!==e&&(this.row=t,this.col=e)}isValid(t){const{countRows:e,countCols:n,countRowHeaders:o,countColHeaders:i}=$({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},t);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-o)&&!(this.row>=e||this.col>=n))}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return WC(zC,this)}isSouthEastOf(t){return this.row>=t.row&&(WC(zC,this)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(WC(zC,this)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(WC(zC,this)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(WC(zC,this)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null==t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null==t?void 0:t.col)&&(this.col=t.col),t instanceof UC&&BC(zC,this,t.isRtl()),this}clone(){return new UC(this.row,this.col,WC(zC,this))}toObject(){return{row:this.row,col:this.col}}}const YC=UC;function $C(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function GC(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KC(t,e){return t.get(XC(t,e))}function XC(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qC=new WeakMap;class ZC{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var i,r,s;GC(this,"highlight",null),GC(this,"from",null),GC(this,"to",null),$C(this,qC,!1),this.highlight=t.clone(),this.from=e.clone(),this.to=n.clone(),r=this,s=o,(i=qC).set(XC(i,r),s)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:e,col:n}=t,o=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return o.row<=e&&i.row>=e&&o.col<=n&&i.col>=n}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}expandByRange(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(t)||!this.overlaps(t))return!1;const n=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),i=this.getDirection(),r=t.getOuterTopStartCorner(),s=t.getOuterBottomEndCorner(),l=Math.min(n.row,r.row),a=Math.min(n.col,r.col),h=Math.max(o.row,s.row),c=Math.max(o.col,s.col),u=this._createCellCoords(l,a),d=this._createCellCoords(h,c);return this.from=u,this.to=d,this.setDirection(i),e&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return KC(qC,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return KC(qC,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return KC(qC,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return KC(qC,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return KC(qC,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return KC(qC,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return KC(qC,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return KC(qC,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof YC&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];const e=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),o=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),r=Math.min(t.from.row,t.to.row),s=Math.max(t.from.row,t.to.row),l=Math.min(t.from.col,t.to.col),a=Math.max(t.from.col,t.to.col),h=[];return e===r&&h.push("top"),i===a&&h.push(KC(qC,this)?"left":"right"),n===s&&h.push("bottom"),o===l&&h.push(KC(qC,this)?"right":"left"),h}getInner(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[];for(let o=t.row;o<=e.row;o++)for(let i=t.col;i<=e.col;i++)this.from.row===o&&this.from.col===i||this.to.row===o&&this.to.col===i||n.push(this._createCellCoords(o,i));return n}getAll(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[];for(let o=t.row;o<=e.row;o++)for(let i=t.col;i<=e.col;i++)t.row===o&&t.col===i?n.push(t):e.row===o&&e.col===i?n.push(e):n.push(this._createCellCoords(o,i));return n}forAll(t){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let o=e.row;o<=n.row;o++)for(let i=e.col;i<=n.col;i++){if(!1===t(o,i))return}}clone(){return new ZC(this.highlight,this.from,this.to,KC(qC,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new YC(t,e,KC(qC,this))}}const QC=ZC;function JC(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function tS(t,e){return t.get(nS(t,e))}function eS(t,e,n){return t.set(nS(t,e),n),n}function nS(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oS=new WeakMap,iS=new WeakMap,rS=new WeakMap,sS=new WeakMap,lS=new WeakMap,aS=new WeakMap,hS=new WeakMap,cS=new WeakMap,uS=new WeakMap,dS=new WeakMap;const gS=class{constructor(t,e,n,o,i,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;JC(this,oS,void 0),JC(this,iS,void 0),JC(this,rS,void 0),JC(this,sS,void 0),JC(this,lS,void 0),JC(this,aS,void 0),JC(this,hS,void 0),JC(this,cS,void 0),JC(this,uS,[null,null]),JC(this,dS,[null,null]),eS(oS,this,n),eS(iS,this,e),eS(rS,this,i),eS(sS,this,r),eS(lS,this,s),eS(aS,this,o),eS(hS,this,t),this.registerEvents()}registerEvents(){tS(aS,this).addEventListener(tS(rS,this).holder,"contextmenu",(t=>this.onContextMenu(t))),tS(aS,this).addEventListener(tS(rS,this).TABLE,"mouseover",(t=>this.onMouseOver(t))),tS(aS,this).addEventListener(tS(rS,this).TABLE,"mouseout",(t=>this.onMouseOut(t)));const t=()=>{tS(aS,this).addEventListener(tS(rS,this).holder,"touchstart",(t=>this.onTouchStart(t))),tS(aS,this).addEventListener(tS(rS,this).holder,"touchend",(t=>this.onTouchEnd(t))),this.momentumScrolling||(this.momentumScrolling={}),tS(aS,this).addEventListener(tS(rS,this).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||tS(oS,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,tS(oS,this).getSetting("onAfterMomentumScroll"))}),200)}))},e=()=>{tS(aS,this).addEventListener(tS(rS,this).holder,"mouseup",(t=>this.onMouseUp(t))),tS(aS,this).addEventListener(tS(rS,this).holder,"mousedown",(t=>this.onMouseDown(t)))};Kw()?t():(Ow()&&t(),e())}selectedCellWasTouched(t){const e=this.parentCell(t).coords;if(tS(cS,this)&&e){const[t,n]=[e.row,tS(cS,this).from.row],[o,i]=[e.col,tS(cS,this).from.col];return t===n&&o===i}return!1}parentCell(t){const e={},n=Pp(t,["TD","TH"],tS(rS,this).TABLE);return n?(e.coords=tS(rS,this).getCoords(n),e.TD=n):Wp(t,"wtBorder")&&Wp(t,"current")?(e.coords=tS(sS,this).getFocusSelection().cellRange.highlight,e.TD=tS(rS,this).getCell(e.coords)):Wp(t,"wtBorder")&&Wp(t,"area")&&tS(sS,this).getAreaSelection().cellRange&&(e.coords=tS(sS,this).getAreaSelection().cellRange.to,e.TD=tS(rS,this).getCell(e.coords)),e}onMouseDown(t){const e=tS(iS,this).rootDocument.activeElement,n=_m(Ap,t.target),o=t.target;if(!["TD","TH"].includes(e.nodeName)&&(o===e||n(0)===e||n(1)===e))return;const i=this.parentCell(o);Wp(o,"corner")?tS(oS,this).getSetting("onCellCornerMouseDown",t,o):i.TD&&tS(oS,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,i.coords,i.TD),(0===t.button||this.touchApplied)&&i.TD&&(tS(dS,this)[0]=i.TD,clearTimeout(tS(uS,this)[0]),tS(uS,this)[0]=setTimeout((()=>{tS(dS,this)[0]=null}),1e3))}onContextMenu(t){if(tS(oS,this).has("onCellContextMenu")){const e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!tS(oS,this).has("onCellMouseOver"))return;const e=tS(rS,this).TABLE,n=Pp(t.target,["TD","TH"],e),o=tS(lS,this)||this;n&&n!==o.lastMouseOver&&Np(n,e)&&(o.lastMouseOver=n,this.callListener("onCellMouseOver",t,tS(rS,this).getCoords(n),n))}onMouseOut(t){if(!tS(oS,this).has("onCellMouseOut"))return;const e=tS(rS,this).TABLE,n=Pp(t.target,["TD","TH"],e),o=Pp(t.relatedTarget,["TD","TH"],e),i=tS(lS,this)||this;n&&n!==o&&Np(n,e)&&(this.callListener("onCellMouseOut",t,tS(rS,this).getCoords(n),n),null===o&&(i.lastMouseOver=null))}onMouseUp(t){const e=this.parentCell(t.target);e.TD&&tS(oS,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===tS(dS,this)[0]&&e.TD===tS(dS,this)[1]?(Wp(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),tS(dS,this)[0]=null,tS(dS,this)[1]=null):e.TD===tS(dS,this)[0]&&(tS(dS,this)[1]=e.TD,clearTimeout(tS(uS,this)[1]),tS(uS,this)[1]=setTimeout((()=>{tS(dS,this)[1]=null}),500)))}onTouchStart(t){eS(cS,this,tS(sS,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;const n=t.target,o=null===(e=this.parentCell(n))||void 0===e?void 0:e.coords,i=qf(o)&&o.row>=0&&o.col>=0;if(t.cancelable&&i&&tS(oS,this).getSetting("isDataViewInstance")){const e=["A","BUTTON","INPUT"];Xw()&&(zw()||Yw())&&this.selectedCellWasTouched(n)&&!e.includes(n.tagName)?t.preventDefault():this.selectedCellWasTouched(n)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,n,o){const i=tS(oS,this).getSettingPure(t);i&&i(e,n,o,tS(hS,this).call(this))}destroy(){clearTimeout(tS(uS,this)[0]),clearTimeout(tS(uS,this)[1]),tS(aS,this).destroy()}};function fS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const pS=class{constructor(t,e,n){fS(this,"offset",void 0),fS(this,"total",void 0),fS(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=n}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function mS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const wS=class{constructor(t,e,n){mS(this,"offset",void 0),mS(this,"total",void 0),mS(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=n}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function bS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class vS{constructor(){bS(this,"currentSize",0),bS(this,"nextSize",0),bS(this,"currentOffset",0),bS(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function yS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class CS{constructor(){yS(this,"size",new vS),yS(this,"workingSpace",0),yS(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof vS}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}function SS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class RS{constructor(t,e,n){SS(this,"rootNode",void 0),SS(this,"nodesPool",void 0),SS(this,"sizeSet",new CS),SS(this,"childNodeType",void 0),SS(this,"visualIndex",0),SS(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=n.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){const t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){const{rootNode:t,sizeSet:e}=this;let n=0;if(this.isSharedViewSet()){let o=t.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)n+=1;else if(e.isPlaceOn(1))break;o=o.nextElementSibling}}else n=t.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:t,sizeSet:e}=this,n=this.isSharedViewSet(),{nextSize:o}=e.getViewSize();let i=this.getRenderedChildCount();for(;i<o;){const o=this.nodesPool();!n||n&&e.isPlaceOn(2)?t.appendChild(o):t.insertBefore(o,t.firstChild),i+=1}const r=n&&e.isPlaceOn(1);for(;i>o;)t.removeChild(r?t.firstChild:t.lastChild),i-=1}render(){const{rootNode:t,sizeSet:e}=this;let n=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(n+=e.sharedSize.nextSize);let o=t.childNodes[n];if(o.tagName!==this.childNodeType){const e=this.nodesPool();t.replaceChild(e,o),o=e}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class xS extends RS{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}function ES(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class MS{constructor(t){ES(this,"nodeType",void 0),this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function TS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class kS{constructor(t,e){TS(this,"nodesPool",null),TS(this,"nodeType",void 0),TS(this,"rootNode",void 0),TS(this,"table",null),TS(this,"renderedNodes",0),this.nodesPool="string"==typeof t?new MS(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}function AS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class HS extends kS{constructor(){super("TH"),AS(this,"orderViews",new WeakMap),AS(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new xS(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:n,rows:o,cells:i}=this.table;for(let r=0;r<t;r++){const t=this.table.renderedRowToSource(r),s=o.getRenderedNode(r);this.sourceRowIndex=t;const l=this.obtainOrderView(s),a=i.obtainOrderView(s);l.appendView(a).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<n;o++){l.render();const n=l.getCurrentNode();n.className="",n.removeAttribute("style"),Up(n,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&zp(n,[["role","rowheader"],["scope","row"],xp(o+1),bp(-1)]),e[o](t,n,o)}l.end()}}}class IS extends kS{constructor(t){super(null,t)}adjust(){const{columnHeadersCount:t,rowHeadersCount:e}=this.table;let n=this.rootNode.firstChild;if(t){const{columnsToRender:o}=this.table,i=o+e;for(let e=0,s=t;e<s;e++){for(n=this.rootNode.childNodes[e],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>t)for(let e=t;e<r;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&$p(n)}render(){const{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&zp(this.rootNode,[["role","rowgroup"]]);for(let e=0;e<t;e+=1){const{columnHeaderFunctions:t,columnsToRender:n,rowHeadersCount:o}=this.table,i=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&zp(i,[["role","row"],Rp(e+1)]);for(let r=-1*o;r<n;r+=1){const n=this.table.renderedColumnToSource(r),s=i.childNodes[r+o];s.className="",s.removeAttribute("style"),Up(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&zp(s,[xp(r+1+this.table.rowHeadersCount),bp(-1),["role","columnheader"],...r>=0?[["scope","col"]]:[["role","row"]]]),t[e](n,s,e)}}}}let OS=!1;class _S extends kS{constructor(t){super(null,t)}adjust(){const{columnsToRender:t,rowHeadersCount:e}=this.table,n=t+e;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:t,rowHeadersCount:e}=this.table;!OS&&t>1e3&&(OS=!0,Ub(Kf(v||(v=j`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`))));for(let o=0;o<e;o++){const t=this.table.renderedColumnToSource(o),e=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[o].style.width=`${e}px`}for(let o=0;o<t;o++){const t=this.table.renderedColumnToSource(o),n=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[o+e].style.width=`${n}px`}const n=this.rootNode.firstChild;n&&Bp(n,"rowHeader")}}function PS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const NS="ht__row_even",DS="ht__row_odd";let LS=!1;class VS extends kS{constructor(t){super("TR",t),PS(this,"orderView",void 0),this.orderView=new RS(t,(t=>this.nodesPool.obtain(t)),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){const{rowsToRender:t}=this.table;!LS&&t>1e3&&(LS=!0,Ub(Kf(y||(y=j`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)))),this.table.isAriaEnabled()&&zp(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let o=0;o<t;o++){this.orderView.render();const t=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(o);var e,n;if(this.table.isAriaEnabled())zp(t,[["role","row"],Rp(i+(null!==(e=null===(n=this.table.rowUtils)||void 0===n||null===(n=n.dataAccessObject)||void 0===n?void 0:n.columnHeaders.length)&&void 0!==e?e:0)+1)]);jp(t,[NS,DS]),Bp(t,(i+1)%2==0?NS:DS)}this.orderView.end()}}function FS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class WS extends kS{constructor(){super("TD"),FS(this,"orderViews",new WeakMap),FS(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new xS(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,columnsToRender:e,rows:n,rowHeaders:o}=this.table;for(let s=0;s<t;s++){const t=this.table.renderedRowToSource(s),l=n.getRenderedNode(s);this.sourceRowIndex=t;const a=this.obtainOrderView(l),h=o.obtainOrderView(l);a.prependView(h).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<e;n++){a.render();const e=a.getCurrentNode(),o=this.table.renderedColumnToSource(n);var i,r;if(Wp(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),Up(e,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(t,o,e),this.table.isAriaEnabled())zp(e,[...e.hasAttribute("role")?[]:[["role","gridcell"]],bp(-1),xp(o+(null!==(i=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.rowHeaders.length)&&void 0!==i?i:0)+1)])}a.end()}}}function BS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class jS{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};BS(this,"rootNode",void 0),BS(this,"rootDocument",void 0),BS(this,"rowHeaders",null),BS(this,"columnHeaders",null),BS(this,"colGroup",null),BS(this,"rows",null),BS(this,"cells",null),BS(this,"rowFilter",null),BS(this,"columnFilter",null),BS(this,"rowUtils",null),BS(this,"columnUtils",null),BS(this,"rowsToRender",0),BS(this,"columnsToRender",0),BS(this,"rowHeaderFunctions",[]),BS(this,"rowHeadersCount",0),BS(this,"columnHeaderFunctions",[]),BS(this,"columnHeadersCount",0),BS(this,"cellRenderer",void 0),BS(this,"activeOverlayName",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setActiveOverlayName(t){this.activeOverlayName=t}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:n,rows:o,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),n.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=n,this.rows=o,this.cells=i}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:t,rows:e}=this;for(let n=0;n<t;n++){const t=e.getRenderedNode(n);if(t.firstChild){const e=this.renderedRowToSource(n),o=this.rowUtils.getHeightByOverlayName(e,this.activeOverlayName);t.firstChild.style.height=o?o-1+"px":""}}}}class zS{constructor(){let{TABLE:t,THEAD:e,COLGROUP:n,TBODY:o,rowUtils:i,columnUtils:r,cellRenderer:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new jS(t,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new HS,columnHeaders:new IS(e),colGroup:new _S(n),rows:new VS(o),cells:new WS}),this.renderer.setAxisUtils(i,r)}setActiveOverlayName(t){return this.renderer.setActiveOverlayName(t),this}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function US(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function YS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $S(t,e){return t.get(KS(t,e))}function GS(t,e,n){return t.set(KS(t,e),n),n}function KS(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var XS=new WeakMap,qS=new WeakMap,ZS=new WeakMap,QS=new WeakMap,JS=new WeakMap;class tR{constructor(t){let{totalColumns:e,stretchMode:n,stretchingColumnWidthFn:o,columnWidthFn:i}=t;YS(this,"stretchAllRatio",0),YS(this,"stretchLastWidth",0),YS(this,"stretchAllColumnsWidth",[]),US(this,XS,0),YS(this,"needVerifyLastColumnWidth",!0),US(this,qS,(()=>0)),US(this,ZS,(t=>t)),US(this,QS,(t=>t)),US(this,JS,(()=>"none")),GS(qS,this,e),GS(JS,this,n),GS(ZS,this,null!=o?o:$S(ZS,this)),GS(QS,this,null!=i?i:$S(QS,this))}refreshStretching(t){if("none"===$S(JS,this).call(this))return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,GS(XS,this,t);let e=0;for(let o=0;o<$S(qS,this).call(this);o++){const n=this._getColumnWidth(o),i=$S(ZS,this).call(this,void 0,o);"number"==typeof i?t-=i:e+=n}const n=t-e;if("all"===$S(JS,this).call(this)&&n>0)this.stretchAllRatio=t/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===$S(JS,this).call(this)&&t!==1/0){const t=this._getColumnWidth($S(qS,this).call(this)-1),e=n+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let n=null;return"all"===$S(JS,this).call(this)&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===$S(JS,this).call(this)&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}_getStretchedAllColumnWidth(t,e){let n=0;if(!this.stretchAllColumnsWidth[t]){const n=Math.round(e*this.stretchAllRatio),o=$S(ZS,this).call(this,n,t);this.stretchAllColumnsWidth[t]=void 0===o?n:isNaN(o)?this._getColumnWidth(t):o}if(this.stretchAllColumnsWidth.length===$S(qS,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)n+=this.stretchAllColumnsWidth[t];n!==$S(XS,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=$S(XS,this)-n)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){return t===$S(qS,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=$S(QS,this).call(this,t);return isNaN(e)&&(e=50),e}}function eR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class nR{constructor(t,e){eR(this,"dataAccessObject",void 0),eR(this,"wtSettings",void 0),eR(this,"headerWidths",new Map),eR(this,"stretching",void 0),this.dataAccessObject=t,this.wtSettings=e,this.stretching=new tR({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(t,e)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",t,e),columnWidthFn:t=>this.dataAccessObject.wtTable.getColumnWidth(t)})}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){let e=this.getWidth(t);const n=this.stretching.getStretchedColumnWidth(t,e);return n&&(e=n),e}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}refreshStretching(){const{wtTable:t,wtViewport:e,cloneSource:n}=this.dataAccessObject,o=n?n.wtTable.holder:t.holder,i=o.offsetHeight<o.scrollHeight?wm():0;this.stretching.refreshStretching(e.getViewportWidth()-i)}calculateWidths(){const{wtSettings:t}=this;let e=t.getSetting("rowHeaderWidth");if(this.refreshStretching(),e=t.getSetting("onModifyRowHeaderWidth",e),null!=e){const n=t.getSetting("rowHeaders").length,o=t.getSetting("defaultColumnWidth");for(let t=0;t<n;t++){let n=Array.isArray(e)?e[t]:e;n=null==n?o:n,this.headerWidths.set(t,n)}}}}function oR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class iR{constructor(t,e){oR(this,"dataAccessObject",void 0),oR(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t);const n=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}getHeightByOverlayName(t,e){let n=this.wtSettings.getSetting("rowHeightByOverlayName",t,e);const o=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==o&&(n=void 0===n?o:Math.max(n,o)),n}}function rR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const sR=class{constructor(t,e,n,o,i){rR(this,"wtSettings",null),rR(this,"domBindings",void 0),rR(this,"TBODY",null),rR(this,"THEAD",null),rR(this,"COLGROUP",null),rR(this,"hasTableHeight",!0),rR(this,"hasTableWidth",!0),rR(this,"isTableVisible",!1),rR(this,"tableOffset",0),rR(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===i,this.name=i,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Yp(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const r=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(r))),this.rowUtils=new iR(this.dataAccessObject,this.wtSettings),this.columnUtils=new nR(this.dataAccessObject,this.wtSettings),this.tableRenderer=new zS({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){const t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){const e=t.parentNode;let n;return e&&e.nodeType===Node.ELEMENT_NODE&&Wp(e,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",e&&e.insertBefore(n,t),n.appendChild(t)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&zp(n,[["role","presentation"]]),n}createHider(t){const e=t.parentNode;let n;return e&&e.nodeType===Node.ELEMENT_NODE&&Wp(e,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",e&&e.insertBefore(n,t),n.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&zp(n,[["role","presentation"]]),n}createHolder(t){const e=t.parentNode;let n;return e&&e.nodeType===Node.ELEMENT_NODE&&Wp(e,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",e&&e.insertBefore(n,t),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&zp(n.parentNode,[["role","presentation"]])),n.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&zp(n,[["role","presentation"]]),n}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,{wtOverlays:n,wtViewport:o}=this.dataAccessObject,i=e.getSetting("totalRows"),r=e.getSetting("totalColumns"),s=e.getSetting("rowHeaders"),l=s.length,a=e.getSetting("columnHeaders"),h=a.length;let c=t;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Zp(this.holder),c=o.createCalculators(c),l&&!e.getSetting("fixedColumnsStart"))){const t=n.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(c=!1)}if(c)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Zp(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const t=i>0?this.getFirstRenderedRow():0,e=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new wS(t,i,h),this.columnFilter=new pS(e,r,l);let c=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const t={};this.wtSettings.getSetting("beforeDraw",!0,t),c=!0!==t.skipRender}if(c){let t;if(this.tableRenderer.setHeaderContentRenderers(s,a),(this.is(fR)||this.is(wR))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,o.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(fR))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||o.createVisibleCalculators(),n.refresh(!1),n.applyToDOM();const e=am(this.hider),i=am(this.TABLE);0!==e&&i!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==o.getWorkspaceWidth()&&(o.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(fR)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let u=!1;return this.isMaster&&(u=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(u=n.bottomOverlay.resetFixedPosition()||u),u=n.inlineStartOverlay.resetFixedPosition()||u,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),u?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(c),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){const e=this.columnFilter.renderedToSource(t);let n=this.wtSettings.getSetting("columnHeaders").length;const o=this.wtSettings.getSetting("defaultRowHeight");let i,r,s;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),r=this.getColumnHeader(e,n),r&&(s=cm(r),(!i&&o<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(l)?null!==l[n]&&void 0!==l[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:t}=this,e=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let o=0,i=t.getSetting("columnHeaders").length;o<i;o++)if(n[o]){if(!e[o]||0===e[o].childNodes.length)return;e[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(fR))&&!t.getSetting("externalRowCalculator")){const t=this.getRenderedRowsCount();for(let n=0;n<t;n++){const t=this.rowFilter.renderedToSource(n);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,n=t.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",e,n);if(o&&Array.isArray(o)&&([e,n]=o),this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(e);if(!i&&e>=0)throw new Error("TR was expected to be rendered but is not");const r=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!r&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(t){let e=null,n=null;var o,i;t<0?(e=null===(o=this.rowFilter)||void 0===o?void 0:o.sourceRowToVisibleColHeadedRow(t),n=this.THEAD):(e=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),n=this.TBODY);return void 0!==e&&void 0!==n&&(!(n.childNodes.length<e+1)&&n.childNodes[e])}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.THEAD.childNodes[e];return null==n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){const e=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((t=>{const o=t.childNodes[n];o&&e.push(o)})),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e>=this.wtSettings.getSetting("rowHeaders").length)return;const n=this.rowFilter.sourceToRendered(t),o=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):n,i=(n<0?this.THEAD:this.TBODY).childNodes[o];return null==i?void 0:i.childNodes[e]}getRowHeaders(t){const e=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<n;o++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null==n?void 0:n.childNodes[o];i&&e.push(i)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=_p(e,["TD","TH"])),null===e)return null;const n=e.parentNode,o=n.parentNode;let i=Dp(n),r=e.cellIndex;if(Lp(mR,e,this.wtRootElement)||Lp(gR,e,this.wtRootElement))"THEAD"===o.nodeName&&(i-=o.childNodes.length);else if(Lp(wR,e,this.wtRootElement)||Lp(fR,e,this.wtRootElement)){i=this.wtSettings.getSetting("totalRows")-o.childNodes.length+i}else i=o===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i);return r=Lp(mR,e,this.wtRootElement)||Lp(pR,e,this.wtRootElement)||Lp(wR,e,this.wtRootElement)?this.columnFilter.offsettedTH(r):this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),this.wot.createCellCoords(i,r)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let t=this.TBODY.childNodes.length;let e,n,o,i,r;if(t*this.wtSettings.getSetting("defaultRowHeight")!==cm(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;t;)t-=1,o=this.rowFilter.renderedToSource(t),e=this.getRowHeight(o),i=this.getTrForRow(o),r=i.querySelector("th"),n=r?cm(r):cm(i)-1,(!e&&this.wtSettings.getSetting("defaultRowHeight")<n||e<n)&&(n+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=n)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(t)<=e}isRowHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(t)<=e}isRowBeforeRenderedRows(t){const e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){const e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return am(this.TABLE)}getHeight(){return hm(this.TABLE)}getTotalWidth(){const t=am(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){const t=hm(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return qp(this.TABLE)}_modifyRowHeaderWidth(t){let e=Hm(t)?t():null;return Array.isArray(e)?(e=[...e],e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}},lR={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return 0===t||0===e?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};Sw(lR,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const aR=lR,hR={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Sw(hR,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const cR=hR;class uR extends sR{constructor(t,e,n,o){super(t,e,n,o,wR)}}vw(uR,aR),vw(uR,cR);const dR=uR,gR="top",fR="bottom",pR="inline_start",mR="top_inline_start_corner",wR="bottom_inline_start_corner",bR=[gR,fR,pR,mR,wR],vR=new Map([[gR,`ht_clone_${gR}`],[fR,`ht_clone_${fR}`],[pR,`ht_clone_${pR} ht_clone_left`],[mR,`ht_clone_${mR} ht_clone_top_left_corner`],[wR,`ht_clone_${wR} ht_clone_bottom_left_corner`]]);function yR(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function CR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SR(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var RR=new WeakSet;function xR(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:o,wtViewport:i,totalColumns:r,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){let l=null;if(e.getSetting("rtlMode")){const t=o.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(t.right-e)}else{l=Zp(o.wtRootElement).left}const a=Math.abs(em(s,s));if(l>a){const e=um(s);let o=i.getRowHeaderWidth();for(let i=1;i<=r;i++)if(o+=n.sumCellSizes(i-1,i),l+o-a>=e){t=i-2;break}}}return t}function ER(t){const{topOverlay:e,wtTable:n,wtViewport:o,totalRows:i,rootWindow:r}=this.dataAccessObject;if(e.mainTableScrollableElement===r){const s=Zp(n.wtRootElement),l=tm(r,r);if(s.top>l){const n=cm(r);let a=o.getColumnHeaderHeight();for(let o=1;o<=i;o++)if(a+=e.sumCellSizes(o-1,o),s.top+a-l>=n){t=o-2;break}}}return t}const MR=class{constructor(t){yR(this,RR),CR(this,"dataAccessObject",void 0),this.dataAccessObject=t}scrollViewport(t,e,n,o,i){const r=this.scrollViewportHorizontally(t.col,n,i),s=this.scrollViewportVertically(t.row,e,o);return r||s}scrollViewportHorizontally(t,e,n){const{drawn:o,totalColumns:i}=this.dataAccessObject;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;const r=void 0===e&&void 0===n,{fixedColumnsStart:s,inlineStartOverlay:l}=this.dataAccessObject;if(r&&t<s)return!1;if(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),!Number.isInteger(t)||t<0||t>i)return!1;const a=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let c=!1;return(r&&(t<a||t>h)||!r)&&(c=l.scrollTo(t,r?t>=this.getLastPartiallyVisibleColumn():e)),c}scrollViewportVertically(t,e,n){const{drawn:o,totalRows:i}=this.dataAccessObject;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;const r=void 0===e&&void 0===n,{fixedRowsBottom:s,fixedRowsTop:l,topOverlay:a}=this.dataAccessObject;if(r&&(t<l||t>i-s-1))return!1;if(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),!Number.isInteger(t)||t<0||t>i)return!1;const h=this.getFirstVisibleRow(),c=this.getLastVisibleRow();let u=!1;return(r&&(t<h||t>c)||!r)&&(u=a.scrollTo(t,r?t>=this.getLastPartiallyVisibleRow():n)),u}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return SR(RR,this,ER).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return SR(RR,this,ER).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return SR(RR,this,xR).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return SR(RR,this,xR).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function TR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class kR{get eventManager(){return new pv(this)}constructor(t,e){TR(this,"wtTable",void 0),TR(this,"wtScroll",void 0),TR(this,"wtViewport",void 0),TR(this,"wtOverlays",void 0),TR(this,"selectionManager",void 0),TR(this,"wtEvent",void 0),TR(this,"guid",`wt_${dp()}`),TR(this,"drawInterrupted",!1),TR(this,"drawn",!1),TR(this,"domBindings",void 0),TR(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new MR(this.createScrollDao())}findOriginalHeaders(){const t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;e<n;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,n){Xp(n,t[e])}])}}createCellCoords(t,e){return new YC(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,n){return new QC(t,e,n,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(t);const e=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<i&&t.row>=e-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<e&&t.row>=e-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}scrollViewport(t,e,n,o,i){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,n,o,i)}scrollViewportHorizontally(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,n)}scrollViewportVertically(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function AR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class HR extends kR{constructor(t,e,n){super(t,e),AR(this,"cloneSource",void 0),AR(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new gS(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function IR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class OR{constructor(t,e,n,o,i){IR(this,"wtSettings",null),Sw(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=e,this.wtSettings=o;const{TABLE:r,hider:s,spreader:l,holder:a,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=r,this.hider=s,this.spreader=l,this.holder=a,this.wtRootElement=h,this.trimmingContainer=rm(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(t){"before"===t&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==t||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=rm(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=nm(t.TABLE)}getRelativeCellPosition(t,e,n){if(!1===this.clone.wtTable.holder.contains(t))return void Ub(`The provided element is not a child of the ${this.type} overlay`);const o=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),r=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};let c=null;return c=o?this.getRelativeCellPositionWithinWindow(r,i,h,a):this.getRelativeCellPositionWithinHolder(r,s,i,h,a),c}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,n,o){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let r=0,s=0;if(e){let t=i.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(i.left+i.width+wm())),r=t<=0?-1*t:0}else r=o.start;if(t){s=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top}else s=o.top;return{start:n.start+r,top:n.top+s}}getRelativeCellPositionWithinHolder(t,e,n,o,i){const r=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let l=0,a=0;if(n||(l=r-i.start),e){const t=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+t.top}else t||(a=s-i.top);return{start:o.start-l,top:o.top-a}}makeClone(){if(-1===bR.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:t,wtSettings:e}=this.wot,{rootDocument:n,rootWindow:o}=this.domBindings,i=n.createElement("div"),r=n.createElement("table"),s=t.wtRootElement.parentNode;i.className=`${vR.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,e.getSetting("ariaTags")&&zp(i,[["role","presentation"]]),r.className=t.TABLE.className;t.TABLE.getAttribute("role")&&r.setAttribute("role",t.TABLE.getAttribute("role")),i.appendChild(r),s.appendChild(i);const l=this.wtSettings.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===gR||"vertical"===l&&this.type===pR?this.mainTableScrollableElement=o:"hidden"===o.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=nm(t.TABLE),new HR(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.needFullRender&&this.clone.draw(t)}reset(){const t=this.clone.wtTable.holder,e=this.clone.wtTable.hider;[t.style,e.style,t.parentNode.style].forEach((t=>{t.width="",t.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class _R extends OR{constructor(t,e,n,o,i,r){super(t,e,wR,n,o),this.bottomOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new dR(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${n}px`}else Cm(e),this.repositionOverlay();let n=hm(this.clone.wtTable.TABLE);const o=am(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=wm(n)),o.style.bottom=`${i}px`}}const PR={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return null===t?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Sw(PR,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const NR=PR;class DR extends sR{constructor(t,e,n,o){super(t,e,n,o,fR)}}vw(DR,aR),vw(DR,NR);const LR=DR;function VR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class FR extends OR{constructor(t,e,n,o){super(t,e,fR,n,o),VR(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new LR(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let n=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||o&&"vertical"===o?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),e.style.bottom=`${n}px`);const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=wm(n)),o.style.bottom=`${i}px`}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let n=!1;return this.mainTableScrollableElement===e?(e.scrollTo(Jp(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const{wtTable:n,wtSettings:o}=this.wot,i=o.getSetting("defaultRowHeight");let r=t,s=0;for(;r<e;){const t=n.getRowHeight(r);s+=void 0===t?i:t,r+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n,rootWindow:o}=this.domBindings,i=wm(n),r=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===s){let n=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(n-=i),n=Math.min(n,t.wtRootElement.scrollWidth),r.width=`${n}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let l=hm(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),r.height=`${l}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;e&&o.offsetHeight!==o.clientHeight&&(i=wm(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),n+=i,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return tm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=t-this.clone.wtTable.getTotalHeight(),o=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-o+t,0),n>e&&(n=0)}return n}adjustHeaderBordersPosition(t){const e=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==e,o=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||0===e)&&o.length>0){const e=this.wot.wtTable.holder.parentNode,n=Wp(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(Bp(e,"innerBorderBottom"),i=!n):(jp(e,"innerBorderBottom"),i=n)}return i}}const WR={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return null===t?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Sw(WR,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const BR=WR;class jR extends sR{constructor(t,e,n,o){super(t,e,n,o,pR)}}vw(jR,BR),vw(jR,cR);const zR=jR,UR={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,o,i,r,s){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let a=0;a<l;a++)Nm(this._localHooks[t][a],this,e,n,o,i,r,s)}},clearLocalHooks(){return this._localHooks={},this}};Sw(UR,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const YR=UR;let $R=class{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}};vw($R,YR);const GR=$R,KR="active-header",XR="header",qR="area",ZR="focus",QR=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});function JR(t,e,n){tx(t,e),e.set(t,n)}function tx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ex(t,e){return t.get(ox(t,e))}function nx(t,e,n){return t.set(ox(t,e),n),n}function ox(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}zb("flat");var ix=new WeakMap,rx=new WeakMap,sx=new WeakSet;class lx{constructor(){var t,e;tx(t=this,e=sx),e.add(t),JR(this,ix,void 0),JR(this,rx,void 0)}setActiveOverlay(t){return nx(rx,this,t),this}setActiveSelection(t){return nx(ix,this,t),this}scan(){const t=ex(ix,this).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"area"===t?this.scanCellsRange((t=>e.add(t))):"focus"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t))),this.scanCellsRange((t=>e.add(t)))):"fill"===t?this.scanCellsRange((t=>e.add(t))):"header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"row"===t?(this.scanRowsInHeadersRange((t=>e.add(t))),this.scanRowsInCellsRange((t=>e.add(t)))):"column"===t&&(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanColumnsInCellsRange((t=>e.add(t)))),e}scanColumnsInHeadersRange(t){const[e,n,o,i]=ex(ix,this).getCorners(),{wtTable:r}=ex(rx,this),s=r.getRenderedColumnsCount(),l=r.getColumnHeadersCount();let a=0;for(let h=-r.getRowHeadersCount();h<s;h++){const s=r.columnFilter.renderedToSource(h);if(!(s<n||s>i)){for(let h=-l;h<0;h++){if(h<e||h>o)continue;const c=h+l;let u=r.getColumnHeader(s,c);const d=ex(rx,this).getSetting("onBeforeHighlightingColumnHeader",s,c,{selectionType:ex(ix,this).settings.selectionType,columnCursor:a,selectionWidth:i-n+1});null!==d&&(d!==s&&(u=r.getColumnHeader(d,c)),t(u))}a+=1}}}scanRowsInHeadersRange(t){const[e,n,o,i]=ex(ix,this).getCorners(),{wtTable:r}=ex(rx,this),s=r.getRenderedRowsCount(),l=r.getRowHeadersCount();let a=0;for(let h=-r.getColumnHeadersCount();h<s;h++){const s=r.rowFilter.renderedToSource(h);if(!(s<e||s>o)){for(let h=-l;h<0;h++){if(h<n||h>i)continue;const c=h+l;let u=r.getRowHeader(s,c);const d=ex(rx,this).getSetting("onBeforeHighlightingRowHeader",s,c,{selectionType:ex(ix,this).settings.selectionType,rowCursor:a,selectionHeight:o-e+1});null!==d&&(d!==s&&(u=r.getRowHeader(d,c)),t(u))}a+=1}}}scanCellsRange(t){const[e,n,o,i]=ex(ix,this).getCorners(),{wtTable:r}=ex(rx,this);ox(sx,this,ax).call(this,((s,l)=>{if(s>=e&&s<=o&&l>=n&&l<=i){const e=r.getCell(ex(rx,this).createCellCoords(s,l)),n=ex(rx,this).getSetting("onAfterDrawSelection",s,l,ex(ix,this).settings.layerLevel);"string"==typeof n&&Bp(e,n),t(e)}}))}scanRowsInCellsRange(t){const[e,,n]=ex(ix,this).getCorners(),{wtTable:o}=ex(rx,this);ox(sx,this,ax).call(this,((i,r)=>{if(i>=e&&i<=n){const e=o.getCell(ex(rx,this).createCellCoords(i,r));t(e)}}))}scanColumnsInCellsRange(t){const[,e,,n]=ex(ix,this).getCorners(),{wtTable:o}=ex(rx,this);ox(sx,this,ax).call(this,((i,r)=>{if(r>=e&&r<=n){const e=o.getCell(ex(rx,this).createCellCoords(i,r));t(e)}}))}}function ax(t){const{wtTable:e}=ex(rx,this),n=e.getRenderedRowsCount(),o=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const n=e.rowFilter.renderedToSource(i);for(let i=0;i<o;i+=1)t(n,e.columnFilter.renderedToSource(i))}}const hx=class{constructor(t,e){e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=QR,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}registerListeners(){const t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()));for(let e=0,n=this.main.childNodes.length;e<n;e++){const t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",(t=>this.onMouseEnter(t,this.main.childNodes[e])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),lb(t);const n=this,o=this.wot.rootDocument.body,i=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(o,"mousemove",(function t(r){var s;((s=r).clientY<Math.floor(i.top)||s.clientY>Math.ceil(i.top+i.height)||s.clientX<Math.floor(i.left)||s.clientX>Math.ceil(i.left+i.width))&&(n.eventManager.removeEventListener(o,"mousemove",t),e.style.display="block")}))}createBorders(t){const{rootDocument:e}=this.wot;this.main=e.createElement("div");const n=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let s=0;s<5;s++){const i=n[s],r=e.createElement("div");r.className=`wtBorder ${this.settings.className||""}`,this.settings[i]&&this.settings[i].hide&&(r.className+=" hidden"),o=r.style,o.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,o.height=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,o.width=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,this.main.appendChild(r)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Kw()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let r=i.bordersHolder;r||(r=e.createElement("div"),r.className="htBorders",i.bordersHolder=r,i.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};Rw({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},((t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t}));Rw({position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"},((t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){const n=this.wot.selectionManager.getAreaSelection();return!(!n.cellRange||t===n.cellRange.to.row&&e===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,n,o,i,r){const s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:l,topHitArea:a,bottom:h,bottomHitArea:c}=this.selectionHandles.styles,u=parseInt(l.borderWidth,10),d=parseInt(l.width,10),g=parseInt(a.width,10),f=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();l.top=`${parseInt(n-d-1,10)}px`,l[s]=`${parseInt(o-d-1,10)}px`,a.top=`${parseInt(n-g/4*3,10)}px`,a[s]=`${parseInt(o-g/4*3,10)}px`;const m=Math.min(parseInt(o+i,10),f-d-2*u),w=Math.min(parseInt(o+i-g/4,10),f-g-2*u);h[s]=`${m}px`,c[s]=`${w}px`;const b=Math.min(parseInt(n+r,10),p-d-2*u),v=Math.min(parseInt(n+r-g/4,10),p-g-2*u);h.top=`${b}px`,c.top=`${v}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(l.display="block",a.display="block",this.isPartRange(t,e)?(h.display="none",c.display="none"):(h.display="block",c.display="block")):(l.display="none",h.display="none",a.display="none",c.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(l.zIndex="9999",a.zIndex="9999"):(l.zIndex="",a.zIndex="")}appear(t){if(this.disabled)return;const{wtTable:e,rootDocument:n,rootWindow:o}=this.wot;let i,r,s,l,a,h;const c=e.getRenderedRowsCount();for(let _=0;_<c;_+=1){const n=e.rowFilter.renderedToSource(_);if(n>=t[0]&&n<=t[2]){i=n,a=t[0];break}}for(let _=c-1;_>=0;_-=1){const n=e.rowFilter.renderedToSource(_);if(n>=t[0]&&n<=t[2]){r=n;break}}const u=e.getRenderedColumnsCount();for(let _=0;_<u;_+=1){const n=e.columnFilter.renderedToSource(_);if(n>=t[1]&&n<=t[3]){s=n,h=t[1];break}}for(let _=u-1;_>=0;_-=1){const n=e.columnFilter.renderedToSource(_);if(n>=t[1]&&n<=t[3]){l=n;break}}if(void 0===i||void 0===s)return void this.disappear();let d=e.getCell(this.wot.createCellCoords(i,s));const g=i!==r||s!==l,f=g?e.getCell(this.wot.createCellCoords(r,l)):d,p=Zp(d),m=g?Zp(f):p,w=Zp(e.TABLE),b=am(e.TABLE),v=p.top,y=p.left,C=this.wot.wtSettings.getSetting("rtlMode");let S=0,R=0;if(C){const t=am(d),e=o.innerWidth-w.left-b;R=y+t-m.left,S=o.innerWidth-y-t-e-1}else R=m.left+am(f)-y,S=y-w.left-1;if(this.isEntireColumnSelected(i,r)){const t=this.getDimensionsFromHeader("columns",s,l,a,w);let e=null;t&&([e,S,R]=t),e&&(d=e)}let x=v-w.top-1,E=m.top+hm(f)-v;if(this.isEntireRowSelected(s,l)){const t=this.getDimensionsFromHeader("rows",i,r,h,w);let e=null;t&&([e,x,E]=t),e&&(d=e)}const M=lm(d,o);parseInt(M.borderTopWidth,10)>0&&(x+=1,E=E>0?E-1:0),parseInt(M[C?"borderRightWidth":"borderLeftWidth"],10)>0&&(S+=1,R=R>0?R-1:0);const T=C?"right":"left";this.topStyle.top=`${x}px`,this.topStyle[T]=`${S}px`,this.topStyle.width=`${R}px`,this.topStyle.display="block",this.startStyle.top=`${x}px`,this.startStyle[T]=`${S}px`,this.startStyle.height=`${E}px`,this.startStyle.display="block";const k=Math.floor(this.settings.border.width/2);this.bottomStyle.top=x+E-k+"px",this.bottomStyle[T]=`${S}px`,this.bottomStyle.width=`${R}px`,this.bottomStyle.display="block",this.endStyle.top=`${x}px`,this.endStyle[T]=S+R-k+"px",this.endStyle.height=`${E+1}px`,this.endStyle.display="block";let A=this.settings.border.cornerVisible;A="function"==typeof A?A(this.settings.layerLevel):A;const H=this.wot.getSetting("onModifyGetCellCoords",r,l);let[I,O]=[r,l];if(H&&Array.isArray(H)&&([,,I,O]=H),Kw()||!A||this.isPartRange(I,O))this.cornerStyle.display="none";else{this.cornerStyle.top=x+E+this.cornerCenterPointOffset-1+"px",this.cornerStyle[T]=S+R+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=rm(e.TABLE);const i=t===o;i&&(t=n.documentElement);const s=parseInt(this.cornerDefaultStyle.width,10)/2,a=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const e=i?f.getBoundingClientRect().left:f.offsetLeft;let n=!1,o=0;C?(o=e-parseInt(this.cornerDefaultStyle.width,10)/2,n=o<0):(o=e+am(f)+parseInt(this.cornerDefaultStyle.width,10)/2,n=o>=um(t)),n&&(this.cornerStyle[T]=`${Math.floor(S+R+this.cornerCenterPointOffset-s)}px`,this.cornerStyle[C?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){(i?f.getBoundingClientRect().top:f.offsetTop)+hm(f)+parseInt(this.cornerDefaultStyle.height,10)/2>=cm(t)&&(this.cornerStyle.top=`${Math.floor(x+E+this.cornerCenterPointOffset-a)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Kw()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,l,x,S,R,E)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,n,o,i){const{wtTable:r}=this.wot,s=r.wtRootElement.parentNode;let l=null,a=null,h=null,c=null,u=null,d=null,g=null,f=null;switch(t){case"rows":l=function(){return r.getRowHeader(...arguments)},a=function(){return hm(...arguments)},h="ht__selection--rows",d="top";break;case"columns":l=function(){return r.getColumnHeader(...arguments)},a=function(){return am(...arguments)},h="ht__selection--columns",d="left"}if(s.classList.contains(h)){const t=this.wot.getSetting("columnHeaders").length;if(g=l(e,t-o),f=l(n,t-o),!g||!f)return!1;const r=Zp(g),s=Zp(f);return g&&f&&(c=r[d]-i[d]-1,u=s[d]+a(f)-r[d]),[g,c,u]}return!1}changeBorderStyle(t,e){const n=this[t].style,o=e[t];!o||o.hide?Bp(this[t],"hidden"):(Wp(this[t],"hidden")&&jp(this[t],"hidden"),n.backgroundColor=o.color,"top"!==t&&"bottom"!==t||(n.height=`${o.width}px`),"start"!==t&&"end"!==t||(n.width=`${o.width}px`))}changeBorderToDefaultStyle(t){const e=1,n="#000",o=this[t].style;o.backgroundColor=n,o.width=`${e}px`,o.height=`${e}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?Bp(this[t],"hidden"):jp(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Kw()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function cx(t,e,n){ux(t,e),e.set(t,n)}function ux(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dx(t,e){return t.get(fx(t,e))}function gx(t,e,n){return t.set(fx(t,e),n),n}function fx(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var px=new WeakMap,mx=new WeakMap,wx=new WeakMap,bx=new WeakMap,vx=new WeakMap,yx=new WeakMap,Cx=new WeakSet;class Sx{constructor(t){var e,n;ux(e=this,n=Cx),n.add(e),cx(this,px,void 0),cx(this,mx,void 0),cx(this,wx,new lx),cx(this,bx,new WeakMap),cx(this,vx,new WeakSet),cx(this,yx,new Map),gx(mx,this,t)}setActiveOverlay(t){return gx(px,this,t),dx(wx,this).setActiveOverlay(dx(px,this)),dx(bx,this).has(dx(px,this))||dx(bx,this).set(dx(px,this),new Set),this}getFocusSelection(){return null!==dx(mx,this)?dx(mx,this).getFocus():null}getAreaSelection(){return null!==dx(mx,this)?dx(mx,this).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(dx(yx,this).has(t)){const e=dx(yx,this).get(t);if(e.has(dx(px,this)))return e.get(dx(px,this));const n=new hx(dx(px,this),t.settings);return e.set(dx(px,this),n),n}const e=new hx(dx(px,this),t.settings);return dx(yx,this).set(t,new Map([[dx(px,this),e]])),e}getBorderInstances(t){var e,n;return Array.from(null!==(e=null===(n=dx(yx,this).get(t))||void 0===n?void 0:n.values())&&void 0!==e?e:[])}destroyBorders(t){dx(yx,this).get(t).forEach((t=>t.destroy())),dx(yx,this).delete(t)}render(t){if(null===dx(mx,this))return;t&&fx(Cx,this,Rx).call(this);const e=Array.from(dx(mx,this)),n=new Map,o=new Map;for(let i=0;i<e.length;i++){const t=e[i],{className:r,headerAttributes:s,createLayers:l,selectionType:a}=t.settings;dx(vx,this).has(t)||(dx(vx,this).add(t),t.addLocalHook("destroy",(()=>this.destroyBorders(t))));const h=this.getBorderInstance(t);if(t.isEmpty()){null==h||h.disappear();continue}if(r){dx(wx,this).setActiveSelection(t).scan().forEach((t=>{if(n.has(t)){const e=n.get(t);e.has(r)&&!0===l?e.set(r,e.get(r)+1):e.set(r,1)}else n.set(t,new Map([[r,1]]));s&&(o.has(t)||o.set(t,[]),"TH"===t.nodeName&&o.get(t).push(...s))}))}const c=t.getCorners();dx(px,this).getSetting("onBeforeDrawBorders",c,a),null==h||h.appear(c)}n.forEach(((t,e)=>{var n;const o=Array.from(t).map((t=>{let[e,n]=t;return 1===n?e:[e,...Array.from({length:n-1},((t,n)=>`${e}-${n+1}`))]})).flat();o.forEach((t=>dx(bx,this).get(dx(px,this)).add(t))),Bp(e,o),"TD"===e.nodeName&&Array.isArray(null===(n=dx(mx,this).options)||void 0===n?void 0:n.cellAttributes)&&zp(e,dx(mx,this).options.cellAttributes)})),Array.from(o.keys()).forEach((t=>{zp(t,[...o.get(t)])}))}}function Rx(){const t=dx(bx,this).get(dx(px,this)),e=dx(px,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach((t=>{var e,n;const o=dx(px,this).wtTable.TABLE.querySelectorAll(`.${t}`);let i=[];Array.isArray(null===(e=dx(mx,this).options)||void 0===e?void 0:e.cellAttributes)&&(i=dx(mx,this).options.cellAttributes.map((t=>t[0]))),Array.isArray(null===(n=dx(mx,this).options)||void 0===n?void 0:n.headerAttributes)&&(i=[...i,...dx(mx,this).options.headerAttributes.map((t=>t[0]))]);for(let r=0,s=o.length;r<s;r++)jp(o[r],t),Up(o[r],i)})),t.clear()}class xx extends OR{constructor(t,e,n,o){super(t,e,pR,n,o)}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new zR(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:t}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!t.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==e||o&&"horizontal"===o?(i=this.getScrollPosition(),Cm(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),ym(n,`${i}px`,"0px"));const r=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),r}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let n=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Qp(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){const n=this.wtSettings.getSetting("defaultColumnWidth");let o=t,i=0;for(;o<e;)i+=this.wot.wtTable.getStretchedColumnWidth(o)||n,o+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:n}=this.domBindings,o=wm(e),i=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"vertical"===r){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=o),e=Math.min(e,t.wtRootElement.scrollHeight),i.height=`${e}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const s=am(this.clone.wtTable.TABLE);i.width=`${s}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(QR.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){const{wtSettings:n}=this,o=n.getSetting("rowHeaders"),i=n.getSetting("fixedColumnsStart"),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0===i&&o.length>0&&!Wp(r.parentNode,"innerBorderInlineStart")?1:0;let l=this.getTableParentOffset(),a=0;if(e){this.wot.wtTable.getColumnWidth(t)>this.wot.wtViewport.getViewportWidth()&&(e=!1)}return e&&r.offsetWidth!==r.clientWidth&&(a=wm(this.domBindings.rootDocument)),e?(l+=this.sumCellSizes(0,t+1),l-=this.wot.wtViewport.getViewportWidth(),l+=s):l+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),l+=a,im(this.mainTableScrollableElement)===l-s&&s>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(s),this.setScrollPosition(l)}getTableParentOffset(){let t=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(em(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);n>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0)}return n}adjustHeaderBordersPosition(t){const{wtSettings:e}=this,n=this.wot.wtTable.holder.parentNode,o=e.getSetting("rowHeaders"),i=e.getSetting("fixedColumnsStart"),r=e.getSetting("totalRows"),s="vertical"===e.getSetting("preventOverflow");r?jp(n,"emptyRows"):Bp(n,"emptyRows");let l=!1;if(!s)if(i&&!o.length)Bp(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&o.length){const e=Wp(n,"innerBorderInlineStart");t?(Bp(n,"innerBorderLeft innerBorderInlineStart"),l=!e):(jp(n,"innerBorderLeft innerBorderInlineStart"),l=e)}return l}}const Ex={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Sw(Ex,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const Mx=Ex;class Tx extends sR{constructor(t,e,n,o){super(t,e,n,o,mR)}}vw(Tx,Mx),vw(Tx,cR);const kx=Tx;function Ax(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Hx extends OR{constructor(t,e,n,o,i,r){super(t,e,mR,n,o),Ax(this,"topOverlay",void 0),Ax(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new kx(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){ym(t,`${this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)}px`,`${this.topOverlay.getOverlayOffset()}px`)}else Cm(t);let e=hm(this.clone.wtTable.TABLE);const n=am(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${n}px`,!1}}class Ix extends sR{constructor(t,e,n,o){super(t,e,n,o,gR)}}vw(Ix,Mx),vw(Ix,NR);const Ox=Ix;function _x(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Px extends OR{constructor(t,e,n,o){super(t,e,gR,n,o),_x(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Ox(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let o=0,i=!1;if(this.trimmingContainer!==e||n&&"vertical"===n)o=this.getScrollPosition(),Cm(t);else{const{wtTable:e}=this.wot,n=e.hider.getBoundingClientRect();i=Math.ceil(n.bottom)===t.offsetHeight,o=this.getOverlayOffset(),ym(t,"0px",`${o}px`)}const r=this.adjustHeaderBordersPosition(o,i);return this.adjustElementsSize(),r}setScrollPosition(t){const e=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Jp(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const n=this.wtSettings.getSetting("defaultRowHeight");let o=t,i=0;for(;o<e;){const t=this.wot.wtTable.getRowHeight(o);i+=void 0===t?n:t,o+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:n}=this.domBindings,o=wm(e),i=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===r){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=o),e=Math.min(e,t.wtRootElement.scrollWidth),i.width=`${e}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=hm(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(s=0),i.height=`${s}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(QR.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){const{wot:n,wtSettings:o}=this,i=(n.cloneSource?n.cloneSource:n).wtTable.holder,r=o.getSetting("columnHeaders"),s=0===o.getSetting("fixedRowsTop")&&r.length>0&&!Wp(i.parentNode,"innerBorderTop")?1:0;let l=this.getTableParentOffset(),a=0;if(e){this.wot.wtTable.getRowHeight(t)>this.wot.wtViewport.getViewportHeight()&&(e=!1)}if(e&&i.offsetHeight!==i.clientHeight&&(a=wm(this.domBindings.rootDocument)),e){const e=o.getSetting("fixedRowsBottom"),i=o.getSetting("totalRows");l+=this.sumCellSizes(0,t+1),l-=n.wtViewport.getViewportHeight()-this.sumCellSizes(i-e,i),l+=1,l+=s}else l+=this.sumCellSizes(o.getSetting("fixedRowsTop"),t);return l+=a,om(this.mainTableScrollableElement)===l-s&&s>0&&this.wot.wtOverlays.expandHiderVerticallyBy(s),this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return tm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>t&&(n=0)}return n}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:n}=this,o=this.wot.wtTable.holder.parentNode,i=n.getSetting("totalColumns"),r="horizontal"===n.getSetting("preventOverflow");i?jp(o,"emptyColumns"):Bp(o,"emptyColumns");let s=!1;if(!e&&!r){const e=n.getSetting("fixedRowsTop"),i=this.cachedFixedRowsTop!==e,r=n.getSetting("columnHeaders");if((i||0===e)&&r.length>0){const e=Wp(o,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),t||0===n.getSetting("totalRows")?(Bp(o,"innerBorderTop"),s=!e):(jp(o,"innerBorderTop"),s=e)}}return s}}function Nx(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Dx(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lx(t,e,n){return t.set(Fx(t,e),n),n}function Vx(t,e){return t.get(Fx(t,e))}function Fx(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wx=new WeakMap,Bx=new WeakMap,jx=new WeakMap,zx=new WeakMap;const Ux=class{constructor(t,e,n,o,i,r){Dx(this,"wot",null),Nx(this,Wx,[]),Dx(this,"topOverlay",null),Dx(this,"bottomOverlay",null),Dx(this,"inlineStartOverlay",null),Dx(this,"topInlineStartCornerOverlay",null),Dx(this,"bottomInlineStartCornerOverlay",null),Dx(this,"browserLineHeight",void 0),Dx(this,"wtSettings",null),Nx(this,Bx,!1),Nx(this,jx,0),Nx(this,zx,null),Dx(this,"resizeObserver",new ResizeObserver((t=>{Hw((()=>{Array.isArray(t)&&t.length&&(Lx(jx,this,Vx(jx,this)+1),100===Vx(jx,this)&&(Ub("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==Vx(zx,this)&&clearTimeout(Vx(zx,this)),Lx(zx,this,setTimeout((()=>{Lx(jx,this,0)}),100)),this.wtSettings.getSetting("onContainerElementResize"))}))}))),this.wot=t,this.wtSettings=o,this.domBindings=n,this.facadeGetter=e,this.wtTable=r;const{rootDocument:s,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=wm(s);const a="hidden"===l.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=a?r.holder:nm(r.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=[...Vx(Wx,this)];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){const{rootWindow:t,rootDocument:e}=this.domBindings,n=t.getComputedStyle(e.body),o=parseInt(n.lineHeight,10),i=1.2*parseInt(n.fontSize,10);this.browserLineHeight=o||i}initOverlays(){const t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Px(...t),this.bottomOverlay=new FR(...t),this.inlineStartOverlay=new xx(...t),this.topInlineStartCornerOverlay=new Hx(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new _R(...t,this.bottomOverlay,this.inlineStartOverlay),Lx(Wx,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Lx(Bx,this,Vx(Wx,this).reduce(((t,e)=>e.hasRenderingStateChanged()||t),!1)),Vx(Wx,this).forEach((t=>t.updateStateOfRendering("before")))}afterDraw(){this.syncScrollWithMaster(),Vx(Wx,this).forEach((t=>{const e=t.hasRenderingStateChanged();t.updateStateOfRendering("after"),e&&!t.needFullRender&&t.reset()}))}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:t,rootWindow:e}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",(t=>this.onKeyDown(t))),this.eventManager.addEventListener(t.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(t,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(n,"scroll",(t=>this.onTableScroll(t)),{passive:!0}),n!==o&&this.eventManager.addEventListener(o,"scroll",(t=>this.onTableScroll(t)),{passive:!0});const i=e.devicePixelRatio&&e.devicePixelRatio>1,r=this.scrollableElement===e,s=this.wtSettings.getSetting("preventWheel"),l={passive:r};(s||i||!jw())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(t=>this.onCloneWheel(t,s)),l);let a;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((t=>{if(t&&t.needFullRender){const{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",(t=>this.onCloneWheel(t,s)),l)}})),this.eventManager.addEventListener(e,"resize",(()=>{clearTimeout(a),a=setTimeout((()=>{this.wtSettings.getSetting("onWindowResize"),Lx(jx,this,0)}),200)})),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){const e=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=t.target;this.keyPressed&&(o!==e&&i!==e&&!t.target.contains(o)||n!==e&&i!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}onCloneWheel(t,e){const{rootWindow:n}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=t.target,s=i!==n&&r!==n&&!r.contains(i),l=o!==n&&r!==n&&!r.contains(o);if(this.keyPressed&&(s||l)||this.scrollableElement===n)return;const a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==n&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=rb(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(n+=n*this.browserLineHeight,e+=e*this.browserLineHeight);const o=this.scrollVertically(e),i=this.scrollHorizontally(n);return o||i}scrollVertically(t){const e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){const e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[o,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Vx(Bx,this))return;const t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:n}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Lx(Bx,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=nm(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){const t=this.wtTable.spreader,e=t.clientWidth,n=t.clientHeight,o=e!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=n),o}adjustElementsSize(){const{wtViewport:t}=this.wot,{wtTable:e}=this,{rootWindow:n}=this.domBindings,o=this.scrollableElement===n,i=this.wtSettings.getSetting("totalColumns"),r=this.wtSettings.getSetting("totalRows"),s=t.getRowHeaderWidth(),l=t.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,r)+1,a=s+this.inlineStartOverlay.sumCellSizes(0,i),h=e.hider.style,c=(()=>!o&&this.scrollableElement.scrollTop>Math.max(0,l-e.holder.clientHeight))()?1:0,u=(()=>!o&&this.scrollableElement.scrollLeft>Math.max(0,a-e.holder.clientWidth))()?1:0;if(h.width=`${a+u}px`,h.height=`${l+c}px`,this.scrollbarSize>0){const{scrollHeight:t,scrollWidth:n}=e.wtRootElement,{scrollHeight:o,scrollWidth:i}=e.holder;this.hasScrollbarRight=t<o,this.hasScrollbarBottom=n<i,this.hasScrollbarRight&&e.hider.scrollWidth+this.scrollbarSize>n?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&e.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(t){const{wtTable:e}=this;e.hider.style.height=`${parseInt(e.hider.style.height,10)+t}px`}expandHiderHorizontallyBy(t){const{wtTable:e}=this;e.hider.style.width=`${parseInt(e.hider.style.width,10)+t}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;const e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return jf(e,(e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)})),n}syncOverlayTableClassNames(){const t=this.wtTable.TABLE;jf([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(e=>{e&&(e.clone.wtTable.TABLE.className=t.className)}))}};function Yx(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class $x{constructor(t){Yx(this,"settings",{}),Yx(this,"defaults",Object.freeze(this.getDefaults())),Rw(this.defaults,((e,n)=>{if(void 0!==t[n])this.settings[n]=t[n];else{if(void 0===e)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=e}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,n)=>{const o=this.getSetting("data",t,e);Xp(n,null==o?"":o)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?Rw(t,((t,e)=>{this.settings[e]=t})):this.settings[t]=e,this}getSetting(t,e,n,o,i){return"function"==typeof this.settings[t]?this.settings[t](e,n,o,i):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class Gx extends sR{constructor(t,e,n,o){super(t,e,n,o,"master")}alignOverlaysWithTrimmingContainer(){const t=rm(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const n=t.parentElement,o=sm(t,"height",e),i=sm(t,"overflow",e),r=this.holder.style,{scrollWidth:s,scrollHeight:l}=t;let a=t.offsetWidth,h=t.offsetHeight;if(n&&["auto","hidden","scroll"].includes(i)){const o=t.cloneNode(!1);o.style.overflow="auto",o.style.position="absolute",t.nextElementSibling?n.insertBefore(o,t.nextElementSibling):n.appendChild(o);const i=parseInt(lm(o,e).height,10);n.removeChild(o),0===i&&(h=0)}h=Math.min(h,l),r.height="auto"===o?"auto":`${h}px`,a=Math.min(a,s),r.width=`${a}px`,r.overflow="",this.hasTableHeight="auto"===r.height||h>0,this.hasTableWidth=a>0}this.isTableVisible=qp(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,n="master",o=t.getSetting("columnHeaders").length;if(o&&!e.hasOversizedColumnHeadersMarked[n]){const i=t.getSetting("rowHeaders").length,r=this.getRenderedColumnsCount();for(let t=0;t<o;t++)for(let e=-1*i;e<r;e++)this.markIfOversizedColumnHeader(e);e.hasOversizedColumnHeadersMarked[n]=!0}}}vw(Gx,BR),vw(Gx,NR);const Kx=Gx;const Xx=class{constructor(t,e,n,o,i){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new AC:new IC],["fullyVisible",()=>new CC],["partiallyVisible",()=>new EC]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new TC:new HC],["fullyVisible",()=>new vC],["partiallyVisible",()=>new RC]]),this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;if(e===this.domBindings.rootWindow)n=t.documentElement.clientHeight;else{n=hm(e)>0&&e.clientHeight>0?e.clientHeight:1/0}return n}getWorkspaceWidth(){const{wtSettings:t}=this,{rootDocument:e,rootWindow:n}=this.domBindings,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=e.documentElement.offsetWidth,r=t.getSetting("totalColumns"),s=t.getSetting("preventOverflow"),l=t.getSetting("rtlMode"),a=this.wtTable.TABLE.getBoundingClientRect(),h=i-(l?a.right-i:a.left);let c,u;if(s)return am(this.wtTable.wtRootElement);if(c=t.getSetting("freezeOverlays")?Math.min(h,i):Math.min(this.getContainerFillWidth(),h,i),o===n&&r>0&&this.sumColumnWidths(0,r-1)>c)return e.documentElement.clientWidth;if(o!==n&&(u=sm(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),"scroll"===u||"hidden"===u||"auto"===u))return Math.max(c,o.clientWidth);const d=t.getSetting("stretchH");return"none"!==d&&d?c:Math.max(c,am(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let n=0,o=t;for(;o<e;)n+=this.wtTable.getColumnWidth(o),o+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);const n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}getWorkspaceOffset(){return Zp(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=hm(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;const e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){const t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let n=0,o=e.length;n<o;n++)this.rowHeaderWidth+=t[n]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,o=e.length;n<o;n++)t?(this.rowHeaderWidth+=am(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const t=this.getWorkspaceWidth();if(t===1/0)return t;const e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:e,wtTable:n}=this;let o,i,r=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=e.getSetting("fixedRowsTop"),a=e.getSetting("fixedRowsBottom"),h=e.getSetting("totalRows");return l&&s>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,l),s+=i,r-=i),a&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(h-a,h),r-=i),o=n.holder.clientHeight===n.holder.offsetHeight?0:wm(this.domBindings.rootDocument),new LC({calculationTypes:t.map((t=>[t,this.rowsCalculatorTypes.get(t)()])),viewportHeight:r,scrollOffset:s,totalRows:e.getSetting("totalRows"),rowHeightFn:t=>n.getRowHeight(t),overrideFn:e.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:e,wtTable:n}=this;let o=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const r=e.getSetting("fixedColumnsStart");if(r&&i>=0){const t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,r);i+=t,o-=t}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=wm(this.domBindings.rootDocument)),new NC({calculationTypes:t.map((t=>[t,this.columnsCalculatorTypes.get(t)()])),viewportWidth:o,scrollOffset:i,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>n.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,n=this.createRowsCalculator(),o=this.createColumnsCalculator();if(t&&!e.getSetting("renderAllRows")){const e=n.getResultsFor("fullyVisible");t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){const e=o.getResultsFor("fullyVisible");t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=o.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=o.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=o.getResultsFor("partiallyVisible"),t}createVisibleCalculators(){const t=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),e=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=t.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=e.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;let{startRow:e,endRow:n}=t;if(null===e&&null===n){if(!t.isVisibleInTrimmingContainer)return!0;e=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:o,endRow:i}=this.rowsRenderCalculator;return!(e<o||e===o&&e>0)&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:e,endColumn:n}=t;if(null===e&&null===n){if(!t.isVisibleInTrimmingContainer)return!0;e=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:o,endColumn:i}=this.columnsRenderCalculator;return!(e<o||e===o&&e>0)&&!(n>i||n===i&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Rw(this.hasOversizedColumnHeadersMarked,((t,e,n)=>{n[e]=void 0}))}};class qx extends kR{constructor(t,e){super(t,new $x(e));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Kx(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new Xx(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Sx(this.wtSettings.getSetting("selections")),this.wtEvent=new gS(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Ux(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t=[],e=[];Rw({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((n,o)=>{this.wtSettings.getSetting(o).length&&e.push(n),t.push(n)})),jp(this.wtTable.wtRootElement.parentNode,t),Bp(this.wtTable.wtRootElement.parentNode,e)}getOverlayByName(t){var e;if(!bR.includes(t))return null;const n=t.replace(/_([a-z])/g,(t=>t[1].toUpperCase()));return null!==(e=this.wtOverlays[`${n}Overlay`])&&void 0!==e?e:null}getViewportDao(){const t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class Zx{constructor(t){t instanceof kR?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{const e=new Zx(t);return()=>e},this._wot=new qx(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,n){return this._wot.createCellRange(t,e,n)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,n,o,i){return this._wot.scrollViewport(t,e,n,o,i)}scrollViewportHorizontally(t,e,n){return this._wot.scrollViewportHorizontally(t,e,n)}scrollViewportVertically(t,e,n){return this._wot.scrollViewportVertically(t,e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(t){return this._wot.getOverlayByName(t)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,n,o,i){return this._wot.wtSettings.getSetting(t,e,n,o,i)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function Qx(t){let{isShiftKey:e,isLeftClick:n,isRightClick:o,coords:i,selection:r,controller:s,cellCoordsFactory:l}=t;const a=r.isSelected()?r.getSelectedRange().current():null,h=r.isSelectedByCorner(),c=r.isSelectedByRowHeader();if(r.markSource("mouse"),e&&a)i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(i):(h||c)&&i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(l(i.row,i.col)):h&&i.row<0&&!s.column?r.setRangeEnd(l(a.to.row,i.col)):c&&i.col<0&&!s.row?r.setRangeEnd(l(i.row,a.to.col)):(!h&&!c&&i.col<0||h&&i.col<0)&&!s.row?r.selectRows(Math.max(a.from.row,0),i.row,i.col):(!h&&!c&&i.row<0||c&&i.row<0)&&!s.column&&r.selectColumns(Math.max(a.from.col,0),i.col,i.row);else{const t=!r.inInSelection(i),e=n||o&&t;i.row<0&&i.col>=0&&!s.column?e&&r.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?e&&r.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?e&&r.setRangeStart(i):i.col<0&&i.row<0&&r.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}r.markEndSource()}const Jx=new Map([["mousedown",Qx],["mouseover",function(t){let{isLeftClick:e,coords:n,selection:o,controller:i,cellCoordsFactory:r}=t;if(!e)return;const s=o.isSelectedByRowHeader(),l=o.isSelectedByColumnHeader(),a=o.tableProps.countCols(),h=o.tableProps.countRows();o.markSource("mouse"),l&&!i.column?o.setRangeEnd(r(h-1,n.col)):s&&!i.row?o.setRangeEnd(r(n.row,a-1)):i.cell||o.setRangeEnd(n),o.markEndSource()}],["touchstart",Qx]]);function tE(t,e){let{coords:n,selection:o,controller:i,cellCoordsFactory:r}=e;Jx.get(t.type)({coords:n,selection:o,controller:i,cellCoordsFactory:r,isShiftKey:t.shiftKey,isLeftClick:cb(t)||"touchstart"===t.type,isRightClick:hb(t)})}const eE=new WeakMap,nE=Symbol("rootInstance");function oE(t){return t===nE}function iE(t){return eE.has(t)}function rE(t,e,n){sE(t,e),e.set(t,n)}function sE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aE(t,e){return t.get(cE(t,e))}function hE(t,e,n){return t.set(cE(t,e),n),n}function cE(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uE=new WeakMap,dE=new WeakMap,gE=new WeakMap,fE=new WeakMap,pE=new WeakMap,mE=new WeakMap,wE=new WeakMap,bE=new WeakSet;function vE(){return parseInt(this.hot.rootElement.getAttribute(Sp()[0]),10)}function yE(t){const e=cE(bE,this,vE).call(this)+t;zp(this.hot.rootElement,...Sp(e))}const CE=class{constructor(t){var e,n;sE(e=this,n=bE),n.add(e),lE(this,"hot",void 0),lE(this,"eventManager",void 0),lE(this,"settings",void 0),lE(this,"THEAD",void 0),lE(this,"TBODY",void 0),lE(this,"_wt",void 0),lE(this,"activeWt",void 0),rE(this,uE,0),rE(this,dE,0),lE(this,"postponedAdjustElementsSize",!1),rE(this,gE,!1),rE(this,fE,void 0),rE(this,pE,void 0),rE(this,mE,0),rE(this,wE,0),this.hot=t,this.eventManager=new pv(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(t,e){const n=this._wt.getCell(t,e);return n<0?null:n}scrollViewport(t,e,n,o,i){return this._wt.scrollViewport(t,e,n,o,i)}scrollViewportHorizontally(t,e,n){return this._wt.scrollViewportHorizontally(t,e,n)}scrollViewportVertically(t,e,n){return this._wt.scrollViewportVertically(t,e,n)}createElements(){const{rootElement:t,rootDocument:e}=this.hot,n=t.getAttribute("style");n&&t.setAttribute("data-originalstyle",n),Bp(t,"handsontable"),hE(pE,this,e.createElement("TABLE")),Bp(aE(pE,this),"htCore"),this.hot.getSettings().tableClassName&&Bp(aE(pE,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(zp(aE(pE,this),[["role","presentation"]]),zp(t,[["role","treegrid"],Cp(-1),Sp(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=e.createElement("THEAD"),aE(pE,this).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),aE(pE,this).appendChild(this.TBODY),this.hot.table=aE(pE,this),this.hot.container.insertBefore(aE(pE,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:t,rootDocument:e,selection:n,rootWindow:o}=this.hot,i=e.documentElement;this.eventManager.addEventListener(t,"mousedown",(t=>{hE(gE,this,!0),this.isTextSelectionAllowed(t.target)||(fm(o),t.preventDefault(),o.focus())})),this.eventManager.addEventListener(t,"mouseup",(()=>{hE(gE,this,!1)})),this.eventManager.addEventListener(t,"mousemove",(t=>{aE(gE,this)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&fm(o),t.preventDefault())})),this.eventManager.addEventListener(i,"keyup",(t=>{n.isInProgress()&&!t.shiftKey&&n.finish()})),this.eventManager.addEventListener(i,"mouseup",(o=>{n.isInProgress()&&cb(o)&&n.finish(),hE(fE,this,!1);const i=Rm(e.activeElement);Sm(e.activeElement)&&!i||!i&&(n.isSelected()||n.isSelectedByAnyHeader()||t.contains(o.target)||hb(o))||this.hot.unlisten()})),this.eventManager.addEventListener(i,"contextmenu",(t=>{n.isInProgress()&&hb(t)&&(n.finish(),hE(fE,this,!1))})),this.eventManager.addEventListener(i,"touchend",(()=>{n.isInProgress()&&n.finish(),hE(fE,this,!1)})),this.eventManager.addEventListener(i,"mousedown",(n=>{const o=n.target,r=n.x||n.clientX,s=n.y||n.clientY;let l=n.target;if(aE(fE,this)||!t||!this.hot.view)return;const{holder:a}=this._wt.wtTable;if(l===a){const t=wm(e);if(e.elementFromPoint(r+t,s)!==a||e.elementFromPoint(r,s+t)!==a)return}else for(;l!==i;){if(null===l){if(n.isTargetWebComponent)break;return}if(l===t)return;l=l.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(o):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}));let r=Op(o);for(;null!==r;)this.eventManager.addEventListener(r.document.documentElement,"click",(()=>{this.hot.unlisten()})),r=Op(r);this.eventManager.addEventListener(aE(pE,this),"selectstart",(t=>{this.settings.fragmentSelection||Sm(t.target)||t.preventDefault()}))}translateFromRenderableToVisualCoords(t){let{row:e,col:n}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,n))}translateFromRenderableToVisualIndex(t,e){let n=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,o=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===n&&(n=t),null===o&&(o=e),[n,o]}countRenderableIndexes(t,e){const n=Math.min(t.getNotTrimmedIndexesLength(),e),o=t.getNearestNotHiddenIndex(n-1,-1);return null===o?0:t.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,n,o){if(isNaN(t)||t<0)return 0;const i=n.getNearestNotHiddenIndex(t,e),r=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(r))return 0;let s=0;return e<0?s=r+1:e>0&&(s=o-r),s}countNotHiddenFixedColumnsStart(){const t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){const t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){const t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let n=0;for(let o=t;o<=e;o++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(o)&&(n+=1);return n}countRenderableRowsInRange(t,e){let n=0;for(let o=t;o<=e;o++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(o)&&(n+=1);return n}isMainTableNotFullyCoveredByOverlays(){const t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){const t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:aE(pE,this),isDataViewInstance:()=>iE(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const t=[];return this.hot.hasRowHeaders()&&t.push(((t,e)=>{const n=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(n,e)})),this.hot.runHooks("afterGetRowHeaderRenderers",t),hE(dE,this,t.length),this.hot.getSettings().ariaTags&&cE(bE,this,vE).call(this)===this.hot.countCols()&&cE(bE,this,yE).call(this,aE(dE,this)),t},columnHeaders:()=>{const t=[];return this.hot.hasColHeaders()&&t.push(((t,e)=>{const n=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(n,e)})),this.hot.runHooks("afterGetColumnHeaderRenderers",t),hE(uE,this,t.length),t},columnWidth:t=>{const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{const e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},rowHeightByOverlayName:(t,e)=>{const n=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t),o=null===n?t:n;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(o),o,e)},cellRenderer:(t,e,n)=>{const[o,i]=this.translateFromRenderableToVisualIndex(t,e),r=this.hot.runHooks("modifyGetCellCoords",o,i);let s=o,l=i;Array.isArray(r)&&([s,l]=r);const a=this.hot.getCellMeta(s,l),h=this.hot.colToProp(l);let c=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(c=this.hot.runHooks("beforeValueRender",c,a)),this.hot.runHooks("beforeRenderer",n,o,i,h,c,a),this.hot.getCellRenderer(a)(this.hot,n,o,i,h,c,a),this.hot.runHooks("afterRenderer",n,o,i,h,c,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&qp(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=o,hE(fE,this,!0),this.hot.runHooks("beforeOnCellMouseDown",t,i,n,r),ab(t)||(tE(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,i,n),this.activeWt=this._wt)},onCellContextMenu:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=o,hE(fE,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,i,n),ab(t)||(this.hot.runHooks("afterOnCellContextMenu",t,i,n),this.activeWt=this._wt)},onCellMouseOut:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=o,this.hot.runHooks("beforeOnCellMouseOut",t,i,n),ab(t)||(this.hot.runHooks("afterOnCellMouseOut",t,i,n),this.activeWt=this._wt)},onCellMouseOver:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.activeWt=o,this.hot.runHooks("beforeOnCellMouseOver",t,i,n,r),ab(t)||(aE(fE,this)&&tE(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,i,n),this.activeWt=this._wt)},onCellMouseUp:(t,e,n,o)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=o,this.hot.runHooks("beforeOnCellMouseUp",t,i,n),ab(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,i,n),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{const e=this.hot.rowIndexMapper,n=t<0;let o=t;return n||(o=e.getVisualFromRenderableIndex(t),null!==o)?(o=this.hot.runHooks("beforeViewportScrollVertically",o),this.hot.runHooks("beforeViewportScroll"),n?o:e.getRenderableFromVisualIndex(o)):t},onBeforeViewportScrollHorizontally:t=>{const e=this.hot.columnIndexMapper,n=t<0;let o=t;return n||(o=e.getVisualFromRenderableIndex(t),null!==o)?(o=this.hot.runHooks("beforeViewportScrollHorizontally",o),this.hot.runHooks("beforeViewportScroll"),n?o:e.getRenderableFromVisualIndex(o)):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,n)=>{const o=this.hot.rowIndexMapper,i=t<0;let r=t;i||(r=o.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingRowHeader",r,e,n);return i?s:o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,n)=>{const o=this.hot.columnIndexMapper,i=t<0;let r=t;i||(r=o.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingColumnHeader",r,e,n);return i?s:o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,n)=>{let o;const[i,r]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange();if(s.size()>0){const t=s.peekByIndex(null!=n?n:0);o=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",i,r,o,n)},onBeforeDrawBorders:(t,e)=>{const[n,o,i,r]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{const n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,n)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,n)=>{const o=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,r=e>=0?i.getVisualFromRenderableIndex(e):e,s=t>=0?o.getVisualFromRenderableIndex(t):t,l=this.hot.runHooks("modifyGetCellCoords",s,r,n);if(Array.isArray(l)){const[t,e,n,r]=l;return[t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t,e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,n>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1)):n,r>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1)):r]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){const n=this.countRenderableRows(),o=t.startRow,i=t.endRow;if("number"==typeof e)t.startRow=Math.max(o-e,0),t.endRow=Math.min(i+e,n-1);else if("auto"===e){const e=Math.ceil(i/n*12);t.startRow=Math.max(o-e,0),t.endRow=Math.min(i+e,n-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){const n=this.countRenderableColumns(),o=t.startColumn,i=t.endColumn;if("number"==typeof e&&(t.startColumn=Math.max(o-e,0),t.endColumn=Math.min(i+e,n-1)),"auto"===e){const e=Math.ceil(i/n*6);t.startColumn=Math.max(o-e,0),t.endColumn=Math.min(i+e,n-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new Zx(t),this.activeWt=this._wt;const e=this._wt.wtTable.spreader,{width:n,height:o}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,o),this.eventManager.addEventListener(e,"mousedown",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(e,"contextmenu",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(t){if(Sm(t))return!0;const e=Np(t,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return aE(fE,this)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){const t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){const n=e.firstChild;if(!Wp(n,"relative"))return $p(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:o}=this.hot,i=n.createElement("div"),r=n.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,t,o),i.appendChild(r),e.appendChild(i)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=()=>{const e=t>=0?this.hot.getColumnMeta(t).headerClassName:null;return e?e.split(" "):[]};if(e.firstChild){const r=e.firstChild;Wp(r,"relative")?(this.updateCellHeader(r.querySelector(".colHeader"),t,n,o),r.className="",Bp(r,["relative",...i()])):($p(e),this.appendColHeader(t,e,n,o))}else{const{rootDocument:r}=this.hot,s=r.createElement("div"),l=r.createElement("span"),a=i();s.classList.add("relative",...a),l.className="colHeader",this.settings.ariaTags&&(zp(s,"role","presentation"),zp(l,"role","presentation")),this.updateCellHeader(l,t,n,o),s.appendChild(l),e.appendChild(s)}this.hot.runHooks("afterGetColHeader",t,e,o)}updateCellHeader(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e;const r=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(Wp(t,"colHeader")?i=r.wtTable.columnFilter.sourceToRendered(e):Wp(t,"rowHeader")&&(i=r.wtTable.rowFilter.sourceToRendered(e))),i>-1?Kp(t,n(e,o)):(Xp(t,String.fromCharCode(160)),Bp(t,"cornerHeader"))}maximumVisibleElementWidth(t){const e=this._wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}maximumVisibleElementHeight(t){const e=this._wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}setLastSize(t,e){hE(mE,this,t),hE(wE,this,e)}getLastSize(){return{width:aE(mE,this),height:aE(wE,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return aE(uE,this)}getRowHeadersCount(){return aE(dE,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(t){var e;return(null!==(e=this._wt.wtOverlays.getParentOverlay(t))&&void 0!==e?e:this._wt).wtTable.name}getOverlayByName(t){return this._wt.getOverlayByName(t)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}},SE="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function RE(t){let e,n=t+1,o="";for(;n>0;)e=(n-1)%26,o=String.fromCharCode(65+e)+o,n=parseInt((n-e)/26,10);return o}function xE(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;const o=[];return Array.isArray(t)&&Array.isArray(t[0])||(n=[t]),n.forEach(((t,n)=>{Array.isArray(t)?t.forEach(((t,i)=>{o.push([n+e,i,t])})):Object.keys(t).forEach((i=>{o.push([n+e,i,t[i]])}))})),o}function EE(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Cw(t[0])&&(e=Mw(t[0]))),e}function ME(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>Array.isArray(t))))}function TE(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>"object"==typeof t&&!Array.isArray(t)&&null!==t)))}const kE=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:EE,createEmptySpreadsheetData:function(t,e){const n=[];let o;for(let i=0;i<t;i++){o=[];for(let t=0;t<e;t++)o.push("");n.push(o)}return n},createSpreadsheetData:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let o,i;for(o=0;o<t;o++){const t=[];for(i=0;i<e;i++)t.push(RE(i)+(o+1));n.push(t)}return n},createSpreadsheetObjectData:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let o,i;for(o=0;o<t;o++){const t={};for(i=0;i<e;i++)t[`prop${i}`]=RE(i)+(o+1);n.push(t)}return n},dataRowToChangesArray:xE,isArrayOfArrays:ME,isArrayOfObjects:TE,spreadsheetColumnIndex:function(t){let e=0;if(t)for(let n=0,o=t.length-1;n<t.length;n+=1,o-=1)e+=Math.pow(26,o)*(SE.indexOf(t[n])+1);return e-=1,e},spreadsheetColumnLabel:RE},Symbol.toStringTag,{value:"Module"}));function AE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const HE=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];AE(this,"hot",void 0),AE(this,"data",void 0),AE(this,"dataType","array"),AE(this,"colToProp",(()=>{})),AE(this,"propToCol",(()=>{})),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){const e=[];return jf(this.data,((n,o)=>{const i=this.getAtCell(o,t);e.push(i)})),e}getAtRow(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===e&&void 0===n,{dataDotNotation:r}=this.hot.getSettings();let s=null,l=null;if(s=this.modifyRowData(t),Array.isArray(s))l=[],i?s.forEach(((e,n)=>{l[n]=this.getAtPhysicalCell(t,n,s)})):Ay(e,n,(n=>{l[n-e]=this.getAtPhysicalCell(t,n,s)}));else if(Cw(s)||Hm(s))if(l=o?[]:{},!i||o){const i=0,a=this.countFirstRowKeys()-1;Ay(i,a,(h=>{const c=this.colToProp(h);if(h>=(e||i)&&h<=(n||a)&&!Number.isInteger(c)){const e=this.getAtPhysicalCell(t,c,s);o?l.push(e):r?Ew(l,c,e):l[c]=e}}))}else Rw(s,((e,n)=>{const o=this.getAtPhysicalCell(t,n,s);r?Ew(l,n,o):l[n]=o}));return l}setAtCell(t,e,n){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=Tw(n);this.hot.runHooks("modifySourceData",t,e,o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(e)?this.data[t][e]=n:Ew(this.data[t],e,n)}}getAtPhysicalCell(t,e,n){let o=null;if(n)if("string"==typeof e){const{dataDotNotation:t}=this.hot.getSettings();o=t?xw(n,e):n[e]}else o="function"==typeof e?e(n):n[e];if(this.hot.hasHook("modifySourceData")){const n=Tw(o);this.hot.runHooks("modifySourceData",t,e,n,"get"),n.isTouched()&&(o=n.value)}return o}getAtCell(t,e){const n=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),n)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,r=null,s=null,l=null;null===t||null===e?(o=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,e.row),r=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col));const a=[];return Ay(i,s,(t=>{a.push(o?this.getAtRow(t,void 0,void 0,n):this.getAtRow(t,r,l,n))})),a}countRows(){if(this.hot.hasHook("modifySourceLength")){const t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return EE(this.data)}destroy(){this.data=null,this.hot=null}};function IE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class OE{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;IE(this,"indexedValues",[]),IE(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){const e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Hm(this.initValueOrFn)?Ay(t-1,(t=>this.indexedValues.push(this.initValueOrFn(t)))):Ay(t-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function _E(t,e,n,o){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map(((t,e)=>Hm(o)?o(t,e):o)),...void 0===i?[]:t.slice(i)]}function PE(t,e){return Wf(t,((t,n)=>!1===e.includes(n)))}vw(OE,YR);class NE extends OE{insert(t,e){this.indexedValues=_E(this.indexedValues,0,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=PE(this.indexedValues,t),super.remove(t)}}class DE extends NE{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return Ff(this.getValues(),((t,e,n)=>(e&&t.push(n),t)),[])}}function LE(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function VE(t,e){return Wf(t,(t=>!1===e.includes(t)))}function FE(t,e){return Bf(t,(t=>t-e.filter((e=>e<t)).length))}function WE(t,e){const n=e[0],o=e.length;return Bf(t,(t=>t>=n?t+o:t))}function BE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class jE extends OE{constructor(){super(...arguments),BE(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((t=>this.indexedValues[t]))}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(n,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=VE(this.orderOfIndexes,[t]),Hm(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=_E(this.indexedValues,0,e,this.initValueOrFn),this.orderOfIndexes=WE(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=PE(this.indexedValues,t),this.orderOfIndexes=VE(this.orderOfIndexes,t),this.orderOfIndexes=FE(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map((t=>[t,this.getValueAtIndex(t)]))}}class zE extends NE{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return Ff(this.getValues(),((t,e,n)=>(e&&t.push(n),t)),[])}}const UE=new Map([["indexesSequence",{getListWithInsertedItems:LE,getListWithRemovedItems:VE}],["physicallyIndexed",{getListWithInsertedItems:_E,getListWithRemovedItems:PE}]]),YE=t=>{if(!1===UE.has(t))throw new Error(`Alter strategy with ID '${t}' does not exist.`);return UE.get(t)};class $E extends OE{constructor(){super((t=>t))}insert(t,e){const n=WE(this.indexedValues,e);this.indexedValues=LE(n,t,e),super.insert(t,e)}remove(t){const e=VE(this.indexedValues,t);this.indexedValues=FE(e,t),super.remove(t)}}const GE=new Map([["hiding",DE],["index",OE],["linkedPhysicalIndexToValue",jE],["physicalIndexToValue",NE],["trimming",zE]]);function KE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}let XE=0;class qE{constructor(){KE(this,"collection",new Map)}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(()=>this.runLocalHooks("change",e))),XE+=1)}unregister(t){const e=this.collection.get(t);qf(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),XE-=1)}unregisterAll(){this.collection.forEach(((t,e)=>this.unregister(e))),this.collection.clear()}get(t){return Zf(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach((e=>{e.remove(t)}))}insertToEvery(t,e){this.collection.forEach((n=>{n.insert(t,e)}))}initEvery(t){this.collection.forEach((e=>{e.init(t)}))}}function ZE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}vw(qE,YR);class QE extends qE{constructor(t,e){super(),ZE(this,"mergedValuesCache",[]),ZE(this,"aggregationFunction",void 0),ZE(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const t=Bf(this.get(),(t=>t.getValues())),e=[],n=qf(t[0])&&t[0].length||0;for(let o=0;o<n;o+=1){const n=[];for(let e=0;e<this.getLength();e+=1)n.push(t[e][o]);e.push(n)}return Bf(e,this.aggregationFunction)}getMergedValueAtIndex(t,e){const n=this.getMergedValues(e)[t];return qf(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function JE(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function tM(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eM=new WeakMap;class nM{constructor(){JE(this,eM,[])}subscribe(t){var e,n;return this.addLocalHook("change",t),this._write((n=this,(e=eM).get(tM(e,n)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){var e,n,o;n=this,o=t,(e=eM).set(tM(e,n),o)}}function oM(t,e){const n=[];let o=0,i=0;for(;o<t.length&&i<e.length;o++,i++)t[o]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[o],newValue:e[i]});for(;o<e.length;o++)n.push({op:"insert",index:o,oldValue:void 0,newValue:e[o]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function iM(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function rM(t,e){return t.get(lM(t,e))}function sM(t,e,n){return t.set(lM(t,e),n),n}function lM(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}vw(nM,YR);var aM=new WeakMap,hM=new WeakMap,cM=new WeakMap,uM=new WeakMap,dM=new WeakMap;class gM{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};iM(this,aM,new Set),iM(this,hM,[]),iM(this,cM,[]),iM(this,uM,!1),iM(this,dM,!1),sM(dM,this,null!=t&&t)}createObserver(){const t=new nM;return rM(aM,this).add(t),t.addLocalHook("unsubscribe",(()=>{rM(aM,this).delete(t)})),t._writeInitialChanges(oM(rM(hM,this),rM(cM,this))),t}emit(t){let e=rM(cM,this);rM(uM,this)&&rM(hM,this).length===t.length||(0===t.length?t=new Array(e.length).fill(rM(dM,this)):sM(hM,this,new Array(t.length).fill(rM(dM,this))),rM(uM,this)||(sM(uM,this,!0),e=rM(hM,this)));const n=oM(e,t);rM(aM,this).forEach((t=>t._write(n))),sM(cM,this,t)}}function fM(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class pM{constructor(){fM(this,"indexesSequence",new $E),fM(this,"trimmingMapsCollection",new QE((t=>t.some((t=>!0===t))),!1)),fM(this,"hidingMapsCollection",new QE((t=>t.some((t=>!0===t))),!1)),fM(this,"variousMapsCollection",new qE),fM(this,"hidingChangesObservable",new gM({initialIndexValue:!1})),fM(this,"notTrimmedIndexesCache",[]),fM(this,"notHiddenIndexesCache",[]),fM(this,"isBatched",!1),fM(this,"indexesSequenceChanged",!1),fM(this,"indexesChangeSource",void 0),fM(this,"trimmedIndexesChanged",!1),fM(this,"hiddenIndexesChanged",!1),fM(this,"renderablePhysicalIndexesCache",[]),fM(this,"fromPhysicalToVisualIndexesCache",new Map),fM(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(t=>{this.runLocalHooks("change",t,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw new Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,n){return this.registerMap(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!GE.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(GE.get(t))(e)}(e,n))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof zE?this.trimmingMapsCollection.register(t,e):e instanceof DE?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);const n=this.getNumberOfIndexes();return n>0&&e.init(n),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){const e=this.notTrimmedIndexesCache[t];return qf(e)?e:null}getPhysicalFromRenderableIndex(t){const e=this.renderablePhysicalIndexesCache[t];return qf(e)?e:null}getVisualFromPhysicalIndex(t){const e=this.fromPhysicalToVisualIndexesCache.get(t);return qf(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){const e=this.fromVisualToRenderableIndexesCache.get(t);return qf(e)?e:null}getNearestNotHiddenIndex(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=e>0?o.findIndex((e=>e>t)):o.reverse().findIndex((e=>e<t)),-1===i?n?this.getNearestNotHiddenIndex(t,-e,!1):null:o[i]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(t).keys()],this.notHiddenIndexesCache=[...new Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){const e=this.getNumberOfIndexes();if(t<e){const e=[...Array(this.getNumberOfIndexes()-t).keys()].map((e=>e+t));this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter((t=>!1===this.isTrimmed(t)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter((t=>!1===this.isHidden(t)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter((t=>!1===this.isHidden(t)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"==typeof t&&(t=[t]);const n=Bf(t,(t=>this.getPhysicalFromVisualIndex(t))),o=this.getNotTrimmedIndexesLength(),i=t.length,r=VE(this.getIndexesSequence(),n),s=r.filter((t=>!1===this.isTrimmed(t)));let l=r.indexOf(s[s.length-1])+1;if(e+i<o){const t=s[e];l=r.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(LE(r,l,n)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){const n=this.getNotTrimmedIndexes()[t],o=qf(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),r=Bf(new Array(e).fill(o),((t,e)=>t+e));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,r),this.hidingMapsCollection.insertToEvery(i,r),this.variousMapsCollection.insertToEvery(i,r),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){const t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromRenderableIndex(e),n=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(n,e)}}}function mM(t){const e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?`${e[1].toLowerCase()}-${e[2].toUpperCase()}`:t}function wM(t){qf(t)&&Yb(Kf(C||(C=j`Language with code "${0}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`),t))}vw(pM,YR);const{register:bM,getValues:vM}=nv("phraseFormatters");bM("pluralize",(function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}));const yM="ContextMenu:items",CM=`${yM}.noItems`,SM=`${yM}.insertRowAbove`,RM=`${yM}.insertRowBelow`,xM=`${yM}.insertColumnOnTheLeft`,EM=`${yM}.insertColumnOnTheRight`,MM=`${yM}.removeRow`,TM=`${yM}.removeColumn`,kM=`${yM}.undo`,AM=`${yM}.redo`,HM=`${yM}.readOnly`,IM=`${yM}.clearColumn`,OM=`${yM}.copy`,_M=`${yM}.copyWithHeaders`,PM=`${yM}.copyWithGroupHeaders`,NM=`${yM}.copyHeadersOnly`,DM=`${yM}.cut`,LM=`${yM}.freezeColumn`,VM=`${yM}.unfreezeColumn`,FM=`${yM}.mergeCells`,WM=`${yM}.unmergeCells`,BM=`${yM}.addComment`,jM=`${yM}.editComment`,zM=`${yM}.removeComment`,UM=`${yM}.readOnlyComment`,YM=`${yM}.align`,$M=`${yM}.align.left`,GM=`${yM}.align.center`,KM=`${yM}.align.right`,XM=`${yM}.align.justify`,qM=`${yM}.align.top`,ZM=`${yM}.align.middle`,QM=`${yM}.align.bottom`,JM=`${yM}.borders`,tT=`${yM}.borders.top`,eT=`${yM}.borders.right`,nT=`${yM}.borders.bottom`,oT=`${yM}.borders.left`,iT=`${yM}.borders.remove`,rT=`${yM}.nestedHeaders.insertChildRow`,sT=`${yM}.nestedHeaders.detachFromParent`,lT=`${yM}.hideColumn`,aT=`${yM}.showColumn`,hT=`${yM}.hideRow`,cT=`${yM}.showRow`,uT="Filters:",dT=`${uT}conditions`,gT=`${dT}.none`,fT=`${dT}.isEmpty`,pT=`${dT}.isNotEmpty`,mT=`${dT}.isEqualTo`,wT=`${dT}.isNotEqualTo`,bT=`${dT}.beginsWith`,vT=`${dT}.endsWith`,yT=`${dT}.contains`,CT=`${dT}.doesNotContain`,ST=`${dT}.byValue`,RT=`${dT}.greaterThan`,xT=`${dT}.greaterThanOrEqualTo`,ET=`${dT}.lessThan`,MT=`${dT}.lessThanOrEqualTo`,TT=`${dT}.isBetween`,kT=`${dT}.isNotBetween`,AT=`${dT}.after`,HT=`${dT}.before`,IT=`${dT}.today`,OT=`${dT}.tomorrow`,_T=`${dT}.yesterday`,PT=`${uT}labels.filterByCondition`,NT=`${uT}labels.filterByValue`,DT=`${uT}labels.conjunction`,LT=`${uT}labels.disjunction`,VT=`${uT}values.blankCells`,FT=`${uT}buttons.selectAll`,WT=`${uT}buttons.clear`,BT=`${uT}buttons.ok`,jT=`${uT}buttons.cancel`,zT=`${uT}buttons.placeholder.search`,UT=`${uT}buttons.placeholder.value`,YT=`${uT}buttons.placeholder.secondValue`,$T="CheckboxRenderer:",GT=`${$T}checked`,KT=`${$T}unchecked`,XT=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:GT,CHECKBOX_RENDERER_NAMESPACE:$T,CHECKBOX_UNCHECKED:KT,CONTEXTMENU_ITEMS_ADD_COMMENT:BM,CONTEXTMENU_ITEMS_ALIGNMENT:YM,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:QM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:GM,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:XM,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:$M,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:ZM,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:KM,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:qM,CONTEXTMENU_ITEMS_BORDERS:JM,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:nT,CONTEXTMENU_ITEMS_BORDERS_LEFT:oT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:eT,CONTEXTMENU_ITEMS_BORDERS_TOP:tT,CONTEXTMENU_ITEMS_CLEAR_COLUMN:IM,CONTEXTMENU_ITEMS_COPY:OM,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:NM,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:PM,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:_M,CONTEXTMENU_ITEMS_CUT:DM,CONTEXTMENU_ITEMS_EDIT_COMMENT:jM,CONTEXTMENU_ITEMS_FREEZE_COLUMN:LM,CONTEXTMENU_ITEMS_HIDE_COLUMN:lT,CONTEXTMENU_ITEMS_HIDE_ROW:hT,CONTEXTMENU_ITEMS_INSERT_LEFT:xM,CONTEXTMENU_ITEMS_INSERT_RIGHT:EM,CONTEXTMENU_ITEMS_MERGE_CELLS:FM,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:sT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:rT,CONTEXTMENU_ITEMS_NO_ITEMS:CM,CONTEXTMENU_ITEMS_READ_ONLY:HM,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:UM,CONTEXTMENU_ITEMS_REDO:AM,CONTEXTMENU_ITEMS_REMOVE_BORDERS:iT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:TM,CONTEXTMENU_ITEMS_REMOVE_COMMENT:zM,CONTEXTMENU_ITEMS_REMOVE_ROW:MM,CONTEXTMENU_ITEMS_ROW_ABOVE:SM,CONTEXTMENU_ITEMS_ROW_BELOW:RM,CONTEXTMENU_ITEMS_SHOW_COLUMN:aT,CONTEXTMENU_ITEMS_SHOW_ROW:cT,CONTEXTMENU_ITEMS_UNDO:kM,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:VM,CONTEXTMENU_ITEMS_UNMERGE_CELLS:WM,CONTEXT_MENU_ITEMS_NAMESPACE:yM,FILTERS_BUTTONS_CANCEL:jT,FILTERS_BUTTONS_CLEAR:WT,FILTERS_BUTTONS_OK:BT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:zT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:YT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:UT,FILTERS_BUTTONS_SELECT_ALL:FT,FILTERS_CONDITIONS_AFTER:AT,FILTERS_CONDITIONS_BEFORE:HT,FILTERS_CONDITIONS_BEGINS_WITH:bT,FILTERS_CONDITIONS_BETWEEN:TT,FILTERS_CONDITIONS_BY_VALUE:ST,FILTERS_CONDITIONS_CONTAINS:yT,FILTERS_CONDITIONS_EMPTY:fT,FILTERS_CONDITIONS_ENDS_WITH:vT,FILTERS_CONDITIONS_EQUAL:mT,FILTERS_CONDITIONS_GREATER_THAN:RT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:xT,FILTERS_CONDITIONS_LESS_THAN:ET,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:MT,FILTERS_CONDITIONS_NAMESPACE:dT,FILTERS_CONDITIONS_NONE:gT,FILTERS_CONDITIONS_NOT_BETWEEN:kT,FILTERS_CONDITIONS_NOT_CONTAIN:CT,FILTERS_CONDITIONS_NOT_EMPTY:pT,FILTERS_CONDITIONS_NOT_EQUAL:wT,FILTERS_CONDITIONS_TODAY:IT,FILTERS_CONDITIONS_TOMORROW:OT,FILTERS_CONDITIONS_YESTERDAY:_T,FILTERS_DIVS_FILTER_BY_CONDITION:PT,FILTERS_DIVS_FILTER_BY_VALUE:NT,FILTERS_LABELS_CONJUNCTION:DT,FILTERS_LABELS_DISJUNCTION:LT,FILTERS_NAMESPACE:uT,FILTERS_VALUES_BLANK_CELLS:VT},Symbol.toStringTag,{value:"Module"})),qT={languageCode:"en-US",[CM]:"No available options",[SM]:"Insert row above",[RM]:"Insert row below",[xM]:"Insert column left",[EM]:"Insert column right",[MM]:["Remove row","Remove rows"],[TM]:["Remove column","Remove columns"],[kM]:"Undo",[AM]:"Redo",[HM]:"Read only",[IM]:"Clear column",[YM]:"Alignment",[$M]:"Left",[GM]:"Center",[KM]:"Right",[XM]:"Justify",[qM]:"Top",[ZM]:"Middle",[QM]:"Bottom",[LM]:"Freeze column",[VM]:"Unfreeze column",[JM]:"Borders",[tT]:"Top",[eT]:"Right",[nT]:"Bottom",[oT]:"Left",[iT]:"Remove border(s)",[BM]:"Add comment",[jM]:"Edit comment",[zM]:"Delete comment",[UM]:"Read-only comment",[FM]:"Merge cells",[WM]:"Unmerge cells",[OM]:"Copy",[_M]:["Copy with header","Copy with headers"],[PM]:["Copy with group header","Copy with group headers"],[NM]:["Copy header only","Copy headers only"],[DM]:"Cut",[rT]:"Insert child row",[sT]:"Detach from parent",[lT]:["Hide column","Hide columns"],[aT]:["Show column","Show columns"],[hT]:["Hide row","Hide rows"],[cT]:["Show row","Show rows"],[gT]:"None",[fT]:"Is empty",[pT]:"Is not empty",[mT]:"Is equal to",[wT]:"Is not equal to",[bT]:"Begins with",[vT]:"Ends with",[yT]:"Contains",[CT]:"Does not contain",[RT]:"Greater than",[xT]:"Greater than or equal to",[ET]:"Less than",[MT]:"Less than or equal to",[TT]:"Is between",[kT]:"Is not between",[AT]:"After",[HT]:"Before",[IT]:"Today",[OT]:"Tomorrow",[_T]:"Yesterday",[VT]:"Blank cells",[PT]:"Filter by condition",[NT]:"Filter by value",[DT]:"And",[LT]:"Or",[FT]:"Select all",[WT]:"Clear",[BT]:"OK",[jT]:"Cancel",[zT]:"Search",[UT]:"Value",[YT]:"Second value",[GT]:"Checked",[KT]:"Unchecked"},ZT=XT,QT=qT.languageCode,{register:JT,getItem:tk,hasItem:ek,getValues:nk}=nv("languagesDictionaries");function ok(t,e){let n=t,o=e;return Cw(t)&&(o=t,n=o.languageCode),function(t,e){t!==QT&&(n=e,Rw(tk(QT),((t,e)=>{Zf(n[e])&&(n[e]=t)})));var n}(n,o),JT(n,ww(o)),ww(o)}function ik(t){return rk(t)?ww(tk(t)):null}function rk(t){return ek(t)}function sk(t,e,n){const o=ik(t);if(null===o)return null;const i=o[e];if(Zf(i))return null;const r=function(t,e){let n=t;return jf(function(){return vM()}(),(o=>{n=o(t,e)})),n}(i,n);return Array.isArray(r)?r[0]:r}function lk(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}ok(qT);const ak=class extends GR{constructor(t,e){super(t,null),lk(this,"visualCellRange",null),this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:n}=t,o=this.getNearestNotHiddenCoords(e,1),i=this.getNearestNotHiddenCoords(n,-1);return null===o||null===i?null:((o.row>i.row||o.col>i.col)&&(o=e,i=n),this.settings.createCellRange(o,o,i))}getNearestNotHiddenCoords(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===o)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,n);return null===i?null:this.settings.createCellCoords(o,i)}getNearestNotHiddenIndex(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}commit(){if(null===this.visualCellRange)return this;const t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}syncWith(t){const e=t.from.clone().normalize(),n="N-S"===t.getVerticalDirection()?1:-1,o="W-E"===t.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let r=null;if(null!==i&&null!==i.col&&null!==i.row||(r=this.getNearestNotHiddenCoords(e,n,o)),null!==r&&t.overlaps(r)){const e=t.highlight.clone();if(e.row>=0&&(e.row=r.row),e.col>=0&&(e.col=r.col),null===this.cellRange){const t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==i&&null===r&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){const t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){const n=this.settings.visualToRenderableCoords(t),o=this.settings.visualToRenderableCoords(e);return null===n.row||null===n.col||null===o.row||null===o.col?null:this.settings.createCellRange(n,n,o)}};function hk(e){let{activeHeaderClassName:n}=e,o=U(e,t);return new ak($($({className:n},o),{},{selectionType:KR}))}function ck(t){let{areaCornerVisible:n}=t,o=U(t,e);return new ak($($({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:n}},o),{},{selectionType:qR}))}function uk(t){let e=Object.assign({},(z(t),t));return new ak($($({className:"highlight"},e),{},{selectionType:qR}))}function dk(t){let{columnClassName:e}=t,o=U(t,n);return new ak($($({className:e},o),{},{selectionType:"column"}))}function gk(t){let{headerClassName:e}=t,n=U(t,r);return new ak($($({className:e},n),{},{selectionType:XR}))}function fk(t){let{rowClassName:e}=t,n=U(t,s);return new ak($($({className:e},n),{},{selectionType:"row"}))}function pk(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function mk(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wk(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bk=new WeakSet;class vk{constructor(t){pk(this,bk),mk(this,"options",void 0),mk(this,"layerLevel",0),mk(this,"focus",void 0),mk(this,"fill",void 0),mk(this,"layeredAreas",new Map),mk(this,"areas",new Map),mk(this,"rowHeaders",new Map),mk(this,"columnHeaders",new Map),mk(this,"activeRowHeaders",new Map),mk(this,"activeColumnHeaders",new Map),mk(this,"activeCornerHeaders",new Map),mk(this,"rowHighlights",new Map),mk(this,"columnHighlights",new Map),mk(this,"customSelections",[]),this.options=t,this.focus=function(t){let{cellCornerVisible:e}=t,n=U(t,o);return new ak($($({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:e}},n),{},{selectionType:ZR}))}(t),this.fill=function(t){let e=Object.assign({},(z(t),t));return new ak($($({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:"fill"}))}(t)}isEnabledFor(t,e){let n=t;t===ZR&&(n="current");let o=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof o&&(o=[o]),!1===o||Array.isArray(o)&&!o.includes(n)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return wk(bk,this,yk).call(this,this.layeredAreas,ck)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return wk(bk,this,yk).call(this,this.areas,uk)}getAreas(){return[...this.areas.values()]}createRowHeader(){return wk(bk,this,yk).call(this,this.rowHeaders,gk)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return wk(bk,this,yk).call(this,this.columnHeaders,gk)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return wk(bk,this,yk).call(this,this.activeRowHeaders,hk)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return wk(bk,this,yk).call(this,this.activeColumnHeaders,hk)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return wk(bk,this,yk).call(this,this.activeCornerHeaders,hk)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return wk(bk,this,yk).call(this,this.rowHighlights,fk)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return wk(bk,this,yk).call(this,this.columnHighlights,dk)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(function(t){let{border:e,visualCellRange:n}=t,o=U(t,i);return new ak($($($({},e),o),{},{selectionType:"custom-selection"}),n)}($($({},this.options),t)))}clear(){this.focus.clear(),this.fill.clear(),jf(this.areas.values(),(t=>{t.clear()})),jf(this.layeredAreas.values(),(t=>{t.clear()})),jf(this.rowHeaders.values(),(t=>{t.clear()})),jf(this.columnHeaders.values(),(t=>{t.clear()})),jf(this.activeRowHeaders.values(),(t=>{t.clear()})),jf(this.activeColumnHeaders.values(),(t=>{t.clear()})),jf(this.activeCornerHeaders.values(),(t=>{t.clear()})),jf(this.rowHighlights.values(),(t=>{t.clear()})),jf(this.columnHighlights.values(),(t=>{t.clear()}))}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function yk(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const o=e($({layerLevel:n},this.options));return t.set(n,o),o}const Ck=vk;function Sk(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Rk{constructor(t){Sk(this,"ranges",[]),Sk(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some((e=>e.includes(t)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const xk=Rk;function Ek(t,e,n){Mk(t,e),e.set(t,n)}function Mk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tk(t,e){return t.get(Ak(t,e))}function kk(t,e,n){return t.set(Ak(t,e),n),n}function Ak(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hk=new WeakMap,Ik=new WeakMap,Ok=new WeakMap,_k=new WeakSet;class Pk{constructor(t,e){var n,o;Mk(n=this,o=_k),o.add(n),Ek(this,Hk,void 0),Ek(this,Ik,void 0),Ek(this,Ok,{x:0,y:0}),kk(Hk,this,t),kk(Ik,this,e)}transformStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=Tk(Ik,this).createCellCoords(t,e);let i=Tk(Hk,this).current().highlight;const r=Tk(Ik,this).visualToRenderableCoords(i);let s=0,l=0;if(this.runLocalHooks("beforeTransformStart",o),null!==r.row&&null!==r.col){const{width:t,height:e}=Ak(_k,this,Dk).call(this),{row:r,col:a}=Ak(_k,this,Fk).call(this,i),h=Tk(Ik,this).fixedRowsBottom(),c=Tk(Ik,this).minSpareRows(),u=Tk(Ik,this).minSpareCols(),d=Tk(Ik,this).autoWrapRow(),g=Tk(Ik,this).autoWrapCol(),f=Tk(Ik,this).createCellCoords(r+o.row,a+o.col);if(f.row>=e){const o=Tw(n&&c>0&&0===h),i=f.col+1,r=Tk(Ik,this).createCellCoords(f.row-e,i>=t?i-t:i);this.runLocalHooks("beforeColumnWrap",o,Ak(_k,this,Wk).call(this,r),i>=t),o.value?this.runLocalHooks("insertRowRequire",Tk(Ik,this).countRenderableRows()):g&&f.assign(r)}else if(f.row<0){const n=Tw(g),o=f.col-1,i=Tk(Ik,this).createCellCoords(e+f.row,o<0?t+o:o);this.runLocalHooks("beforeColumnWrap",n,Ak(_k,this,Wk).call(this,i),o<0),g&&f.assign(i)}if(f.col>=t){const o=Tw(n&&u>0),i=f.row+1,r=Tk(Ik,this).createCellCoords(i>=e?i-e:i,f.col-t);this.runLocalHooks("beforeRowWrap",o,Ak(_k,this,Wk).call(this,r),i>=e),o.value?this.runLocalHooks("insertColRequire",Tk(Ik,this).countRenderableColumns()):d&&f.assign(r)}else if(f.col<0){const n=Tw(d),o=f.row-1,i=Tk(Ik,this).createCellCoords(o<0?e+o:o,t+f.col);this.runLocalHooks("beforeRowWrap",n,Ak(_k,this,Wk).call(this,i),o<0),d&&f.assign(i)}const{rowDir:p,colDir:m}=Ak(_k,this,Nk).call(this,f);s=p,l=m,i=Ak(_k,this,Wk).call(this,f)}return this.runLocalHooks("afterTransformStart",i,s,l),i}transformEnd(t,e){const n=Tk(Ik,this).createCellCoords(t,e),o=Tk(Hk,this).current(),i=Tk(Ik,this).visualToRenderableCoords(o.highlight),r=Ak(_k,this,Lk).call(this,o.to.row,o.from.row),s=Ak(_k,this,Vk).call(this,o.to.col,o.from.col),l=o.to.clone();let a=0,h=0;if(this.runLocalHooks("beforeTransformEnd",n),null!==i.row&&null!==i.col&&null!==r&&null!==s){const{row:t,col:e}=Ak(_k,this,Fk).call(this,o.highlight),i=Tk(Ik,this).createCellCoords(r+n.row,s+n.col),c=o.getTopStartCorner(),u=o.getTopEndCorner(),d=o.getBottomEndCorner();if(n.col<0&&s>=e&&i.col<e){const t=i.col-e;i.col=Ak(_k,this,Vk).call(this,c.col,u.col)+t}else if(n.col>0&&s<=e&&i.col>e){const t=Ak(_k,this,Vk).call(this,u.col,c.col),e=Math.max(i.col-t,1);i.col=t+e}if(n.row<0&&r>=t&&i.row<t){const e=i.row-t;i.row=Ak(_k,this,Lk).call(this,c.row,d.row)+e}else if(n.row>0&&r<=t&&i.row>t){const t=Ak(_k,this,Lk).call(this,d.row,c.row),e=Math.max(i.row-t,1);i.row=t+e}const{rowDir:g,colDir:f}=Ak(_k,this,Nk).call(this,i);a=g,h=f;const p=Ak(_k,this,Wk).call(this,i);0===n.row&&0!==n.col?l.col=p.col:0!==n.row&&0===n.col?l.row=p.row:(l.row=p.row,l.col=p.col)}return this.runLocalHooks("afterTransformEnd",l,a,h),l}setOffsetSize(t){let{x:e,y:n}=t;kk(Ok,this,{x:e,y:n})}resetOffsetSize(){kk(Ok,this,{x:0,y:0})}}function Nk(t){const{width:e,height:n}=Ak(_k,this,Dk).call(this);let o=0,i=0;return t.row<0?(o=-1,t.row=0):t.row>0&&t.row>=n&&(o=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:o,colDir:i}}function Dk(){return{width:Tk(Ok,this).x+Tk(Ik,this).countRenderableColumns(),height:Tk(Ok,this).y+Tk(Ik,this).countRenderableRows()}}function Lk(t,e){const n=Tk(Ik,this).findFirstNonHiddenRenderableRow(t,e);return null===n?null:Tk(Ok,this).y+n}function Vk(t,e){const n=Tk(Ik,this).findFirstNonHiddenRenderableColumn(t,e);return null===n?null:Tk(Ok,this).x+n}function Fk(t){const{row:e,col:n}=Tk(Ik,this).visualToRenderableCoords(t);if(null===e||null===n)throw new Error("Renderable coords are not visible.");return Tk(Ik,this).createCellCoords(Tk(Ok,this).y+e,Tk(Ok,this).x+n)}function Wk(t){const e=t.clone();return e.col=t.col-Tk(Ok,this).x,e.row=t.row-Tk(Ok,this).y,Tk(Ik,this).renderableToVisualCoords(e)}vw(Pk,YR);const Bk=Pk,jk=[3,2],zk=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Uk=Symbol("root"),Yk=Symbol("child");function $k(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uk;if(e!==Uk&&e!==Yk)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),o=e===Uk;let i=0;if(n){const e=t[0];if(0===t.length)i=1;else if(o&&e instanceof QC)i=3;else if(o&&Array.isArray(e))i=$k(e,Yk);else if(t.length>=2&&t.length<=4){const e=!t.some(((t,e)=>!zk[e].includes(typeof t)));e&&(i=2)}}return i}function Gk(t){let{createCellCoords:e,createCellRange:n,keepDirection:o=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!jk.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const s=3===t;let l=s?r.from.row:r[0],a=s?r.from.col:r[1],h=s?r.to.row:r[2],c=s?r.to.col:r[3];if("function"==typeof i&&("string"==typeof a&&(a=i(a)),"string"==typeof c&&(c=i(c))),Zf(h)&&(h=l),Zf(c)&&(c=a),!o){const t=l,e=a,n=h,o=c;l=Math.min(t,n),a=Math.min(e,o),h=Math.max(t,n),c=Math.max(e,o)}const u=e(l,a),d=e(h,c);return n(u,u,d)}}function Kk(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Xk(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qk(t,e){return t.get(Qk(t,e))}function Zk(t,e,n){return t.set(Qk(t,e),n),n}function Qk(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jk=new WeakMap,tA=new WeakMap,eA=new WeakMap,nA=new WeakMap,oA=new WeakMap,iA=new WeakMap;class rA{constructor(t,e){var n=this;Xk(this,"settings",void 0),Xk(this,"tableProps",void 0),Xk(this,"inProgress",!1),Xk(this,"selectedRange",new xk(((t,e,n)=>this.tableProps.createCellRange(t,e,n)))),Xk(this,"highlight",void 0),Kk(this,Jk,void 0),Kk(this,tA,void 0),Xk(this,"selectedByRowHeader",new Set),Xk(this,"selectedByColumnHeader",new Set),Kk(this,eA,!1),Kk(this,nA,!1),Kk(this,oA,"unknown"),Kk(this,iA,-1),this.settings=t,this.tableProps=e,this.highlight=new Ck({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,n)=>this.tableProps.createCellRange(t,e,n)}),Zk(Jk,this,new Bk(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol})),Zk(tA,this,new Bk(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const t=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,t.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const t=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,t.getOuterBottomEndCorner().col)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),qk(Jk,this).addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...e)})),qk(Jk,this).addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...e)})),qk(Jk,this).addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...e)})),qk(Jk,this).addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...e)})),qk(Jk,this).addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...e)})),qk(Jk,this).addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("insertColRequire",...e)})),qk(Jk,this).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...e)})),qk(Jk,this).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...e)})),qk(tA,this).addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...e)})),qk(tA,this).addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...e)}))}getSelectedRange(){return this.selectedRange}markSource(t){Zk(oA,this,t)}markEndSource(){Zk(oA,this,"unknown")}getSelectionSource(){return qk(oA,this)}setExpectedLayers(t){Zk(iA,this,t)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Zk(iA,this,-1)}isInProgress(){return this.inProgress}setRangeStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;const i="multiple"===this.settings.selectionMode,r=Zf(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();Zk(eA,this,!1),this.runLocalHooks("beforeSetRangeStart"+(n?"Only":""),s),(!i||i&&!r&&Zf(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(o.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(t)}setRangeStartOnly(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,n)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;const e=t.clone(),n=this.tableProps.countRows(),o=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((n>0||o>0)&&(0===n&&e.col<0&&!i||0===o&&e.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();const r=this.selectedRange.current();if(this.settings.navigableHeaders||r.highlight.normalize(),"single"===this.settings.selectionMode)r.setFrom(r.highlight),r.setTo(r.highlight);else{const t=r.getHorizontalDirection(),n=r.getVerticalDirection(),o=this.isMultiple();r.setTo(e),o&&(t!==r.getHorizontalDirection()||1===r.getWidth()&&!r.includes(r.highlight))&&r.from.assign({col:r.highlight.col}),o&&(n!==r.getVerticalDirection()||1===r.getHeight()&&!r.includes(r.highlight))&&r.from.assign({row:r.highlight.row})}n>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!r.isSingleHeader())&&r.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const s=-1===qk(iA,this)||this.selectedRange.size()===qk(iA,this);this.runLocalHooks("afterSetRangeEnd",t,s)}applyAndCommit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),o=this.tableProps.countCols();e<this.highlight.layerLevel&&(jf(this.highlight.getAreas(),(t=>{t.clear()})),jf(this.highlight.getLayeredAreas(),(t=>{t.clear()})),jf(this.highlight.getRowHeaders(),(t=>{t.clear()})),jf(this.highlight.getColumnHeaders(),(t=>{t.clear()})),jf(this.highlight.getActiveRowHeaders(),(t=>{t.clear()})),jf(this.highlight.getActiveColumnHeaders(),(t=>{t.clear()})),jf(this.highlight.getActiveCornerHeaders(),(t=>{t.clear()})),jf(this.highlight.getRowHighlights(),(t=>{t.clear()})),jf(this.highlight.getColumnHighlights(),(t=>{t.clear()}))),this.highlight.useLayerLevel(e);const i=this.highlight.createArea(),r=this.highlight.createLayeredArea(),s=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),a=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),u=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(i.clear(),r.clear(),s.clear(),l.clear(),a.clear(),h.clear(),c.clear(),u.clear(),d.clear(),this.highlight.isEnabledFor(qR,t.highlight)&&(this.isMultiple()||e>=1)&&(i.add(t.from).add(t.to).commit(),r.add(t.from).add(t.to).commit(),1===e)){const t=this.selectedRange.previous();this.highlight.useLayerLevel(e-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(e)}if(this.highlight.isEnabledFor(XR,t.highlight)){if(!t.isSingleHeader()){const e=this.tableProps.createCellCoords(Math.max(t.from.row,0),-1),n=this.tableProps.createCellCoords(t.to.row,-1),o=this.tableProps.createCellCoords(-1,Math.max(t.from.col,0)),i=this.tableProps.createCellCoords(-1,t.to.col);"single"===this.settings.selectionMode?(s.add(e).commit(),l.add(o).commit(),u.add(e).commit(),d.add(o).commit()):(s.add(e).add(n).commit(),l.add(o).add(i).commit(),u.add(e).add(n).commit(),d.add(o).add(i).commit())}const e=!qk(nA,this)&&this.isEntireRowSelected()&&(o>0&&o===t.getWidth()||0===o&&this.isSelectedByRowHeader()),i=!qk(nA,this)&&this.isEntireColumnSelected()&&(n>0&&n===t.getHeight()||0===n&&this.isSelectedByColumnHeader());e&&a.add(this.tableProps.createCellCoords(Math.max(t.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(t.to.row,0),-1)).commit(),i&&h.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(t.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(t.to.col,0))).commit(),e&&i&&c.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(t){if(this.selectedRange.isEmpty())return;const e=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",t);const n=this.highlight.getFocus();n.clear(),e.setHighlight(t),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(ZR,e.highlight)&&n.add(e.highlight).commit().syncWith(e),this.inProgress||(Zk(eA,this,!0),this.runLocalHooks("afterSetFocus",e.highlight))}transformStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?qk(Jk,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):qk(Jk,this).resetOffsetSize(),this.setRangeStart(qk(Jk,this).transformStart(t,e,n))}transformEnd(t,e){this.settings.navigableHeaders?qk(Jk,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):qk(Jk,this).resetOffsetSize(),this.setRangeEnd(qk(Jk,this).transformEnd(t,e))}transformFocus(t,e){const n=this.selectedRange.current(),{row:o,col:i}=n.getOuterTopStartCorner(),r=this.tableProps.countRenderableColumnsInRange(0,i-1),s=this.tableProps.countRenderableRowsInRange(0,o-1);n.highlight.isHeader()?qk(tA,this).setOffsetSize({x:i<0?Math.abs(i):-r,y:o<0?Math.abs(o):-s}):qk(tA,this).setOffsetSize({x:i<0?0:-r,y:o<0?0:-s});const l=qk(tA,this).transformStart(t,e);this.setRangeFocus(l.normalize())}shiftRows(t,e){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=t){const{from:o,to:i,highlight:r}=n,s=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),h=a?-1:0,c=a?0:e;this.getSelectedRange().pop();const u=this.tableProps.createCellCoords(Oy(o.row+c,h,s-1),o.col),d=this.tableProps.createCellCoords(Oy(i.row+e,h,s-1),i.col);this.markSource("shift"),r.row>=t?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(Oy(r.row+e,0,s-1),r.col)):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(t,e){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=t){const{from:o,to:i,highlight:r}=n,s=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),h=l?-1:0,c=l?0:e;this.getSelectedRange().pop();const u=this.tableProps.createCellCoords(o.row,Oy(o.col+c,h,s-1)),d=this.tableProps.createCellCoords(i.row,Oy(i.col+e,h,s-1));this.markSource("shift"),r.col>=t?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(r.row,Oy(r.col+e,0,s-1))):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const t=Tw(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}isFocusSelectionChanged(){return this.isSelected()&&qk(eA,this)}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{col:e}=t.getOuterTopStartCorner(),n=this.tableProps.countRowHeaders(),o=this.tableProps.countCols();return(n>0&&e<0||0===n)&&t.getWidth()===o};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const n=this.selectedRange.peekByIndex(t);return!!n&&e(n)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{row:e}=t.getOuterTopStartCorner(),n=this.tableProps.countColHeaders(),o=this.tableProps.countRows();return(n>0&&e<0||0===n)&&t.getHeight()===o};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const n=this.selectedRange.peekByIndex(t);return!!n&&e(n)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){const e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=n?-l:0,h=e?-s:0;if(0===a&&0===h&&(0===i||0===r))return;let c=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight;const{focusPosition:u,disableHeadersHighlight:d}=o;Zk(nA,this,d),u&&Number.isInteger(null==u?void 0:u.row)&&Number.isInteger(null==u?void 0:u.col)&&(c=this.tableProps.createCellCoords(Oy(u.row,a,i-1),Oy(u.col,h,r-1)));const g=this.tableProps.createCellCoords(a,h),f=this.tableProps.createCellCoords(i-1,r-1);this.clear(),this.setRangeStartOnly(g,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),Zk(nA,this,!1)}selectCells(t){var e=this;const n=$k(t);if(1===n)return!1;if(0===n)throw new Error(Kf(S||(S=j`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`)));const o=Gk(n,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),i=this.settings.navigableHeaders,r={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},s=!t.some((t=>{const e=o(t),n=e.isValid(r);return!(n&&!e.containsHeaders()||n&&e.containsHeaders()&&e.isSingleHeader())}));return s&&(this.clear(),this.setExpectedLayers(t.length),jf(t,(t=>{const{from:e,to:n}=o(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(n.clone())})),this.finish()),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o="string"==typeof t?this.tableProps.propToCol(t):t,i="string"==typeof e?this.tableProps.propToCol(e):e,r=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=this.tableProps.createCellCoords(a,o),c=this.tableProps.createCellCoords(r-1,i),u=this.tableProps.createCellRange(h,h,c).isValid({countRows:r,countCols:s,countRowHeaders:0,countColHeaders:l});if(u){let t=0,e=0;Number.isInteger(null==n?void 0:n.row)&&Number.isInteger(null==n?void 0:n.col)?(t=Oy(n.row,a,r-1),e=Oy(n.col,Math.min(o,i),Math.max(o,i))):(t=Oy(n,a,r-1),e=o);const s=this.tableProps.createCellCoords(t,e),h=0===l?0:Oy(s.row,a,-1),c=r-1,u=this.tableProps.createCellCoords(h,o),d=this.tableProps.createCellCoords(c,i);this.runLocalHooks("beforeSelectColumns",u,d,s),u.row=h,d.row=c,this.setRangeStartOnly(u,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",u,d,s),this.finish()}return u}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=this.tableProps.countRows(),i=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),s=0===r?0:-r,l=this.tableProps.createCellCoords(t,s),a=this.tableProps.createCellCoords(e,i-1),h=this.tableProps.createCellRange(l,l,a).isValid({countRows:o,countCols:i,countRowHeaders:r,countColHeaders:0});if(h){let o=0,l=0;Number.isInteger(null==n?void 0:n.row)&&Number.isInteger(null==n?void 0:n.col)?(o=Oy(n.row,Math.min(t,e),Math.max(t,e)),l=Oy(n.col,s,i-1)):(o=t,l=Oy(n,s,i-1));const a=this.tableProps.createCellCoords(o,l),h=0===r?0:Oy(a.col,s,-1),c=i-1,u=this.tableProps.createCellCoords(t,h),d=this.tableProps.createCellCoords(e,c);this.runLocalHooks("beforeSelectRows",u,d,a),u.col=h,d.col=c,this.setRangeStartOnly(u,void 0,a),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",u,d,a),this.finish()}return h}refresh(){if(!this.isSelected())return;const t=this.tableProps.countRows(),e=this.tableProps.countCols();if(0===t||0===e)return void this.deselect();const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:o,to:i,highlight:r}=n;this.clear(),r.assign({row:Oy(r.row,-1/0,t-1),col:Oy(r.col,-1/0,e-1)}),o.assign({row:Oy(o.row,-1/0,t-1),col:Oy(o.col,-1/0,e-1)}),i.assign({row:Oy(i.row,0,t-1),col:Oy(i.col,0,e-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(r).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach((t=>{t.commit()})),!this.isSelected())return;const t=this.highlight.getFocus(),e=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const t=this.highlight.createArea(),e=this.highlight.createLayeredArea(),o=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),r=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();t.commit(),e.commit(),o.commit(),i.commit(),r.commit(),s.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(e)}}vw(rA,YR);const sA=rA,lA=/^(\r\n|\n\r|\r|\n)/,aA=/^[^\t\r\n]+/,hA=/^\t/;function cA(t){let e,n,o,i,r,s="";for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,o=0;o<i;o+=1)o>0&&(s+="\t"),r=t[e][o],"string"==typeof r?r.indexOf("\n")>-1?s+=`"${r.replace(/"/g,'""')}"`:s+=r:s+=null==r?"":r;e!==n-1&&(s+="\n")}return s}function uA(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class dA{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,n){uA(this,"hot",void 0),uA(this,"metaManager",void 0),uA(this,"tableMeta",void 0),uA(this,"dataSource",void 0),uA(this,"duckSchema",void 0),uA(this,"colToPropCache",void 0),uA(this,"propToColCache",void 0),this.hot=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const t=this.getSchema();if(void 0===t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const e=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,e){let o=0,i=0,r=!1;if("function"==typeof e){const e=Mw(t);o=e>0?e:this.countFirstRowKeys(),r=!0}else{const t=this.tableMeta.maxCols;o=Math.min(t,e.length)}for(n=0;n<o;n++){const t=r?e(n):e[n];if(Cw(t)){if(void 0!==t.data){const e=r?i:n;this.colToPropCache[e]=t.data,this.propToColCache.set(t.data,e)}i+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return EE(this.dataSource)}recursiveDuckColumns(t,e,n){let o,i=e,r=n;return void 0===i&&(i=0,r=""),"object"!=typeof t||Array.isArray(t)||Rw(t,((t,e)=>{null===t?(o=r+e,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(t,i,`${e}.`)})),i}colToProp(t){if(!1===Number.isInteger(t))return t;const e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&qf(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){const e=this.propToColCache.get(t);if(qf(e))return this.hot.toVisualColumn(e);const n=this.hot.toVisualColumn(t);return null===n?t:n}getSchema(){const t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?gw(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:o="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let r=i,s=0,l=t;("number"!=typeof l||l>=i)&&(l=i),l<this.hot.countRows()&&(r=this.hot.toPhysicalRow(l));if(!1===this.hot.runHooks("beforeCreateRow",l,e,n)||null===r)return{delta:0};const a=this.tableMeta.maxRows,h=this.getSchema().length,c=[];for(;s<e&&i+s<a;){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=ww(this.getSchema()):(t=[],Ay(h-1,(()=>t.push(null)))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(l+s):(t={},mw(t,this.getSchema())),c.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(l,s),"below"===o&&(r=Math.min(r+1,i)),this.spliceData(r,0,c);const u=this.hot.toVisualRow(r);return this.hot.countSourceRows()===c.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==t?this.metaManager.createRow(null,s):"auto"!==n&&this.metaManager.createRow(r,e)),this.hot.runHooks("afterCreateRow",u,s,n),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:r}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:o="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,r=this.tableMeta.maxCols,s=this.hot.countSourceCols();let l=t;("number"!=typeof l||l>=s)&&(l=s);if(!1===this.hot.runHooks("beforeCreateCol",l,e,n))return{delta:0};let a=s;l<this.hot.countCols()&&(a=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let c=this.hot.countCols(),u=0,d=a;"end"===o&&(d=Math.min(d+1,s));const g=d;for(;u<e&&c<r;){if("number"!=typeof l||l>=c)if(h>0)for(let t=0;t<h;t+=1)void 0===i[t]&&(i[t]=[]),i[t].push(null);else i.push([null]);else for(let t=0;t<h;t++)i[t].splice(d,0,null);u+=1,d+=1,c+=1}this.hot.columnIndexMapper.insertIndexes(l,u),u>0&&(null==t?this.metaManager.createColumn(null,u):"auto"!==n&&this.metaManager.createColumn(g,e));const f=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",f,u,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:u,startPhysicalIndex:g}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(t)?t:-e;const i=this.visualRowsToPhysical(o,e),r=this.hot.countSourceRows();o=(r+o)%r;if(!1===this.hot.runHooks("beforeRemoveRow",o,i.length,i,n))return!1;const s=i.length;if(this.filterData(o,s,i),o<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const t=qf(this.tableMeta.columns)||qf(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort(((t,e)=>e-t)).forEach((t=>{this.metaManager.removeRow(t,1)})),this.hot.runHooks("afterRemoveRow",o,s,i,n),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o="number"!=typeof t?-e:t;o=(this.hot.countCols()+o)%this.hot.countCols();const i=this.visualColumnsToPhysical(o,e),r=i.slice(0).sort(((t,e)=>e-t));if(!1===this.hot.runHooks("beforeRemoveCol",o,e,i,n))return!1;let s=!0;const l=r.length,a=this.dataSource;for(let h=0;h<l;h++)s&&i[0]!==i[h]-h&&(s=!1);if(s)for(let h=0,c=this.hot.countSourceRows();h<c;h++)a[h].splice(i[0],e),0===h&&this.metaManager.removeColumn(i[0],e);else for(let h=0,c=this.hot.countSourceRows();h<c;h++)for(let t=0;t<l;t++)a[h].splice(r[t],1),0===h&&this.metaManager.removeColumn(r[t],1);return o<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",o,e,i,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,n){const o=this.hot.getDataAtCol(t),i=o.slice(e,e+n),r=o.slice(e+n);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];Lf(l,r);let h=0;for(;h<n;)l.push(null),h+=1;return Df(l),this.hot.populateFromArray(e,t,l,null,null,"spliceCol"),i}spliceRow(t,e,n){const o=this.hot.getSourceDataAtRow(t),i=o.slice(e,e+n),r=o.slice(e+n);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];Lf(l,r);let h=0;for(;h<n;)l.push(null),h+=1;return this.hot.populateFromArray(t,e,[l],null,null,"spliceRow"),i}spliceData(t,e,n){if(!1!==this.hot.runHooks("beforeDataSplice",t,e,n)){const e=[...this.dataSource.slice(0,t),...n,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach((t=>this.dataSource.push(t)))}}filterData(t,e,n){let o=this.hot.runHooks("filterData",t,e,n);!1===Array.isArray(o)&&(o=this.dataSource.filter(((t,e)=>-1===n.indexOf(e)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(t,e){const n=this.hot.toPhysicalRow(t);let o=this.dataSource[n];const i=this.hot.runHooks("modifyRowData",n);o=isNaN(i)?i:o;const{dataDotNotation:r}=this.hot.getSettings();let s=null;if(o&&o.hasOwnProperty&&kw(o,e))s=o[e];else if(r&&"string"==typeof e&&e.indexOf(".")>-1){let t=o;if(!t)return null;const n=e.split(".");for(let e=0,o=n.length;e<o;e++)if(t=t[n[e]],void 0===t)return null;s=t}else"function"==typeof e&&(s=e(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const t=Tw(s);this.hot.runHooks("modifyData",n,this.propToCol(e),t,"get"),t.isTouched()&&(s=t.value)}return s}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,n){const o=this.hot.toPhysicalRow(t);let i=n,r=this.dataSource[o];const s=this.hot.runHooks("modifyRowData",o);if(r=isNaN(s)?s:r,this.hot.hasHook("modifyData")){const t=Tw(i);this.hot.runHooks("modifyData",o,this.propToCol(e),t,"set"),t.isTouched()&&(i=t.value)}const{dataDotNotation:l}=this.hot.getSettings();if(r&&r.hasOwnProperty&&kw(r,e))r[e]=i;else if(l&&"string"==typeof e&&e.indexOf(".")>-1){let t,n=r,o=0;const s=e.split(".");for(o=0,t=s.length-1;o<t;o++)void 0===n[s[o]]&&(n[s[o]]={}),n=n[s[o]];n[s[o]]=i}else"function"==typeof e?e(this.dataSource.slice(o,o+1)[0],i):r[e]=i}visualRowsToPhysical(t,e){const n=this.hot.countSourceRows(),o=[];let i,r=(n+t)%n,s=e;for(;r<n&&s;)i=this.hot.toPhysicalRow(r),o.push(i),s-=1,r+=1;return o}visualColumnsToPhysical(t,e){const n=this.hot.countCols(),o=[];let i=(n+t)%n,r=e;for(;i<n&&r;){const t=this.hot.toPhysicalColumn(i);o.push(t),r-=1,i+=1}return o}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){const t=this.tableMeta.maxRows;let e;e=t<0||0===t?0:t||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}getAll(){const t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!=0||this.hot.countSourceRows()?this.getRange(t,e,dA.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,n){const o=[];let i,r,s;const l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];const h=n===dA.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),u=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(i=Math.min(t.row,e.row);i<=c;i++){s=[];const n=i>=0?this.hot.toPhysicalRow(i):i;for(r=Math.min(t.col,e.col);r<=u&&null!==n;r++)s.push(h.call(this,i,this.colToProp(r)));null!==n&&o.push(s)}return o}getText(t,e){return cA(this.getRange(t,e,dA.DESTINATION_RENDERER))}getCopyableText(t,e){return cA(this.getRange(t,e,dA.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const gA=dA,{register:fA,getItem:pA,hasItem:mA,getNames:wA,getValues:bA}=nv("cellTypes");function vA(t){if(!mA(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return pA(t)}function yA(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);const{editor:n,renderer:o,validator:i}=e;n&&dv(t,n),o&&tC(t,o),i&&lC(t,i),fA(t,e)}function CA(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const o="string"==typeof e.type?vA(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Rw(e,((e,n)=>{t._automaticallyAssignedMetaProps.delete(n)})),!Cw(o))return;n!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);const i={};Rw(o,((e,o)=>{var r;(function(t,e){var n;return"CELL_TYPE"!==t&&((null===(n=e._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(t))||!kw(e,t))})(o,n)&&(i[o]=e,null===(r=t._automaticallyAssignedMetaProps)||void 0===r||r.add(o))})),pw(t,i)}function SA(t){return Number.isInteger(t)&&t>=0}function RA(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function xA(t){return null==t}const EA=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,o;for(e=0,n=this.countRows();e<n;e++)if(o=this.getDataAtCell(e,t),!1===Qf(o))return!1;return!0},isEmptyRow(t){let e,n,o,i;for(e=0,n=this.countCols();e<n;e++)if(o=this.getDataAtCell(t,e),!1===Qf(o))return"object"==typeof o&&(i=this.getCellMeta(t,e),yw(this.getSchema()[i.prop],o));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function MA(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class TA{constructor(t){MA(this,"metaCtor",class{}),MA(this,"meta",void 0),this.meta=this.metaCtor.prototype,pw(this.meta,EA()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;pw(this.meta,t),CA(this.meta,$($({},t),{},{type:null!==(e=t.type)&&void 0!==e?e:this.meta.type}),t)}}function kA(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class AA{constructor(t){kA(this,"meta",void 0);const e=t.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(t){pw(this.meta,t),CA(this.meta,t,t)}}function HA(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class IA{constructor(t){HA(this,"valueFactory",void 0),HA(this,"data",[]),HA(this,"index",[]),HA(this,"holes",new Set),this.valueFactory=t}obtain(t){RA((()=>SA(t)),"Expecting an unsigned number.");const e=this._getStorageIndexByKey(t);let n;if(e>=0)n=this.data[e],void 0===n&&(n=this.valueFactory(t),this.data[e]=n);else if(n=this.valueFactory(t),this.holes.size>0){const e=this.holes.values().next().value;this.holes.delete(e),this.data[e]=n,this.index[t]=e}else this.data.push(n),this.index[t]=this.data.length-1;return n}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;RA((()=>SA(t)||xA(t)),"Expecting an unsigned number or null/undefined argument.");const n=[],o=this.data.length;for(let r=0;r<e;r++)n.push(o+r),this.data.push(void 0);const i=xA(t)?this.index.length:t;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;RA((()=>SA(t)||xA(t)),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(xA(t)?this.index.length-e:t,e);for(let o=0;o<n.length;o++){const t=n[o];"number"==typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return Wf(this.data,((t,e)=>!this.holes.has(e)))[Symbol.iterator]()}entries(){const t=[];for(let n=0;n<this.data.length;n++){const e=this._getKeyByStorageIndex(n);-1!==e&&t.push([e,this.data[n]])}let e=0;return{next:()=>{if(e<t.length){const n=t[e];return e+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Symbol.iterator](){return this.entries()}}function OA(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const _A=["data","width"];class PA{constructor(t){OA(this,"globalMeta",void 0),OA(this,"metas",new IA((()=>this._createMeta()))),this.globalMeta=t,this.metas=new IA((()=>this._createMeta()))}updateMeta(t,e){const n=this.getMeta(t);pw(n,e),CA(n,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}fw(n,t);for(let o=0;o<e.length;o++)n.prototype[e[o]]=void 0;return n}(this.globalMeta.getMetaConstructor(),_A).prototype}}function NA(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class DA{constructor(t){NA(this,"columnMeta",void 0),NA(this,"metas",new IA((()=>this._createRow()))),this.columnMeta=t}updateMeta(t,e,n){const o=this.getMeta(t,e);pw(o,n),CA(o,n)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(t,e)}getMeta(t,e,n){const o=this.metas.obtain(t).obtain(e);return void 0===n?o:o[n]}setMeta(t,e,n,o){var i;const r=this.metas.obtain(t).obtain(e);null===(i=r._automaticallyAssignedMetaProps)||void 0===i||i.delete(n),r[n]=o}removeMeta(t,e,n){delete this.metas.obtain(t).obtain(e)[n]}getMetas(){const t=[],e=Array.from(this.metas.values());for(let n=0;n<e.length;n++)qf(e[n])&&t.push(...e[n].values());return t}getMetasAtRow(t){RA((()=>SA(t)),"Expecting an unsigned number.");const e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new IA((t=>this._createMeta(t)))}_createMeta(t){return new(this.columnMeta.getMetaConstructor(t))}}class LA{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new TA(t),this.tableMeta=new AA(this.globalMeta),this.columnMeta=new PA(this.globalMeta),this.cellMeta=new DA(this.columnMeta),n.forEach((t=>new t(this))),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,n){let{visualRow:o,visualColumn:i}=n;const r=this.cellMeta.getMeta(t,e);return r.visualRow=o,r.visualCol=i,r.row=t,r.col=e,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(t,e,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,n)}setCellMeta(t,e,n,o){this.cellMeta.setMeta(t,e,n,o)}updateCellMeta(t,e,n){this.cellMeta.updateMeta(t,e,n)}removeCellMeta(t,e,n){this.cellMeta.removeMeta(t,e,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function VA(t,e,n,o){const{hotInstance:i,dataMap:r,dataSource:s,internalSource:l,source:a,metaManager:h,firstRun:c}=o,u=up(l),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Hm(d.dataSchema)?i.dataType="function":i.dataType="object",r&&r.destroy(),t=i.runHooks(`before${u}`,t,c,a);const g=new gA(i,t,h);if(e(g),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);{const e=g.getSchema();let n;t=[];let o=0,r=0;for(o=0,r=d.startRows;o<r;o++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)n=ww(e[0]),t.push(n);else{n=[];for(let t=0,e=d.startCols;t<e;t++)n.push(null);t.push(n)}else n=ww(e),t.push(n)}}Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${u}`,t,c,a),c||(i.runHooks("afterChange",null,l),i.render()),i.getSettings().ariaTags&&zp(i.rootElement,[Cp(-1),Sp(i.countCols()+(i.view?i.countRowHeaders():0))])}function FA(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}vw(LA,YR);class WA{constructor(t){FA(this,"metaManager",void 0),FA(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",(t=>this.extendCellMeta(t))),tv.getSingleton().add("beforeRender",(t=>{t&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(t){var e;const{row:n,col:o}=t;if(null!==(e=this.metaSyncMemo.get(n))&&void 0!==e&&e.has(o))return;const{visualRow:i,visualCol:r}=t,s=this.metaManager.hot,l=s.colToProp(r);t.prop=l,s.runHooks("beforeGetCellMeta",i,r,t);const a=kw(t,"type")?t.type:null;let h=Hm(t.cells)?t.cells(n,o,l):null;var c;a&&(h?h.type=null!==(c=h.type)&&void 0!==c?c:a:h={type:a});h&&this.metaManager.updateCellMeta(n,o,h),s.runHooks("afterGetCellMeta",i,r,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(o)}}function BA(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function jA(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zA(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var UA=new WeakMap;class YA{constructor(t){jA(this,"metaManager",void 0),jA(this,"usageTracker",new Set),jA(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),BA(this,UA,((t,e,n)=>{if(!n)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)})),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((t,e)=>{const{initOnly:n,target:o,onChange:i}=t,r="string"==typeof o,s=r?o:e,l=`_${s}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[s],i?(this.installPropWatcher(e,l,i),r&&this.installPropWatcher(o,l,i)):n&&(this.installPropWatcher(e,l,zA(UA,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(e))}))}installPropWatcher(t,e,n){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(i){const r=!o.usageTracker.has(t);o.usageTracker.add(t),n.call(o,t,i,r),this[e]=i},enumerable:!0,configurable:!0})}}const $A="gridDefault",GA="editorManager.handlingEditor",KA={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},XA={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){jf(this._hooksStorage[t]||[],(e=>{this.hot.removeHook(t,e)}))},clearHooks(){Rw(this._hooksStorage,((t,e)=>this.removeHooksByKey(e))),this._hooksStorage={}}};Sw(XA,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const qA=XA;function ZA(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const QA=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class JA{static get EDITOR_TYPE(){return"base"}constructor(t){ZA(this,"hot",void 0),ZA(this,"state",QA.VIRGIN),ZA(this,"_opened",!1),ZA(this,"_fullEditMode",!1),ZA(this,"_closeCallback",null),ZA(this,"TD",null),ZA(this,"row",null),ZA(this,"col",null),ZA(this,"prop",null),ZA(this,"originalValue",null),ZA(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,n,o,i,r){this.TD=o,this.row=t,this.col=e,this.prop=n,this.originalValue=i,this.cellProperties=r,this.state=this.isOpened()?this.state:QA.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let n,o,i,r;if(e){const t=this.hot.getSelectedLast();n=Math.max(Math.min(t[0],t[2]),0),o=Math.max(Math.min(t[1],t[3]),0),i=Math.max(t[0],t[2]),r=Math.max(t[1],t[3])}else[n,o,i,r]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",n,o);Array.isArray(s)&&([n,o]=s),this.hot.populateFromArray(n,o,t,i,r,"edit")}beginEditing(t,e){if(this.state!==QA.VIRGIN)return;const n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,i)),this.state=QA.EDITING,this.isInFullEditMode()){const e="string"==typeof t?t:Xf(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,n){let o;if(n){const t=this._closeCallback;this._closeCallback=e=>{t&&t(e),n(e),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==QA.VIRGIN){if(this.state===QA.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();const n=this.getValue();o=this.cellProperties.trimWhitespace?[["string"==typeof n?String.prototype.trim.call(n||""):n]]:[[n]],this.state=QA.WAITING,this.saveValue(o,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(t=>{this.state=QA.FINISHED,this.discardEditor(t)})):(this.state=QA.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=QA.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===QA.FINISHED)if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=QA.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=QA.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===QA.WAITING}getEditedCellRect(){var t;const e=this.getEditedCell();if(!e)return;const{wtOverlays:n,wtViewport:o}=this.hot.view._wt,i=this.hot.rootWindow,r=Zp(e),s=am(e),l=Zp(this.hot.rootElement),a=am(this.hot.rootElement),h=n.topOverlay.holder,c=n.inlineStartOverlay.holder,u=h!==i?h.scrollTop:0,d=c!==i?c.scrollLeft:0,g=i.innerWidth-l.left-a,{wtTable:f}=null!==(t=n.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,p=f.name,m=["master","inline_start"].includes(p)?u:0,w=["master","top","bottom"].includes(p)?d:0,b=r.top===l.top?0:1;let v=r.top-l.top-b-m,y=0;y=this.hot.isRtl()?i.innerWidth-r.left-s-g-1+w:r.left-l.left-1-w,["top","top_inline_start_corner"].includes(p)&&(v+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(y+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const C=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),x=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(C&&S<=0||S===x)&&(v+=1),R<=0&&(y+=1);const E=o.rowsRenderCalculator.startPosition,M=o.columnsRenderCalculator.startPosition,T=Math.abs(n.inlineStartOverlay.getScrollPosition()),k=n.topOverlay.getScrollPosition(),A=wm(this.hot.rootDocument);let H=e.offsetTop;if(["inline_start","master"].includes(p)&&(H+=E-k),["bottom","bottom_inline_start_corner"].includes(p)){const{wtViewport:t,wtTable:e}=n.bottomOverlay.clone;H+=t.getWorkspaceHeight()-e.getHeight()-A}let I=e.offsetLeft;this.hot.isRtl()?(I=I>=0?f.getWidth()-e.offsetLeft:Math.abs(I),I+=M-T-s):["top","master","bottom"].includes(p)&&(I+=M-T);const O=lm(this.TD,this.hot.rootWindow),_=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",P=parseInt(O[_],10)>0?0:1,N=parseInt(O.borderTopWidth,10)>0?0:1,D=am(e)+P,L=hm(e)+N,V=bm(h)?A:0,F=vm(c)?A:0,W=this.hot.view.maximumVisibleElementWidth(I)-V+P;return{top:v,start:y,height:L,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(H)-F+N,23),width:D,maxWidth:W}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const t=this.hot.countRows();let e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}vw(JA,qA);const tH={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const o=t._getEditorManager(),i=o.getActiveEditor();i.isInFullEditMode()&&i.state===QA.EDITING||(o.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},eH={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},nH={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},oH={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},iH={name:"editorOpen",callback(t,e,n){const o=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:r}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),i="function"==typeof o.enterMoves?o.enterMoves(e):o.enterMoves;n.includes("shift")?t.selection.transformFocus(-i.row,-i.col):t.selection.transformFocus(i.row,i.col)}else r.isHeader()||(t.getSettings().enterBeginsEditing?o.cellProperties.readOnly?o.moveSelectionAfterEnter(e):o.openEditor(null,e,!0):o.moveSelectionAfterEnter(e),lb(e))}};const rH={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())||t.selection.transformEnd(1,0)}},sH={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),o=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==o){const n=t._createCellCoords(o,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.min(n.row-i,t.countRows()-1);t.selection.setRangeEnd(n),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},lH={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())||t.selection.transformEnd(0,-1*t.getDirectionFactor())}},aH={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())||t.selection.transformEnd(0,t.getDirectionFactor())}},hH={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:o}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,o.col,e)}},cH={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByRowHeader();if(o.isCell()||s){const l=n.getNearestNotHiddenIndex(t.countRows()-1,-1),a=i.clone();a.row=o.row,e.setRangeStart(a,void 0,!1,o.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,r.col))}}},uH={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&o.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),l=i.clone();l.col=o.col,e.setRangeStart(l,void 0,!1,o.clone()),e.setRangeEnd(t._createCellCoords(r.row,s))}}},dH={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&o.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),l=n.getNearestNotHiddenIndex(s,1),a=i.clone();a.col=o.col,e.setRangeStart(a,void 0,!1,o.clone()),e.setRangeEnd(t._createCellCoords(r.row,l))}}},gH={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByColumnHeader();if(o.isCell()||s){const l=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),a=i.clone();a.col=o.col,e.setRangeStart(a,void 0,!1,o.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,l))}}},fH={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByColumnHeader();if(o.isCell()||s){const l=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),a=i.clone();a.col=o.col,e.setRangeStart(a,void 0,!1,o.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,l))}}},pH={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:o,from:i,to:r}=t.getSelectedRangeLast(),s=o.isHeader()&&t.selection.isSelectedByRowHeader();if(o.isCell()||s){const l=n.getNearestNotHiddenIndex(0,1),a=i.clone();a.row=o.row,e.setRangeStart(a,void 0,!1,o.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,r.col))}}},mH={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:o}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,o.row,e)}},wH={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())||t.selection.transformEnd(-1,0)}},bH={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),o=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==o){const n=t._createCellCoords(o,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.max(n.row-i,0);t.selection.setRangeEnd(n),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}};const vH={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},yH={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:o}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;o===t.countRows()-1?i=1:o+i>t.countRows()&&(i=t.countRows()-o-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},CH={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),o=t.getSelectedRangeLast(),i="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},SH={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),o=t.getSelectedRangeLast(),i="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},RH={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},xH={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},EH={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===n&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},MH={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:o}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),r=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=o.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(r,s))}},TH={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},kH={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,o=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,r=n.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(i,r))}},AH={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,o=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===i&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(o,i))}},HH={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:o}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===i&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(o,i))}},IH={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===n&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},OH={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:o}=t,i=parseInt(t.getSettings().fixedRowsTop,10),r=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),l=o.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(s,l))}},_H={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}};const PH=[KA,tH,eH,nH,oH,iH,rH,sH,lH,aH,hH,cH,uH,dH,gH,fH,pH,mH,wH,bH,vH,yH,CH,SH,RH,xH,EH,MH,TH,kH,AH,HH,IH,OH,_H,{name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:o}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);o===-n?i=-1:o+i<n&&(i=-(o+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,o=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,r=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,o),l=t._createCellCoords(i,r);if(!t._createCellRange(s,s,l).includes(e)&&(e.row>=0||e.col>=0)){const n={};if(e.col>=0){const o=Math.floor(t.countVisibleCols()/2);n.col=Math.max(e.col-o,0)}if(e.row>=0){const o=Math.floor(t.countVisibleRows()/2);n.row=Math.max(e.row-o,0)}t.scrollViewportTo($($({},n),{},{verticalSnap:"top",horizontalSnap:"start"}))}}},{name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:o}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,o),r=new Map;for(let s=0;s<e.length;s++)e[s].forAll(((e,s)=>{if(e>=0&&s>=0&&(e!==n||s!==o)){const{readOnly:n}=t.getCellMeta(e,s);n||r.set(`${e}x${s}`,[e,s,i])}}));t.setDataAtCell(Array.from(r.values()))}}];function NH(t){const e={};return PH.forEach((n=>{let{name:o,callback:i}=n;e[o]=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return i(t,...n)}})),e}function DH(t){const e=t.getShortcutManager().addContext("editor"),n=NH(t),o={group:GA};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>n.editorCloseAndSaveByEnter(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>n.editorCloseAndSaveByEnter(t,e)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(t,e)=>n.editorCloseAndSave(t,e)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(t,e)=>n.editorCloseAndSaveByArrowKeys(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],o)}function LH(t){const e=t.getShortcutManager().addContext("grid"),n=NH(t),o={runOnlyIf:()=>{const{navigableHeaders:e}=t.getSettings();return qf(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:$A};e.addShortcuts([{keys:[["F2"]],callback:t=>n.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>n.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:GA,runOnlyIf:()=>qf(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var e;return!(null!==(e=t.getSelectedRangeLast())&&void 0!==e&&e.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var e,n;return!(null!==(e=t.getSelectedRangeLast())&&void 0!==e&&e.highlight.isHeader())&&(null===(n=t.getSelectedRangeLast())||void 0===n?void 0:n.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:t=>n.moveCellSelectionInlineStart(t)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:t=>n.moveCellSelectionInlineEnd(t)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],o)}function VH(t){const e=t.rootDocument.createElement("input");return e.type="text",e.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&zp(e,[["role","presentation"],["aria-hidden","true"]]),e}function FH(t){const e=function(t){return e=>{if(!e)return null;const n=WH(t),o=BH(t);return e.col<n.col&&(e.col=n.col),e.col>o.col&&(e.col=o.col),e.row<n.row&&(e.row=n.row),e.row>o.row&&(e.row=o.row),e}}(t);let n;const{activate:o,deactivate:i}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.rootElement,o=VH(t),i=VH(t);return o.addEventListener("focus",(()=>null==e?void 0:e.onFocusFromTop())),i.addEventListener("focus",(()=>null==e?void 0:e.onFocusFromBottom())),n.firstChild.before(o),n.lastChild.after(i),{activate(){t._registerTimeout((()=>{o.tabIndex=0,i.tabIndex=0}),10)},deactivate(){t._registerTimeout((()=>{o.tabIndex=-1,i.tabIndex=-1}),10)}}}(t,{onFocusFromTop(){var o;const i=null!==(o=e(n))&&void 0!==o?o:WH(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_above",i),t.selectCell(i.row,i.col)),t.listen()},onFocusFromBottom(){var o;const i=null!==(o=e(n))&&void 0!==o?o:BH(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_below",i),t.selectCell(i.row,i.col)),t.listen()}}),r={wrapped:!1,flipped:!1};let s=!0,l=!1,a=!1;t.addHook("afterListen",(()=>i())),t.addHook("afterUnlisten",(()=>o())),t.addHook("afterSelection",((e,o,i,h,c)=>{var u;(l&&(r.wrapped&&r.flipped||a)&&(a=!1,c.value=!0),s)&&(n=null===(u=t.getSelectedRangeLast())||void 0===u?void 0:u.highlight)})),t.addHook("beforeRowWrap",((t,e,n)=>{r.wrapped=!0,r.flipped=n}));const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:$A,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([$($({},h),{},{callback:()=>{const{tabNavigation:e}=t.getSettings();l=!0,t.getSelectedRangeLast()&&!e&&(s=!1),e||(a=!0)},position:"before"}),$($({},h),{},{callback:e=>{const{tabNavigation:o,autoWrapRow:i}=t.getSettings();if(l=!1,s=!0,!o||!t.selection.isSelected()||i&&r.wrapped&&r.flipped||!i&&r.wrapped)return i&&r.wrapped&&r.flipped&&(n=e.shiftKey?WH(t):BH(t)),r.wrapped=!1,r.flipped=!1,t.deselectCell(),t.unlisten(),!1;e.preventDefault()},position:"after"})])}function WH(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:o}=t.getSettings();let i=o&&t.countColHeaders()>0?-t.countColHeaders():0,r=o&&t.countRowHeaders()>0?-t.countRowHeaders():0;return 0===i&&(i=e.getVisualFromRenderableIndex(i)),0===r&&(r=n.getVisualFromRenderableIndex(r)),null===i||null===r?null:t._createCellCoords(i,r)}function BH(t){var e,n;const{rowIndexMapper:o,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings();let s=o.getRenderableIndexesLength()-1,l=i.getRenderableIndexesLength()-1;if(s<0){if(!r||0===t.countColHeaders())return null;s=-1}if(l<0){if(!r||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=o.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(n=i.getVisualFromRenderableIndex(l))&&void 0!==n?n:l)}const jH=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),zH=t=>t.map((t=>{const e=t.toLowerCase();return jH.has(e)?jH.get(e):e})).sort().join("+"),UH=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),YH=t=>{let{which:e,key:n}=t;if(UH.has(e))return UH.get(e);const o=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(o)?o:n.toLowerCase()},$H=Symbol("shortcut-context");function GH(t){return Cw(t)&&t.__kindOf===$H}const KH=["meta","alt","shift","control"],XH=function(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed:e=>t.has(e)}}(),qH=[];let ZH=0;const QH=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:o,afterKeyDown:i}=t;const r=Fy({errorIdExists:t=>`The "${t}" context name is already registered.`});let s="grid";const l=()=>s,a=t=>r.getItem(t);let h=!1;const c=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();const o=GH(n)?n:a(n);let i=!1;if(!o.hasShortcut(e))return i;const r=o.getShortcuts(e);for(let s=0;s<r.length;s++){const{callback:n,runOnlyIf:o,preventDefault:l,stopPropagation:a,captureCtrl:u,forwardToContext:d}=r[s];if(!0===o(t)){if(h=u,i=!1===n(t,e),h=!1,l&&t.preventDefault(),a&&(lb(t),t.stopPropagation()),i)break;d&&c(t,e,d)}}return i},u=function(t,e,n,o,i){const r=t=>KH.includes(t),s=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];return t.altKey&&n.push("alt"),e&&(t.ctrlKey||t.metaKey)?n.push("control/meta"):(t.ctrlKey&&n.push("control"),t.metaKey&&n.push("meta")),t.shiftKey&&n.push("shift"),n},l=t=>{if(!1===e(t))return;const l=n(t);if(229===t.keyCode||!1===l||ab(t))return;const a=YH(t);let h=[];r(a)||(h=s(t));const c=[a].concat(h);!i(t,c)&&(Qw()&&h.includes("meta")||!Qw()&&h.includes("control"))&&i(t,[a].concat(s(t,!0))),o(t)},a=t=>{if(t.key){const e=YH(t);r(e)&&XH.press(e)}},h=t=>{if(t.key){const e=YH(t);r(e)&&XH.release(e)}},c=()=>{XH.releaseAll()};return{mount:()=>{let e=t;for(ZH+=1;e;)1===ZH&&(e.document.documentElement.addEventListener("keydown",a),qH.push({event:"keydown",listener:a}),e.document.documentElement.addEventListener("keyup",h),qH.push({event:"keyup",listener:h})),e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("blur",c),e=Op(e)},unmount:()=>{let e=t;for(ZH-=1;e;){if(0===ZH){for(let t=0;t<qH.length;t++){const{event:n,listener:o}=qH[t];e.document.documentElement.removeEventListener(n,o)}qH.length=0}e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("blur",c),e=Op(e)}},isPressed:t=>XH.isPressed(t),releasePressedKeys:()=>XH.releaseAll()}}(e,n,o,i,c);return u.mount(),{addContext:t=>{const e=(t=>{const e=Fy({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:t,callback:n,group:o,runOnlyIf:i=()=>!0,captureCtrl:r=!1,preventDefault:s=!0,stopPropagation:l=!1,relativeToGroup:a,position:h,forwardToContext:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Zf(o))throw new Error("You need to define the shortcut's group.");if(!1===Hm(n))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(Kf(R||(R=j`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`)));const u={callback:n,group:o,runOnlyIf:i,captureCtrl:r,preventDefault:s,stopPropagation:l};qf(a)&&(u.relativeToGroup=a,u.position=h),GH(c)&&(u.forwardToContext=c),t.forEach((t=>{const n=zH(t);if(e.hasItem(n)){const t=e.getItem(n);let o=t.findIndex((t=>t.group===a));-1!==o?"before"===h?o-=1:o+=1:o=t.length,t.splice(o,0,u)}else e.addItem(n,[u])}))},o=t=>{const n=zH(t);e.removeItem(n)};return{__kindOf:$H,addShortcut:n,addShortcuts:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((t=>{Rw(e,((n,o)=>{!1===Object.prototype.hasOwnProperty.call(t,o)&&(t[o]=e[o])})),n(t)}))},getShortcuts:t=>{const n=zH(t),o=e.getItem(n);return qf(o)?o.slice():[]},hasShortcut:t=>{const n=zH(t);return e.hasItem(n)},removeShortcutsByKeys:o,removeShortcutsByGroup:t=>{e.getItems().forEach((e=>{let[n,i]=e;const r=i.filter((e=>e.group!==t));0===r.length?o((t=>t.split("+"))(n)):(i.length=0,i.push(...r))}))}}})(t);return r.addItem(t,e),e},getActiveContextName:l,getContext:a,setActiveContextName:t=>{if(!r.hasItem(t))throw new Error(Kf(x||(x=j`You've tried to activate the "${0}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`),t));s=t},isCtrlPressed:()=>!h&&(u.isPressed("control")||u.isPressed("meta")),releasePressedKeys:()=>u.releasePressedKeys(),destroy:()=>u.unmount()}};let JH=null;const tI=new Map;function eI(t,e){var n,o=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;const s=new pv(r);let l,a,h,c,u,d,g=!0;var f;oE(i)&&(f=this,eE.set(f,!0)),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=null!==(n=null==e?void 0:e.layoutDirection)&&void 0!==n?n:"inherit",m=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return"rtl"===m},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1},e.language=function(t){let e=mM(t);return rk(e)||(e=QT,wM(t)),e}(e.language);const w=new LA(r,e,[WA,YA]),b=w.getTableMeta(),v=w.getGlobalMeta(),y=Fy();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),iE(this)&&hp(e.licenseKey,t),this.guid=`ht_${dp()}`,tI.set(this.guid,this),this.columnIndexMapper=new pM,this.rowIndexMapper=new pM,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(t=>{r.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(t=>{r.runHooks("afterRowSequenceChange",t)})),a=new HE(r),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let C=new sA(b,{rowIndexMapper:r.rowIndexMapper,columnIndexMapper:r.columnIndexMapper,countCols:()=>r.countCols(),countRows:()=>r.countRows(),propToCol:t=>l.propToCol(t),isEditorOpened:()=>!!r.getActiveEditor()&&r.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return o.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return o.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>r.getShortcutManager(),createCellCoords:(t,e)=>r._createCellCoords(t,e),createCellRange:(t,e,n)=>r._createCellRange(t,e,n),visualToRenderableCoords:t=>{const{row:e,col:n}=t;return r._createCellCoords(e>=0?r.rowIndexMapper.getRenderableFromVisualIndex(e):e,n>=0?r.columnIndexMapper.getRenderableFromVisualIndex(n):n)},renderableToVisualCoords:t=>{const{row:e,col:n}=t;return r._createCellCoords(e>=0?r.rowIndexMapper.getVisualFromRenderableIndex(e):e,n>=0?r.columnIndexMapper.getVisualFromRenderableIndex(n):n)},findFirstNonHiddenRenderableRow:(t,e)=>{const n=e>t?1:-1,o=Math.min(t,e),i=Math.max(t,e),s=r.rowIndexMapper.getNearestNotHiddenIndex(t,n);return null===s||1===n&&s>i||-1===n&&s<o?null:s>=0?r.rowIndexMapper.getRenderableFromVisualIndex(s):s},findFirstNonHiddenRenderableColumn:(t,e)=>{const n=e>t?1:-1,o=Math.min(t,e),i=Math.max(t,e),s=r.columnIndexMapper.getNearestNotHiddenIndex(t,n);return null===s||1===n&&s>i||-1===n&&s<o?null:s>=0?r.columnIndexMapper.getRenderableFromVisualIndex(s):s},isDisabledCellSelection:(t,e)=>t<0||e<0?r.getSettings().disableVisualSelection:r.getCellMeta(t,e).disableVisualSelection});this.selection=C;const S=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.commit()};function R(t){const e=mM(t);rk(e)?(r.runHooks("beforeLanguageChange",e),v.language=e,r.runHooks("afterLanguageChange",e)):wM(t)}function x(t,e){const n="className"===t?r.rootElement:r.table;if(g)Bp(n,e);else{let o=[],i=[];v[t]&&(o=Array.isArray(v[t])?v[t]:$f(v[t])),e&&(i=Array.isArray(e)?e:$f(e));const r=Yf(o,i),s=Yf(i,o);r.length&&jp(n,r),s.length&&Bp(n,s)}v[t]=e}function E(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function M(t){const e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function T(t,e,n){if(!t.length)return void n();const o=r.getActiveEditor(),i=new E;let s=!0;i.onQueueEmpty=()=>{o&&s&&o.cancelChanges(),n()};for(let a=t.length-1;a>=0;a--){const[n,o,,h]=t[a],c=l.propToCol(o);let u;u=Number.isInteger(c)?r.getCellMeta(n,c):$($({},Object.getPrototypeOf(b)),b),"numeric"===u.type&&"string"==typeof h&&ky(h)&&(t[a][3]=M(h)),r.getCellValidator(u)&&(i.addValidatorToQueue(),r.validateCell(t[a][3],u,function(e,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");!1===o&&!1===n.allowInvalid&&(s=!1,t.splice(e,1),n.valid=!0),i.removeValidatorFormQueue()}}(a,u),e))}i.checkIfQueueIsEmpty()}function k(t,e){for(let o=t.length-1;o>=0;o--){let n=!1;if(null!==t[o]){if(null!==t[o][2]&&void 0!==t[o][2]||null!==t[o][3]&&void 0!==t[o][3]){if(b.allowInsertRow)for(;t[o][0]>r.countRows()-1;){const{delta:t}=l.createRow(void 0,void 0,{source:e});if(0===t){n=!0;break}}if("array"===r.dataType&&(!b.columns||0===b.columns.length)&&b.allowInsertColumn)for(;l.propToCol(t[o][1])>r.countCols()-1;){const{delta:t}=l.createCol(void 0,void 0,{source:e});if(0===t){n=!0;break}}n||l.set(t[o][0],t[o][1],t[o][3])}}else t.splice(o,1)}const n=t.length>0;if(r.forceFullRender=!0,n){h.adjustRowsAndCols(),r.runHooks("beforeChangeRender",t,e),c.closeEditor(),r.view.render(),c.prepareEditor(),r.view.adjustElementsSize(),r.runHooks("afterChange",t,e||"edit");const n=r.getActiveEditor();n&&qf(n.refreshValue)&&n.refreshValue()}else r.view.render()}function A(t,e,n){return Array.isArray(t)?t:[[t,e,n]]}function H(t,e){const n=r.getActiveEditor(),o=r.runHooks("beforeChange",t,e||"edit"),i=t.filter((t=>null!==t));return!1===o||0===i.length?(n&&n.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",S),this.rowIndexMapper.addLocalHook("cacheUpdated",S),this.selection.addLocalHook("afterSetRangeEnd",((t,e)=>{const n=Tw(!1),o=this.selection.getSelectedRange(),{from:i,to:s}=o.current(),l=o.size()-1;this.runHooks("afterSelection",i.row,i.col,s.row,s.col,n,l),this.runHooks("afterSelectionByProp",i.row,r.colToProp(i.col),s.row,r.colToProp(s.col),n,l),e&&(!n.isTouched()||n.isTouched()&&!n.value)&&d.scrollTo(t);const a=C.isSelectedByRowHeader(),h=C.isSelectedByColumnHeader();a&&h?Bp(this.rootElement,["ht__selection--rows","ht__selection--columns"]):a?(jp(this.rootElement,"ht__selection--columns"),Bp(this.rootElement,"ht__selection--rows")):h?(jp(this.rootElement,"ht__selection--rows"),Bp(this.rootElement,"ht__selection--columns")):jp(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==C.getSelectionSource()&&c.closeEditor(null),r.view.render(),c.prepareEditor()})),this.selection.addLocalHook("beforeSetFocus",(t=>{this.runHooks("beforeSelectionFocusSet",t.row,t.col)})),this.selection.addLocalHook("afterSetFocus",(t=>{const e=Tw(!1);this.runHooks("afterSelectionFocusSet",t.row,t.col,e),(!e.isTouched()||e.isTouched()&&!e.value)&&d.scrollTo(t),c.closeEditor(),r.view.render(),c.prepareEditor()})),this.selection.addLocalHook("afterSelectionFinished",(t=>{const e=t.length-1,{from:n,to:o}=t[e];this.runHooks("afterSelectionEnd",n.row,n.col,o.row,o.col,e),this.runHooks("afterSelectionEndByProp",n.row,r.colToProp(n.col),o.row,r.colToProp(o.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(t=>{const e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("afterDeselect",(()=>{c.closeEditor(),r.view.render(),jp(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSetRangeStart",...e)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSetRangeStartOnly",...e)})).addLocalHook("beforeSetRangeEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSetRangeEnd",...e)})).addLocalHook("beforeSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSelectColumns",...e)})).addLocalHook("afterSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("afterSelectColumns",...e)})).addLocalHook("beforeSelectRows",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeSelectRows",...e)})).addLocalHook("afterSelectRows",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("afterSelectRows",...e)})).addLocalHook("beforeModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("modifyTransformStart",...e)})).addLocalHook("afterModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("afterModifyTransformStart",...e)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("modifyTransformFocus",...e)})).addLocalHook("afterModifyTransformFocus",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("afterModifyTransformFocus",...e)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("modifyTransformEnd",...e)})).addLocalHook("afterModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("afterModifyTransformEnd",...e)})).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeRowWrap",...e)})).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runHooks("beforeColumnWrap",...e)})).addLocalHook("insertRowRequire",(t=>this.alter("insert_row_above",t,1,"auto"))).addLocalHook("insertColRequire",(t=>this.alter("insert_col_start",t,1,"auto"))),h={alter(t,e){var n,o;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const u=t=>{if(0===t.length)return[];const e=[...t];e.sort(((t,e)=>{let[n]=t,[o]=e;return n===o?0:n>o?1:-1}));return Ff(e,((t,e)=>{let[n,o]=e;const i=t[t.length-1],[r,s]=i,l=r+s;if(n<=l){const t=Math.max(o-(l-n),0);i[1]+=t}else t.push([n,o]);return t}),[e[0]])};switch(t){case"insert_row_below":case"insert_row_above":const a=r.countSourceRows();if(b.maxRows===a)return;const h="insert_row_below"===t?"below":"above";e=null!==(n=e)&&void 0!==n?n:"below"===h?a:0;const{delta:d,startPhysicalIndex:g}=l.createRow(e,i,{source:s,mode:h});C.shiftRows(r.toVisualRow(g),d);break;case"insert_col_start":case"insert_col_end":const f="insert_col_end"===t?"end":"start";e=null!==(o=e)&&void 0!==o?o:"end"===f?r.countSourceCols():0;const{delta:p,startPhysicalIndex:m}=l.createCol(e,i,{source:s,mode:f});if(p){if(Array.isArray(b.colHeaders)){const t=[r.toVisualColumn(m),0];t.length+=p,Array.prototype.splice.apply(b.colHeaders,t)}C.shiftColumns(r.toVisualColumn(m),p)}break;case"remove_row":const w=t=>{let e=0;jf(t,(t=>{let[n,o]=t;const i=Qf(n)?r.countRows()-1:Math.max(n-e,0);Number.isInteger(n)&&(n=Math.max(n-e,0));if(!l.removeRow(n,o,s))return;if(C.isSelected()){const{row:t}=r.getSelectedRangeLast().highlight;t>=n&&t<=n+o-1&&c.closeEditor(!0)}const a=r.countRows();0===a?C.deselect():"ContextMenu.removeRow"===s?C.refresh():C.shiftRows(n,-o);const h=b.fixedRowsTop;h>=i+1&&(b.fixedRowsTop-=Math.min(o,h-i));const u=b.fixedRowsBottom;u&&i>=a-u&&(b.fixedRowsBottom-=Math.min(o,u)),e+=o}))};Array.isArray(e)?w(u(e)):w([[e,i]]);break;case"remove_col":const v=t=>{let e=0;jf(t,(t=>{let[n,o]=t;const i=Qf(n)?r.countCols()-1:Math.max(n-e,0);let a=r.toPhysicalColumn(i);Number.isInteger(n)&&(n=Math.max(n-e,0));if(!l.removeCol(n,o,s))return;if(C.isSelected()){const{col:t}=r.getSelectedRangeLast().highlight;t>=n&&t<=n+o-1&&c.closeEditor(!0)}0===r.countCols()?C.deselect():"ContextMenu.removeColumn"===s?C.refresh():C.shiftColumns(n,-o);const h=b.fixedColumnsStart;h>=i+1&&(b.fixedColumnsStart-=Math.min(o,h-i)),Array.isArray(b.colHeaders)&&(void 0===a&&(a=-1),b.colHeaders.splice(a,o)),e+=o}))};Array.isArray(e)?v(u(e)):v([[e,i]]);break;default:throw new Error(`There is no such action "${t}"`)}r.view.render(),a||h.adjustRowsAndCols()},adjustRowsAndCols(){const t=b.minRows,e=b.minSpareRows,n=b.minCols,o=b.minSpareCols;if(t){const e=r.countRows();e<t&&l.createRow(e,t-e,{source:"auto"})}if(e){const t=r.countEmptyRows(!0);if(t<e){const n=e-t,o=Math.min(n,b.maxRows-r.countSourceRows());l.createRow(r.countRows(),o,{source:"auto"})}}{let t;(n||o)&&(t=r.countEmptyCols(!0));let e=r.countCols();if(n&&!b.columns&&e<n){const o=n-e;t+=o,l.createCol(e,o,{source:"auto"})}if(o&&!b.columns&&"array"===r.dataType&&t<o){e=r.countCols();const n=o-t,i=Math.min(n,b.maxCols-e);l.createCol(e,i,{source:"auto"})}}r.view&&r.view.adjustElementsSize()},populateFromArray(t,e,n,o,i){let s,l,a,h;const c=[],u={},d=[],g=t.row,f=t.col;if(l=e.length,0===l)return!1;let p=0,m=0;switch(Cw(n)&&(p=n.col-f+1,m=n.row-g+1),i){case"shift_down":const i=Vf(e),w=i.length,v=Math.max(w,p),y=r.getData().slice(g),C=Vf(y).slice(f,f+v);for(a=0;a<v;a+=1)if(a<w){for(s=0,l=i[a].length;s<m-l;s+=1)i[a].push(i[a][s%l]);a<C.length?d.push(i[a].concat(C[a])):d.push(i[a].concat(new Array(y.length).fill(null)))}else d.push(i[a%w].concat(C[a]));r.populateFromArray(g,f,Vf(d));break;case"shift_right":const S=e.length,R=Math.max(S,m),x=r.getData().slice(g).map((t=>t.slice(f)));for(s=0;s<R;s+=1)if(s<S){for(a=0,h=e[s].length;a<p-h;a+=1)e[s].push(e[s][a%h]);if(s<x.length)for(let t=0;t<x[s].length;t+=1)e[s].push(x[s][t]);else e[s].push(...new Array(x[0].length).fill(null))}else e.push(e[s%l].slice(0,R).concat(x[s]));r.populateFromArray(g,f,e);break;default:u.row=t.row,u.col=t.col;let E,M=0,T=0,k=!0;const A=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=e[t%e.length];return null!==n?o[n%o.length]:o},H=e.length,I=n?n.row-t.row+1:0;for(l=n?I:Math.max(H,I),s=0;s<l&&!(n&&u.row>n.row&&I>H||!b.allowInsertRow&&u.row>r.countRows()-1||u.row>=b.maxRows);s++){const e=s-M,i=A(e).length,d=n?n.col-t.col+1:0;if(h=n?d:Math.max(i,d),u.col=t.col,E=r.getCellMeta(u.row,u.col),"CopyPaste.paste"!==o&&"Autofill.fill"!==o||!E.skipRowOnPaste){for(T=0,a=0;a<h&&!(n&&u.col>n.col&&d>i||!b.allowInsertColumn&&u.col>r.countCols()-1||u.col>=b.maxCols);a++){if(E=r.getCellMeta(u.row,u.col),("CopyPaste.paste"===o||"Autofill.fill"===o)&&E.skipColumnOnPaste){T+=1,u.col+=1,h+=1;continue}if(E.readOnly&&"UndoRedo.undo"!==o){u.col+=1;continue}let t=A(e,a-T),n=r.getDataAtCell(u.row,u.col);if(null!==t&&"object"==typeof t)if(Array.isArray(t)&&null===n&&(n=[]),null===n||"object"!=typeof n)k=!1;else{const e=gw(Array.isArray(n)?n:n[0]||n),o=gw(Array.isArray(t)?t:t[0]||t);yw(e,o)||Array.isArray(e)&&Array.isArray(o)?t=ww(t):k=!1}else null!==n&&"object"==typeof n&&(k=!1);k&&c.push([u.row,u.col,t]),k=!0,u.col+=1}u.row+=1}else M+=1,u.row+=1,l+=1}r.setDataAtCell(c,null,null,o||"populateFromArray")}}},this.init=function(){a.setData(b.data),r.runHooks("beforeInit"),(Kw()||qw())&&Bp(r.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new CE(this),c=xv.getInstance(r,b,C),d=function(t){const{selection:e}=t;let n=!1,o=!1;return{resume(){o=!1},suspend(){o=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var r;if(n||o)return void(n=!1);let s;e.isFocusSelectionChanged()?s=function(t){return e=>{t.scrollViewportTo(e.toObject())}}(t):e.isSelectedByCorner()?s=()=>{}:e.isSelectedByRowHeader()?s=function(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}(t):e.isSelectedByColumnHeader()?s=function(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}(t):1===e.getSelectedRange().size()&&e.isMultiple()?s=function(t){return e=>{t.scrollViewportTo(e.toObject())}}(t):1!==e.getSelectedRange().size()||e.isMultiple()?e.getSelectedRange().size()>1&&(s=function(t){return e=>{t.scrollViewportTo(e.toObject())}}(t)):s=function(t){return e=>{const n=t.selection.getSelectionSource(),{row:o,col:i}=e;if(o<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&o>=0)t.scrollViewportTo({row:o});else{if("mouse"===n&&(i===t.view.getLastPartiallyVisibleColumn()||o===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:o,col:i})}}}(t),null===(r=s)||void 0===r||r(i)}}}(r),u=new Lv(r),iE(this)&&FH(r),r.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&null===r.rootElement.offsetParent&&Em(r.rootElement,(()=>{r.view._wt.wtOverlays.updateLastSpreaderSize(),r.render(),r.view.adjustElementsSize()})),"object"==typeof g&&(r.runHooks("afterChange",g[0],g[1]),g=!1),r.runHooks("afterInit")},this._createCellCoords=function(t,e){return r.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,n){return r.view._wt.createCellRange(t,e,n)},this.validateCell=function(t,e,n,o){let i=r.getCellValidator(e);function s(t){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===e.hidden)return void n(t);const o=e.visualCol,i=e.visualRow,s=r.getCell(i,o,!0);if(s&&"TH"!==s.nodeName){const t=r.rowIndexMapper.getRenderableFromVisualIndex(i),e=r.columnIndexMapper.getRenderableFromVisualIndex(o);r.view._wt.getSetting("cellRenderer",t,e,s)}n(t)}var l;Jf(i)&&(l=i,i=function(t,e){e(l.test(t))}),Hm(i)?(t=r.runHooks("beforeValidate",t,e.visualRow,e.prop,o),r._registerImmediate((()=>{i.call(e,t,(n=>{r&&(n=r.runHooks("afterValidate",n,t,e.visualRow,e.prop,o),e.valid=n,s(n),r.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,o))}))}))):r._registerImmediate((()=>{e.valid=!0,s(e.valid,!1)}))},this.setDataAtCell=function(t,e,n,o){const i=A(t,e,n),s=[];let h,c,u,d=o;for(h=0,c=i.length;h<c;h++){if("object"!=typeof i[h])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof i[h][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=i[h][1]>=this.countCols()?i[h][1]:l.colToProp(i[h][1]),s.push([i[h][0],u,a.getAtCell(this.toPhysicalRow(i[h][0]),i[h][1]),i[h][2]])}d||"object"!=typeof t||(d=e);const g=H(s,o);r.runHooks("afterSetDataAtCell",g,d),T(g,d,(()=>{k(g,d)}))},this.setDataAtRowProp=function(t,e,n,o){const i=A(t,e,n),s=[];let l,h,c=o;for(l=0,h=i.length;l<h;l++)s.push([i[l][0],i[l][1],a.getAtCell(this.toPhysicalRow(i[l][0]),i[l][1]),i[l][2]]);c||"object"!=typeof t||(c=e);const u=H(s,o);r.runHooks("afterSetDataAtRowProp",u,c),T(u,c,(()=>{k(u,c)}))},this.listen=function(){r&&!r.isListening()&&(tI.forEach((t=>{r!==t&&t.unlisten()})),JH=r.guid,r.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(JH=null,r.runHooks("afterUnlisten"))},this.isListening=function(){return JH===r.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c.closeEditor(t),r.view.render(),e&&C.isSelected()&&c.prepareEditor()},this.populateFromArray=function(t,e,n,o,i,s,l){if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"==typeof o?r._createCellCoords(o,i):null;return h.populateFromArray(r._createCellCoords(t,e),n,a,s,l)},this.spliceCol=function(t,e,n){for(var o=arguments.length,i=new Array(o>3?o-3:0),r=3;r<o;r++)i[r-3]=arguments[r];return l.spliceCol(t,e,n,...i)},this.spliceRow=function(t,e,n){for(var o=arguments.length,i=new Array(o>3?o-3:0),r=3;r<o;r++)i[r-3]=arguments[r];return l.spliceRow(t,e,n,...i)},this.getSelected=function(){if(C.isSelected())return Bf(C.getSelectedRange(),(t=>{let{from:e,to:n}=t;return[e.row,e.col,n.row,n.col]}))},this.getSelectedLast=function(){const t=this.getSelected();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(C.isSelected())return Array.from(C.getSelectedRange())},this.getSelectedRangeLast=function(){const t=this.getSelectedRange();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(t){if(!C.isSelected()||0===this.countRows()||0===this.countCols())return;const e=[];jf(C.getSelectedRange(),(t=>{if(t.isSingleHeader())return;const n=t.getTopStartCorner(),o=t.getBottomEndCorner();Ay(n.row,o.row,(t=>{Ay(n.col,o.col,(n=>{this.getCellMeta(t,n).readOnly||e.push([t,n,null])}))}))})),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():r.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||r.view.render())},this.batchRender=function(t){this.suspendRender();const e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const n=t();return this.resumeExecution(e),n},this.batch=function(t){this.suspendRender(),this.suspendExecution();const e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!r.view)return;const{width:t,height:e}=r.view.getLastSize(),{width:n,height:o}=r.rootElement.getBoundingClientRect(),i=n!==t||o!==e;!1===r.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:n,height:o},i)||((i||r.view._wt.wtOverlays.scrollableElement===r.rootWindow)&&(r.view.setLastSize(n,o),r.render()),r.runHooks("afterRefreshDimensions",{width:t,height:e},{width:n,height:o},i))},this.updateData=function(t,e){VA(t,(t=>{l=t}),(t=>{l=t,r.columnIndexMapper.fitToLength(this.getInitialColumnCount()),r.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols(),C.refresh()}),{hotInstance:r,dataMap:l,dataSource:a,internalSource:"updateData",source:e,metaManager:w,firstRun:g})},this.loadData=function(t,e){VA(t,(t=>{l=t}),(()=>{w.clearCellsCache(),r.initIndexMappers(),h.adjustRowsAndCols(),C.refresh(),g&&(g=[null,"loadData"])}),{hotInstance:r,dataMap:l,dataSource:a,internalSource:"loadData",source:e,metaManager:w,firstRun:g})},this.getInitialColumnCount=function(){const t=b.columns;let e=0;if(Array.isArray(t))e=t.length;else if(Hm(t))if("array"===r.dataType){const n=this.countSourceCols();for(let o=0;o<n;o+=1)t(o)&&(e+=1)}else"object"!==r.dataType&&"function"!==r.dataType||(e=l.colToPropCache.length);else if(qf(b.dataSchema)){const t=l.getSchema();e=Array.isArray(t)?t.length:Mw(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,n,o){return Zf(t)?l.getAll():l.getRange(r._createCellCoords(t,e),r._createCellCoords(n,o),l.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,o){return l.getCopyableText(r._createCellCoords(t,e),r._createCellCoords(n,o))},this.getCopyableData=function(t,e){return l.getCopyable(t,l.colToProp(e))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(g?r.loadData:r.updateData).bind(this);let o,i,s=!1;if(qf(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(qf(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(qf(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(o in t)"data"===o||("language"===o?R(t.language):"className"===o?x("className",t.className):"tableClassName"===o&&r.table?(x("tableClassName",t.tableClassName),r.view._wt.wtOverlays.syncOverlayTableClassNames()):tv.getSingleton().isRegistered(o)||tv.getSingleton().isDeprecated(o)?(Hm(t[o])||Array.isArray(t[o]))&&(t[o].initialHook=!0,r.addHook(o,t[o])):!e&&kw(t,o)&&(v[o]=t[o]));void 0===t.data&&void 0===b.data?n(null,"updateSettings"):void 0!==t.data?n(t.data,"updateSettings"):void 0!==t.columns&&(l.createMap(),r.initIndexMappers());const a=r.countCols(),c=b.columns;if(c&&Hm(c)&&(s=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||w.clearCache(),a>0)for(o=0,i=0;o<a;o++){if(c){const t=s?c(o):c[i];t&&w.updateColumnMeta(i,t)}i+=1}qf(t.cell)&&Rw(t.cell,(t=>{r.setCellMetaObject(t.row,t.col,t)})),r.runHooks("afterCellMetaReset");let u=r.rootElement.style.height;""!==u&&(u=parseInt(r.rootElement.style.height,10));let d=t.height;if(Hm(d)&&(d=d()),e){r.rootElement.getAttribute("style")&&r.rootElement.setAttribute("data-initialstyle",r.rootElement.getAttribute("style"))}if(null===d){const t=r.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?r.rootElement.setAttribute("style",t):(r.rootElement.style.height="",r.rootElement.style.overflow="")}else void 0!==d&&(r.rootElement.style.height=isNaN(d)?`${d}`:`${d}px`,r.rootElement.style.overflow="hidden");if(void 0!==t.width){let e=t.width;Hm(e)&&(e=e()),r.rootElement.style.width=isNaN(e)?`${e}`:`${e}px`}e||(r.view&&(r.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),r.view._wt.exportSettingsAsClassNames()),r.runHooks("afterUpdateSettings",t)),h.adjustRowsAndCols(),r.view&&!g&&(r.forceFullRender=!0,r.view.render(),r.view._wt.wtOverlays.adjustElementsSize()),e||!r.view||""!==u&&""!==d&&void 0!==d||u===d||r.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const t=r.getSelectedLast();if(b.getValue){if(Hm(b.getValue))return b.getValue.call(r);if(t)return r.getData()[t[0][0]][b.getValue]}else if(t)return r.getDataAtCell(t[0],t[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,o,i){h.alter(t,e,n,o,i)},this.getCell=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e,i=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;o=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===i||null===o||void 0===i||void 0===o?null:r.view.getCellAtCoords(r._createCellCoords(i,o),n)},this.getCoords=function(t){const e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;const{row:n,col:o}=e;let i=n,s=o;return n>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(n)),o>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(o)),r._createCellCoords(i,s)},this.colToProp=function(t){return l.colToProp(t)},this.propToCol=function(t){return l.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return l.get(t,l.colToProp(e))},this.getDataAtRowProp=function(t,e){return l.get(t,e)},this.getDataAtCol=function(t){const e=[],n=l.getRange(r._createCellCoords(0,t),r._createCellCoords(b.data.length-1,t),l.DESTINATION_RENDERER);for(let o=0;o<n.length;o+=1)for(let t=0;t<n[o].length;t+=1)e.push(n[o][t]);return e},this.getDataAtProp=function(t){const e=[],n=l.getRange(r._createCellCoords(0,l.propToCol(t)),r._createCellCoords(b.data.length-1,l.propToCol(t)),l.DESTINATION_RENDERER);for(let o=0;o<n.length;o+=1)for(let t=0;t<n[o].length;t+=1)e.push(n[o][t]);return e},this.getSourceData=function(t,e,n,o){let i;return i=void 0===t?a.getData():a.getByRange(r._createCellCoords(t,e),r._createCellCoords(n,o)),i},this.getSourceDataArray=function(t,e,n,o){let i;return i=void 0===t?a.getData(!0):a.getByRange(r._createCellCoords(t,e),r._createCellCoords(n,o),!0),i},this.getSourceDataAtCol=function(t){return a.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,n,o){const i=A(t,e,n),s=this.hasHook("afterSetSourceDataAtCell"),l=[];s&&jf(i,(t=>{let[e,n,o]=t;l.push([e,n,a.getAtCell(e,n),o])})),jf(i,(t=>{let[e,n,o]=t;a.setAtCell(e,n,o)})),s&&this.runHooks("afterSetSourceDataAtCell",l,o),this.render();const h=r.getActiveEditor();h&&qf(h.refreshValue)&&h.refreshValue()},this.getSourceDataAtRow=function(t){return a.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return a.getAtCell(t,e)},this.getDataAtRow=function(t){return l.getRange(r._createCellCoords(t,0),r._createCellCoords(t,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,o){const i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,o],[r,s]=i;let[,,l,a]=i,h=null,c=null;void 0===l&&(l=r),void 0===a&&(a=s);let u="mixed";return Ay(Math.max(Math.min(r,l),0),Math.max(r,l),(t=>{let e=!0;return Ay(Math.max(Math.min(s,a),0),Math.max(s,a),(n=>{const o=this.getCellMeta(t,n);return c=o.type,h?e=h===c:h=c,e})),u=e?c:"mixed",e})),u},this.removeCellMeta=function(t,e,n){const[o,i]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)];let s=w.getCellMetaKeyValue(o,i,n);!1!==r.runHooks("beforeRemoveCellMeta",t,e,n,s)&&(w.removeCellMeta(o,i,n),r.runHooks("afterRemoveCellMeta",t,e,n,s)),s=null},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&w.removeRow(this.toPhysicalRow(t),e),o.length>0&&jf(o.reverse(),(e=>{w.createRow(this.toPhysicalRow(t)),jf(e,((e,n)=>this.setCellMetaObject(t,n,e)))})),r.render()},this.setCellMetaObject=function(t,e,n){"object"==typeof n&&Rw(n,((n,o)=>{this.setCellMeta(t,e,o,n)}))},this.setCellMeta=function(t,e,n,o){if(!1===r.runHooks("beforeSetCellMeta",t,e,n,o))return;let i=t,s=e;t<this.countRows()&&(i=this.toPhysicalRow(t)),e<this.countCols()&&(s=this.toPhysicalColumn(e)),w.setCellMeta(i,s,n,o),r.runHooks("afterSetCellMeta",t,e,n,o)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(t,e){let n=this.toPhysicalRow(t),o=this.toPhysicalColumn(e);return null===n&&(n=t),null===o&&(o=e),w.getCellMeta(n,o,{visualRow:t,visualColumn:e})},this.getColumnMeta=function(t){return w.getColumnMeta(this.toPhysicalColumn(t))},this.getCellMetaAtRow=function(t){return w.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===r.dataType||b.columns)},this.getCellRenderer=function(t,e){const n="number"==typeof t?r.getCellMeta(t,e).renderer:t.renderer;return"string"==typeof n?Jy(n):Zf(n)?Jy("text"):n},this.getCellEditor=function(t,e){const n="number"==typeof t?r.getCellMeta(t,e).editor:t.editor;return"string"==typeof n?uv(n):Zf(n)?uv("text"):n},this.getCellValidator=function(t,e){const n="number"==typeof t?r.getCellMeta(t,e).validator:t.validator;return"string"==typeof n?sC(n):n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){const o=new E;t&&(o.onQueueEmpty=t);let i=r.countRows()-1;for(;i>=0;){if(void 0!==e&&-1===e.indexOf(i)){i-=1;continue}let t=r.countCols()-1;for(;t>=0;)void 0===n||-1!==n.indexOf(t)?(o.addValidatorToQueue(),r.validateCell(r.getDataAtCell(i,t),r.getCellMeta(i,t),(t=>{if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(o.valid=!1),o.removeValidatorFormQueue()}),"validateCells"),t-=1):t-=1;i-=1}o.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=b.rowHeaders,n=t;return void 0!==n&&(n=r.runHooks("modifyRowHeader",n)),void 0===n?(e=[],Ay(r.countRows()-1,(t=>{e.push(r.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[n]?e=e[n]:Hm(e)?e=e(n):e&&"string"!=typeof e&&"number"!=typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(void 0!==b.colHeaders&&null!==b.colHeaders)return!!b.colHeaders;for(let t=0,e=r.countCols();t<e;t++)if(r.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=r.runHooks("modifyColHeader",t);if(void 0===n){const t=[],e=r.countCols();for(let n=0;n<e;n++)t.push(r.getColHeader(n));return t}let o=b.colHeaders;const i=r.toPhysicalColumn(n),s=function(t){const e=[],n=r.countCols();let o=0;for(;o<n;o++)Hm(b.columns)&&b.columns(o)&&e.push(o);return e[t]}(i);return!1===b.colHeaders?o=null:b.columns&&Hm(b.columns)&&b.columns(s)&&b.columns(s).title?o=b.columns(s).title:b.columns&&b.columns[i]&&b.columns[i].title?o=b.columns[i].title:Array.isArray(b.colHeaders)&&void 0!==b.colHeaders[i]?o=b.colHeaders[i]:Hm(b.colHeaders)?o=b.colHeaders(i):b.colHeaders&&"string"!=typeof b.colHeaders&&"number"!=typeof b.colHeaders&&(o=RE(n)),o=r.runHooks("modifyColumnHeaderValue",o,t,e),o},this._getColWidthFromSettings=function(t){let e;if(t>=0){e=r.getCellMeta(0,t).width}if(void 0!==e&&e!==b.width||(e=b.colWidths),null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){let e=r._getColWidthFromSettings(t);return e=r.runHooks("modifyColWidth",e,t),void 0===e&&(e=50),e},this._getRowHeightFromSettings=function(t){let e=b.rowHeights;if(null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){let e=r._getRowHeightFromSettings(t);return e=r.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return a.countRows()},this.countSourceCols=function(){return a.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const t=b.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Hy(r.countRows()-1,(n=>{if(r.isEmptyRow(n))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Hy(r.countCols()-1,(n=>{if(r.isEmptyCol(n))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return b.isEmptyRow.call(r,t)},this.isEmptyCol=function(t){return b.isEmptyCol.call(r,t)},this.selectCell=function(t,e,n,o){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Zf(t)&&!Zf(e)&&this.selectCells([[t,e,n,o]],i,r)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&d.suspend();const n=C.selectCells(t);return n&&e&&r.listen(),d.resume(),n},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;return C.selectColumns(t,e,n)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;return C.selectRows(t,e,n)},this.deselectCell=function(){C.deselect()},this.selectAll=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),C.selectAll(t,e,n)};const I=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);this.scrollViewportTo=function(t){var e,n;"number"==typeof t&&(t={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(n=arguments[4])||void 0===n||n});const{row:o,col:i,verticalSnap:s,horizontalSnap:l,considerHiddenIndexes:a}=null!==(e=t)&&void 0!==e?e:{};let h,c,u,d;void 0!==s&&(h="top"===s,c=!h),void 0!==l&&(u="start"===l,d=!u);let g=o,f=i;if(void 0===a||a){const t=Number.isInteger(o)&&o>=0,e=Number.isInteger(i)&&i>=0,n=t?I(this.rowIndexMapper,o):void 0,s=e?I(this.columnIndexMapper,i):void 0;if(null===n||null===s)return!1;g=t?r.rowIndexMapper.getRenderableFromVisualIndex(n):o,f=e?r.columnIndexMapper.getRenderableFromVisualIndex(s):i}const p=Number.isInteger(g),m=Number.isInteger(f);return p&&g>=0&&m&&f>=0?r.view.scrollViewport(r._createCellCoords(g,f),h,d,c,u):p&&g>=0&&(m&&f<0||!m)?r.view.scrollViewportVertically(g,h,c):!!(m&&f>=0&&(p&&g<0||!p))&&r.view.scrollViewportHorizontally(f,d,u)},this.scrollToFocusedCell=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",t);const{highlight:e}=this.getSelectedRangeLast();this.scrollViewportTo(e.toObject())?this.view.render():(this.removeHook("afterScroll",t),this._registerImmediate((()=>t())))},this.destroy=function(){if(r._clearTimeouts(),r._clearImmediates(),r.view&&r.view.destroy(),a&&a.destroy(),a=null,this.getShortcutManager().destroy(),w.clearCache(),tI.delete(this.guid),iE(r)){const t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}$p(r.rootElement),s.destroy(),c&&c.destroy(),r.batchExecution((()=>{r.rowIndexMapper.unregisterAll(),r.columnIndexMapper.unregisterAll(),y.getItems().forEach((t=>{let[,e]=t;e.destroy()})),y.clear(),r.runHooks("afterDestroy")}),!0),tv.getSingleton().destroy(r),Rw(r,((t,e,n)=>{var o;Hm(t)?n[e]=(o=e,()=>{throw new Error(`The "${o}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==e&&(n[e]=null)})),r.isDestroyed=!0,l&&l.destroy(),l=null,h=null,C=null,c=null,r=null},this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return r.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return r.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return r.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return r.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return r.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return r.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return r.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return r.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return r.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return r.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return r.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return r.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(t){const e=up(t);return"UndoRedo"===e?this.undoRedo:y.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:y.getId(t)},this.getInstance=function(){return r},this.addHook=function(t,e,n){tv.getSingleton().add(t,e,r,n)},this.hasHook=function(t){return tv.getSingleton().has(t,r)||tv.getSingleton().has(t)},this.addHookOnce=function(t,e,n){tv.getSingleton().once(t,e,r,n)},this.removeHook=function(t,e){tv.getSingleton().remove(t,e,r)},this.runHooks=function(t,e,n,o,i,s,l){return tv.getSingleton().run(r,t,e,n,o,i,s,l)},this.getTranslatedPhrase=function(t,e){return sk(b.language,t,e)},this.toHTML=()=>Ry(this),this.toTableElement=()=>{const t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",Ry(this)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){let e=t;"function"==typeof e&&(e=setTimeout(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(e)},this._clearTimeouts=function(){jf(this.timeouts,(t=>{clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){jf(this.immediates,(t=>{clearImmediate(t)}))},this._getEditorManager=function(){return c},this.isRtl=function(){return"rtl"===r.rootWindow.getComputedStyle(r.rootElement).direction},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1};const O=QH({handleEvent:()=>r.isListening(),beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||r.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});var _;this.addHook("beforeOnCellMouseDown",(t=>{!1===t.ctrlKey&&!1===t.metaKey&&O.releasePressedKeys()})),this.getShortcutManager=function(){return O},this.getFocusManager=function(){return u},Yy().forEach((t=>{const e=$y(t);y.addItem(t,new e(this))})),_=r,[LH,DH].forEach((t=>t(_))),O.setActiveContextName("grid"),tv.getSingleton().run(r,"construct")}function nI(t,e,n){t.addEventListener(e,n,!1)}function oI(t,e,n){t.removeEventListener(e,n,!1)}function iI(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function rI(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,o=t.createTextNode(""),i=t.createElement("span");let r;function s(){o.textContent=r.value,i.style.position="absolute",i.style.fontSize=iI(r).fontSize,i.style.fontFamily=iI(r).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const t=i.clientWidth+2;n.removeChild(i);const s=r.style;s.height=`${e.minHeight}px`,e.minWidth>t?s.width=`${e.minWidth}px`:t>e.maxWidth?s.width=`${e.maxWidth}px`:s.width=`${t}px`;const l=r.scrollHeight?r.scrollHeight-1:0;e.minHeight>l?s.height=`${e.minHeight}px`:e.maxHeight<l?(s.height=`${e.maxHeight}px`,s.overflowY="visible"):s.height=`${l}px`}function l(){t.defaultView.setTimeout(s,0)}return{init:function(t,n){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r=t,function(t){if(t&&t.minHeight)if("inherit"===t.minHeight)e.minHeight=r.clientHeight;else{const n=parseInt(t.minHeight,10);isNaN(n)||(e.minHeight=n)}if(t&&t.maxHeight)if("inherit"===t.maxHeight)e.maxHeight=r.clientHeight;else{const n=parseInt(t.maxHeight,10);isNaN(n)||(e.maxHeight=n)}if(t&&t.minWidth)if("inherit"===t.minWidth)e.minWidth=r.clientWidth;else{const n=parseInt(t.minWidth,10);isNaN(n)||(e.minWidth=n)}if(t&&t.maxWidth)if("inherit"===t.maxWidth)e.maxWidth=r.clientWidth;else{const n=parseInt(t.maxWidth,10);isNaN(n)||(e.maxWidth=n)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))}(n),"TEXTAREA"===r.nodeName&&(r.style.resize="none",r.style.height=`${e.minHeight}px`,r.style.minWidth=`${e.minWidth}px`,r.style.maxWidth=`${e.maxWidth}px`,r.style.overflowY="hidden"),a&&(nI(r,"input",s),nI(r,"keydown",l)),s()},resize:s,unObserve(){oI(r,"input",s),oI(r,"keydown",l)}}}function sI(t,e){const n=dm(e),o=e.value.split("\n");let i=n,r=0;for(let s=0;s<o.length;s++){const e=o[s];0!==s&&(r+=o[s-1].length+1);const l=r+e.length;if("home"===t?i=r:"end"===t&&(i=l),n<=l)break}pm(e,i)}function lI(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const aI="ht_editor_hidden",hI="textEditor";class cI extends JA{static get EDITOR_TYPE(){return"text"}constructor(t){super(t),lI(this,"eventManager",new pv(this)),lI(this,"autoResize",rI(this.hot.rootDocument)),lI(this,"TEXTAREA",void 0),lI(this,"textareaStyle",void 0),lI(this,"TEXTAREA_PARENT",void 0),lI(this,"textareaParentStyle",void 0),lI(this,"layerClass",void 0),this.eventManager=new pv(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Hp(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,n,o,i,r){const s=this.state;if(super.prepare(t,e,n,o,i,r),!r.readOnly){this.refreshDimensions(!0);const{allowInvalid:t}=r;t&&!this.isOpened()&&(this.TEXTAREA.value=""),s===QA.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(t,e){this.state===QA.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),pm(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),zp(this.TEXTAREA,[["data-hot-input",""],bp(-1)]),Bp(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Bp(this.TEXTAREA_PARENT,"handsontableInputHolder"),Wp(this.TEXTAREA_PARENT,this.layerClass)&&jp(this.TEXTAREA_PARENT,this.layerClass),Bp(this.TEXTAREA_PARENT,aI),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Gw()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",jp(this.TEXTAREA_PARENT,this.layerClass),Bp(this.TEXTAREA_PARENT,aI)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const t=this.TEXTAREA_PARENT.childNodes;let e=!1;Ay(t.length-1,(n=>{if(Wp(t[n],"handsontableEditor"))return e=!0,!1})),Wp(this.TEXTAREA_PARENT,aI)&&jp(this.TEXTAREA_PARENT,aI),e?(this.layerClass="ht_editor_visible",Bp(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Bp(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==QA.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD)return void(t||this.close());const{top:e,start:n,width:o,maxWidth:i,height:r,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=lm(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const a=lm(this.TEXTAREA),h=parseInt(a.paddingLeft,10)+parseInt(a.paddingRight,10),c=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10),u=o-h,d=r-c,g=i-h,f=s-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(u,g),minHeight:Math.min(d,f),maxWidth:g,maxHeight:f},!0)}bindEvents(){Xw()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===QA.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===QA.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),e={runOnlyIf:()=>qf(this.hot.getSelected()),group:hI},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[n]=e;sI(n,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[n]=e;sI(n,this.TEXTAREA)}}],e)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(hI)}}function uI(t,e,n,o,i,r,s){const l=s.ariaTags,a=[],h=[],c=[],u=[];s.className&&Bp(e,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&u.push(["aria-readonly","true"])):l&&c.push("aria-readonly"),!1===s.valid&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&u.push(["aria-invalid","true"])):(h.push(s.invalidCellClassName),l&&c.push("aria-invalid")),!1===s.wordWrap&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!r&&s.placeholder&&a.push(s.placeholderCellClassName),jp(e,h),Bp(e,a),Up(e,c),zp(e,u)}uI.RENDERER_TYPE="base";function dI(t,e,n,o,i,r,s){uI.apply(this,[t,e,n,o,i,r,s]);let l=r;if(!l&&s.placeholder&&(l=s.placeholder),l=Xf(l),s.trimWhitespace&&(l=l.trim()),s.rendererTemplate){$p(e);const o=t.rootDocument.createElement("TEMPLATE");o.setAttribute("bind","{{}}"),o.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(o),o.model=t.getSourceDataAtRow(n),e.appendChild(o)}else Xp(e,l)}dI.RENDERER_TYPE="text";const gI={CELL_TYPE:"text",editor:cI,renderer:dI};function fI(t,e){const n=new eI(t,e||{},nE);return n.init(),n}function pI(t,e,n){return e=vI(e),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,CI()?Reflect.construct(e,n||[],vI(t).constructor):e.apply(t,n))}function mI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wI(t,e,n){return e&&function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,EI(o.key),o)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function bI(t,e,n){return(e=EI(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vI(t){return vI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vI(t)}function yI(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xI(t,e)}function CI(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(CI=function(){return!!t})()}function SI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function RI(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?SI(Object(n),!0).forEach((function(e){bI(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):SI(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function xI(t,e){return xI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xI(t,e)}function EI(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function MI(t){return MI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MI(t)}yA(gI),fI.editors={BaseEditor:JA},fI.Core=function(t){return new eI(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},nE)},fI.DefaultSettings=EA(),fI.hooks=tv.getSingleton(),fI.CellCoords=YC,fI.CellRange=QC,fI.packageName="handsontable",fI.buildDate="17/10/2024 09:16:16",fI.version="14.6.1",fI.languages={dictionaryKeys:ZT,getLanguageDictionary:ik,getLanguagesDictionaries:function(){return nk()},registerLanguageDictionary:ok,getTranslatedPhrase:sk};var TI=Symbol("unassigned"),kI=null;function AI(t){var e=fI.hooks.getRegistered(),n={};for(var o in Object.assign(n,fI.DefaultSettings),n)n[o]={default:TI};for(var i=0;i<e.length;i++)n[e[i]]={default:TI};return n.settings={default:TI},"HotTable"===t&&(n.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},n.wrapperRendererCacheSize={type:Number,default:3e3}),n}function HI(t){var e={},n=t.settings;if(n!==TI)for(var o in n)n.hasOwnProperty(o)&&n[o]!==TI&&(e[o]=n[o]);for(var i in t)t.hasOwnProperty(i)&&"settings"!==i&&t[i]!==TI&&(e[i]=t[i]);return e}function II(t,e){var n=HI(t),o=t.settings?t.settings:n,i=t.settings?n:null,r={};for(var s in o)!o.hasOwnProperty(s)||void 0===o[s]||e&&"data"!==s&&PI(e[s],o[s])||(r[s]=o[s]);for(var l in i)!i.hasOwnProperty(l)||"id"===l||"settings"===l||"wrapperRendererCacheSize"===l||void 0===i[l]||e&&"data"!==l&&PI(e[l],i[l])||(r[l]=i[l]);return r}function OI(t,e){var n=null;return t.every((function(t,o){return!t.data||!t.data.attrs||void 0===t.data.attrs[e]||(n=t,!1)})),n}function _I(t,e,n,o){var i=e.$el?e.$el.ownerDocument:document,r={propsData:n,parent:e,data:o};kI||((kI=i.createElement("DIV")).id="vueHotComponents",i.body.appendChild(kI));var s=i.createElement("DIV");return kI.appendChild(s),new t.componentOptions.Ctor(r).$mount(s)}function PI(t,e){var n=function(t){var e,n=(e=new WeakSet,function(t,n){if("object"===MI(n)&&null!==n){if(e.has(n))return;e.add(n)}return n});return JSON.stringify(t,n)};return"function"==typeof t&&"function"==typeof e?t.toString()===e.toString():MI(t)===MI(e)&&n(t)===n(e)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var NI={};!function(t){!function(t){var e=Symbol("newer"),n=Symbol("older");function o(t,e){"number"!=typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function i(t,o){this.key=t,this.value=o,this[e]=void 0,this[n]=void 0}t.LRUMap=o,o.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][n]=t[n]),t[n]&&(t[n][e]=t[e]),t[e]=void 0,t[n]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},o.prototype.assign=function(t){var o,r=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var s=t[Symbol.iterator](),l=s.next();!l.done;l=s.next()){var a=new i(l.value[0],l.value[1]);if(this._keymap.set(a.key,a),o?(o[e]=a,a[n]=o):this.oldest=a,o=a,0==r--)throw new Error("overflow")}this.newest=o,this.size=this._keymap.size},o.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},o.prototype.set=function(t,o){var r=this._keymap.get(t);return r?(r.value=o,this._markEntryAsUsed(r),this):(this._keymap.set(t,r=new i(t,o)),this.newest?(this.newest[e]=r,r[n]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)},o.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[n]=void 0,this._keymap.delete(t.key),--this.size,[t.key,t.value]},o.prototype.has=function(t){return this._keymap.has(t)}}(t)}(NI);var DI={name:"HotTable",props:AI("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new NI.LRUMap(this.wrapperRendererCacheSize);return e.shift=function(){var t=NI.LRUMap.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return II(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var t,e=this.getGlobalRendererVNode(),n=this.getGlobalEditorVNode(),o=II(this.$props);o.columns=this.columnSettings?this.columnSettings:o.columns,n&&(o.editor=this.getEditorClass(n,this),n.child.$destroy()),e&&(o.renderer=this.getRendererWrapper(e,this),e.child.$destroy()),this.hotInstance=new fI.Core(this.$el,o),this.hotInstance.init(),(t=this).hotInstance&&(t.hotInstance.addHook("beforeChange",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateCol",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveCol",(function(){t.__internalEdit=!0}))),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,n=this.hotInstance.getSourceData(),o=[],i=[],r=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),l=0;if(n&&n.length!==r&&n.length<r)for(var a=n.length;a<r;a++)o.push(a);if(s)if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&(null===(e=n[0])||void 0===e?void 0:e.length)!==l&&n[0].length<l)for(var h=n[0].length;h<l;h++)i.push(h);this.hotInstance.batch((function(){o.length>0?t.hotInstance.rowIndexMapper.removeIndexes(o):t.hotInstance.rowIndexMapper.insertIndexes(r-1,n.length-r),s&&0!==n.length&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(l-1,n[0].length-l))}))}},getGlobalRendererVNode:function(){return OI(this.$slots.default||[],"hot-renderer")},getGlobalEditorVNode:function(){return OI(this.$slots.default||[],"hot-editor")},getColumnSettings:function(){var t=this.$children.filter((function(t){return"HotColumn"===t.$options.name})),e=!1,n=t.map((function(t){return t.usesRendererComponent&&(e=!0),RI({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(t,e){var n=this;return function(o,i,r,s,l,a,h){if(i&&!i.getAttribute("ghost-table")){var c=n.rendererCache,u={hotInstance:o,TD:i,row:r,col:s,prop:l,value:a,cellProperties:h,isRenderer:!0};if(c&&!c.has("".concat(r,"-").concat(s))){var d=_I(t,e,t.componentOptions.propsData,u);c.set("".concat(r,"-").concat(s),{component:d,lastUsedTD:null})}var g=c.get("".concat(r,"-").concat(s)),f=g.component,p=g.lastUsedTD;if(Object.assign(f.$data,u),!f.$el.parentElement||p!==i){for(;i.firstChild;)i.removeChild(i.firstChild);i.appendChild(f.$el),g.lastUsedTD=i}}return i}},getEditorClass:function(t,e){var n=t.key?t.key.toString():null,o=t.componentOptions.Ctor.options.name,i=n?"".concat(o,":").concat(n):o,r=this.editorCache,s=null;return r.has(i)?s=r.get(i):(s=_I(t,e,t.componentOptions.propsData,{isEditor:!0}),r.set(i,s)),s.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:"14.6.1"};function LI(t,e,n,o,i,r,s,l,a,h){const c="function"==typeof n?n.options:n;return t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),n}var VI=LI({render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{attrs:{id:t.id}},[t._t("default")],2)},staticRenderFns:[]},0,DI,0,false);function FI(t){return FI="function"==typeof Symbol&&"symbol"===MI(Symbol.iterator)?function(t){return MI(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":MI(t)},FI(t)}function WI(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function BI(t,e,n){(n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e)).forEach((function(o){var i=n?Reflect.getOwnMetadata(o,e,n):Reflect.getOwnMetadata(o,e);n?Reflect.defineMetadata(o,i,t,n):Reflect.defineMetadata(o,i,t)}))}AI("HotColumn"),"function"==typeof SuppressedError&&SuppressedError;var jI={__proto__:[]}instanceof Array;var zI=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function UI(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(t){if("constructor"!==t)if(zI.indexOf(t)>-1)e[t]=n[t];else{var o=Object.getOwnPropertyDescriptor(n,t);void 0!==o.value?"function"==typeof o.value?(e.methods||(e.methods={}))[t]=o.value:(e.mixins||(e.mixins=[])).push({data:function(){return function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t,o.value)}}):(o.get||o.set)&&((e.computed||(e.computed={}))[t]={get:o.get,set:o.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return function(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var o in t.$options.props)t.hasOwnProperty(o)||n.push(o);n.forEach((function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},configurable:!0})}))};var o=new e;e.prototype._init=n;var i={};return Object.keys(o).forEach((function(t){void 0!==o[t]&&(i[t]=o[t])})),i}(this,t)}});var o=t.__decorators__;o&&(o.forEach((function(t){return t(e)})),delete t.__decorators__);var i=Object.getPrototypeOf(t.prototype),r=i instanceof X?i.constructor:X,s=r.extend(e);return function(t,e,n){Object.getOwnPropertyNames(e).forEach((function(o){if(!YI[o]){var i=Object.getOwnPropertyDescriptor(t,o);if(!i||i.configurable){var r,s,l=Object.getOwnPropertyDescriptor(e,o);if(!jI){if("cid"===o)return;var a=Object.getOwnPropertyDescriptor(n,o);if(r=l.value,s=FI(r),null!=r&&("object"===s||"function"===s)&&a&&a.value===l.value)return}Object.defineProperty(t,o,l)}}}))}(s,t,r),"undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys&&function(t,e){BI(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(n){BI(t.prototype,e.prototype,n)})),Object.getOwnPropertyNames(e).forEach((function(n){BI(t,e,n)}))}(s,t),s}var YI={prototype:!0,arguments:!0,callee:!0,caller:!0};function $I(t){return"function"==typeof t?UI(t):function(e){return UI(e,t)}}$I.registerHooks=function(t){zI.push.apply(zI,WI(t))};var GI=function(t){function e(){var t;return mI(this,e),(t=pI(this,e,arguments)).name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return yI(e,t),wI(e,[{key:"mounted",value:function(){var t,e=this;this.$data.hotCustomEditorClass=(t=function(t){function n(t){var o;return mI(this,n),o=pI(this,n,[t]),e.$data.hotCustomEditorInstance=o,o}return yI(n,t),wI(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(fI.editors.BaseEditor),Object.getOwnPropertyNames(fI.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(t.prototype[n]=function(){for(var t,o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(t=e[n]).call.apply(t,[this].concat(i))})})),t)}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];(t=fI.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(t,e,n,o,i,r){return this.$data.hotInstance=r.instance,this.$data.row=t,this.$data.col=e,this.$data.prop=n,this.$data.TD=o,this.$data.originalValue=i,this.$data.cellProperties=r,fI.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,e,n,o,i,r)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=fI.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}}])}(X);GI=function(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}([$I({})],GI),(()=>{if(!window.matchMedia)return{value:q(null)};const t=q(window.matchMedia("(prefers-color-scheme: dark)").matches);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>t.value=e.matches))})();const KI={create:()=>rt().defaults((()=>new Worker(new URL(""+new URL("xlsx.worker-cd94d320.js",G.meta.url).href,self.location),{type:"module"})))},XI={create:()=>rt().defaults((()=>new Worker(new URL(""+new URL("sheet.worker-2ecfdf72.js",G.meta.url).href,self.location),{type:"module"})))},qI="handsontableEditor";class ZI extends cI{static get EDITOR_TYPE(){return"handsontable"}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),pm(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r);const s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(t,e){const n=this.getSourceData(e.row,e.col);void 0!==n&&s.setValue(n),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&pw(l,r.handsontable),this.htOptions=l}beginEditing(t,e){const n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(t,e)}createElements(){super.createElements();const t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,n)}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()}))}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const e={group:qI,relativeToGroup:GA,position:"before"},n=(t,e)=>{const n=this.htEditor;if(void 0!==t&&(t<0||n.flipped&&t>n.countRows()-1?n.deselectCell():n.selectCell(t,0),n.getData().length))return e.preventDefault(),lb(e),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{const e=this.htEditor;let o,i;return!e.getSelectedLast()&&e.flipped?o=e.countRows()-1:e.getSelectedLast()&&(e.flipped?(i=e.getSelectedLast()[0],o=Math.max(0,i-1)):(i=e.getSelectedLast()[0],o=i-1)),n(o,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{const e=this.htEditor;let o,i;if(e.getSelectedLast()||e.flipped){if(e.getSelectedLast())if(e.flipped)o=e.getSelectedLast()[0]+1;else if(!e.flipped){const t=e.countRows()-1;i=e.getSelectedLast()[0],o=Math.min(t,i+1)}}else o=0;return n(o,t)},preventDefault:!1}],e)}unregisterShortcuts(){super.unregisterShortcuts();this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(qI)}}function QI(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function JI(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tO(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var eO=new WeakMap;class nO extends ZI{constructor(){super(...arguments),JI(this,"query",null),JI(this,"strippedChoices",[]),JI(this,"rawChoices",[]),QI(this,eO,this.hot.guid.slice(0,9)),JI(this,"sortByRelevance",(function(t,e,n){const o=[],i=[],r=t.length;let s,l,a,h,c=e.length;if(0===r){for(a=0;a<c;a++)i.push(a);return i}for(a=0;a<c;a++){if(l=pp(Xf(e[a])),n)h=l.indexOf(t);else{const e=this.cellProperties.locale;h=l.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==h&&(s=l.length-h-r,o.push({baseIndex:a,index:h,charsLeft:s,value:l}))}for(o.sort(((t,e)=>{if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),a=0,c=o.length;a<c;a++)i.push(o[a].baseIndex);return i}))}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const t=this.rawChoices.find((t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value));return qf(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),Bp(this.htContainer,"autocompleteEditor"),Bp(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&zp(this.TEXTAREA,[["type","text"],["role","combobox"],yp("listbox"),["aria-autocomplete","list"]])}prepare(t,e,n,o,i,r){var s;super.prepare(t,e,n,o,i,r),this.hot.getSettings().ariaTags&&zp(this.TEXTAREA,[Ep("false"),(s=`${tO(eO,this)}-listbox-${t}-${e}`,["aria-controls",s])])}open(){super.open();const t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,o=null==n?void 0:n.length,{row:i,col:r}=this;this.showEditableElement(),this.focus();let s=wm();var l;0===s&&Qw()&&(s+=15),this.addHook("beforeKeyDown",(t=>this.onBeforeKeyDown(t))),this.htEditor.updateSettings({colWidths:t?[am(this.TEXTAREA)-2]:void 0,width:t?am(this.TEXTAREA)+s:void 0,autoColumnSize:!0,renderer:(t,i,r,s,l,a,h)=>{dI(t,i,r,s,l,a,h);const{filteringCaseSensitive:c,allowHtml:u,locale:d}=this.cellProperties,g=this.query;let f,p,m=Xf(a);var w;m&&!u&&(f=!0===c?m.indexOf(g):m.toLocaleLowerCase(d).indexOf(g.toLocaleLowerCase(d)),-1!==f&&(p=m.substr(f,g.length),m=m.replace(p,`<strong>${p}</strong>`))),e&&zp(i,[["role","option"],...n?[(w=o,["aria-setsize",w])]:[],...n?[kp(n.indexOf(a)+1)]:[],["id",`${this.htEditor.rootElement.id}_${r}-${s}`]]),i.innerHTML=m},afterSelectionEnd:(t,n)=>{if(e){const e=this.htEditor.getCell(t,n,!0);zp(e,[["aria-selected","true"]]),zp(this.TEXTAREA,...(o=e.id,["aria-activedescendant",o]))}var o}}),e&&(zp(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,"role","presentation"),zp(this.htEditor.rootElement,[["role","listbox"],(l="polite",["aria-live",l]),Tp("text"),["id",`${tO(eO,this)}-listbox-${i}-${r}`]]),zp(this.TEXTAREA,...Ep("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&zp(this.TEXTAREA,[Ep("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){const e=this.cellProperties.source;this.query=t,"function"==typeof e?e.call(this.cellProperties,t,(t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))})):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){const e=dm(this.TEXTAREA),n=gm(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let r=null,s=null,l=t;o&&(r=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const a=Array.isArray(r)?r.length:0;if(!1===i)a&&(s=r[0]);else{const t=[];for(let e=0,n=l.length;e<n&&!(o&&a<=e);e++)a?t.push(l[r[e]]):t.push(l[e]);s=0,l=t}this.strippedChoices=l,0===l.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Vf([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s)),this.hot.listen(),pm(this.TEXTAREA,e,e===n?void 0:n)}flipDropdownIfNeeded(){const t=rm(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(e||!e&&(n||"horizontal"===n))return!1;const o=Zp(this.TEXTAREA),i=hm(this.TEXTAREA),r=this.getDropdownHeight(),s=t.scrollTop,l=hm(this.hot.view._wt.wtTable.THEAD),a=Zp(t),h=o.top-a.top-l+s,c=t.scrollHeight-h-l-i,u=r>c&&h>c;return u?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(u?h:c,r),u}limitDropdownIfNeeded(t,e){if(e>t){let n=0,o=0,i=0,r=null;do{i=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=i,o+=1}while(n<t);r=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-r+"px"),this.setDropdownHeight(n-i)}}flipDropdown(t){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0}unflipDropdown(){const t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const t=this.htEditor.getColWidth(0)+wm(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const t=this.htEditor.getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){const{allowHtml:e}=this.cellProperties,n=Bf(t,(t=>Xf(t)));return Bf(n,(t=>e?t:pp(t)))}allowKeyEventPropagation(t){const e=this.htEditor.getSelectedRangeLast(),n=e?e.from.row:-1;let o=!1;return t===tb.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(o=!0),t===tb.ARROW_UP&&n>-1&&(o=!0),o}onBeforeKeyDown(t){if(nb(t.keyCode)||t.keyCode===tb.BACKSPACE||t.keyCode===tb.DELETE||t.keyCode===tb.INSERT){let e=10;if(t.keyCode===tb.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),e)}}}class oO extends JA{static get EDITOR_TYPE(){return"checkbox"}beginEditing(t,e){if(e&&"mouseup"===e.type&&"TD"===e.target.nodeName){const t=this.TD.querySelector('input[type="checkbox"]');Wp(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}
/*!
       * Pikaday
       *
       * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
       */const iO=()=>window,rO=()=>window.document,sO=(t,e)=>window.setTimeout(t,e),lO=function(t,e,n,o){t.addEventListener(e,n,!!o)},aO=function(t,e,n,o){t.removeEventListener(e,n,!!o)},hO=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},cO=function(t,e){hO(t,e)||(t.className=""===t.className?e:t.className+" "+e)},uO=function(t,e){var n;t.className=(n=(" "+t.className+" ").replace(" "+e+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,"")},dO=function(t){return/Array/.test(Object.prototype.toString.call(t))},gO=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},fO=function(t){let e=t.getDay();return 0===e||6===e},pO=function(t){return t%4==0&&t%100!=0||t%400==0},mO=function(t,e){return[31,pO(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},wO=function(t){gO(t)&&t.setHours(0,0,0,0)},bO=function(t,e){return t.getTime()===e.getTime()},vO=function(t,e,n){let o,i;for(o in e)i=void 0!==t[o],i&&"object"==typeof e[o]&&null!==e[o]&&void 0===e[o].nodeName?gO(e[o])?n&&(t[o]=new Date(e[o].getTime())):dO(e[o])?n&&(t[o]=e[o].slice(0)):t[o]=vO({},e[o],n):!n&&i||(t[o]=e[o]);return t},yO=function(t,e,n){let o=rO().createEvent("HTMLEvents");o.initEvent(e,!0,!1),o=vO(o,n),t.dispatchEvent(o)},CO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},SO={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},RO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},xO=function(t){let e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},EO=function(t,e,n,o,i){let r=new Date(o,n,e),s=t.hasMoment?t.moment(r).isoWeek():function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),o=t.getDay(),i=e,r=i-1,s=function(t){return(t+7-1)%7};t.setDate(n+r-s(o));let l=new Date(t.getFullYear(),0,i),a=(t.getTime()-l.getTime())/864e5;return 1+Math.round((a-r+s(l.getDay()))/7)}(r,i);return'<td class="pika-week">'+s+"</td>"},MO=function(t,e,n,o){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(o?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},TO=function(t,e,n,o,i,r){let s,l,a,h,c,u=t._o,d=n===u.minYear,g=n===u.maxYear,f='<div id="'+r+'" class="pika-title" role="heading" aria-live="polite">',p=!0,m=!0;for(a=[],s=0;s<12;s++)a.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===o?' selected="selected"':"")+(d&&s<u.minMonth||g&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(h='<div class="pika-label">'+u.i18n.months[o]+'<select class="pika-select pika-select-month" tabindex="-1">'+a.join("")+"</select></div>",dO(u.yearRange)?(s=u.yearRange[0],l=u.yearRange[1]+1):(s=n-u.yearRange,l=1+n+u.yearRange),a=[];s<l&&s<=u.maxYear;s++)s>=u.minYear&&a.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return c='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+a.join("")+"</select></div>",u.showMonthAfterYear?f+=c+h:f+=h+c,d&&(0===o||u.minMonth>=o)&&(p=!1),g&&(11===o||u.maxMonth<=o)&&(m=!1),0===e&&(f+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(f+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),f+"</div>"},kO=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+RO(t,e)+'">'+RO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"}(t)+("<tbody>"+e.join("")+"</tbody></table>")};function AO(t){let e=this,n=e.config(t);e._onMouseDown=function(t){if(!e._v)return;let o=(t=t||iO().event).target||t.srcElement;if(o)if(hO(o,"is-disabled")||(!hO(o,"pika-button")||hO(o,"is-empty")||hO(o.parentNode,"is-disabled")?hO(o,"pika-prev")?e.prevMonth():hO(o,"pika-next")&&e.nextMonth():(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&sO((function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()}),100))),hO(o,"pika-select"))e._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}},e._onChange=function(t){let n=(t=t||iO().event).target||t.srcElement;n&&(hO(n,"pika-select-month")?e.gotoMonth(n.value):hO(n,"pika-select-year")&&e.gotoYear(n.value))},e._onKeyChange=function(t){if(t=t||iO().event,e.isVisible())switch(t.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null)}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let t=this.moment(n.field.value,n.format,n.formatStrict);return t&&t.isValid()?t.toDate():null}return new Date(Date.parse(n.field.value))},e._onInputChange=function(t){let n;t.firedBy!==e&&(n=e._parseFieldValue(),gO(n)&&e.setDate(n),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let t=rO().activeElement;do{if(hO(t,"pika-single"))return}while(t=t.parentNode);e._c||(e._b=sO((function(){e.hide()}),50)),e._c=!1},e._onClick=function(t){let o=(t=t||iO().event).target||t.srcElement,i=o;if(o){!hasEventListeners&&hO(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),lO(o,"change",e._onChange)));do{if(hO(i,"pika-single")||i===n.trigger)return}while(i=i.parentNode);e._v&&o!==n.trigger&&i!==n.trigger&&e.hide()}},e.el=rO().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),lO(e.el,"mousedown",e._onMouseDown,!0),lO(e.el,"touchend",e._onMouseDown,!0),lO(e.el,"change",e._onChange),n.keyboardInput&&lO(rO(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?rO().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),lO(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let o=n.defaultDate;gO(o)?n.setDefaultDate?e.setDate(o,!0):e.gotoDate(o):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",lO(n.trigger,"click",e._onInputClick),lO(n.trigger,"focus",e._onInputFocus),lO(n.trigger,"blur",e._onInputBlur)):this.show()}function HO(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}AO.prototype={config:function(t){this._o||(this._o=vO({},SO,!0));let e=vO(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,gO(e.minDate)||(e.minDate=!1),gO(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),dO(e.yearRange)){let t=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||SO.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,gO(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return gO(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",yO(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),!gO(t))return;let n=this._o.minDate,o=this._o.maxDate;gO(n)&&t<n?t=n:gO(o)&&t>o&&(t=o),this._d=new Date(t.getTime()),wO(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),yO(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(gO(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),o=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();o.setMonth(o.getMonth()+1),o.setDate(o.getDate()-1),e=i<n.getTime()||o.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n,o=this.getDate()||new Date,i=24*parseInt(e)*60*60*1e3;"add"===t?n=new Date(o.valueOf()+i):"subtract"===t&&(n=new Date(o.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=CO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=CO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(wO(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=SO.minDate,this._o.minYear=SO.minYear,this._o.minMonth=SO.minMonth,this._o.startRange=SO.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(wO(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=SO.maxDate,this._o.maxYear=SO.maxYear,this._o.maxMonth=SO.maxMonth,this._o.endRange=SO.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e,n=this._o,o=n.minYear,i=n.maxYear,r=n.minMonth,s=n.maxMonth,l="";this._y<=o&&(this._y=o,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let a=0;a<n.numberOfMonths;a++)e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),l+='<div class="pika-lendar">'+TO(this,a,this.calendars[a].year,this.calendars[a].month,this.calendars[0].year,e)+this.render(this.calendars[a].year,this.calendars[a].month,e)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&sO((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)},adjustPosition:function(){let t,e,n,o,i,r,s,l,a,h,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,o=iO().innerWidth||rO().documentElement.clientWidth,i=iO().innerHeight||rO().documentElement.clientHeight,r=rO().body.scrollTop||rO().documentElement.scrollTop,h=!0,c=!0,a=t.getBoundingClientRect(),s=a.left+iO().pageXOffset,l=a.bottom+iO().pageYOffset,(this._o.reposition&&s+e>o||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,h=!1),(this._o.reposition&&l+n>i+r||this._o.position.indexOf("top")>-1&&l-n-t.offsetHeight>0)&&(l=l-n-t.offsetHeight,c=!1),s<0&&(s=0),l<0&&(l=0),this.el.style.left=s+"px",this.el.style.top=l+"px",cO(this.el,h?"left-aligned":"right-aligned"),cO(this.el,c?"bottom-aligned":"top-aligned"),uO(this.el,h?"right-aligned":"left-aligned"),uO(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let o=this._o,i=new Date,r=mO(t,e),s=new Date(t,e,1).getDay(),l=[],a=[];wO(i),o.firstDay>0&&(s-=o.firstDay,s<0&&(s+=7));let h=0===e?11:e-1,c=11===e?0:e+1,u=0===e?t-1:t,d=11===e?t+1:t,g=mO(u,h),f=r+s,p=f;for(;p>7;)p-=7;f+=7-p;let m=!1;for(let w=0,b=0;w<f;w++){let n=new Date(t,e,w-s+1),f=!!gO(this._d)&&bO(n,this._d),p=bO(n,i),v=-1!==o.events.indexOf(n.toDateString()),y=w<s||w>=r+s,C=w-s+1,S=e,R=t,x=o.startRange&&bO(o.startRange,n),E=o.endRange&&bO(o.endRange,n),M=o.startRange&&o.endRange&&o.startRange<n&&n<o.endRange;y&&(w<s?(C=g+C,S=h,R=u):(C-=r,S=c,R=d));let T={day:C,month:S,year:R,hasEvent:v,isSelected:f,isToday:p,isDisabled:o.minDate&&n<o.minDate||o.maxDate&&n>o.maxDate||o.disableWeekends&&fO(n)||o.disableDayFn&&o.disableDayFn(n),isEmpty:y,isStartRange:x,isEndRange:E,isInRange:M,showDaysInNextAndPreviousMonths:o.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:o.enableSelectionDaysInNextAndPreviousMonths};o.pickWholeWeek&&f&&(m=!0),a.push(xO(T)),7==++b&&(o.showWeekNumber&&a.unshift(EO(this,w-s,e,t,o.firstWeekOfYearMinDays)),l.push(MO(a,o.isRTL,o.pickWholeWeek,m)),a=[],b=0,m=!1)}return kO(o,l,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),uO(this.el,"is-hidden"),this._o.bound&&(lO(rO(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let t=this._v;!1!==t&&(this._o.bound&&aO(rO(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),cO(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),aO(this.el,"mousedown",this._onMouseDown,!0),aO(this.el,"touchend",this._onMouseDown,!0),aO(this.el,"change",this._onChange),t.keyboardInput&&aO(rO(),"keydown",this._onKeyChange),t.field&&(aO(t.field,"change",this._onInputChange),t.bound&&(aO(t.trigger,"click",this._onInputClick),aO(t.trigger,"focus",this._onInputFocus),aO(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const IO="date",OO="dateEditor";class _O extends cI{constructor(){super(...arguments),HO(this,"defaultDateFormat","DD/MM/YYYY"),HO(this,"parentDestroyed",!1),HO(this,"$datePicker",null)}static get EDITOR_TYPE(){return IO}init(){super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Bp(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",(t=>{Wp(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()}))}destroyElements(){const t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(t),super.open(),e.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:OO})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{const t=this.hot._getEditorManager();t.closeEditor(),this.hot.view.render(),t.prepareEditor()}));this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(OO),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(t,e)}showDatepicker(t){const e=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),o=!!t&&ob(t.keyCode);let i;this.datePicker.style.display="block",this.$datePicker=new AO(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(kc),this.$datePicker._onInputFocus=function(){},this.originalValue?(i=this.originalValue,kc(i,e,!0).isValid()&&this.$datePicker.setMoment(kc(i,e),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),o||n||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,kc(i,e,!0).isValid()&&this.$datePicker.setMoment(kc(i,e),!0),o||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&mw(e,this.cellProperties.datePickerConfig);const n=e.onSelect,o=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.keyboardInput=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=kc(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),n&&n()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},e}refreshDimensions(t){var e;if(super.refreshDimensions(t),this.state!==QA.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper:n,columnIndexMapper:o}=this.hot,{wtOverlays:i}=this.hot.view._wt,{wtTable:r}=null!==(e=i.getParentOverlay(this.TD))&&void 0!==e?e:this.hot.view._wt,s=n.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleRow()),l=n.getVisualFromRenderableIndex(r.getLastPartiallyVisibleRow()),a=o.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleColumn()),h=o.getVisualFromRenderableIndex(r.getLastPartiallyVisibleColumn());if(this.row>=s&&this.row<=l&&this.col>=a&&this.col<=h){const t=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+hm(this.TD)}px`;let e=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?e+=t.right-am(this.datePicker):e+=t.left,this.datePickerStyle.left=`${e}px`}else this.hideDatepicker()}}class PO extends nO{static get EDITOR_TYPE(){return"dropdown"}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}tv.getSingleton().add("beforeValidate",(function(t,e,n){const o=this.propToCol(n);if(Number.isInteger(o)){const t=this.getCellMeta(e,o);t.editor===PO&&void 0===t.strict&&(t.filter=!1,t.strict=!0)}}));class NO extends cI{static get EDITOR_TYPE(){return"numeric"}}class DO extends cI{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,$p(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const LO="ht_editor_visible",VO="selectEditor";class FO extends JA{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",Bp(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Wp(this.select,LO)&&jp(this.select,LO),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r);const s=this.cellProperties.selectOptions;let l;l="function"==typeof s?this.prepareOptions(s(this.row,this.col,this.prop)):this.prepareOptions(s),$p(this.select),Rw(l,((t,e)=>{const n=this.hot.rootDocument.createElement("OPTION");n.value=e,Kp(n,t),this.select.appendChild(n)}))}prepareOptions(t){let e={};if(Array.isArray(t))for(let n=0,o=t.length;n<o;n++)e[t[n]]=t[n];else"object"==typeof t&&(e=t);return e}refreshValue(){const t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==QA.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:t,start:e,width:n,height:o}=this.getEditedCellRect(),i=this.select.style;i.height=`${o}px`,i.width=`${n}px`,i.top=`${t}px`,i[this.hot.isRtl()?"right":"left"]=`${e}px`,i.margin="0px",Bp(this.select,LO)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),e={group:VO};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],e)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(VO)}}class WO extends cI{static get EDITOR_TYPE(){return"time"}prepare(t,e,n,o,i,r){super.prepare(t,e,n,o,i,r),this.TEXTAREA.dir="ltr"}}function BO(t,e,n,o,i,r,s){uI.apply(this,[t,e,n,o,i,r,s]),Kp(e,null==r?"":r,!1)}BO.RENDERER_TYPE="html";function jO(t,e,n,o,i,r,s){const{rootDocument:l}=t,a=s.allowHtml?BO:dI,h=l.createElement("DIV"),c=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",c&&h.setAttribute("aria-hidden","true"),h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[t,e,n,o,i,r,s]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),Bp(e,"htAutocomplete"),!t.acArrowListener){const i=new pv(t);t.acArrowListener=function(i){Wp(i.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,o),e)},i.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}jO.RENDERER_TYPE="autocomplete";function zO(t,e,n,o,i,r,s){jO.apply(this,[t,e,n,o,i,r,s])}zO.RENDERER_TYPE="dropdown";const UO=new WeakMap,YO=new WeakMap,$O="data-row",GO="data-col",KO="checkboxRenderer",XO="checkbox";function qO(t,e,n,o,i,r,s){const{rootDocument:l}=t,a=t.getSettings().ariaTags;uI.apply(this,[t,e,n,o,i,r,s]),function(t){let e=YO.get(t);if(!e){const{rootElement:n}=t;e=new pv(t),e.addEventListener(n,"click",(e=>function(t,e){const{target:n}=t;if(!ZO(n))return;if(!n.hasAttribute($O)||!n.hasAttribute(GO))return;const o=parseInt(n.getAttribute($O),10),i=parseInt(n.getAttribute(GO),10),r=e.getCellMeta(o,i);r.readOnly&&t.preventDefault()}(e,t))),e.addEventListener(n,"mouseup",(e=>function(t,e){const{target:n}=t;if(!ZO(n))return;if(!n.hasAttribute($O)||!n.hasAttribute(GO))return;setTimeout(e.listen,10)}(e,t))),e.addEventListener(n,"change",(e=>function(t,e){const{target:n}=t;if(!ZO(n))return;if(!n.hasAttribute($O)||!n.hasAttribute(GO))return;const o=parseInt(n.getAttribute($O),10),i=parseInt(n.getAttribute(GO),10),r=e.getCellMeta(o,i);if(!r.readOnly){let n=null;n=t.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,e.setDataAtCell(o,i,n)}}(e,t))),YO.set(t,e)}}(t);let h=function(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(l);const c=s.label;let u=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),$p(e),r===s.checkedTemplate||Xf(r).toLocaleLowerCase(s.locale)===Xf(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:r===s.uncheckedTemplate||Xf(r).toLocaleLowerCase(s.locale)===Xf(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:Qf(r)?Bp(h,"noValue"):(h.style.display="none",Bp(h,"htBadValue"),u=!0),zp(h,[[$O,n],[GO,o]]),a&&zp(h,[vp(h.checked?t.getTranslatedPhrase(GT):t.getTranslatedPhrase(KT)),Mp(h.checked),["role","checkbox"]]),!u&&c){let s="";if(c.value)s="function"==typeof c.value?c.value.call(this,n,o,i,r):c.value;else if(c.property){const e=t.getDataAtRowProp(n,c.property);s=null!==e?e:""}const a=function(t,e,n){const o=t.createElement("label");return o.className="htCheckboxRendererLabel "+(n?"fullWidth":""),o.appendChild(t.createTextNode(e)),o.cloneNode(!0)}(l,s,!0!==c.separated);"before"===c.position?c.separated?(e.appendChild(a),e.appendChild(h)):(a.appendChild(h),h=a):c.position&&"after"!==c.position||(c.separated?(e.appendChild(h),e.appendChild(a)):(a.insertBefore(h,a.firstChild),h=a))}function d(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=t.getSelectedRange(),o=[],i=new Map;let r=[],s=0;if(n){for(let l=0;l<n.length;l++){const{row:a,col:h}=n[l].getTopStartCorner(),{row:c,col:u}=n[l].getBottomEndCorner();for(let n=a;n<=c;n+=1)for(let l=h;l<=u;l+=1){const a=t.getCellMeta(n,l),h={checkedTemplate:a.checkedTemplate,uncheckedTemplate:a.uncheckedTemplate};if("checkbox"!==a.type){!0!==e||a.readOnly||(i.has(o.length)?i.set(o.length,[...i.get(o.length),[n,l,null]]):i.set(o.length,[[n,l,null]]));continue}if(!0===a.readOnly)continue;void 0===a.checkedTemplate&&(a.checkedTemplate=!0),void 0===a.uncheckedTemplate&&(a.uncheckedTemplate=!1);const c=t.getDataAtCell(n,l);!1===e?[a.checkedTemplate,a.checkedTemplate.toString()].includes(c)?r.push([n,l,a.uncheckedTemplate,h]):[a.uncheckedTemplate,a.uncheckedTemplate.toString(),null,void 0].includes(c)&&r.push([n,l,a.checkedTemplate,h]):r.push([n,l,a.uncheckedTemplate,h]),s+=1}o.push(s),s=0}r=r.every((t=>{let[,,e]=t;return e===r[0][2]}))?r.map((t=>{let[e,n,o]=t;return[e,n,o]})):r.map((t=>{let[e,n,,o]=t;return[e,n,o.checkedTemplate]})),r.length>0&&o.forEach(((e,n)=>{let o=r.splice(0,e);i.size&&i.has(n)&&(o=[...o,...i.get(n)]),t.setDataAtCell(o)}))}}function g(){const e=t.getSelectedRange();if(e){for(let n=0;n<e.length;n++){const o=e[n].getTopStartCorner(),i=e[n].getBottomEndCorner();for(let e=o.row;e<=i.row;e++)for(let n=o.col;n<=i.col;n++){const o=t.getCellMeta(e,n),i=t.getCell(e,n);if(null==i)return!0;if(i.querySelectorAll("input[type=checkbox]").length>0&&!o.readOnly)return!0}}return!1}}(!c||c&&!c.separated)&&e.appendChild(h),u&&e.appendChild(l.createTextNode("#bad-value#")),UO.has(t)||(UO.set(t,!0),function(){const e=t.getShortcutManager().getContext("grid"),n={group:KO,relativeToGroup:GA,position:"before"};e.addShortcuts([{keys:[["space"]],callback:()=>(d(),!g()),runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!g()),runOnlyIf:()=>{const e=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(null==e?void 0:e.isSingle())&&e.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!g()),runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()}}],n)}())}function ZO(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}tv.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,n){const{label:o,type:i,row:r,column:s,prop:l}=e;if(i===XO){if(o){const{value:e,property:i}=o;let a=n;if(e)a="function"==typeof e?e(r,s,l,n):e;else if(i){const t=this.getDataAtRowProp(r,i);a=null!==t?t:n}t=a}return t}})),qO.RENDERER_TYPE=XO;function QO(t,e,n,o,i,r,s){jO.apply(this,[t,e,n,o,i,r,s])}QO.RENDERER_TYPE="handsontable";var JO={exports:{}};!function(t){t.exports=function t(e,n,o){function i(s,l){if(!n[s]){if(!e[s]){var a="function"==typeof st&&st;if(!l&&a)return a(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[s]={exports:{}};e[s][0].call(c.exports,(function(t){return i(e[s][1][t]||t)}),c,c.exports,t,e,n,o)}return n[s].exports}for(var r="function"==typeof st&&st,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e,n){!function(t){var n,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,r=Math.floor,s="[BigNumber Error] ",l=s+"Number primitive has more than 15 significant digits: ",a=1e14,h=14,c=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,g=1e9;function f(t){var e=0|t;return 0<t||t===e?e:e-1}function p(t){for(var e,n,o=1,i=t.length,r=t[0]+"";o<i;){for(e=t[o++]+"",n=h-e.length;n--;e="0"+e);r+=e}for(i=r.length;48===r.charCodeAt(--i););return r.slice(0,i+1||1)}function m(t,e){var n,o,i=t.c,r=e.c,s=t.s,l=e.s,a=t.e,h=e.e;if(!s||!l)return null;if(n=i&&!i[0],o=r&&!r[0],n||o)return n?o?0:-l:s;if(s!=l)return s;if(n=s<0,o=a==h,!i||!r)return o?0:!i^n?1:-1;if(!o)return h<a^n?1:-1;for(l=(a=i.length)<(h=r.length)?a:h,s=0;s<l;s++)if(i[s]!=r[s])return i[s]>r[s]^n?1:-1;return a==h?0:h<a^n?1:-1}function w(t,e,n,o){if(t<e||n<t||t!==(t<0?i(t):r(t)))throw Error(s+(o||"Argument")+("number"==typeof t?t<e||n<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function b(t){var e=t.c.length-1;return f(t.e/h)==e&&t.c[e]%2!=0}function v(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function y(t,e,n){var o,i;if(e<0){for(i=n+".";++e;i+=n);t=i+t}else if(++e>(o=t.length)){for(i=n,e-=o;--e;i+=n);t+=i}else e<o&&(t=t.slice(0,e)+"."+t.slice(e));return t}(n=function t(e){var n,C,S,R,x,E,M,T,k,A,H=z.prototype={constructor:z,toString:null,valueOf:null},I=new z(1),O=20,_=4,P=-7,N=21,D=-1e7,L=1e7,V=!1,F=1,W=0,B={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},j="0123456789abcdefghijklmnopqrstuvwxyz";function z(t,e){var n,i,s,a,u,d,g,f,p=this;if(!(p instanceof z))return new z(t,e);if(null==e){if(t instanceof z)return p.s=t.s,p.e=t.e,void(p.c=(t=t.c)?t.slice():t);if((d="number"==typeof t)&&0*t==0){if(p.s=1/t<0?(t=-t,-1):1,t===~~t){for(a=0,u=t;10<=u;u/=10,a++);return p.e=a,void(p.c=[t])}f=String(t)}else{if(f=String(t),!o.test(f))return S(p,f,d);p.s=45==f.charCodeAt(0)?(f=f.slice(1),-1):1}-1<(a=f.indexOf("."))&&(f=f.replace(".","")),0<(u=f.search(/e/i))?(a<0&&(a=u),a+=+f.slice(u+1),f=f.substring(0,u)):a<0&&(a=f.length)}else{if(w(e,2,j.length,"Base"),f=String(t),10==e)return G(p=new z(t instanceof z?t:f),O+p.e+1,_);if(d="number"==typeof t){if(0*t!=0)return S(p,f,d,e);if(p.s=1/t<0?(f=f.slice(1),-1):1,z.DEBUG&&15<f.replace(/^0\.0*|\./,"").length)throw Error(l+t);d=!1}else p.s=45===f.charCodeAt(0)?(f=f.slice(1),-1):1;for(n=j.slice(0,e),a=u=0,g=f.length;u<g;u++)if(n.indexOf(i=f.charAt(u))<0){if("."==i){if(a<u){a=g;continue}}else if(!s&&(f==f.toUpperCase()&&(f=f.toLowerCase())||f==f.toLowerCase()&&(f=f.toUpperCase()))){s=!0,u=-1,a=0;continue}return S(p,String(t),d,e)}-1<(a=(f=C(f,e,10,p.s)).indexOf("."))?f=f.replace(".",""):a=f.length}for(u=0;48===f.charCodeAt(u);u++);for(g=f.length;48===f.charCodeAt(--g););if(f=f.slice(u,++g)){if(g-=u,d&&z.DEBUG&&15<g&&(c<t||t!==r(t)))throw Error(l+p.s*t);if(L<(a=a-u-1))p.c=p.e=null;else if(a<D)p.c=[p.e=0];else{if(p.e=a,p.c=[],u=(a+1)%h,a<0&&(u+=h),u<g){for(u&&p.c.push(+f.slice(0,u)),g-=h;u<g;)p.c.push(+f.slice(u,u+=h));f=f.slice(u),u=h-f.length}else u-=g;for(;u--;f+="0");p.c.push(+f)}}else p.c=[p.e=0]}function U(t,e,n,o){var i,r,s,l,a;if(null==n?n=_:w(n,0,8),!t.c)return t.toString();if(i=t.c[0],s=t.e,null==e)a=p(t.c),a=1==o||2==o&&(s<=P||N<=s)?v(a,s):y(a,s,"0");else if(r=(t=G(new z(t),e,n)).e,l=(a=p(t.c)).length,1==o||2==o&&(e<=r||r<=P)){for(;l<e;a+="0",l++);a=v(a,r)}else if(e-=s,a=y(a,r,"0"),l<r+1){if(0<--e)for(a+=".";e--;a+="0");}else if(0<(e+=r-l))for(r+1==l&&(a+=".");e--;a+="0");return t.s<0&&i?"-"+a:a}function Y(t,e){for(var n,o=1,i=new z(t[0]);o<t.length;o++){if(!(n=new z(t[o])).s){i=n;break}e.call(i,n)&&(i=n)}return i}function $(t,e,n){for(var o=1,i=e.length;!e[--i];e.pop());for(i=e[0];10<=i;i/=10,o++);return(n=o+n*h-1)>L?t.c=t.e=null:t.c=n<D?[t.e=0]:(t.e=n,e),t}function G(t,e,n,o){var s,l,c,d,g,f,p,m=t.c,w=u;if(m){t:{for(s=1,d=m[0];10<=d;d/=10,s++);if((l=e-s)<0)l+=h,c=e,p=(g=m[f=0])/w[s-c-1]%10|0;else if((f=i((l+1)/h))>=m.length){if(!o)break t;for(;m.length<=f;m.push(0));g=p=0,c=(l%=h)-h+(s=1)}else{for(g=d=m[f],s=1;10<=d;d/=10,s++);p=(c=(l%=h)-h+s)<0?0:g/w[s-c-1]%10|0}if(o=o||e<0||null!=m[f+1]||(c<0?g:g%w[s-c-1]),o=n<4?(p||o)&&(0==n||n==(t.s<0?3:2)):5<p||5==p&&(4==n||o||6==n&&(0<l?0<c?g/w[s-c]:0:m[f-1])%10&1||n==(t.s<0?8:7)),e<1||!m[0])return m.length=0,o?(e-=t.e+1,m[0]=w[(h-e%h)%h],t.e=-e||0):m[0]=t.e=0,t;if(0==l?(m.length=f,d=1,f--):(m.length=f+1,d=w[h-l],m[f]=0<c?r(g/w[s-c]%w[c])*d:0),o)for(;;){if(0==f){for(l=1,c=m[0];10<=c;c/=10,l++);for(c=m[0]+=d,d=1;10<=c;c/=10,d++);l!=d&&(t.e++,m[0]==a&&(m[0]=1));break}if(m[f]+=d,m[f]!=a)break;m[f--]=0,d=1}for(l=m.length;0===m[--l];m.pop());}t.e>L?t.c=t.e=null:t.e<D&&(t.c=[t.e=0])}return t}function K(t){var e,n=t.e;return null===n?t.toString():(e=p(t.c),e=n<=P||N<=n?v(e,n):y(e,n,"0"),t.s<0?"-"+e:e)}return z.clone=t,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(s+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(w(n=t[e],0,g,e),O=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(w(n=t[e],0,8,e),_=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((n=t[e])&&n.pop?(w(n[0],-g,0,e),w(n[1],0,g,e),P=n[0],N=n[1]):(w(n,-g,g,e),P=-(N=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if((n=t[e])&&n.pop)w(n[0],-g,-1,e),w(n[1],1,g,e),D=n[0],L=n[1];else{if(w(n,-g,g,e),!n)throw Error(s+e+" cannot be zero: "+n);D=-(L=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if((n=t[e])!==!!n)throw Error(s+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw V=!n,Error(s+"crypto unavailable");V=n}else V=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(w(n=t[e],0,9,e),F=n),t.hasOwnProperty(e="POW_PRECISION")&&(w(n=t[e],0,g,e),W=n),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(n=t[e]))throw Error(s+e+" not an object: "+n);B=n}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(n=t[e])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(s+e+" invalid: "+n);j=n}}return{DECIMAL_PLACES:O,ROUNDING_MODE:_,EXPONENTIAL_AT:[P,N],RANGE:[D,L],CRYPTO:V,MODULO_MODE:F,POW_PRECISION:W,FORMAT:B,ALPHABET:j}},z.isBigNumber=function(t){return t instanceof z||t&&!0===t._isBigNumber||!1},z.maximum=z.max=function(){return Y(arguments,H.lt)},z.minimum=z.min=function(){return Y(arguments,H.gt)},z.random=(R=9007199254740992,x=Math.random()*R&2097151?function(){return r(Math.random()*R)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,n,o,l,a,c=0,d=[],f=new z(I);if(null==t?t=O:w(t,0,g),l=i(t/h),V)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(l*=2));c<l;)9e15<=(a=131072*e[c]+(e[c+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),e[c]=n[0],e[c+1]=n[1]):(d.push(a%1e14),c+=2);c=l/2}else{if(!crypto.randomBytes)throw V=!1,Error(s+"crypto unavailable");for(e=crypto.randomBytes(l*=7);c<l;)9e15<=(a=281474976710656*(31&e[c])+1099511627776*e[c+1]+4294967296*e[c+2]+16777216*e[c+3]+(e[c+4]<<16)+(e[c+5]<<8)+e[c+6])?crypto.randomBytes(7).copy(e,c):(d.push(a%1e14),c+=7);c=l/7}if(!V)for(;c<l;)(a=x())<9e15&&(d[c++]=a%1e14);for(l=d[--c],t%=h,l&&t&&(a=u[h-t],d[c]=r(l/a)*a);0===d[c];d.pop(),c--);if(c<0)d=[o=0];else{for(o=-1;0===d[0];d.splice(0,1),o-=h);for(c=1,a=d[0];10<=a;a/=10,c++);c<h&&(o-=h-c)}return f.e=o,f.c=d,f}),z.sum=function(){for(var t=1,e=arguments,n=new z(e[0]);t<e.length;)n=n.plus(e[t++]);return n},C=function(){var t="0123456789";function e(t,e,n,o){for(var i,r,s=[0],l=0,a=t.length;l<a;){for(r=s.length;r--;s[r]*=e);for(s[0]+=o.indexOf(t.charAt(l++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(o,i,r,s,l){var a,h,c,u,d,g,f,m,w=o.indexOf("."),b=O,v=_;for(0<=w&&(u=W,W=0,o=o.replace(".",""),g=(m=new z(i)).pow(o.length-w),W=u,m.c=e(y(p(g.c),g.e,"0"),10,r,t),m.e=m.c.length),c=u=(f=e(o,i,r,l?(a=j,t):(a=t,j))).length;0==f[--u];f.pop());if(!f[0])return a.charAt(0);if(w<0?--c:(g.c=f,g.e=c,g.s=s,f=(g=n(g,m,b,v,r)).c,d=g.r,c=g.e),w=f[h=c+b+1],u=r/2,d=d||h<0||null!=f[h+1],d=v<4?(null!=w||d)&&(0==v||v==(g.s<0?3:2)):u<w||w==u&&(4==v||d||6==v&&1&f[h-1]||v==(g.s<0?8:7)),h<1||!f[0])o=d?y(a.charAt(1),-b,a.charAt(0)):a.charAt(0);else{if(f.length=h,d)for(--r;++f[--h]>r;)f[h]=0,h||(++c,f=[1].concat(f));for(u=f.length;!f[--u];);for(w=0,o="";w<=u;o+=a.charAt(f[w++]));o=y(o,c,a.charAt(0))}return o}}(),n=function(){function t(t,e,n){var o,i,r,s,l=0,a=t.length,h=e%d,c=e/d|0;for(t=t.slice();a--;)l=((i=h*(r=t[a]%d)+(o=c*r+(s=t[a]/d|0)*h)%d*d+l)/n|0)+(o/d|0)+c*s,t[a]=i%n;return l&&(t=[l].concat(t)),t}function e(t,e,n,o){var i,r;if(n!=o)r=o<n?1:-1;else for(i=r=0;i<n;i++)if(t[i]!=e[i]){r=t[i]>e[i]?1:-1;break}return r}function n(t,e,n,o){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*o+t[n]-e[n];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(o,i,s,l,c){var u,d,g,p,m,w,b,v,y,C,S,R,x,E,M,T,k,A=o.s==i.s?1:-1,H=o.c,I=i.c;if(!(H&&H[0]&&I&&I[0]))return new z(o.s&&i.s&&(H?!I||H[0]!=I[0]:I)?H&&0==H[0]||!I?0*A:A/0:NaN);for(y=(v=new z(A)).c=[],A=s+(d=o.e-i.e)+1,c||(c=a,d=f(o.e/h)-f(i.e/h),A=A/h|0),g=0;I[g]==(H[g]||0);g++);if(I[g]>(H[g]||0)&&d--,A<0)y.push(1),p=!0;else{for(E=H.length,T=I.length,A+=2,1<(m=r(c/(I[g=0]+1)))&&(I=t(I,m,c),H=t(H,m,c),T=I.length,E=H.length),x=T,S=(C=H.slice(0,T)).length;S<T;C[S++]=0);k=I.slice(),k=[0].concat(k),M=I[0],I[1]>=c/2&&M++;do{if(m=0,(u=e(I,C,T,S))<0){if(R=C[0],T!=S&&(R=R*c+(C[1]||0)),1<(m=r(R/M)))for(c<=m&&(m=c-1),b=(w=t(I,m,c)).length,S=C.length;1==e(w,C,b,S);)m--,n(w,T<b?k:I,b,c),b=w.length,u=1;else 0==m&&(u=m=1),b=(w=I.slice()).length;if(b<S&&(w=[0].concat(w)),n(C,w,S,c),S=C.length,-1==u)for(;e(I,C,T,S)<1;)m++,n(C,T<S?k:I,S,c),S=C.length}else 0===u&&(m++,C=[0]);y[g++]=m,C[0]?C[S++]=H[x]||0:(C=[H[x]],S=1)}while((x++<E||null!=C[0])&&A--);p=null!=C[0],y[0]||y.splice(0,1)}if(c==a){for(g=1,A=y[0];10<=A;A/=10,g++);G(v,s+(v.e=g+d*h-1)+1,l,p)}else v.e=d,v.r=+p;return v}}(),E=/^(-?)0([xbo])(?=\w[\w.]*$)/i,M=/^([^.]+)\.$/,T=/^\.([^.]+)$/,k=/^-?(Infinity|NaN)$/,A=/^\s*\+(?=[\w.])|^\s+|\s+$/g,S=function(t,e,n,o){var i,r=n?e:e.replace(A,"");if(k.test(r))t.s=isNaN(r)?null:r<0?-1:1,t.c=t.e=null;else{if(!n&&(r=r.replace(E,(function(t,e,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,o&&o!=i?t:e})),o&&(i=o,r=r.replace(M,"$1").replace(T,"0.$1")),e!=r))return new z(r,i);if(z.DEBUG)throw Error(s+"Not a"+(o?" base "+o:"")+" number: "+e);t.c=t.e=t.s=null}},H.absoluteValue=H.abs=function(){var t=new z(this);return t.s<0&&(t.s=1),t},H.comparedTo=function(t,e){return m(this,new z(t,e))},H.decimalPlaces=H.dp=function(t,e){var n,o,i;if(null!=t)return w(t,0,g),null==e?e=_:w(e,0,8),G(new z(this),t+this.e+1,e);if(!(n=this.c))return null;if(o=((i=n.length-1)-f(this.e/h))*h,i=n[i])for(;i%10==0;i/=10,o--);return o<0&&(o=0),o},H.dividedBy=H.div=function(t,e){return n(this,new z(t,e),O,_)},H.dividedToIntegerBy=H.idiv=function(t,e){return n(this,new z(t,e),0,1)},H.exponentiatedBy=H.pow=function(t,e){var n,o,l,a,c,u,d,g,f=this;if((t=new z(t)).c&&!t.isInteger())throw Error(s+"Exponent not an integer: "+K(t));if(null!=e&&(e=new z(e)),c=14<t.e,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!t.c||!t.c[0])return g=new z(Math.pow(+K(f),c?2-b(t):+K(t))),e?g.mod(e):g;if(u=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new z(NaN);(o=!u&&f.isInteger()&&e.isInteger())&&(f=f.mod(e))}else{if(9<t.e&&(0<f.e||f.e<-1||(0==f.e?1<f.c[0]||c&&24e7<=f.c[1]:f.c[0]<8e13||c&&f.c[0]<=9999975e7)))return a=f.s<0&&b(t)?-0:0,-1<f.e&&(a=1/a),new z(u?1/a:a);W&&(a=i(W/h+2))}for(d=c?(n=new z(.5),u&&(t.s=1),b(t)):(l=Math.abs(+K(t)))%2,g=new z(I);;){if(d){if(!(g=g.times(f)).c)break;a?g.c.length>a&&(g.c.length=a):o&&(g=g.mod(e))}if(l){if(0===(l=r(l/2)))break;d=l%2}else if(G(t=t.times(n),t.e+1,1),14<t.e)d=b(t);else{if(0==(l=+K(t)))break;d=l%2}f=f.times(f),a?f.c&&f.c.length>a&&(f.c.length=a):o&&(f=f.mod(e))}return o?g:(u&&(g=I.div(g)),e?g.mod(e):a?G(g,W,_,void 0):g)},H.integerValue=function(t){var e=new z(this);return null==t?t=_:w(t,0,8),G(e,e.e+1,t)},H.isEqualTo=H.eq=function(t,e){return 0===m(this,new z(t,e))},H.isFinite=function(){return!!this.c},H.isGreaterThan=H.gt=function(t,e){return 0<m(this,new z(t,e))},H.isGreaterThanOrEqualTo=H.gte=function(t,e){return 1===(e=m(this,new z(t,e)))||0===e},H.isInteger=function(){return!!this.c&&f(this.e/h)>this.c.length-2},H.isLessThan=H.lt=function(t,e){return m(this,new z(t,e))<0},H.isLessThanOrEqualTo=H.lte=function(t,e){return-1===(e=m(this,new z(t,e)))||0===e},H.isNaN=function(){return!this.s},H.isNegative=function(){return this.s<0},H.isPositive=function(){return 0<this.s},H.isZero=function(){return!!this.c&&0==this.c[0]},H.minus=function(t,e){var n,o,i,r,s=this,l=s.s;if(e=(t=new z(t,e)).s,!l||!e)return new z(NaN);if(l!=e)return t.s=-e,s.plus(t);var c=s.e/h,u=t.e/h,d=s.c,g=t.c;if(!c||!u){if(!d||!g)return d?(t.s=-e,t):new z(g?s:NaN);if(!d[0]||!g[0])return g[0]?(t.s=-e,t):new z(d[0]?s:3==_?-0:0)}if(c=f(c),u=f(u),d=d.slice(),l=c-u){for((i=(r=l<0)?(l=-l,d):(u=c,g)).reverse(),e=l;e--;i.push(0));i.reverse()}else for(o=(r=(l=d.length)<(e=g.length))?l:e,l=e=0;e<o;e++)if(d[e]!=g[e]){r=d[e]<g[e];break}if(r&&(i=d,d=g,g=i,t.s=-t.s),0<(e=(o=g.length)-(n=d.length)))for(;e--;d[n++]=0);for(e=a-1;l<o;){if(d[--o]<g[o]){for(n=o;n&&!d[--n];d[n]=e);--d[n],d[o]+=a}d[o]-=g[o]}for(;0==d[0];d.splice(0,1),--u);return d[0]?$(t,d,u):(t.s=3==_?-1:1,t.c=[t.e=0],t)},H.modulo=H.mod=function(t,e){var o,i,r=this;return t=new z(t,e),!r.c||!t.s||t.c&&!t.c[0]?new z(NaN):!t.c||r.c&&!r.c[0]?new z(r):(9==F?(i=t.s,t.s=1,o=n(r,t,0,3),t.s=i,o.s*=i):o=n(r,t,0,F),(t=r.minus(o.times(t))).c[0]||1!=F||(t.s=r.s),t)},H.multipliedBy=H.times=function(t,e){var n,o,i,r,s,l,c,u,g,p,m,w,b,v,y,C=this,S=C.c,R=(t=new z(t,e)).c;if(!(S&&R&&S[0]&&R[0]))return!C.s||!t.s||S&&!S[0]&&!R||R&&!R[0]&&!S?t.c=t.e=t.s=null:(t.s*=C.s,S&&R?(t.c=[0],t.e=0):t.c=t.e=null),t;for(o=f(C.e/h)+f(t.e/h),t.s*=C.s,(c=S.length)<(p=R.length)&&(b=S,S=R,R=b,i=c,c=p,p=i),i=c+p,b=[];i--;b.push(0));for(v=a,y=d,i=p;0<=--i;){for(n=0,m=R[i]%y,w=R[i]/y|0,r=i+(s=c);i<r;)n=((u=m*(u=S[--s]%y)+(l=w*u+(g=S[s]/y|0)*m)%y*y+b[r]+n)/v|0)+(l/y|0)+w*g,b[r--]=u%v;b[r]=n}return n?++o:b.splice(0,1),$(t,b,o)},H.negated=function(){var t=new z(this);return t.s=-t.s||null,t},H.plus=function(t,e){var n,o=this,i=o.s;if(e=(t=new z(t,e)).s,!i||!e)return new z(NaN);if(i!=e)return t.s=-e,o.minus(t);var r=o.e/h,s=t.e/h,l=o.c,c=t.c;if(!r||!s){if(!l||!c)return new z(i/0);if(!l[0]||!c[0])return c[0]?t:new z(l[0]?o:0*i)}if(r=f(r),s=f(s),l=l.slice(),i=r-s){for((n=0<i?(s=r,c):(i=-i,l)).reverse();i--;n.push(0));n.reverse()}for((i=l.length)-(e=c.length)<0&&(n=c,c=l,l=n,e=i),i=0;e;)i=(l[--e]=l[e]+c[e]+i)/a|0,l[e]=a===l[e]?0:l[e]%a;return i&&(l=[i].concat(l),++s),$(t,l,s)},H.precision=H.sd=function(t,e){var n,o,i;if(null!=t&&t!==!!t)return w(t,1,g),null==e?e=_:w(e,0,8),G(new z(this),t,e);if(!(n=this.c))return null;if(o=(i=n.length-1)*h+1,i=n[i]){for(;i%10==0;i/=10,o--);for(i=n[0];10<=i;i/=10,o++);}return t&&this.e+1>o&&(o=this.e+1),o},H.shiftedBy=function(t){return w(t,-c,c),this.times("1e"+t)},H.squareRoot=H.sqrt=function(){var t,e,o,i,r,s=this,l=s.c,a=s.s,h=s.e,c=O+4,u=new z("0.5");if(1!==a||!l||!l[0])return new z(!a||a<0&&(!l||l[0])?NaN:l?s:1/0);if((o=0==(a=Math.sqrt(+K(s)))||a==1/0?(((e=p(l)).length+h)%2==0&&(e+="0"),a=Math.sqrt(+e),h=f((h+1)/2)-(h<0||h%2),new z(e=a==1/0?"1e"+h:(e=a.toExponential()).slice(0,e.indexOf("e")+1)+h)):new z(a+"")).c[0])for((a=(h=o.e)+c)<3&&(a=0);;)if(r=o,o=u.times(r.plus(n(s,r,c,1))),p(r.c).slice(0,a)===(e=p(o.c)).slice(0,a)){if(o.e<h&&--a,"9999"!=(e=e.slice(a-3,a+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(G(o,o.e+O+2,1),t=!o.times(o).eq(s));break}if(!i&&(G(r,r.e+O+2,0),r.times(r).eq(s))){o=r;break}c+=4,a+=4,i=1}return G(o,o.e+O+1,_,t)},H.toExponential=function(t,e){return null!=t&&(w(t,0,g),t++),U(this,t,e,1)},H.toFixed=function(t,e){return null!=t&&(w(t,0,g),t=t+this.e+1),U(this,t,e)},H.toFormat=function(t,e,n){var o;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=B;else if("object"!=typeof n)throw Error(s+"Argument not an object: "+n);if(o=this.toFixed(t,e),this.c){var i,r=o.split("."),l=+n.groupSize,a=+n.secondaryGroupSize,h=n.groupSeparator||"",c=r[0],u=r[1],d=this.s<0,g=d?c.slice(1):c,f=g.length;if(a&&(i=l,l=a,f-=a=i),0<l&&0<f){for(i=f%l||l,c=g.substr(0,i);i<f;i+=l)c+=h+g.substr(i,l);0<a&&(c+=h+g.slice(i)),d&&(c="-"+c)}o=u?c+(n.decimalSeparator||"")+((a=+n.fractionGroupSize)?u.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):u):c}return(n.prefix||"")+o+(n.suffix||"")},H.toFraction=function(t){var e,o,i,r,l,a,c,d,g,f,m,w,b=this,v=b.c;if(null!=t&&(!(c=new z(t)).isInteger()&&(c.c||1!==c.s)||c.lt(I)))throw Error(s+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+K(c));if(!v)return new z(b);for(e=new z(I),g=o=new z(I),i=d=new z(I),w=p(v),l=e.e=w.length-b.e-1,e.c[0]=u[(a=l%h)<0?h+a:a],t=!t||0<c.comparedTo(e)?0<l?e:g:c,a=L,L=1/0,c=new z(w),d.c[0]=0;f=n(c,e,0,1),1!=(r=o.plus(f.times(i))).comparedTo(t);)o=i,i=r,g=d.plus(f.times(r=g)),d=r,e=c.minus(f.times(r=e)),c=r;return r=n(t.minus(o),i,0,1),d=d.plus(r.times(g)),o=o.plus(r.times(i)),d.s=g.s=b.s,m=n(g,i,l*=2,_).minus(b).abs().comparedTo(n(d,o,l,_).minus(b).abs())<1?[g,i]:[d,o],L=a,m},H.toNumber=function(){return+K(this)},H.toPrecision=function(t,e){return null!=t&&w(t,1,g),U(this,t,e,2)},H.toString=function(t){var e,n=this,o=n.s,i=n.e;return null===i?o?(e="Infinity",o<0&&(e="-"+e)):e="NaN":(e=null==t?i<=P||N<=i?v(p(n.c),i):y(p(n.c),i,"0"):10===t?y(p((n=G(new z(n),O+i+1,_)).c),n.e,"0"):(w(t,2,j.length,"Base"),C(y(p(n.c),i,"0"),10,t,o,!0)),o<0&&n.c[0]&&(e="-"+e)),e},H.valueOf=H.toJSON=function(){return K(this)},H._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(H[Symbol.toStringTag]="BigNumber",H[Symbol.for("nodejs.util.inspect.custom")]=H.valueOf),null!=e&&z.set(e),z}()).default=n.BigNumber=n,void 0!==e&&e.exports?e.exports=n:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=n)}(this)},{}],2:[function(t,e,n){e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,n){function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,i=!1,r=void 0;try{for(var s,l=t[Symbol.iterator]();!(o=(s=l.next()).done)&&(n.push(s.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==l.return||l.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=t("./globalState"),r=t("./validating"),s=t("./parsing"),l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a={general:{scale:1024,suffixes:l,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:l,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function c(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=s.parseFormat(e)),!r.validateFormat(e))return"ERROR: invalid format";var o=e.prefix||"",l=e.postfix||"",c=function(t,e,n){switch(e.output){case"currency":return function(t,e,n){var o=n.currentCurrency(),i=Object.assign({},h,e),r=void 0,s="",l=!!i.totalLength||!!i.forceAverage||i.average,a=e.currencyPosition||o.position,c=e.currencySymbol||o.symbol;i.spaceSeparated&&(s=" "),"infix"===a&&(r=s+c+s);var u=f({instance:t,providedFormat:e,state:n,decimalSeparator:r});return"prefix"===a&&(u=t._value<0&&"sign"===i.negative?"-".concat(s).concat(c).concat(u.slice(1)):c+s+u),a&&"postfix"!==a||(u=u+(s=l?"":s)+c),u}(t,e=p(e,i.currentCurrencyDefaultFormat()),i);case"percent":return function(t,e,n,o){var i=e.prefixSymbol,r=f({instance:o(100*t._value),providedFormat:e,state:n}),s=Object.assign({},h,e);return i?"%".concat(s.spaceSeparated?" ":"").concat(r):"".concat(r).concat(s.spaceSeparated?" ":"","%")}(t,e=p(e,i.currentPercentageDefaultFormat()),i,n);case"byte":return e=p(e,i.currentByteDefaultFormat()),y=t,S=i,R=n,x=(C=e).base||"binary",E=a[x],T=(M=u(y._value,E.suffixes,E.scale)).value,k=M.suffix,A=f({instance:R(T),providedFormat:C,state:S,defaults:S.currentByteDefaultFormat()}),H=S.currentAbbreviations(),"".concat(A).concat(H.spaced?" ":"").concat(k);case"time":return e=p(e,i.currentTimeDefaultFormat()),m=t,w=Math.floor(m._value/60/60),b=Math.floor((m._value-60*w*60)/60),v=Math.round(m._value-60*w*60-60*b),"".concat(w,":").concat(b<10?"0":"").concat(b,":").concat(v<10?"0":"").concat(v);case"ordinal":return o=t,r=e=p(e,i.currentOrdinalDefaultFormat()),l=(s=i).currentOrdinal(),c=Object.assign({},h,r),d=f({instance:o,providedFormat:r,state:s}),g=l(o._value),"".concat(d).concat(c.spaceSeparated?" ":"").concat(g);default:return f({instance:t,providedFormat:e,numbro:n})}var o,r,s,l,c,d,g,m,w,b,v,y,C,S,R,x,E,M,T,k,A,H}(t,e,n);return(c=o+c)+l}function u(t,e,n){var o=e[0],i=Math.abs(t);if(n<=i){for(var r=1;r<e.length;++r){var s=Math.pow(n,r),l=Math.pow(n,r+1);if(s<=i&&i<l){o=e[r],t/=s;break}}o===e[0]&&(t/=Math.pow(n,e.length-1),o=e[e.length-1])}return{value:t,suffix:o}}function d(t){for(var e="",n=0;n<t;n++)e+="0";return e}function g(t,e){return-1!==t.toString().indexOf("e")?function(t,e){var n=t.toString(),i=o(n.split("e"),2),r=i[0],s=i[1],l=o(r.split("."),2),a=l[0],h=l[1],c=void 0===h?"":h;if(0<+s)n=a+c+d(s-c.length);else{var u=".";u=+a<0?"-0".concat(u):"0".concat(u);var g=(d(-s-1)+Math.abs(a)+c).substr(0,e);g.length<e&&(g+=d(e-g.length)),n=u+g}return 0<+s&&0<e&&(n+=".".concat(d(e))),n}(t,e):(Math.round(+"".concat(t,"e+").concat(e))/Math.pow(10,e)).toFixed(e)}function f(t){var e=t.instance,n=t.providedFormat,r=t.state,s=void 0===r?i:r,l=t.decimalSeparator,a=t.defaults,c=void 0===a?s.currentDefaults():a,u=e._value;if(0===u&&s.hasZeroFormat())return s.getZeroFormat();if(!isFinite(u))return u.toString();var d,f,p,m,w,b,v,y,C=Object.assign({},h,c,n),S=C.totalLength,R=S?0:C.characteristic,x=C.optionalCharacteristic,E=C.forceAverage,M=!!S||!!E||C.average,T=S?-1:M&&void 0===n.mantissa?0:C.mantissa,k=!S&&(void 0===n.optionalMantissa?-1===T:C.optionalMantissa),A=C.trimMantissa,H=C.thousandSeparated,I=C.spaceSeparated,O=C.negative,_=C.forceSign,P=C.exponential,N="";if(M){var D=function(t){var e=t.value,n=t.forceAverage,o=t.abbreviations,i=t.spaceSeparated,r=void 0!==i&&i,s=t.totalLength,l=void 0===s?0:s,a="",h=Math.abs(e),c=-1;if(h>=Math.pow(10,12)&&!n||"trillion"===n?(a=o.trillion,e/=Math.pow(10,12)):h<Math.pow(10,12)&&h>=Math.pow(10,9)&&!n||"billion"===n?(a=o.billion,e/=Math.pow(10,9)):h<Math.pow(10,9)&&h>=Math.pow(10,6)&&!n||"million"===n?(a=o.million,e/=Math.pow(10,6)):(h<Math.pow(10,6)&&h>=Math.pow(10,3)&&!n||"thousand"===n)&&(a=o.thousand,e/=Math.pow(10,3)),a&&(a=(r?" ":"")+a),l){var u=e.toString().split(".")[0];c=Math.max(l-u.length,0)}return{value:e,abbreviation:a,mantissaPrecision:c}}({value:u,forceAverage:E,abbreviations:s.currentAbbreviations(),spaceSeparated:I,totalLength:S});u=D.value,N+=D.abbreviation,S&&(T=D.mantissaPrecision)}if(P){var L=(f=(d={value:u,characteristicPrecision:R}).value,m=void 0===(p=d.characteristicPrecision)?0:p,b=(w=o(f.toExponential().split("e"),2))[0],v=w[1],y=+b,m&&1<m&&(y*=Math.pow(10,m-1),v=0<=(v=+v-(m-1))?"+".concat(v):v),{value:y,abbreviation:"e".concat(v)});u=L.value,N=L.abbreviation+N}var V,F,W,B=function(t,e,n,i,r){if(-1===i)return t;var s=g(e,i),l=o(s.toString().split("."),2),a=l[0],h=l[1],c=void 0===h?"":h;if(c.match(/^0+$/)&&(n||r))return a;var u=c.match(/0+$/);return r&&u?"".concat(a,".").concat(c.toString().slice(0,u.index)):s.toString()}(u.toString(),u,k,T,A);return B=function(t,e,n,o,i){var r=o.currentDelimiters(),s=r.thousands;i=i||r.decimal;var l=r.thousandsSize||3,a=t.toString(),h=a.split(".")[0],c=a.split(".")[1];return n&&(e<0&&(h=h.slice(1)),function(t,e){for(var n=[],o=0,i=t;0<i;i--)o===e&&(n.unshift(i),o=0),o++;return n}(h.length,l).forEach((function(t,e){h=h.slice(0,t+e)+s+h.slice(t+e)})),e<0&&(h="-".concat(h))),c?h+i+c:h}(B=function(t,e,n,i){var r=t,s=o(r.toString().split("."),2),l=s[0],a=s[1];if(l.match(/^-?0$/)&&n)return a?"".concat(l.replace("0",""),".").concat(a):l.replace("0","");if(l.length<i)for(var h=i-l.length,c=0;c<h;c++)r="0".concat(r);return r.toString()}(B,0,x,R),u,H,s,l),(M||P)&&(B+=N),(_||u<0)&&(V=B,W=O,B=0===(F=u)?V:0==+V?V.replace("-",""):0<F?"+".concat(V):"sign"===W?V:"(".concat(V.replace("-",""),")")),B}function p(t,e){if(!t)return e;var n=Object.keys(t);return 1===n.length&&"output"===n[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return c.apply(void 0,n.concat([t]))},getByteUnit:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(t){var e=a.general;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(t){var e=a.binary;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return function(t){var e=a.decimal;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},formatOrDefault:p}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,n){var o=t("./en-US"),i=t("./validating"),r=t("./parsing"),s={},l=void 0,a={},h=null,c={};function u(t){l=t}function d(){return a[l]}s.languages=function(){return Object.assign({},a)},s.currentLanguage=function(){return l},s.currentCurrency=function(){return d().currency},s.currentAbbreviations=function(){return d().abbreviations},s.currentDelimiters=function(){return d().delimiters},s.currentOrdinal=function(){return d().ordinal},s.currentDefaults=function(){return Object.assign({},d().defaults,c)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().timeFormat)},s.setDefaults=function(t){t=r.parseFormat(t),i.validateFormat(t)&&(c=t)},s.getZeroFormat=function(){return h},s.setZeroFormat=function(t){return h="string"==typeof t?t:null},s.hasZeroFormat=function(){return null!==h},s.languageData=function(t){if(t){if(a[t])return a[t];throw new Error('Unknown tag "'.concat(t,'"'))}return d()},s.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!i.validateLanguage(t))throw new Error("Invalid language data");a[t.languageTag]=t,e&&u(t.languageTag)},s.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:o.languageTag;if(!a[t]){var n=t.split("-")[0],i=Object.keys(a).find((function(t){return t.split("-")[0]===n}));return a[i]?void u(i):void u(e)}u(t)},s.registerLanguage(o),l=o.languageTag,e.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,n){e.exports=function(e){return{loadLanguagesInNode:function(n){return o=e,void n.forEach((function(e){var n=void 0;try{n=t("../languages/".concat(e))}catch(n){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}n&&o.registerLanguage(n)}));var o}}}},{}],6:[function(t,e,n){var o=t("bignumber.js");function i(t,e,n){var i=new o(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new o(r),t._value=i.minus(r).toNumber(),t}e.exports=function(t){return{add:function(e,n){return r=n,s=t,l=new o((i=e)._value),a=r,s.isNumbro(r)&&(a=r._value),a=new o(a),i._value=l.plus(a).toNumber(),i;var i,r,s,l,a},subtract:function(e,n){return i(e,n,t)},multiply:function(e,n){return r=n,s=t,l=new o((i=e)._value),a=r,s.isNumbro(r)&&(a=r._value),a=new o(a),i._value=l.times(a).toNumber(),i;var i,r,s,l,a},divide:function(e,n){return r=n,s=t,l=new o((i=e)._value),a=r,s.isNumbro(r)&&(a=r._value),a=new o(a),i._value=l.dividedBy(a).toNumber(),i;var i,r,s,l,a},set:function(e,n){return o=e,r=i=n,t.isNumbro(i)&&(r=i._value),o._value=r,o;var o,i,r},difference:function(e,n){return o=n,i(s=(r=t)(e._value),o,r),Math.abs(s._value);var o,r,s}}}},{"bignumber.js":1}],7:[function(t,e,n){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var i=t("./globalState"),r=t("./validating"),s=t("./loading")(g),l=t("./unformatting"),a=t("./formatting")(g),h=t("./manipulating")(g),c=t("./parsing"),u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e}var e;return(e=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=c.parseFormat(t)),(t=a.formatOrDefault(t,i.currentCurrencyDefaultFormat())).output="currency",a.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",a.format(this,t)}},{key:"binaryByteUnits",value:function(){return a.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return a.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return a.getByteUnit(this)}},{key:"difference",value:function(t){return h.difference(this,t)}},{key:"add",value:function(t){return h.add(this,t)}},{key:"subtract",value:function(t){return h.subtract(this,t)}},{key:"multiply",value:function(t){return h.multiply(this,t)}},{key:"divide",value:function(t){return h.divide(this,t)}},{key:"set",value:function(t){return h.set(this,d(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(t.prototype,e),t}();function d(t){var e=t;return g.isNumbro(t)?e=t._value:"string"==typeof t?e=g.unformat(t):isNaN(t)&&(e=NaN),e}function g(t){return new u(d(t))}g.version="2.1.2",g.isNumbro=function(t){return t instanceof u},g.language=i.currentLanguage,g.registerLanguage=i.registerLanguage,g.setLanguage=i.setLanguage,g.languages=i.languages,g.languageData=i.languageData,g.zeroFormat=i.setZeroFormat,g.defaultFormat=i.currentDefaults,g.setDefaults=i.setDefaults,g.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,g.validate=r.validate,g.loadLanguagesInNode=s.loadLanguagesInNode,g.unformat=l.unformat,e.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,n){e.exports={parseFormat:function(t){var e,n,o,i,r,s,l,a,h,c,u,d,g,f,p,m,w,b,v,y,C=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(n=C,r=C,function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(s=(i=t=(o=(e=t).match(/^{([^}]*)}/))?(n.prefix=o[1],e.slice(o[0].length)):e).match(/{([^}]*)}$/))?(r.postfix=s[1],i.slice(0,-s[0].length)):i,C),l=C,(a=t.match(/[1-9]+[0-9]*/))&&(l.totalLength=+a[0]),h=C,(c=t.split(".")[0].match(/0+/))&&(h.characteristic=c[0].length),function(t,e){if(-1!==t.indexOf(".")){var n=t.split(".")[0];e.optionalCharacteristic=-1===n.indexOf("0")}}(t,C),u=C,-1!==t.indexOf("a")&&(u.average=!0),g=C,-1!==(d=t).indexOf("K")?g.forceAverage="thousand":-1!==d.indexOf("M")?g.forceAverage="million":-1!==d.indexOf("B")?g.forceAverage="billion":-1!==d.indexOf("T")&&(g.forceAverage="trillion"),function(t,e){var n=t.split(".")[1];if(n){var o=n.match(/0+/);o&&(e.mantissa=o[0].length)}}(t,C),p=C,(f=t).match(/\[\.]/)?p.optionalMantissa=!0:f.match(/\./)&&(p.optionalMantissa=!1),m=C,-1!==t.indexOf(",")&&(m.thousandSeparated=!0),w=C,-1!==t.indexOf(" ")&&(w.spaceSeparated=!0),v=C,(b=t).match(/^\+?\([^)]*\)$/)&&(v.negative="parenthesis"),b.match(/^\+?-/)&&(v.negative="sign"),y=C,t.match(/^\+/)&&(y.forceSign=!0),C)}}},{}],9:[function(t,e,n){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function i(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,a=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===s?0:function t(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=3<arguments.length?arguments[3]:void 0,l=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,h=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var c="",u=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(u!==e)return-1*t(u,n,r,s,l,a,h);for(var d=0;d<o.length;d++){var g=o[d];if((c=e.replace(g.key,""))!==e)return t(c,n,r,s,l,a,h)*g.factor}if((c=e.replace("%",""))!==e)return t(c,n,r,s,l,a,h)/100;var f=parseFloat(e);if(!isNaN(f)){var p=s(f);if(p&&"."!==p&&(c=e.replace(new RegExp("".concat(i(p),"$")),""))!==e)return t(c,n,r,s,l,a,h);var m={};Object.keys(a).forEach((function(t){m[a[t]]=t}));for(var w=Object.keys(m).sort().reverse(),b=w.length,v=0;v<b;v++){var y=w[v],C=m[y];if((c=e.replace(y,""))!==e){var S=void 0;switch(C){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return t(c,n,r,s,l,a,h)*S}}}}(function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=t.replace(n,"");return(o=o.replace(new RegExp("([0-9])".concat(i(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,n),e,n,r,s,l,a)}e.exports={unformat:function(e,n){var o,i,s,l=t("./globalState"),a=l.currentDelimiters(),h=l.currentCurrency().symbol,c=l.currentOrdinal(),u=l.getZeroFormat(),d=l.currentAbbreviations(),g=void 0;if("string"==typeof e)g=function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var n=t.split(":");if(3!==n.length)return!1;var o=+n[0],i=+n[1],r=+n[2];return!isNaN(o)&&!isNaN(i)&&!isNaN(r)}(e,a)?(i=+(o=e.split(":"))[0],s=+o[1],+o[2]+60*s+3600*i):r(e,a,h,c,u,d,n);else{if("number"!=typeof e)return;g=e}if(void 0!==g)return g}}},{"./globalState":4}],10:[function(t,e,n){function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=t("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,l={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},a={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(t){return!!r.unformat(t)}function c(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=Object.keys(t).map((function(o){if(!e[o])return console.error("".concat(n," Invalid key: ").concat(o)),!1;var r=t[o],s=e[o];if("string"==typeof s&&(s={type:s}),"format"===s.type){if(!c(r,l,"[Validate ".concat(o,"]"),!0))return!1}else if(i(r)!==s.type)return console.error("".concat(n," ").concat(o,' type mismatched: "').concat(s.type,'" expected, "').concat(i(r),'" provided')),!1;if(s.restrictions&&s.restrictions.length)for(var a=s.restrictions.length,h=0;h<a;h++){var u=s.restrictions[h],d=u.restriction,g=u.message;if(!d(r,t))return console.error("".concat(n," ").concat(o," invalid value: ").concat(g)),!1}return s.restriction&&!s.restriction(r,t)?(console.error("".concat(n," ").concat(o," invalid value: ").concat(s.message)),!1):s.validValues&&-1===s.validValues.indexOf(r)?(console.error("".concat(n," ").concat(o," invalid value: must be among ").concat(JSON.stringify(s.validValues),', "').concat(r,'" provided')),!1):!(s.children&&!c(r,s.children,"[Validate ".concat(o,"]")))}));return r||s.push.apply(s,o(Object.keys(e).map((function(o){var i=e[o];if("string"==typeof i&&(i={type:i}),i.mandatory){var r=i.mandatory;if("function"==typeof r&&(r=r(t)),r&&void 0===t[o])return console.error("".concat(n,' Missing mandatory key "').concat(o,'"')),!1}return!0})))),s.reduce((function(t,e){return t&&e}),!0)}function u(t){return c(t,l,"[Validate format]")}e.exports={validate:function(t,e){var n=h(t),o=u(e);return n&&o},validateFormat:u,validateInput:h,validateLanguage:function(t){return c(t,a,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)}(JO);const t_=Z(JO.exports);function e_(t,e){if(Ty(t)){const n=e.numericFormat,o=n&&n.culture||"-",i=n&&n.pattern;if(void 0!==o&&!t_.languages()[o]){const t=o.replace("-",""),e=t_.allLanguages?t_.allLanguages[o]:t_[t];e&&t_.registerLanguage(e)}t_.setLanguage(o),t=t_(t).format(i||"0")}return t}function n_(t,e,n,o,i,r,s){let l=r;if(Ty(l)){const t=s.className||"",n=t.length?t.split(" "):[];l=e_(l,s),n.indexOf("htLeft")<0&&n.indexOf("htCenter")<0&&n.indexOf("htRight")<0&&n.indexOf("htJustify")<0&&n.push("htRight"),n.indexOf("htNumeric")<0&&n.push("htNumeric"),s.className=n.join(" "),e.dir="ltr"}dI(t,e,n,o,i,l,s)}n_.RENDERER_TYPE="numeric";function o_(t,e,n,o,i,r,s){dI.apply(this,[t,e,n,o,i,r,s]);const l=s.hashLength||e.innerHTML.length,a=s.hashSymbol||"*";let h="";Ay(l-1,(()=>{h+=a})),Kp(e,h)}o_.RENDERER_TYPE="password";function i_(t,e,n,o,i,r,s){dI.apply(this,[t,e,n,o,i,r,s])}i_.RENDERER_TYPE="select";function r_(t,e,n,o,i,r,s){dI.apply(this,[t,e,n,o,i,r,s]),e.dir="ltr"}r_.RENDERER_TYPE="time";function s_(t,e){let n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,l_(n,e)):l_(n,e)(this.source):e(!0)}function l_(t,e){const n=t;return function(t){let o=!1;for(let e=0,i=t.length;e<i;e++)if(n===t[e]){o=!0;break}e(o)}}function a_(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}s_.VALIDATOR_TYPE="autocomplete";const h_=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:a_},Symbol.toStringTag,{value:"Module"}));function c_(t,e){const n=cv(IO,this.instance);let o=t,i=!0;null==o&&(o="");let r=kc(o,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=kc(new Date(o)).isValid()||r;if(this.allowEmpty&&""===o&&(s=!0,r=!0),s||(i=!1),!s&&r&&(i=!0),s&&!r)if(!0===this.correctFormat){const t=function(t,e){const n=kc(a_(t)),o=kc(t,e),i=t.search(/[A-z]/g)>-1;let r;r=n.isValid()&&n.format("x")===o.format("x")||!o.isValid()||i?n:o;return r.format(e)}(o,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,t,"dateValidator"),i=!0}else i=!1;e(i)}c_.VALIDATOR_TYPE="date";function u_(t,e){s_.apply(this,[t,e])}u_.VALIDATOR_TYPE="dropdown";function d_(t,e){let n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):e(""!==n&&Ty(t))}d_.VALIDATOR_TYPE="numeric";const g_=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function f_(t,e){const n=this.timeFormat||"h:mm:ss a";let o=!0,i=t;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const r=/^\d{1,2}$/.test(i);r&&(i+=":00");const s=kc(i,g_,!0).isValid()?kc(i):kc(i,n);let l=s.isValid(),a=kc(i,n,!0).isValid()&&!r;if(this.allowEmpty&&""===i&&(l=!0,a=!0),l||(o=!1),!l&&a&&(o=!0),l&&!a)if(!0===this.correctFormat){const t=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,t,"timeValidator"),o=!0}else o=!1;e(o)}f_.VALIDATOR_TYPE="time";const p_={CELL_TYPE:"autocomplete",editor:nO,renderer:jO,validator:s_},m_={CELL_TYPE:"checkbox",editor:oO,renderer:qO};function w_(t,e,n,o,i,r,s){jO.apply(this,[t,e,n,o,i,r,s])}w_.RENDERER_TYPE="date";const b_={CELL_TYPE:"date",editor:_O,renderer:w_,validator:c_},v_={CELL_TYPE:"dropdown",editor:PO,renderer:zO,validator:u_},y_={CELL_TYPE:"handsontable",editor:ZI,renderer:QO},C_={CELL_TYPE:"numeric",editor:NO,renderer:n_,validator:d_,dataType:"number"},S_={CELL_TYPE:"password",editor:DO,renderer:o_,copyable:!1},R_={CELL_TYPE:"select",editor:FO,renderer:i_},x_={CELL_TYPE:"time",editor:WO,renderer:r_,validator:f_};function E_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M_(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T_(t,e){return t.get(k_(t,e))}function k_(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const A_=new Map([["plugin",function(t){return!!$y(t)}],["cell-type",mA],["editor",sv],["renderer",qy],["validator",oC]]),H_=[];let I_=null;var O_=new WeakMap,__=new WeakSet;class P_{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){var e,n;E_(e=this,n=__),n.add(e),M_(this,"eventManager",new pv(this)),M_(this,"pluginName",null),M_(this,"pluginsInitializedCallbacks",[]),M_(this,"isPluginsReady",!1),M_(this,"enabled",!1),M_(this,"initialized",!1),function(t,e,n){E_(t,e),e.set(t,n)}(this,O_,{}),Sw(this,"hot",t,{writable:!1}),I_=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(t=>this.onUpdateSettings(t))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){const t=[];if(e.forEach((e=>{const[n,o]=e.split(":");if(!A_.has(n))throw new Error(`Unknown plugin dependency type "${n}" was found.`);A_.get(n)(o)||t.push(` - ${o} (${n})`)})),t.length>0){const e=[`The ${this.pluginName} plugin requires the following modules:\n`,`${t.join("\n")}\n`].join("");H_.push(e)}}I_||(I_=Yy()),I_.indexOf("UndoRedo")>=0&&I_.splice(I_.indexOf("UndoRedo"),1),I_.indexOf(this.pluginName)>=0&&I_.splice(I_.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));if(0===I_.length){if(H_.length>0){const t=[`${H_.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e,n){T_(O_,this)[t]=T_(O_,this)[t]||[];const o=T_(O_,this)[t];this.hot.addHook(t,e,n),o.push(e),T_(O_,this)[t]=o}removeHooks(t){jf(T_(O_,this)[t]||[],(e=>{this.hot.removeHook(t,e)}))}clearHooks(){const t=T_(O_,this);Rw(t,((t,e)=>this.removeHooks(e))),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){jf(this.pluginsInitializedCallbacks,(t=>t())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){const e=k_(__,this,N_).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),Rw(this,((t,e)=>{"hot"!==e&&(this[e]=null)})),delete this.t,delete this.hot}}function N_(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let n=0;n<e.length;n++)if(void 0!==t[e[n]])return!0;return!1}function D_(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const L_=class{constructor(t){D_(this,"hot",null),D_(this,"container",null),D_(this,"injected",!1),D_(this,"rows",[]),D_(this,"columns",[]),D_(this,"samples",null),D_(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(t){const e=this.hot.getColHeader(0);if(null!=e){const e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(t){this.injected||this.injectTable(),jf(this.rows,(e=>{const{height:n}=e.table.getBoundingClientRect();t(e.row,Math.ceil(n)-1)}))}getWidths(t){this.injected||this.injectTable(),jf(this.columns,(e=>{const{width:n}=e.table.getBoundingClientRect();t(e.col,Math.ceil(n))}))}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach((n=>{jf(n.strings,(n=>{e.appendChild(this.createColElement(n.col,t))}))})),e}createRow(t){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),o=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,o),n.appendChild(o)),this.samples.forEach((o=>{jf(o.strings,(o=>{const i=o.col,r=this.hot.getCellMeta(t,i),s=this.hot.getCellRenderer(r),l=e.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,t,i,this.hot.colToProp(i),o.value,r),n.appendChild(l)}))})),n}appendColumnHeadersRow(){const{rootDocument:t}=this.hot,e=t.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const o=t.createElement("th");n.push([-1,o]),e.appendChild(o)}this.samples.forEach((o=>{jf(o.strings,(o=>{const i=o.col,r=t.createElement("th");n.push([i,r]),e.appendChild(r)}))})),this.table.tHead.appendChild(e),jf(n,(t=>{const[e,n]=t;this.hot.view.appendColHeader(e,n)}))}createCol(t){const{rootDocument:e}=this.hot,n=e.createDocumentFragment();return this.samples.forEach((o=>{jf(o.strings,(o=>{const i=o.row,r=this.hot.getCellMeta(i,t),s=this.hot.getCellRenderer(r),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,i,t,this.hot.colToProp(t),o.value,r),a.appendChild(l),n.appendChild(a)}))})),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){const n=this.hot.rootDocument.createElement("col");let o=0;e>=0&&t>=0&&(o=this.hot.getCellMeta(e,t).colspan);let i=this.hot.getColWidth(t);if(o>1)for(let r=t+1;r<t+o;r++)i+=this.hot.getColWidth(r);return n.style.width=`${i}px`,n}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),o=e.createElement("table"),i=e.createElement("thead"),r=e.createElement("tbody"),s=e.createElement("colgroup"),l=e.createElement("tr"),a=e.createElement("th");return this.isVertical()&&o.appendChild(s),this.isHorizontal()&&(l.appendChild(a),i.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&r.appendChild(l),o.appendChild(r),Bp(o,t),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:r,colGroup:s,tr:l,th:a}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),o=e.createElement("div");return Bp(o,`htGhostTable htAutoSize ${t.trim()}`),n.appendChild(o),{fragment:n,container:o}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function V_(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class F_{static get SAMPLE_COUNT(){return 3}constructor(t){V_(this,"samples",null),V_(this,"dataFactory",null),V_(this,"customSampleCount",null),V_(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:F_.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,n){const o=new Map,{from:i,to:r}="number"==typeof n?{from:n,to:n}:n;return Ay(i,r,(n=>{const i=this.generateSample(t,e,n);o.set(n,i)})),o}generateSample(t,e,n){if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");const o=new Map,i="row"===t?"col":"row",r=[];return Ay(e.from,e.to,(e=>{const s="row"===t?this.dataFactory(n,e):this.dataFactory(e,n);if(!1===s)return;const{value:l,bundleSeed:a}=s,h="string"==typeof a&&a.length>0;let c;c=h?a:Cw(l)?`${Object.keys(l).length}`:Array.isArray(l)?`${l.length}`:`${Xf(l).length}`,o.has(c)||o.set(c,{needed:this.getSampleCount(),strings:[]});const u=o.get(c);if(u.needed){(!(r.indexOf(l)>-1)||this.allowDuplicates||h)&&(u.strings.push({value:l,[i]:e}),r.push(l),u.needed-=1)}})),o}}const W_=F_;function B_(t,e,n){j_(t,e),e.set(t,n)}function j_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z_(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U_(t,e){return t.get($_(t,e))}function Y_(t,e,n){return t.set($_(t,e),n),n}function $_(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("modifyAutoColumnSizeSeed");const G_="autoColumnSize";var K_=new WeakMap,X_=new WeakMap,q_=new WeakSet;class Z_ extends P_{static get PLUGIN_KEY(){return G_}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){var e,n;super(t),j_(e=this,n=q_),n.add(e),z_(this,"ghostTable",new L_(this.hot)),z_(this,"samplesGenerator",new W_(((t,e)=>{const n=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(o))return!1;const i=this.hot.getCellMeta(t,e);let r="";i.spanned||(r=this.hot.getDataAtCell(t,e));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,r)),{value:r,bundleSeed:s}}))),z_(this,"inProgress",!1),z_(this,"measuredColumns",0),z_(this,"columnWidthsMap",new NE),B_(this,K_,[]),B_(this,X_,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",((t,e,n)=>$_(q_,this,nP).call(this,t,e,n)))}isEnabled(){return!1!==this.hot.getSettings()[G_]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[G_];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $_(q_,t,tP).call(t,...n)})),this.addHook("beforeChangeRender",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $_(q_,t,eP).call(t,...n)})),this.addHook("afterFormulasValuesUpdate",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $_(q_,t,iP).call(t,...n)})),this.addHook("beforeRender",(()=>$_(q_,this,J_).call(this))),this.addHook("modifyColWidth",((t,e)=>this.getColumnWidth(e,t))),this.addHook("init",(()=>$_(q_,this,oP).call(this))),super.enablePlugin()}updatePlugin(){Y_(X_,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((t,e,n)=>$_(q_,this,nP).call(this,t,e,n)))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.getFirstVisibleColumn(),e=this.getLastVisibleColumn();if(-1===t||-1===e)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:t,to:e},void 0,n)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o="number"==typeof t?{from:t,to:t}:t,i="number"==typeof e?{from:e,to:e}:e;Ay(o.from,o.to,(t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),n||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){this.samplesGenerator.generateColumnSamples(t,i).forEach(((t,e)=>this.ghostTable.addColumn(e,t)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const o=this.hot.countCols()-1;let i=null;this.inProgress=!0;const r=()=>{if(!this.hot)return Iw(i),void(this.inProgress=!1);this.calculateColumnsWidth({from:n,to:Math.min(n+Z_.CALCULATION_STEP,o)},t,e),n=n+Z_.CALCULATION_STEP+1,n<o?i=Hw(r):(Iw(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateColumnsWidth({from:0,to:s},t,e),n=s+1),n<o?r():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[G_],e=t&&kw(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&kw(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[G_];let e=Z_.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Cw(t)&&(e=t.syncLimit,gp(e)?e=Iy(n,e):e>>=0),Math.min(e,n)}getColumnWidth(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=e;return void 0===o&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),n&&"number"==typeof o&&(o=Math.max(o,50))),o}getFirstVisibleColumn(){var t;return null!==(t=this.hot.view.getFirstRenderedVisibleColumn())&&void 0!==t?t:-1}getLastVisibleColumn(){var t;return null!==(t=this.hot.view.getLastRenderedVisibleColumn())&&void 0!==t?t:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce(((t,e,n)=>{const o=U_(K_,this).length;return(o-1<n||U_(K_,this)[n]!==e)&&t.push(this.hot.toVisualColumn(n)),o-1<n?U_(K_,this).push(e):U_(K_,this)[n]=e,t}),[])}clearCache(t){Array.isArray(t)?this.hot.batchExecution((()=>{t.forEach((t=>{this.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter((t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Q_(t){const e={from:0,to:this.hot.countRows()-1};t.forEach((t=>{const n=this.hot.toPhysicalColumn(t);if(null!==n&&!this.hot._getColWidthFromSettings(n)){this.samplesGenerator.generateColumnSamples(t,e).forEach(((t,e)=>this.ghostTable.addColumn(e,t)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)}))}),!0),this.ghostTable.clean())}function J_(){this.calculateVisibleColumnsWidth(),this.inProgress||($_(q_,this,Q_).call(this,U_(X_,this)),Y_(X_,this,[]))}function tP(t,e){e||this.recalculateAllColumnsWidth()}function eP(t){const e=t.reduce(((t,e)=>{let[,n]=e;const o=this.hot.propToCol(n);return Number.isInteger(o)&&-1===t.indexOf(o)&&t.push(o),t}),[]);U_(X_,this).push(...e)}function nP(t,e,n){let o=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),o=this.getColumnWidth(e,void 0,!1)),o}function oP(){Y_(K_,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function iP(t){const e=t.reduce(((t,e)=>{var n;const o=null===(n=e.address)||void 0===n?void 0:n.col;if(Number.isInteger(o)){const e=this.hot.toVisualColumn(o);-1===t.indexOf(e)&&t.push(e)}return t}),[]);U_(X_,this).push(...e)}const rP={horizontal:"horizontal",vertical:"vertical"};function sP(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function lP(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aP(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("modifyAutofillRange"),tv.getSingleton().register("beforeAutofill"),tv.getSingleton().register("afterAutofill");const hP="autofill",cP=["fillHandle"];var uP=new WeakSet;class dP extends P_{constructor(){super(...arguments),sP(this,uP),lP(this,"addingStarted",!1),lP(this,"mouseDownOnCellCorner",!1),lP(this,"mouseDragOutside",!1),lP(this,"handleDraggedCells",0),lP(this,"directions",[]),lP(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return hP}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[hP,...cP]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(t=>aP(uP,this,fP).call(this,t))),this.addHook("afterOnCellCornerDblClick",(t=>aP(uP,this,gP).call(this,t))),this.addHook("beforeOnCellMouseOver",((t,e)=>aP(uP,this,pP).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const t=this.hot.getSelectedRangeLast(),{row:e,col:n}=t.getTopStartCorner(),{row:o,col:i}=t.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:n,endRow:o,endCol:i}]),s=[],l=[],a=[];return jf(r,(t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===s.indexOf(e)&&s.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===l.indexOf(e)&&l.push(e)})),jf(s,(t=>{const e=[];jf(l,(n=>{e.push(this.hot.getCopyableData(t,n))})),a.push(e)})),a}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[t,e,n,o]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),s=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[r.row,r.col,s.row,s.col],a=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,t),Math.min(r.col,e),Math.max(s.row,n),Math.max(s.col,o)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:u}=function(t,e,n){let o,i,r;return e[0]===t[0]&&e[1]<t[1]?(r="left",o=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(r="right",o=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(r="up",o=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",o=n(t[2]+1,e[1]),i=n(e[2],e[3])),o&&o.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:o,endOfDragCoords:i}}(l,a,((t,e)=>this.hot._createCellCoords(t,e)));if(c&&c.row>-1&&c.col>-1){const t=this.getSelectionData(),e=i.clone(),n=this.hot._createCellRange(c,c,u),o=this.hot.runHooks("beforeAutofill",t,e,n,h);if(!1===o)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let r=o;const s=o;if(["up","left"].indexOf(h)>-1&&(1!==s.length||0!==s[0].length))if(r=[],"up"===h){const t=u.row-c.row+1,e=t%s.length;for(let n=0;n<t;n++)r.push(s[(n+(s.length-e))%s.length])}else{const t=u.col-c.col+1,e=t%s[0].length;for(let n=0;n<s.length;n++){r.push([]);for(let o=0;o<t;o++)r[n].push(s[n][(o+(s[n].length-e))%s[n].length])}}this.hot.populateFromArray(c.row,c.col,r,u.row,u.col,`${this.pluginName}.fill`,null),this.setSelection(a),this.hot.runHooks("afterAutofill",r,e,n,h),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){const e=this.hot.getSelectedRangeLast(),n=e.getBottomEndCorner();let o=t;if(this.directions.includes(rP.vertical)&&this.directions.includes(rP.horizontal)){const i=e.getTopStartCorner();(n.col<=t.col||i.col>=t.col)&&(o=this.hot._createCellCoords(n.row,t.col)),(n.row<t.row||i.row>t.row)&&(o=this.hot._createCellCoords(t.row,n.col))}else if(this.directions.includes(rP.vertical))o=this.hot._createCellCoords(t.row,n.col);else{if(!this.directions.includes(rP.horizontal))return;o=this.hot._createCellCoords(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(o)}showBorder(t){const e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){const e=this.hot.getData(),n=this.hot.countRows();let o;for(let i=t[2]+1;i<n;i++){for(let o=t[1];o<=t[3];o++){if(!Qf(e[i][o]))return-1}const n=e[i][t[1]-1],r=e[i][t[3]+1];Qf(n)&&Qf(r)||(o=i)}return o}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...Bf(t,(t=>Math.max(t,0))),!1,!1)}selectAdjacent(){const t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){const{documentElement:e}=this.hot.rootDocument,n=Zp(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+hm(this.hot.table),o=Zp(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+am(this.hot.table);return t.clientY>n&&t.clientX<=o}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",(()=>aP(uP,this,mP).call(this))),this.eventManager.addEventListener(t,"mousemove",(t=>aP(uP,this,wP).call(this,t)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const t=function(t){const e={};return!0===t?(e.directions=Object.keys(rP),e.autoInsertRow=!0):Cw(t)?(qf(t.autoInsertRow)?t.direction===rP.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,qf(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(rP)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function gP(){this.selectAdjacent()&&this.fillIn()}function fP(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function pP(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function mP(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function wP(t){const e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function bP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vP(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yP(t,e){return t.get(CP(t,e))}function CP(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SP="autoRowSize";var RP=new WeakMap,xP=new WeakSet;class EP extends P_{static get PLUGIN_KEY(){return SP}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){var e,n;super(t),bP(e=this,n=xP),n.add(e),vP(this,"headerHeight",null),vP(this,"ghostTable",new L_(this.hot)),vP(this,"samplesGenerator",new W_(((t,e)=>{const n=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(o))return!1;if(t>=0&&e>=0){if(this.hot.getCellMeta(t,e).hidden)return!1}let i;return t>=0?i=this.hot.getDataAtCell(t,e):-1===t&&(i=this.hot.getColHeader(e)),{value:i}}))),vP(this,"inProgress",!1),vP(this,"measuredRows",0),vP(this,"rowHeightsMap",new NE),function(t,e,n){bP(t,e),e.set(t,n)}(this,RP,[]),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",((t,e,n)=>CP(xP,this,kP).call(this,t,e,n)))}isEnabled(){const t=this.hot.getSettings()[SP];return!0===t||Cw(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return CP(xP,t,AP).call(t,...n)})),this.addHook("beforeChangeRender",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return CP(xP,t,HP).call(t,...n)})),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("afterFormulasValuesUpdate",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return CP(xP,t,OP).call(t,...n)})),this.addHook("beforeRender",(()=>CP(xP,this,TP).call(this))),this.addHook("modifyRowHeight",((t,e)=>this.getRowHeight(e,t))),this.addHook("init",(()=>CP(xP,this,IP).call(this))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((t,e,n)=>CP(xP,this,kP).call(this,t,e,n)))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const t=this.getFirstVisibleRow(),e=this.getLastVisibleRow();if(-1===t||-1===e)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:t,to:e},void 0,n)}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o="number"==typeof t?{from:t,to:t}:t,i="number"==typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){const t=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(t.get(-1))}Ay(o.from,o.to,(t=>{let e=this.hot.toPhysicalRow(t);if(null===e&&(e=t),n||null===this.rowHeightsMap.getValueAtIndex(e)){this.samplesGenerator.generateRowSamples(t,i).forEach(((t,e)=>this.ghostTable.addRow(e,t)))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const o=this.hot.countRows()-1;let i=null;this.inProgress=!0;const r=()=>{if(!this.hot)return Iw(i),void(this.inProgress=!1);this.calculateRowsHeight({from:n,to:Math.min(n+EP.CALCULATION_STEP,o)},t,e),n=n+EP.CALCULATION_STEP+1,n<o?i=Hw(r):(Iw(i),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateRowsHeight({from:0,to:s},t,e),n=s+1),n<o?r():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const t=this.hot.getSettings()[SP],e=t&&kw(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&kw(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[SP];let e=EP.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return Cw(t)&&(e=t.syncLimit,gp(e)?e=Iy(n,e):e>>=0),Math.min(e,n)}getRowHeight(t,e){const n=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let o=e;return null!==n&&n>(e||0)&&(o=n),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var t;return null!==(t=this.hot.view.getFirstRenderedVisibleRow())&&void 0!==t?t:-1}getLastVisibleRow(){var t;return null!==(t=this.hot.view.getLastRenderedVisibleRow())&&void 0!==t?t:-1}clearCache(t){this.headerHeight=null,Array.isArray(t)?this.hot.batchExecution((()=>{t.forEach((t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0):this.rowHeightsMap.clear()}clearCacheByRange(t){const{from:e,to:n}="number"==typeof t?{from:t,to:t}:t;this.hot.batchExecution((()=>{Ay(Math.min(e,n),Math.max(e,n),(t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter((t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function MP(t){const e={from:0,to:this.hot.countCols()-1};t.forEach((t=>{this.samplesGenerator.generateRowSamples(t,e).forEach(((t,e)=>this.ghostTable.addRow(e,t)))})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{const n=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(n,e)}))}),!0),this.ghostTable.clean())}function TP(){var t,e,n;this.calculateVisibleRowsHeight(),this.inProgress||(CP(xP,this,MP).call(this,yP(RP,this)),e=this,n=[],(t=RP).set(CP(t,e),n))}function kP(t,e,n){let o=t;return n&&(this.calculateRowsHeight(e,void 0,!0),o=this.getRowHeight(e)),o}function AP(t,e){e||this.recalculateAllRowsHeight()}function HP(t){const e=t.reduce(((t,e)=>{let[n]=e;return-1===t.indexOf(n)&&t.push(n),t}),[]);yP(RP,this).push(...e)}function IP(){this.recalculateAllRowsHeight()}function OP(t){const e=t.reduce(((t,e)=>{var n;const o=null===(n=e.address)||void 0===n?void 0:n.row;if(Number.isInteger(o)){const e=this.hot.toVisualRow(o);-1===t.indexOf(e)&&t.push(e)}return t}),[]);yP(RP,this).push(...e)}const{getListWithInsertedItems:_P,getListWithRemovedItems:PP}=YE("physicallyIndexed");const NP=class extends OE{constructor(){super((t=>t))}insert(t,e){const n=WE(this.indexedValues,e);this.indexedValues=_P(n,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){const e=PP(this.indexedValues,t);this.indexedValues=FE(e,t),super.remove(t)}},{getListWithInsertedItems:DP,getListWithRemovedItems:LP}=YE("physicallyIndexed");const VP=class extends OE{constructor(){super((t=>t))}insert(t,e){this.indexedValues=DP(this.indexedValues,t,e,((t,e)=>this.getNextValue(e))),super.insert(t,e)}remove(t){this.indexedValues=LP(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}};function FP(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function WP(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const BP="bindRowsWithHeaders",jP=new Map([["loose",NP],["strict",VP]]);var zP=new WeakSet;class UP extends P_{constructor(){super(...arguments),FP(this,zP),WP(this,"headerIndexes",null)}static get PLUGIN_KEY(){return BP}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[BP]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[BP];"string"!=typeof t&&(t="loose");const e=jP.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",(t=>function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(zP,this,YP).call(this,t))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function YP(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function $P(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GP(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KP(t,e){return t.get(qP(t,e))}function XP(t,e,n){return t.set(qP(t,e),n),n}function qP(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ZP="collapsibleColumns",QP=["nestedHeaders"],JP="collapsibleIndicator",tN=ZP,eN=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var nN=new WeakMap,oN=new WeakSet;class iN extends P_{constructor(){var t,e;super(...arguments),$P(t=this,e=oN),e.add(t),GP(this,"nestedHeadersPlugin",null),GP(this,"headerStateManager",null),function(t,e,n){$P(t,e),e.set(t,n)}(this,nN,null)}static get PLUGIN_KEY(){return ZP}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[ZP,...QP]}isEnabled(){return!!this.hot.getSettings()[ZP]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();e||Ub("You need to configure the Nested Headers plugin in order to use collapsible headers."),XP(nN,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>qP(oN,this,lN).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qP(oN,t,aN).call(t,...n)})),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return qP(oN,t,rN).call(t,...n)})),this.addHook("beforeOnCellMouseDown",((t,e,n)=>qP(oN,this,sN).call(this,t,e,n))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:t}=this.hot.getSettings();"boolean"==typeof t?this.headerStateManager.mapState((t=>({collapsible:t.origColspan>1}))):Array.isArray(t)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),XP(nN,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;const{row:e,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:o,isCollapsed:i,columnIndex:r}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,n))&&void 0!==t?t:{};if(o)return i?this.expandSection({row:e,col:r}):this.collapseSection({row:e,col:r}),!1},runOnlyIf:()=>{var t,e;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader())},group:tN,relativeToGroup:GA,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tN)}clearButtons(){if(!this.hot.view)return;const t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(t){t&&t.parentNode.removeChild(t)};Ay(0,t-1,(t=>{const r=e.childNodes[t],s=n.childNodes[t],l=o?o.childNodes[t]:null;Ay(0,r.childNodes.length-1,(t=>{let e=r.childNodes[t].querySelector(`.${JP}`);i(e),s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(`.${JP}`),i(e)),o&&l&&l.childNodes[t]&&(e=l.childNodes[t].querySelector(`.${JP}`),i(e))}))}))}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){const e=this.headerStateManager.mapNodes((e=>{const{collapsible:n,origColspan:o,headerLevel:i,columnIndex:r,isCollapsed:s}=e;if(!0===n&&o>1&&(s&&"expand"===t||!s&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(i),col:r}}));this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!eN.has(e))throw new Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;const n=Wf(t,(t=>{let{row:e}=t;return e<0}));let o=n.length>0;jf(n,(t=>{var n;let{row:i,col:r}=t;const{collapsible:s,isCollapsed:l}=null!==(n=this.headerStateManager.getHeaderSettings(i,r))&&void 0!==n?n:{};if(!s||l&&"collapse"===e||!l&&"expand"===e)return o=!1,!1}));const i=[],r=[];o&&jf(n,(t=>{let{row:n,col:o}=t;const{colspanCompensation:s,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(e,n,o);s>0&&(r.push(...l),i.push(a))}));const s=this.getCollapsedColumns();let l=[];"collapse"===e?l=Uf([...s,...r]):"expand"===e&&(l=Wf(s,(t=>!r.includes(t))));const a=eN.get(e);if(!1===this.hot.runHooks(a.beforeHook,s,l,o))return void jf(i,(t=>{t()}));this.hot.batchExecution((()=>{jf(r,(t=>{KP(nN,this).setValueAtIndex(this.hot.toPhysicalColumn(t),a.hideColumn)}))}),!0);const h=this.getCollapsedColumns().length!==s.length,c=this.hot.getSelectedRangeLast();if("collapse"===e&&h&&c){const{row:t,col:e}=c.highlight;if((this.hot.rowIndexMapper.isHidden(t)||this.hot.columnIndexMapper.isHidden(e))&&r.includes(e)){const n=t>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(t,1,!0):t,o=e>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(e,1,!0):e;null!==n&&null!==o&&this.hot.selectCell(n,o)}}this.hot.runHooks(a.afterHook,s,l,o,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return KP(nN,this).getHiddenIndexes()}destroy(){XP(nN,this,null),super.destroy()}}function rN(t,e,n){var o;const{collapsible:i,origColspan:r,isCollapsed:s}=null!==(o=this.headerStateManager.getHeaderSettings(n,t))&&void 0!==o?o:{},l=i&&r>1&&t>=this.hot.getSettings().fixedColumnsStart,a=this.hot.getSettings().ariaTags;let h=e.querySelector(`.${JP}`);var c;(Up(e,[Ep("")[0]]),l)?(h||(h=this.hot.rootDocument.createElement("div"),Bp(h,JP),e.querySelector("div:first-child").appendChild(h)),jp(h,["collapsed","expanded"]),s?(Bp(h,"collapsed"),Xp(h,"+"),a&&zp(e,...Ep(!1))):(Bp(h,"expanded"),Xp(h,"-"),a&&zp(e,...Ep(!0))),a&&zp(h,"aria-hidden","true")):null===(c=h)||void 0===c||c.remove()}function sN(t,e){Wp(t.target,JP)&&(Wp(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Wp(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),lb(t))}function lN(){this.updatePlugin()}function aN(t,e){e||this.updatePlugin()}function hN(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const cN=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class uN{constructor(t,e){hN(this,"hot",void 0),hN(this,"sortingStates",new jE),hN(this,"sortEmptyCells",false),hN(this,"indicator",true),hN(this,"headerAction",true),hN(this,"compareFunctionFactory",void 0),hN(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){Cw(t)&&Rw(t,((t,e)=>{cN.includes(e)&&(this[e]=t)}))}getAllColumnsProperties(){const t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((e=>{let[n]=e;return n===t}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return Cw(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){if(null===this.sortingStates)return[];return this.sortingStates.getEntries().map((t=>{let[e,n]=t;return $({column:this.hot.toVisualColumn(e)},n)}))}getColumnSortState(t){const e=this.getSortOrderOfColumn(t);if(qf(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function dN(t,e,n){const o=e.locale;return function(e,i){const{sortEmptyCells:r}=n;return"string"==typeof e&&(e=e.toLocaleLowerCase(o)),"string"==typeof i&&(i=i.toLocaleLowerCase(o)),e===i?yN:Qf(e)?Qf(i)?yN:r&&"asc"===t?CN:SN:Qf(i)?r&&"asc"===t?SN:CN:isNaN(e)&&!isNaN(i)?"asc"===t?SN:CN:!isNaN(e)&&isNaN(i)?"asc"===t?CN:SN:(isNaN(e)||isNaN(i)||(e=parseFloat(e),i=parseFloat(i)),e<i?"asc"===t?CN:SN:e>i?"asc"===t?SN:CN:yN)}}const gN="default";const{register:fN,getItem:pN,hasItem:mN}=nv("sorting.compareFunctionFactory"),{register:wN,getItem:bN}=nv("sorting.mainSortComparator");function vN(t){return mN(t)?pN(t):pN(gN)}fN("checkbox",(function(t,e,n){const o=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:r}=n;return function(s,l){const a=Qf(s),h=Qf(l),c=a?i:s,u=h?i:l,d=c===i||c===o,g=u===i||u===o;if(!1===r){if(a&&!1===h)return SN;if(!1===a&&h)return CN}return!1===d&&g?"asc"===t?CN:SN:d&&!1===g?"asc"===t?SN:CN:!1===d&&!1===g?dN(t,e,n)(s,l):c===i&&u===o?"asc"===t?CN:SN:c===o&&u===i?"asc"===t?SN:CN:yN}})),fN("date",(function(t,e,n){return IN(t,e.dateFormat,n)})),fN(gN,dN),fN("numeric",(function(t,e,n){return function(e,o){const i=parseFloat(e),r=parseFloat(o),{sortEmptyCells:s}=n;if(i===r||isNaN(i)&&isNaN(r))return yN;if(s){if(Qf(e))return"asc"===t?CN:SN;if(Qf(o))return"asc"===t?SN:CN}return isNaN(i)?SN:isNaN(r)?CN:i<r?"asc"===t?CN:SN:i>r?"asc"===t?SN:CN:yN}})),fN("time",(function(t,e,n){return IN(t,e.timeFormat,n)}));const yN=0,CN=-1,SN=1;const RN="asc",xN="desc",EN="colHeader";function MN(t){if(t.some((t=>!1===function(t){if(!1===Cw(t))return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[RN,xN].includes(n)}(t))))return!1;const e=t.map((t=>{let{column:e}=t;return e}));return new Set(e).size===e.length}function TN(t){if(t!==xN)return t===RN?xN:RN}function kN(t){return t.querySelector(`.${EN}`)}function AN(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(e.parentNode)-n.length}function HN(t,e,n){return-1===t&&e>=0&&!1===hb(n)}function IN(t,e,n){return function(o,i){const{sortEmptyCells:r}=n;if(o===i)return yN;if(Qf(o))return Qf(i)?yN:r&&"asc"===t?CN:SN;if(Qf(i))return r&&"asc"===t?SN:CN;const s=kc(o,e),l=kc(i,e);return s.isValid()?l.isValid()?l.isAfter(s)?"asc"===t?CN:SN:l.isBefore(s)?"asc"===t?SN:CN:yN:CN:SN}}const ON="indicatorDisabled",_N="columnSorting",PN="sortAction",NN=new Map([[RN,"ascending"],[xN,"descending"]]);function DN(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function LN(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VN(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const FN="columnSorting",WN="append",BN=FN;wN(FN,(function(t,e){return function(n,o){const[,...i]=n,[,...r]=o;return function(n){const o=t[n],s=e[n],l=i[n],a=r[n],h=s.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:vN(s.type))(o,s,h)(l,a)}(0)}})),tv.getSingleton().register("beforeColumnSort"),tv.getSingleton().register("afterColumnSort");var jN=new WeakSet;class zN extends P_{constructor(){super(...arguments),DN(this,jN),LN(this,"columnStatesManager",null),LN(this,"columnMetaCache",null),LN(this,"pluginKey",FN),LN(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return FN}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new uN(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new NE((t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((t,e)=>VN(jN,this,YN).call(this,t,e))),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return VN(jN,t,GN).call(t,...n)})),this.addHook("afterOnCellMouseDown",((t,e)=>this.onAfterOnCellMouseDown(t,e))),this.addHook("afterInit",(()=>VN(jN,this,UN).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return VN(jN,t,$N).call(t,...n)})),this.hot.view&&VN(jN,this,UN).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const t=(t,e)=>{const n=kN(e);!1!==AN(t,e)&&null!==n&&this.updateHeaderClasses(n)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(t.col)),!1},runOnlyIf:()=>{var t,e;const n=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return n&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.row&&n.col>=0},relativeToGroup:GA,position:"before",group:BN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(BN)}sort(t){const e=this.getSortConfig(),n=this.getNormalizedSortConfigs(t),o=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",e,n,o)&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new $E),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",e,o?n:e,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return qf(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){const e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){const e=this.hot.countCols();return MN(t)&&t.every((t=>{let{column:n}=t;return n<=e&&n>=0}))}saveAllSortSettings(t){const e=this.columnStatesManager.getAllColumnsProperties();e.initialConfig=Bf(t,(t=>{let{column:e}=t,n=U(t,l);return $({column:this.hot.toPhysicalColumn(e)},n)})),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){const t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);const e=t.value,n=t=>{let{column:e}=t,n=U(t,a);return $({column:this.hot.toVisualColumn(e)},n)};return qf(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=Bf(e.initialConfig,n)),e}getColumnNextConfig(t){const e=this.columnStatesManager.getSortOrderOfColumn(t);if(qf(e)){const n=TN(e);return qf(n)?{column:t,sortOrder:n}:void 0}const n=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<n)return{column:t,sortOrder:TN()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:WN;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(t),o=-1!==n,i=this.getSortConfig(),r=this.getColumnNextConfig(t);if(o){if(Zf(r))return[...i.slice(0,n),...i.slice(n+1)];if(e===WN)return[...i.slice(0,n),...i.slice(n+1),r];if("replace"===e)return[...i.slice(0,n),r,...i.slice(n+1)]}return qf(r)?i.concat(r):i}getPluginColumnConfig(t){if(Cw(t)){const e=t[this.pluginKey];if(Cw(e))return e}return{}}getMergedPluginSettings(t){const e=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(o);return Array.isArray(i.columns)?Object.assign(n,e,this.getPluginColumnConfig(i.columns[t])):Hm(i.columns)?Object.assign(n,e,this.getPluginColumnConfig(i.columns(t))):Object.assign(n,e)}getFirstCellSettings(t){const e=this.hot.getCellMeta(0,t),n=Object.create(e);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),n}getNumberOfRowsToSort(t){const e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===t.length)return;const e=[],n=this.hot.countRows(),o=e=>Bf(t,(t=>this.hot.getDataAtCell(e,t.column)));for(let a=0;a<this.getNumberOfRowsToSort(n);a+=1)e.push([this.hot.toPhysicalRow(a)].concat(o(a)));const i=Bf(e,(t=>t[0]));!function(t,e){const n=bN(e);for(var o=arguments.length,i=new Array(o>2?o-2:0),r=2;r<o;r++)i[r-2]=arguments[r];t.sort(n(...i))}(e,this.pluginKey,Bf(t,(t=>t.sortOrder)),Bf(t,(t=>this.getFirstCellSettings(t.column))));for(let a=e.length;a<n;a+=1)e.push([a].concat(o(a)));const r=Bf(e,(t=>t[0])),s=new Map(Bf(i,((t,e)=>[t,r[e]]))),l=Bf(this.hot.rowIndexMapper.getIndexesSequence(),(t=>s.has(t)?s.get(t):t));this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(t){if(Cw(t)){this.columnStatesManager.updateAllColumnsProperties(t);const e=t.initialConfig;(Array.isArray(e)||Cw(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if(jp(t,Array.from(NN.values()).concat(PN,ON,_N)),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];Bp(t,function(t,e,n,o){const i=[_N];if(o&&i.push(PN),!1===n)return i.push(ON),i;const r=t.getSortOrderOfColumn(e);return qf(r)&&i.push(NN.get(r)),i}(...n))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),qf(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&Wp(t.target,EN)}onAfterOnCellMouseDown(t,e){if(!1!==HN(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col));const t=this.hot.getActiveEditor(),n=this.getColumnNextConfig(e.col);null!=t&&t.isOpened()&&this.hot.getCellValidator(t.row,t.col)?this.hot.addHookOnce("postAfterValidate",(()=>{this.sort(n)})):this.sort(n)}}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function UN(){const t=this.getAllSavedSortSettings();if(Cw(t))this.sortBySettings(t);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function YN(t,e){const n=kN(e);if(!1===AN(t,e)||null===n)return;const o=this.getFirstCellSettings(t)[this.pluginKey],i=o.indicator,r=o.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,r),this.hot.getSettings().ariaTags){const n=this.columnStatesManager.getSortOrderOfColumn(t);zp(e,...(s=n?`${n}ending`:"none",["aria-sort",s]))}var s}function $N(t){!0===t&&this.hot.view&&VN(jN,this,UN).call(this)}function GN(t,e,n,o){!1!==HN(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(o.column=!0)}function KN(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const XN=class{constructor(t,e){KN(this,"plugin",void 0),KN(this,"hot",void 0),KN(this,"endpoints",[]),KN(this,"settings",void 0),KN(this,"settingsType","array"),KN(this,"currentEndpoint",null),KN(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){const e=[];let n=t;if(n||"function"!=typeof this.settings)return n||(n=this.settings),jf(n,(t=>{const n={};this.assignSetting(t,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,n,"reversedRowCoords",!1),this.assignSetting(t,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,n,"sourceColumn",t.destinationColumn),this.assignSetting(t,n,"type","sum"),this.assignSetting(t,n,"forceNumeric",!1),this.assignSetting(t,n,"suppressDataTypeErrors",!0),this.assignSetting(t,n,"customFunction",null),this.assignSetting(t,n,"readOnly",!0),this.assignSetting(t,n,"roundFloat",!1),e.push(n)})),e;this.settingsType="function"}assignSetting(t,e,n,o){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(o instanceof Error)throw o;e[n]=o}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=o}resetSetupBeforeStructureAlteration(t,e,n){if("function"!==this.settingsType)return;const o=t.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();jf(i,(i=>{"row"===o&&i.destinationRow>=e&&("insert_row"===t?i.alterRowOffset=n:"remove_row"===t&&(i.alterRowOffset=-1*n)),"col"===o&&i.destinationColumn>=e&&("insert_col"===t?i.alterColumnOffset=n:"remove_col"===t&&(i.alterColumnOffset=-1*n))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(t,e,n,o,i){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",t)}const s=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===t.indexOf("move_row"),c=e;jf(a,(t=>{"row"===s&&t.destinationRow>=c&&(t.alterRowOffset=l*n),"col"===s&&t.destinationColumn>=c&&(t.alterColumnOffset=l*n)})),this.resetAllEndpoints(a,!h),jf(a,h?t=>{this.extendEndpointRanges(t,c,o[0],o.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}:t=>{this.shiftEndpointCoordinates(t,c)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,n,o){jf(t.ranges,(t=>{t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=o:n<t[0]&&(t[0]-=o):n>=t[0]&&n<=t[1]&&(t[1]-=o,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}recreatePhysicalRanges(t){const e=t.ranges,n=[],o=[];jf(e,(t=>{const e=[];if(t[1])for(let n=t[0];n<=t[1];n++)e.push(this.hot.toPhysicalRow(n));else e.push(this.hot.toPhysicalRow(t[0]));o.push(e)})),jf(o,(t=>{let e=[];jf(t,((o,i)=>{0===i?e.push(o):t[i]!==t[i-1]+1&&(e.push(t[i-1]),n.push(e),e=[],e.push(o)),i===t.length-1&&(e.push(o),n.push(e))}))})),t.ranges=n}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,jf(t.ranges,(n=>{jf(n,((o,i)=>{o>=e&&(n[i]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.some((t=>{const e=t.alterRowOffset||0,n=t.alterColumnOffset||0;return t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+n>=this.hot.countCols()}))||(this.cellsToSetCache=[],jf(t,(t=>{this.resetEndpointValue(t,e)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],jf(this.getAllEndpoints(),(t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){const e=[];this.cellsToSetCache=[],jf(t,((t,n,o)=>{`${t[2]||""}`!=`${t[3]}`&&jf(this.getAllEndpoints(),((t,i)=>{this.hot.propToCol(o[n][1])===t.sourceColumn&&-1===e.indexOf(i)&&e.push(i)}))})),jf(e,(t=>{this.refreshEndpoint(this.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach((t=>{const e=this.hot.toVisualRow(t.destinationRow);if(null!==e){const n=this.hot.getCellMeta(e,t.destinationColumn);n.readOnly=t.readOnly,n.className="columnSummaryResult"}}))}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.alterRowOffset||0,o=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?n:0)),this.hot.toVisualColumn(t.destinationColumn+(e?o:0)),""])}setEndpointValue(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(t.destinationRow);if(null!==i){const n=this.hot.getCellMeta(i,t.destinationColumn);"init"!==e&&n.readOnly===t.readOnly||(n.readOnly=t.readOnly,n.className="columnSummaryResult")}if((!0===t.roundFloat||Number.isInteger(t.roundFloat))&&!isNaN(t.result)){const e=t.roundFloat;let n=0;Number.isInteger(e)&&(n=Math.min(Math.max(0,e),100)),t.result=t.result.toFixed(n)}n?this.hot.setDataAtCell(o,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ub("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};function qN(t){return null==t||isNaN(t)}function ZN(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function QN(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JN(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tD="columnSummary";var eD=new WeakSet;class nD extends P_{constructor(){super(...arguments),ZN(this,eD),QN(this,"endpoints",null)}static get PLUGIN_KEY(){return tD}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[tD]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[tD],this.endpoints=new XN(this,this.settings),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return JN(eD,t,oD).call(t,...n)})),this.addHook("afterChange",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return JN(eD,t,rD).call(t,...n)})),this.addHook("afterUpdateSettings",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return JN(eD,t,iD).call(t,...n)})),this.addHook("beforeCreateRow",((t,e,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,n))),this.addHook("beforeCreateCol",((t,e,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,n))),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)})),this.addHook("afterCreateRow",((t,e,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,n))),this.addHook("afterCreateCol",((t,e,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,n))),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)})),this.addHook("afterRowMove",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return JN(eD,t,sD).call(t,...n)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}calculateSum(t){let e=0;return Rw(t.ranges,(n=>{e+=this.getPartialSum(n,t.sourceColumn)})),e}getPartialSum(t,e){let n=0,o=t[1]||t[0],i=null,r=0;do{if(i=this.getCellValue(o,e),i=qN(i)?null:i,null!==i){const t=(`${i}`.split(".")[1]||[]).length||1;t>r&&(r=t)}n+=i||0,o-=1}while(o>=t[0]);return Math.round(n*Math.pow(10,r))/Math.pow(10,r)}calculateMinMax(t,e){let n=null;return Rw(t.ranges,(o=>{const i=this.getPartialMinMax(o,t.sourceColumn,e);if(null===n&&null!==i&&(n=i),null!==i)switch(e){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i)}})),null===n?"Not enough data":n}getPartialMinMax(t,e,n){let o,i=null,r=t[1]||t[0];do{if(o=this.getCellValue(r,e),o=qN(o)?null:o,null===i)i=o;else if(null!==o)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o)}r-=1}while(r>=t[0]);return i}countEmpty(t,e){let n,o=0,i=t[1]||t[0];do{n=this.getCellValue(i,e),n=qN(n)?null:n,null===n&&(o+=1),i-=1}while(i>=t[0]);return o}countEntries(t){let e=0;return Rw(t.ranges,(n=>{const o=void 0===n[1]?1:n[1]-n[0]+1,i=this.countEmpty(n,t.sourceColumn);e+=o,e-=i})),e}calculateAverage(t){return this.calculateSum(t)/this.countEntries(t)}getCellValue(t,e){const n=this.hot.toVisualRow(t),o=this.hot.toVisualColumn(e);let i=this.hot.getSourceDataAtCell(t,e),r="";if(null!==n&&null!==o&&(r=this.hot.getCellMeta(n,o).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Kf(E||(E=j`ColumnSummary plugin: cell at (${0}, ${0}) is not in a\x20
          numeric format. Cannot do the calculation.`),t,e));return i}}function oD(){this.endpoints.initEndpoints()}function iD(t){void 0!==t.columns&&this.endpoints.refreshCellMetas()}function rD(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function sD(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function lD(t,e,n){aD(t,e),e.set(t,n)}function aD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hD(t,e){return t.get(uD(t,e))}function cD(t,e,n){return t.set(uD(t,e),n),n}function uD(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dD=new WeakMap,gD=new WeakMap,fD=new WeakMap,pD=new WeakSet;class mD{constructor(){var t,e;aD(t=this,e=pD),e.add(t),lD(this,dD,!0),lD(this,gD,null),lD(this,fD,new ResizeObserver((t=>uD(pD,this,wD).call(this,t))))}setObservedElement(t){cD(gD,this,t)}unobserve(){hD(fD,this).unobserve(hD(gD,this))}observe(){cD(dD,this,!0),hD(fD,this).observe(hD(gD,this))}destroy(){hD(fD,this).disconnect()}}function wD(t){!hD(dD,this)&&Array.isArray(t)&&t.length?t.forEach((t=>{let{borderBoxSize:e}=t;const{inlineSize:n,blockSize:o}=e[0];this.runLocalHooks("resize",n,o)})):cD(dD,this,!1)}function bD(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function vD(t,e){return t.get(CD(t,e))}function yD(t,e,n){return t.set(CD(t,e),n),n}function CD(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}vw(mD,YR);var SD=new WeakMap,RD=new WeakMap,xD=new WeakMap,ED=new WeakMap,MD=new WeakMap,TD=new WeakMap,kD=new WeakMap;class AD{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){var n=this;bD(this,SD,void 0),bD(this,RD,!1),bD(this,xD,null),bD(this,ED,void 0),bD(this,MD,void 0),bD(this,TD,!0),bD(this,kD,new mD),yD(SD,this,t),yD(RD,this,e),yD(ED,this,this.createEditor()),yD(MD,this,vD(ED,this).style),vD(kD,this).setObservedElement(this.getInputElement()),vD(kD,this).addLocalHook("resize",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runLocalHooks("resize",...e)})),this.hide()}setPosition(t,e){vD(MD,this).left=`${t}px`,vD(MD,this).top=`${e}px`}setSize(t,e){if(t&&e){const n=this.getInputElement();n.style.width=`${t}px`,n.style.height=`${e}px`}}getSize(){return{width:am(this.getInputElement()),height:hm(this.getInputElement())}}observeSize(){vD(kD,this).observe()}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){this.getInputElement().readOnly=t}show(){vD(MD,this).display="block",yD(TD,this,!1)}hide(){vD(kD,this).unobserve(),vD(TD,this)||(vD(MD,this).display="none"),yD(TD,this,!0)}isVisible(){return"block"===vD(MD,this).display}setValue(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return vD(SD,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=vD(SD,this).createElement("div"),e=vD(SD,this).createElement("textarea");return t.style.display="none",yD(xD,this,vD(SD,this).createElement("div")),vD(xD,this).setAttribute("dir",vD(RD,this)?"rtl":"ltr"),Bp(vD(xD,this),AD.CLASS_EDITOR_CONTAINER),vD(SD,this).body.appendChild(vD(xD,this)),Bp(t,AD.CLASS_EDITOR),Bp(e,AD.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),vD(xD,this).appendChild(t),t}getInputElement(){return vD(ED,this).querySelector(`.${AD.CLASS_INPUT}`)}destroy(){const t=vD(xD,this)?vD(xD,this).parentNode:null;vD(ED,this).parentNode.removeChild(vD(ED,this)),yD(ED,this,null),yD(MD,this,null),vD(kD,this).destroy(),t&&t.removeChild(vD(xD,this))}}vw(AD,YR);const HD=AD;function ID(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class OD{constructor(t){ID(this,"wasLastActionShow",!0),ID(this,"showDebounced",null),ID(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),250)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Om((t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)}),t)}destroy(){this.clearLocalHooks()}}vw(OD,YR);const _D=OD;function PD(t,e){const n={};return jf(t,(t=>{t.forAll(((t,o)=>{t>=0&&o>=0&&(n[t]||(n[t]=[]),n[t][o]=e(t,o))}))})),n}function ND(t,e,n,o,i){jf(t,(t=>{t.forAll(((t,r)=>{t>=0&&r>=0&&function(t,e,n,o,i,r){const s=i(t,e);let l=o;s.className&&(l="vertical"===n?function(t,e){return-1!==t.indexOf(e)?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}(s.className,o):function(t,e){return-1!==t.indexOf(e)?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}(s.className,o));r(t,e,"className",l)}(t,r,e,n,o,i)}))}))}function DD(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function LD(t,e){let n=!1;return Array.isArray(t)&&jf(t,(t=>(t.forAll(((t,o)=>{if(t>=0&&o>=0&&e(t,o))return n=!0,!1})),n))),n}function VD(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:t}=e.defaultView,{top:o,left:i}=t.getBoundingClientRect();n.top=o,n.left=i}return n}function FD(t,e){return LD(t.getSelectedRange(),function(t){return function(e,n){const o=this.getCellMeta(e,n).className;return o&&-1!==o.indexOf(t)}}(e).bind(t))}const WD="---------";const BD="alignment";const jD="clear_column";const zD="col_left";const UD="col_right";const YD="make_read_only";const $D="redo";const GD="remove_col";const KD="remove_row";const XD="row_above";const qD="row_below";const ZD="no_items";const QD="undo";const JD=[XD,qD,zD,UD,jD,KD,GD,QD,$D,YD,BD,WD,ZD],tL={[WD]:function(){return{name:WD}},[ZD]:function(){return{key:ZD,name(){return this.getTranslatedPhrase(CM)},disabled:!0,isCommand:!1}},[XD]:function(){return{key:XD,name(){return this.getTranslatedPhrase(SM)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){return 0===this.countRows()}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}},[qD]:function(){return{key:qD,name(){return this.getTranslatedPhrase(RM)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows))},hidden(){return!this.getSettings().allowInsertRow}}},[zD]:function(){return{key:zD,name(){return this.getTranslatedPhrase(xM)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){return 0===this.countCols()}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}},[UD]:function(){return{key:UD,name(){return this.getTranslatedPhrase(EM)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden(){return!this.getSettings().allowInsertColumn}}},[jD]:function(){return{key:jD,name(){return this.getTranslatedPhrase(IM)},callback(t,e){const n=e[0].start.col,o=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),o,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader())}}},[KD]:function(){return{key:KD,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,o]=t[0];n-o!=0&&(e=1)}return this.getTranslatedPhrase(MM,e)},callback(){this.alter("remove_row",function(t){const e=$k(t.getSelected());if(0===e||1===e)return[];const n=Gk(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),o=new Set;jf(t.getSelected(),(t=>{const{from:e,to:i}=n(t),r=Math.max(e.row,0),s=i.row-r+1;jf(Array.from(new Array(s),((t,e)=>r+e)),(t=>{o.has(t)||o.add(t)}))}));const i=Ff(Array.from(o).sort(((t,e)=>t-e)),((t,e,n,o)=>(0!==n&&e===o[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return i}(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}},[GD]:function(){return{key:GD,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,o]=t[0];n-o!=0&&(e=1)}return this.getTranslatedPhrase(TM,e)},callback(){this.alter("remove_col",function(t){const e=$k(t.getSelected());if(0===e||1===e)return[];const n=Gk(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),o=new Set;jf(t.getSelected(),(t=>{const{from:e,to:i}=n(t),r=Math.max(e.col,0),s=i.col-r+1;jf(Array.from(new Array(s),((t,e)=>r+e)),(t=>{o.has(t)||o.add(t)}))}));const i=Ff(Array.from(o).sort(((t,e)=>t-e)),((t,e,n,o)=>(0!==n&&e===o[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return i}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}},[QD]:function(){return{key:QD,name(){return this.getTranslatedPhrase(kM)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[$D]:function(){return{key:$D,name(){return this.getTranslatedPhrase(AM)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[YD]:function(){return{key:YD,checkable:!0,ariaChecked(){return LD(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly))},ariaLabel(){return this.getTranslatedPhrase(HM)},name(){let t=this.getTranslatedPhrase(HM);return LD(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly))&&(t=DD(t)),t},callback(){const t=this.getSelectedRange(),e=LD(t,((t,e)=>this.getCellMeta(t,e).readOnly));jf(t,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&this.setCellMeta(t,n,"readOnly",!e)}))})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}},[BD]:function(){return{key:BD,name(){return this.getTranslatedPhrase(YM)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:`${BD}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase($M)},ariaChecked(){return FD(this,"htLeft")},name(){let t=this.getTranslatedPhrase($M);return FD(this,"htLeft")&&(t=DD(t)),t},callback(){const t=this.getSelectedRange(),e=PD(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",e,t,n,o),ND(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${BD}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(GM)},ariaChecked(){return FD(this,"htCenter")},name(){let t=this.getTranslatedPhrase(GM);return FD(this,"htCenter")&&(t=DD(t)),t},callback(){const t=this.getSelectedRange(),e=PD(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",e,t,n,o),ND(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${BD}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(KM)},ariaChecked(){return FD(this,"htRight")},name(){let t=this.getTranslatedPhrase(KM);return FD(this,"htRight")&&(t=DD(t)),t},callback(){const t=this.getSelectedRange(),e=PD(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",o="htRight";this.runHooks("beforeCellAlignment",e,t,n,o),ND(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${BD}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(XM)},ariaChecked(){return FD(this,"htJustify")},name(){let t=this.getTranslatedPhrase(XM);return FD(this,"htJustify")&&(t=DD(t)),t},callback(){const t=this.getSelectedRange(),e=PD(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",e,t,n,o),ND(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{name:WD},{key:`${BD}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(qM)},ariaChecked(){return FD(this,"htTop")},name(){let t=this.getTranslatedPhrase(qM);return FD(this,"htTop")&&(t=DD(t)),t},callback(){const t=this.getSelectedRange(),e=PD(t,((t,e)=>this.getCellMeta(t,e).className)),n="vertical",o="htTop";this.runHooks("beforeCellAlignment",e,t,n,o),ND(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${BD}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(ZM)},ariaChecked(){return FD(this,"htMiddle")},name(){let t=this.getTranslatedPhrase(ZM);return FD(this,"htMiddle")&&(t=DD(t)),t},callback(){const t=this.getSelectedRange(),e=PD(t,((t,e)=>this.getCellMeta(t,e).className)),n="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,o),ND(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1},{key:`${BD}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(QM)},ariaChecked(){return FD(this,"htBottom")},name(){let t=this.getTranslatedPhrase(QM);return FD(this,"htBottom")&&(t=DD(t)),t},callback(){const t=this.getSelectedRange(),e=PD(t,((t,e)=>this.getCellMeta(t,e).className)),n="vertical",o="htBottom";this.runHooks("beforeCellAlignment",e,t,n,o),ND(t,n,o,((t,e)=>this.getCellMeta(t,e)),((t,e,n,o)=>this.setCellMeta(t,e,n,o))),this.render()},disabled:!1}]}}}};function eL(){const t={};return Rw(tL,((e,n)=>{t[n]=e()})),t}function nL(t,e,n){oL(t,e),e.set(t,n)}function oL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iL(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rL(t,e,n){return t.set(lL(t,e),n),n}function sL(t,e){return t.get(lL(t,e))}function lL(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aL="comments",hL="comment",cL="value",uL="style",dL="readOnly",gL=aL,fL=`plugin:${aL}`;var pL=new WeakMap,mL=new WeakMap,wL=new WeakMap,bL=new WeakMap,vL=new WeakMap,yL=new WeakMap,CL=new WeakSet;class SL extends P_{constructor(){var t,e;super(...arguments),oL(t=this,e=CL),e.add(t),iL(this,"range",{}),nL(this,pL,null),nL(this,mL,null),nL(this,wL,!1),nL(this,bL,!1),nL(this,vL,null),nL(this,yL,"")}static get PLUGIN_KEY(){return aL}static get PLUGIN_PRIORITY(){return 60}isEnabled(){return!!this.hot.getSettings()[aL]}enablePlugin(){var t=this;this.enabled||(sL(pL,this)||(rL(pL,this,new HD(this.hot.rootDocument,this.hot.isRtl())),sL(pL,this).addLocalHook("resize",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return lL(CL,t,AL).call(t,...n)}))),sL(mL,this)||rL(mL,this,new _D(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(t=>this.addToContextMenu(t))),this.addHook("afterRenderer",((t,e,n,o,i,r)=>lL(CL,this,ML).call(this,t,r))),this.addHook("afterScroll",(()=>lL(CL,this,IL).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(t=>lL(CL,this,HL).call(this,t))),sL(mL,this).addLocalHook("hide",(()=>this.hide())),sL(mL,this).addLocalHook("show",((t,e)=>this.showAtCell(t,e))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){sL(mL,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid"),n=t.addContext(fL);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const e=this.hot.getSelectedRangeLast();rL(bL,this,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(fL),this.hot._registerTimeout((()=>{rL(bL,this,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!sL(pL,this).isVisible()},group:gL}),n.addShortcut({keys:[["Escape"]],callback:()=>{sL(pL,this).setValue(sL(yL,this)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>sL(pL,this).isVisible()&&sL(pL,this).isFocused(),group:gL}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>sL(pL,this).isVisible()&&sL(pL,this).isFocused(),group:gL})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gL)}registerListeners(){const{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",(t=>lL(CL,this,xL).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>lL(CL,this,RL).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>lL(CL,this,EL).call(this))),this.eventManager.addEventListener(e,"focus",(()=>lL(CL,this,kL).call(this))),this.eventManager.addEventListener(e,"blur",(()=>lL(CL,this,TL).call(this)))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){const e=_p(t.target,"TD","TBODY");return!!(e&&Wp(e,"htCommentCell")&&_p(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const e=sL(pL,this).getValue();let n="";null!=t?n=t:null!=e&&(n=e);const o=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(o,i,{[cL]:n}),this.hot.render()}setCommentAtCell(t,e,n){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(n)}removeComment(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,hL),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(n)}getComment(){const t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,cL)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,cL)}show(){var t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:n}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const o=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return sL(mL,this).cancelHiding(),sL(pL,this).setValue(null!==(t=o[hL]?o[hL][cL]:null)&&void 0!==t?t:""),sL(pL,this).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){sL(pL,this).hide()}refreshEditor(){var t,e;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&sL(pL,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:o}=this.hot,{row:i,col:r}=this.range.from;let s=n.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(r);const a=null===s;sL(pL,this).setPosition(0,0),null===s&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),null===l&&(l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)));const h=null===s,c=null===l;s=null!==(t=s)&&void 0!==t?t:0,l=null!==(e=l)&&void 0!==e?e:0;const{rootWindow:u,view:{_wt:d}}=this.hot,{wtTable:g}=d,f=d.getCell({row:s,col:l},!0),p=this.getCommentMeta(i,r,uL);p?sL(pL,this).setSize(p.width,p.height):sL(pL,this).resetSize();const m=c?0:g.getStretchedColumnWidth(l),w=a&&!h?hm(f):0,{left:b,top:v,width:y,height:C}=f.getBoundingClientRect(),{width:S,height:R}=sL(pL,this).getSize(),{innerWidth:x,innerHeight:E}=this.hot.rootWindow,M=this.hot.rootDocument.documentElement;let T=b+u.scrollX+m,k=v+u.scrollY+w;this.hot.isRtl()&&(T-=S+m),this.hot.isLtr()&&b+y+S>x?T=b+u.scrollX-S-1:this.hot.isRtl()&&T<-(M.scrollWidth-M.clientWidth)&&(T=b+u.scrollX+m+1),v+R>E&&(k-=R-C+1),sL(pL,this).setPosition(T,k),sL(pL,this).setReadOnlyState(this.getCommentMeta(i,r,dL)),sL(pL,this).observeSize()}focusEditor(){sL(pL,this).focus()}updateCommentMeta(t,e,n){const o=this.hot.getCellMeta(t,e)[hL];let i;o?(i=ww(o),mw(i,n)):i=n,this.hot.setCellMeta(t,e,hL,i)}getCommentMeta(t,e,n){const o=this.hot.getCellMeta(t,e);if(o[hL])return o[hL][n]}addToContextMenu(t){var e;t.items.push({name:WD},(e=this,{key:"commentsAddEdit",name(){var t;const n=null===(t=this.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return null!=n&&n.isCell()&&e.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(jM):this.getTranslatedPhrase(BM)},callback(){const t=this.getSelectedRangeLast();e.setRange(t),e.show(),e.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}),function(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(zM)},callback(){this.getSelectedRangeLast().forAll(((e,n)=>{e>=0&&n>=0&&t.removeCommentAtCell(e,n,!1)})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(UM);return LD(this.getSelectedRange(),((e,n)=>t.getCommentMeta(e,n,dL)))?DD(e):e},callback(){this.getSelectedRangeLast().forAll(((e,n)=>{if(e>=0&&n>=0){const o=!!t.getCommentMeta(e,n,dL);t.updateCommentMeta(e,n,{[dL]:!o})}}))},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getDisplayDelaySetting(){const t=this.hot.getSettings()[aL];if(Cw(t))return t.displayDelay}getEditorInputElement(){return sL(pL,this).getInputElement()}destroy(){var t,e;null===(t=sL(pL,this))||void 0===t||t.destroy(),null===(e=sL(mL,this))||void 0===e||e.destroy(),super.destroy()}}function RL(t){if(this.hot.view&&this.hot.view._wt&&!sL(wL,this)&&!this.targetIsCommentTextArea(t)){const e=_p(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function xL(t){const{rootDocument:e}=this.hot;if(!(sL(wL,this)||sL(pL,this).isFocused()||Wp(t.target,"wtBorder")||sL(vL,this)===t.target)&&sL(pL,this))if(rL(vL,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const e=this.hot._createCellRange(this.hot.getCoords(t.target));sL(mL,this).show(e)}else Np(t.target,e)&&!this.targetIsCommentTextArea(t)&&sL(mL,this).hide()}function EL(){rL(wL,this,!1)}function ML(t,e){e[hL]&&e[hL][cL]&&Bp(t,e.commentedCellClassName)}function TL(){rL(yL,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function kL(){rL(yL,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(fL)}function AL(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[uL]:{width:t,height:e}})}function HL(t){sL(pL,this).isVisible()&&lb(t)}function IL(){sL(bL,this)||this.hide()}var OL=ve,_L=TypeError,PL=ir,NL=Ue,DL=pi,LL=xs,VL=function(t,e){if(!delete t[e])throw new _L("Cannot delete property "+OL(e)+" of "+OL(t))},FL=Ms,WL=1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(Yb){return Yb instanceof TypeError}}();function BL(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}PL({target:"Array",proto:!0,arity:1,forced:WL},{unshift:function(t){var e=NL(this),n=DL(e),o=arguments.length;if(o){FL(n+o);for(var i=n;i--;){var r=i+o;i in e?e[r]=e[i]:VL(e,r)}for(var s=0;s<o;s++)e[s]=arguments[s]}return LL(e,n+o)}});class jL{constructor(t){BL(this,"hot",void 0),BL(this,"commands",{}),BL(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];const i=t.split(":"),r=i[0],s=2===i.length?i[1]:null;let l=this.commands[r];if(!l)throw new Error(`Menu command '${r}' not exists.`);if(s&&l.submenu&&(l=function(t,e){let n;return jf(e,(e=>{const o=e.key?e.key.split(":"):null;if(Array.isArray(o)&&o[1]===t)return n=e,!1})),n}(s,l.submenu.items)),!0===l.disabled)return;if("function"==typeof l.disabled&&!0===l.disabled.call(this.hot))return;if(kw(l,"submenu"))return;const a=[];"function"==typeof l.callback&&a.push(l.callback),"function"==typeof this.commonCallback&&a.push(this.commonCallback),n.unshift(i.join(":")),jf(a,(t=>t.apply(this.hot,n)))}}function zL(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class UL{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;zL(this,"hot",void 0),zL(this,"predefinedItems",eL()),zL(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){const e={};this.defaultOrderPattern.length=0,Rw(t,((t,n)=>{let o="";t.name===WD?(e[WD]=t,o=WD):isNaN(parseInt(n,10))?(t.key=void 0===t.key?n:t.key,e[n]=t,o=t.key):(e[t.key]=t,o=t.key),this.defaultOrderPattern.push(o)})),this.predefinedItems=e}getItems(){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=[];let i=t;i&&i.items?i=i.items:Array.isArray(i)||(i=e);Cw(i)?Rw(i,((t,e)=>{let i=n["string"==typeof t?t:e];i||(i=t),Cw(t)?pw(i,t):"string"==typeof i&&(i={name:i}),void 0===i.key&&(i.key=e),o.push(i)})):jf(i,((t,e)=>{let i=n[t];!i&&JD.indexOf(t)>=0||(i||(i={name:t,key:`${e}`}),Cw(t)&&pw(i,t),void 0===i.key&&(i.key=e),o.push(i))}));return o}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function YL(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class $L{constructor(t,e){YL(this,"top",void 0),YL(this,"topRelative",void 0),YL(this,"left",void 0),YL(this,"leftRelative",void 0),YL(this,"scrollTop",void 0),YL(this,"scrollLeft",void 0),YL(this,"cellHeight",void 0),YL(this,"cellWidth",void 0);const n=e.scrollY,o=e.scrollX;let i,r,s,l,a,h;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),s=parseInt(t.left,10),a=t.height||0,h=t.width||0,r=i,l=s,i+=n,s+=o):"event"===this.type&&(i=parseInt(t.pageY,10),s=parseInt(t.pageX,10),a=t.target.clientHeight,h=t.target.clientWidth,r=i-n,l=s-o),this.top=i,this.topRelative=r,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=a,this.cellWidth=h}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function GL(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function KL(t,e){return t.get(qL(t,e))}function XL(t,e,n){return t.set(qL(t,e),n),n}function qL(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ZL=new WeakMap,QL=new WeakMap,JL=new WeakMap,tV=new WeakMap,eV=new WeakMap;class nV{constructor(t){GL(this,ZL,void 0),GL(this,QL,void 0),GL(this,JL,void 0),GL(this,tV,!1),GL(this,eV,{above:0,below:0,left:0,right:0}),XL(tV,this,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return KL(eV,this)[t]=e,this}setElement(t){return XL(ZL,this,t),this}setParentElement(t){return XL(QL,this,t),this}updatePosition(t){XL(JL,this,new $L(t,KL(ZL,this).ownerDocument.defaultView)),KL(tV,this)?(KL(JL,this).fitsBelow(KL(ZL,this))?this.setPositionBelowCursor():KL(JL,this).fitsAbove(KL(ZL,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===KL(ZL,this).dir?KL(JL,this).fitsOnLeft(KL(ZL,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():KL(JL,this).fitsOnRight(KL(ZL,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=KL(eV,this).above+KL(JL,this).top-KL(ZL,this).offsetHeight;KL(QL,this)&&(t=KL(JL,this).top+KL(JL,this).cellHeight-KL(ZL,this).offsetHeight+3),KL(ZL,this).style.top=`${t}px`}setPositionBelowCursor(){let t=KL(eV,this).below+KL(JL,this).top+1;KL(QL,this)&&(t=KL(JL,this).top-1),KL(ZL,this).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=KL(JL,this).left;if(KL(QL,this)){const e=Number.parseInt(getComputedStyle(KL(QL,this).querySelector(".htCore")).borderRightWidth,10);t+=KL(JL,this).cellWidth+e}else t+=KL(eV,this).right;KL(ZL,this).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=KL(eV,this).left+KL(JL,this).left-KL(ZL,this).offsetWidth;if(KL(QL,this)){t-=Number.parseInt(getComputedStyle(KL(QL,this).querySelector(".htCore")).borderLeftWidth,10)}KL(ZL,this).style.left=`${t}px`}}function oV(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:o=()=>{},onClear:i=()=>{}}=t;const r=new Set;let s=Oy(e,-1,a()-1);function l(t,e){const n=a()-1;if(t<0&&(t=n),t>n&&(t=0),r.has(t))return-1;r.add(t);return!1===o(t,!1)&&(t=l(1===e?++t:--t,e)),t}function a(){return Math.max(n(),0)}return{setCurrentPage:function(t){t>-1&&t<a()&&!1!==o(t,!0)&&(s=t)},getCurrentPage:function(){return s},toFirstItem:function(){a()>0&&(r.clear(),s=l(0,1))},toLastItem:function(){a()>0&&(r.clear(),s=l(a()-1,-1))},toNextItem:function(){a()>0&&(r.clear(),s=l(++s,1))},toPreviousItem:function(){a()>0&&(r.clear(),s=l(--s,-1))},getSize:a,clear:function(){r.clear(),s=e,i()}}}function iV(t){return kw(t,"submenu")}function rV(t){return new RegExp(WD,"i").test(t.name)}function sV(t,e){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(e)}function lV(t){return kw(t,"disableSelection")}function aV(t,e){const n=t.slice(0);for(let o=0;o<n.length&&n[o].name===e;)n.shift();return n}function hV(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:WD,n=t.slice(0);return n=aV(n,e),n=function(t,e){let n=t.slice(0);return n.reverse(),n=aV(n,e),n.reverse(),n}(n,e),n=function(t){const e=[];return jf(t,((t,n)=>{n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}(n),n}function cV(t){return oV({size:()=>t.countRows(),onItemSelect(e,n){const o=t.getCell(e,0);if(!o||function(t){return Wp(t,"htSeparator")}(o)||function(t){return Wp(t,"htDisabled")}(o)||function(t){return Wp(t,"htSelectionDisabled")}(o))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}const uV="menu",dV=uV;function gV(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function fV(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pV(t,e,n){return t.set(wV(t,e),n),n}function mV(t,e){return t.get(wV(t,e))}function wV(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bV=new WeakMap,vV=new WeakMap,yV=new WeakMap;class CV{get tableBorderWidth(){return void 0===mV(yV,this)&&this.hotMenu&&pV(yV,this,parseInt(lm(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),mV(yV,this)}constructor(t,e){var n=this;fV(this,"hot",void 0),fV(this,"options",void 0),fV(this,"eventManager",new pv(this)),fV(this,"container",void 0),fV(this,"positioner",void 0),fV(this,"hotMenu",null),fV(this,"hotSubMenus",{}),fV(this,"parentMenu",void 0),fV(this,"menuItems",null),fV(this,"origOutsideClickDeselects",null),gV(this,bV,void 0),gV(this,vV,void 0),gV(this,yV,void 0),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new nV(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.parentMenu.runLocalHooks("afterSelectionChange",...e)}))}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"touchstart",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"contextmenu",(t=>this.onDocumentContextMenu(t))),t=Op(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return mV(bV,this)}getKeyboardShortcutsCtrl(){return mV(vV,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=Om((t=>this.openSubMenu(t)),300),e=this.options.minWidth||215;let n=!1,o=Wf(this.menuItems,(t=>(t.key===ZD&&(n=!0),function(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))}(t,this.hot))));if(o.length<1&&!n)o.push(eL()[ZD]);else if(0===o.length)return;o=hV(o,WD);let i=!1;const r={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:t=>qf(t)&&t<e?e:t,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(s=this.hot,(t,e,n,o,i,r)=>{const l=t.getSourceDataAtRow(n),a=s.rootDocument.createElement("div"),h="function"==typeof r?r.call(s):r,c="function"==typeof l.ariaLabel?l.ariaLabel.call(s):l.ariaLabel,u="function"==typeof l.ariaChecked?l.ariaChecked.call(s):l.ariaChecked;if($p(e),Bp(a,"htItemWrapper"),s.getSettings().ariaTags){const t=!sV(l,s)&&!lV(l)&&!rV(l);zp(e,[...(d=l,!0===d.checkable?[["role","menuitemcheckbox"],vp(c),Mp(u)]:[["role","menuitem"],vp(h)]),...t?[bp(-1)]:[],...sV(l,s)?[["aria-disabled","true"]]:[],...iV(l)?[Ep(!1)]:[]])}var d;e.className="",e.appendChild(a),rV(l)?Bp(e,"htSeparator"):"function"==typeof l.renderer?(Bp(e,"htCustomMenuRenderer"),e.appendChild(l.renderer(t,a,n,o,i,h))):Kp(a,h),sV(l,s)?Bp(e,"htDisabled"):lV(l)?Bp(e,"htSelectionDisabled"):iV(l)&&Bp(e,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{mV(bV,this).setCurrentPage(e.row)},afterOnCellMouseOver:(e,n)=>{this.isAllSubMenusClosed()?t(n.row):this.openSubMenu(n.row)},rowHeights:t=>o[t].name===WD?1:void 0,afterOnCellContextMenu:t=>{t.preventDefault(),Zw()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,n,o,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{Zw()&&hb(t)||!i||!this.hasSelectedItem()||(Kw()||qw()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var s;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),pV(bV,this,cV(this.hotMenu)),pV(vV,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];function o(t,e){s(e).addShortcuts(t,{group:uV})}function i(t,e){const i=s(e);t.forEach((t=>{let{keys:e}=t;e.forEach((t=>i.removeShortcutsByKeys(t)))})),n.push({shortcuts:t,contextName:e}),o(t,e)}function r(t){return t?`${dV}:${t}`:dV}function s(e){var n;const o=t.hotMenu.getShortcutManager(),i=r(e);return null!==(n=o.getContext(i))&&void 0!==n?n:o.addContext(i)}return o(function(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,o)=>{const i=e.getSettings(),r="function"==typeof i.tabMoves?i.tabMoves(n):i.tabMoves;o.includes("shift")?e.selection.transformStart(-r.row,-r.col):e.selection.transformStart(r.row,r.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=n.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const o=n.getSelectedLast();o&&(n.getSourceDataAtRow(o[0]).submenu?t.openSubMenu(o[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}(t)),e.forEach((t=>{let{shortcuts:e,contextName:n}=t;i(e,n)})),{addCustomShortcuts:i,getCustomShortcuts:function(){return[...n]},getContext:s,listen:function(e){t.hotMenu.getShortcutManager().setActiveContextName(r(e))}}}(this)),mV(vV,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(t&&this.isSubMenu())this.parentMenu.close();else if(mV(bV,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){zp(this.parentMenu.hotMenu.getCell(t[0],0),[Ep(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(t){if(!this.hotMenu)return!1;const e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!function(t){return Wp(t,"htSubmenu")}(e))return!1;const n=this.hotMenu.getSourceDataAtRow(t),o=new CV(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(n.submenu.items),o.open(),o.setPosition(e.getBoundingClientRect()),this.hotSubMenus[n.key]=o,this.hot.getSettings().ariaTags&&zp(e,[Ep(!0)]),o}closeSubMenu(t){const e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];if(n){n.destroy(),delete this.hotSubMenus[e.key];const o=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&zp(o,[Ep(!1)])}}closeAllSubMenus(){jf(this.hotMenu.getData(),((t,e)=>this.closeSubMenu(e)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;const n=this.hot.getSelectedRange(),o=n?function(t){return Bf(t,(t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})))}(n):[];this.runLocalHooks("executeCommand",e.key,o,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,o,t)}isCommandPassive(t){return!1===t.isCommand||rV(t)||sV(t,this.hot)||iV(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}updateMenuDimensions(){const{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,n=t.hider.style,o=t.holder.style,i=parseInt(n.width,10),r=Ff(e,((t,e,n)=>{const o=this.hotMenu.getCell(n,0)?hm(this.hotMenu.getCell(n,0)):0;return t+(e.name===WD?1:o)}),0);o.width=`${i+3}px`,o.height=`${r+3}px`,n.height=o.height}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.options.container.ownerDocument;let n,o=t;return o&&(Hm(o)&&(o=o.call(this.hot),o=null===o||Zf(o)?"":o.toString()),o=o.replace(/[^A-z0-9]/g,"_"),o=`${this.options.className}Sub_${o}`,n=e.querySelector(`.${this.options.className}.${o}`)),n||(n=e.createElement("div"),Bp(n,`htMenu ${this.options.className}`),o&&Bp(n,o),this.options.container.appendChild(n)),n}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&zp(this.hotMenu.rootElement,[["role","menu"],bp(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Np(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Np(t.target,".htMenu")||this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&Wp(t.target,"htCore")&&Np(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function SV(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function RV(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xV(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}vw(CV,YR);const EV="contextMenu",MV=EV;tv.getSingleton().register("afterContextMenuDefaultOptions"),tv.getSingleton().register("beforeContextMenuShow"),tv.getSingleton().register("afterContextMenuShow"),tv.getSingleton().register("afterContextMenuHide"),tv.getSingleton().register("afterContextMenuExecute");var TV=new WeakSet;class kV extends P_{constructor(){super(...arguments),SV(this,TV),RV(this,"commandExecutor",new jL(this.hot)),RV(this,"itemsFactory",null),RV(this,"menu",null)}static get PLUGIN_KEY(){return EV}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[XD,qD,WD,zD,UD,WD,KD,GD,WD,QD,$D,WD,YD,WD,BD]}isEnabled(){return!!this.hot.getSettings()[EV]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[EV];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new CV(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>xV(TV,this,HV).call(this))),this.menu.addLocalHook("afterOpen",(()=>xV(TV,this,IV).call(this))),this.menu.addLocalHook("afterClose",(()=>xV(TV,this,OV).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.executeCommand.call(t,...n)})),this.addHook("afterOnCellContextMenu",(t=>xV(TV,this,AV).call(this,t))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),n=VD(this.menu.container,this.hot.rootDocument);this.open({left:e.left+n.left,top:e.top+n.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:MV})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(MV)}open(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(e=this.menu)&&void 0!==e&&e.isOpened())return;this.prepareMenuItems(),this.menu.open();this.menu.tableBorderWidth>0||(n.below+=1,n.right+=1,n.above-=1,n.left-=1),Rw(n,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t)}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.commandExecutor.execute(t,...n)}prepareMenuItems(){this.itemsFactory=new UL(this.hot,kV.DEFAULT_ITEMS);const t=this.hot.getSettings()[EV],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);const n=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),jf(n,(t=>this.commandExecutor.registerCommand(t.key,t)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function AV(t){const e=this.hot.getSettings(),n=e.rowHeaders,o=e.colHeaders;const i=t.target;if(this.close(),Wp(i,"handsontableInput"))return;if(t.preventDefault(),t.stopPropagation(),!n&&!o&&!(function(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}(i)||Wp(i,"current")&&Wp(i,"wtBorder")))return;const r=VD(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+r.top,left:t.clientX+r.left})}function HV(){this.hot.runHooks("beforeContextMenuShow",this)}function IV(){this.hot.runHooks("afterContextMenuShow",this)}function OV(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}kV.SEPARATOR={name:WD};class _V{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class PV{constructor(){this.clipboardData=new _V}preventDefault(){}}function NV(t,e,n){DV(t,e),e.set(t,n)}function DV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LV(t,e){return t.get(FV(t,e))}function VV(t,e,n){return t.set(FV(t,e),n),n}function FV(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var WV=new WeakMap,BV=new WeakMap,jV=new WeakMap,zV=new WeakMap,UV=new WeakMap,YV=new WeakMap,$V=new WeakSet;class GV{constructor(t){let{countRows:e,countColumns:n,rowsLimit:o,columnsLimit:i,countColumnHeaders:r}=t;var s,l;DV(s=this,l=$V),l.add(s),NV(this,WV,void 0),NV(this,BV,void 0),NV(this,jV,void 0),NV(this,zV,void 0),NV(this,UV,void 0),NV(this,YV,void 0),VV(BV,this,e),VV(jV,this,n),VV(zV,this,o),VV(UV,this,i),VV(YV,this,r)}setSelectedRange(t){VV(WV,this,t)}getCellsRange(){if(0===LV(BV,this).call(this)||0===LV(jV,this).call(this))return null;const{row:t,col:e}=LV(WV,this).getTopStartCorner(),{row:n,col:o}=LV(WV,this).getBottomEndCorner(),i=FV($V,this,XV).call(this,t,n),r=FV($V,this,KV).call(this,e,o);return{isRangeTrimmed:n!==i||o!==r,startRow:t,startCol:e,endRow:i,endCol:r}}getMostBottomColumnHeadersRange(){if(0===LV(jV,this).call(this)||0===LV(YV,this).call(this))return null;const{col:t}=LV(WV,this).getTopStartCorner(),{col:e}=LV(WV,this).getBottomEndCorner(),n=FV($V,this,KV).call(this,t,e);return{isRangeTrimmed:e!==n,startRow:-1,startCol:t,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(0===LV(jV,this).call(this)||0===LV(YV,this).call(this))return null;const{col:t}=LV(WV,this).getTopStartCorner(),{col:e}=LV(WV,this).getBottomEndCorner(),n=FV($V,this,KV).call(this,t,e);return{isRangeTrimmed:e!==n,startRow:-LV(YV,this).call(this),startCol:t,endRow:-1,endCol:n}}}function KV(t,e){return Math.min(e,Math.max(t+LV(UV,this).call(this)-1,t))}function XV(t,e){return Math.min(e,Math.max(t+LV(zV,this).call(this)-1,t))}function qV(t){const e=[],n=[];return jf(t,(t=>{Ay(Math.min(t.startRow,t.endRow),Math.max(t.startRow,t.endRow),(t=>{-1===e.indexOf(t)&&e.push(t)}));Ay(Math.min(t.startCol,t.endCol),Math.max(t.startCol,t.endCol),(t=>{-1===n.indexOf(t)&&n.push(t)}))})),{rows:e,columns:n}}function ZV(t,e,n){QV(t,e),e.set(t,n)}function QV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JV(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tF(t,e){return t.get(nF(t,e))}function eF(t,e,n){return t.set(nF(t,e),n),n}function nF(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("afterCopyLimit"),tv.getSingleton().register("modifyCopyableRange"),tv.getSingleton().register("beforeCut"),tv.getSingleton().register("afterCut"),tv.getSingleton().register("beforePaste"),tv.getSingleton().register("afterPaste"),tv.getSingleton().register("beforeCopy"),tv.getSingleton().register("afterCopy");const oF="copyPaste",iF=["fragmentSelection"],rF=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var sF=new WeakMap,lF=new WeakMap,aF=new WeakMap,hF=new WeakMap,cF=new WeakMap,uF=new WeakMap,dF=new WeakMap,gF=new WeakMap,fF=new WeakSet;class pF extends P_{constructor(){var t,e;super(...arguments),QV(t=this,e=fF),e.add(t),JV(this,"columnsLimit",1/0),JV(this,"rowsLimit",1/0),JV(this,"pasteMode","overwrite"),JV(this,"uiContainer",this.hot.rootDocument.body),ZV(this,sF,!1),ZV(this,lF,!1),ZV(this,aF,!1),ZV(this,hF,"cells-only"),ZV(this,cF,!1),ZV(this,uF,!1),ZV(this,dF,new GV({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),ZV(this,gF,!1),JV(this,"copyableRanges",[])}static get PLUGIN_KEY(){return oF}static get SETTING_KEYS(){return[oF,...iF]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[oF]}enablePlugin(){var t=this;if(this.enabled)return;const{[oF]:e}=this.hot.getSettings();var n,o;"object"==typeof e&&(this.pasteMode=null!==(n=e.pasteMode)&&void 0!==n?n:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,eF(sF,this,!!e.copyColumnHeaders),eF(lF,this,!!e.copyColumnGroupHeaders),eF(aF,this,!!e.copyColumnHeadersOnly),this.uiContainer=null!==(o=e.uiContainer)&&void 0!==o?o:this.uiContainer);this.addHook("afterContextMenuDefaultOptions",(t=>nF(fF,this,yF).call(this,t))),this.addHook("afterSelection",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return nF(fF,t,CF).call(t,...n)})),this.addHook("afterSelectionEnd",(()=>nF(fF,this,SF).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return t.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return t.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return t.onPaste(...arguments)})),$w()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return nF(fF,t,RF).call(t,...n)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return nF(fF,t,xF).call(t,...n)})),this.addHook("afterSelection",(()=>nF(fF,this,EF).call(this)))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){eF(hF,this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),eF(cF,this,!0),nF(fF,this,mF).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){eF(uF,this,!0),nF(fF,this,mF).call(this,"cut")}getRangedCopyableData(t){return cA(this.getRangedData(t))}getRangedData(t){const e=[],{rows:n,columns:o}=qV(t);return jf(n,(t=>{const n=[];jf(o,(e=>{t<0?n.push(this.hot.getColHeader(e,t)):n.push(this.hot.getCopyableData(t,e))})),e.push(n)})),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;const n=new PV;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.onPaste(n)}setCopyableText(){const t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader())return void(this.copyableRanges=[]);tF(dF,this).setSelectedRange(t);const e=new Map([["headers",null],["cells",null]]);"column-headers-only"===tF(hF,this)?e.set("headers",tF(dF,this).getMostBottomColumnHeadersRange()):("with-column-headers"===tF(hF,this)?e.set("headers",tF(dF,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===tF(hF,this)&&e.set("headers",tF(dF,this).getAllColumnHeadersRange()),e.set("cells",tF(dF,this).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((t=>null!==t)).map((t=>{let{startRow:e,startCol:n,endRow:o,endCol:i}=t;return{startRow:e,startCol:n,endRow:o,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=e.get("cells");if(null!==n&&n.isRangeTrimmed){const{startRow:t,startCol:e,endRow:o,endCol:i}=n;this.hot.runHooks("afterCopyLimit",o-t+1,i-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;const n=t.length,o=t[0].length,i=[],{row:r,col:s}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner();let h=r,c=s,u=r,d=s;for(;i.length<n||h<=l;){const{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,s);if(h=l+1,!0===e)continue;u=l,c=s;const g=[],f=i.length%n;for(;g.length<o||c<=a;){const{skipColumnOnPaste:e,visualCol:n}=this.hot.getCellMeta(r,c);if(c=n+1,!0===e)continue;d=n;const i=g.length%o;g.push(t[f][i])}i.push(g)}return eF(gF,this,!0),this.hot.populateFromArray(r,s,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,s,u,d]}onCopy(t){var e;const n=this.hot.getFocusManager().getRefocusElement(),o=null===(e=t.target)||void 0===e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!tF(cF,this)||this.isEditorOpened()||t.target instanceof HTMLElement&&(o&&t.target!==n||!o&&t.target!==this.hot.rootDocument.body))return;t.preventDefault(),this.setCopyableText(),eF(cF,this,!1);const i=this.getRangedData(this.copyableRanges),r=nF(fF,this,wF).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,r)){const e=cA(i);if(t&&t.clipboardData){const n=xy(i,this.hot.rootDocument);t.clipboardData.setData("text/plain",e),t.clipboardData.setData("text/html",[rF,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",e);this.hot.runHooks("afterCopy",i,this.copyableRanges,r)}eF(hF,this,"cells-only")}onCut(t){var e;const n=this.hot.getFocusManager().getRefocusElement(),o=null===(e=t.target)||void 0===e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!tF(uF,this)||this.isEditorOpened()||t.target instanceof HTMLElement&&(o&&t.target!==n||!o&&t.target!==this.hot.rootDocument.body))return;t.preventDefault(),this.setCopyableText(),eF(uF,this,!1);const i=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",i,this.copyableRanges)){const e=cA(i);if(t&&t.clipboardData){const n=xy(i,this.hot.rootDocument);t.clipboardData.setData("text/plain",e),t.clipboardData.setData("text/html",[rF,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",e);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}}onPaste(t){var e;const n=this.hot.getFocusManager().getRefocusElement(),o=null===(e=t.target)||void 0===e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||t.target instanceof HTMLElement&&(o&&t.target!==n||!o&&t.target!==this.hot.rootDocument.body))return;let i;if(t.preventDefault(),t&&void 0!==t.clipboardData){const e=mp(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(e&&/(<table)|(<TABLE)/g.test(e)){i=Ey(e,this.hot.rootDocument).data}else i=t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof i&&(i=function(t){const e=[[""]];if(0===t.length)return e;let n,o=0,i=0;for(;t.length>0&&n!==t.length;)if(n=t.length,t.match(hA))t=t.replace(hA,""),o+=1,e[i][o]="";else if(t.match(lA))t=t.replace(lA,""),o=0,i+=1,e[i]=[""];else{let n="";if(t.startsWith('"')){let e=0,o=!0;for(;o;){const i=t.slice(0,1);'"'===i&&(e+=1),n+=i,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&e%2==0)&&(o=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(t=>new Array(Math.floor(t.length/2)).fill('"').join("")))}else{const e=t.match(aA);n=e?e[0]:"",t=t.slice(n.length)}e[i][o]=n}return e}(i)),void 0===i||i&&0===i.length)return;if(!1===this.hot.runHooks("beforePaste",i,this.copyableRanges))return;const[r,s,l,a]=this.populateValues(i);this.hot.selectCell(r,s,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,a)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}destroy(){super.destroy()}}function mF(t){if($w()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:o}=e.highlight,i=this.hot.getCell(n,o,!0);i&&km(i,(()=>{this.hot.rootDocument.execCommand(t)}))}}else this.hot.rootDocument.execCommand(t)}function wF(t){const{rows:e}=qV(t);let n=0;for(let o=0;o<e.length&&!(e[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function bF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,o=this.hot.getCell(e,n,!0);o&&Mm(o)}}}function vF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,o=this.hot.getCell(e,n,!0);null!=o&&o.hasAttribute("contenteditable")&&Tm(o)}}}function yF(t){var e;t.items.push({name:"---------"},(e=this,{key:"copy",name(){return this.getTranslatedPhrase(OM)},callback(){e.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1})),tF(sF,this)&&t.items.push(function(t){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),e=t?Oy(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(_M,e)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),tF(lF,this)&&t.items.push(function(t){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),e=t?Oy(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(PM,e)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),tF(aF,this)&&t.items.push(function(t){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),e=t?Oy(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(NM,e)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),t.items.push(function(t){return{key:"cut",name(){return this.getTranslatedPhrase(DM)},callback(){t.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}function CF(t,e,n,o,i){tF(gF,this)&&(i.value=!0),eF(gF,this,!1)}function SF(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function RF(){nF(fF,this,vF).call(this)}function xF(){nF(fF,this,bF).call(this)}function EF(){nF(fF,this,vF).call(this)}function MF(t,e){return`border_row${t}col${e}`}function TF(t){var e,n;(qf(t.start)||qf(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(qf(t.end)||qf(t.right))&&(t.end=null!==(n=t.end)&&void 0!==n?n:t.right);return delete t.left,delete t.right,t}function kF(t){return qf(t.start)&&(t.left=t.start),qf(t.end)&&(t.right=t.end),t}function AF(t,e){return{id:MF(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function HF(t,e){let n=!1;return jf(t.getSelectedRange(),(o=>{o.forAll(((o,i)=>{if(o<0||i<0)return;const r=t.getCellMeta(o,i).borders;if(r){if(!e)return n=!0,!1;if(!kw(r[e],"hide")||!1===r[e].hide)return n=!0,!1}}))})),n}function IF(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}const OF=new Map([["left","start"],["right","end"]]);function _F(t){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(nT);return HF(this,"bottom")&&(t=IF(t)),t},callback(e,n){const o=HF(this,"bottom");t.prepareBorder(n,"bottom",o)}}}function PF(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(oT);return HF(this,e)&&(t=IF(t)),t},callback(n,o){const i=HF(this,e);t.prepareBorder(o,e,i)}}}function NF(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(iT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!HF(this)}}}function DF(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(eT);return HF(this,e)&&(t=IF(t)),t},callback(n,o){const i=HF(this,e);t.prepareBorder(o,e,i)}}}function LF(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function VF(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FF(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const WF="customBorders";var BF=new WeakSet;class jF extends P_{constructor(){super(...arguments),LF(this,BF),VF(this,"savedBorders",[])}static get PLUGIN_KEY(){return WF}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[WF]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>FF(BF,this,zF).call(this,t))),this.addHook("init",(()=>FF(BF,this,UF).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let n=["top","bottom","start","end"],o=null;e&&(this.checkSettingsCohesion([e]),n=Object.keys(e),o=TF(e));const i=Gk($k(t),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});jf(t,(t=>{i(t).forAll(((t,e)=>{jf(n,(n=>{var i,r;this.prepareBorderFromCustomAdded(t,e,o,(i=n,null!==(r=OF.get(i))&&void 0!==r?r:i))}))}))})),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;const e=Gk($k(t),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return jf(t,(t=>{e(t).forAll(((t,e)=>{jf(this.savedBorders,(o=>{o.row===t&&o.col===e&&n.push(kF(o))}))}))})),n}clearBorders(t){t?this.setBorders(t):(jf(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);const n=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col));this.checkCustomSelections(t,n,e)||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:n})}prepareBorderFromCustomAdded(t,e,n,o){const i=this.hot.countRows(),r=this.hot.countCols();if(t>=i||e>=r)return;let s=AF(t,e);var l,a;n&&(l=s,kw(a=n,"border")&&a.border&&(l.border=a.border),kw(a,"top")&&qf(a.top)&&(a.top?(Cw(a.top)||(a.top={width:1,color:"#000"}),l.top=a.top):(a.top={hide:!0},l.top=a.top)),kw(a,"bottom")&&qf(a.bottom)&&(a.bottom?(Cw(a.bottom)||(a.bottom={width:1,color:"#000"}),l.bottom=a.bottom):(a.bottom={hide:!0},l.bottom=a.bottom)),kw(a,"start")&&qf(a.start)&&(a.start?(Cw(a.start)||(a.start={width:1,color:"#000"}),l.start=a.start):(a.start={hide:!0},l.start=a.start)),kw(a,"end")&&qf(a.end)&&(a.end?(Cw(a.end)||(a.end={width:1,color:"#000"}),l.end=a.end):(a.end={hide:!0},l.end=a.end)),s=l,jf(this.hot.selection.highlight.customSelections,(t=>{if(s.id===t.settings.id)return Object.assign(t.settings,n),s.id=t.settings.id,s.top=t.settings.top,s.bottom=t.settings.bottom,s.start=t.settings.start,s.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",kF(s)),this.insertBorderIntoSettings(s,o)}prepareBorderFromCustomAddedRange(t,e){const n=Math.min(t.to.row,this.hot.countRows()-1),o=Math.min(t.to.col,this.hot.countCols()-1);Ay(t.from.row,n,(n=>{Ay(t.from.col,o,(o=>{const i=AF(n,o);let r=0;n===t.from.row&&kw(e,"top")&&(r+=1,i.top=e.top),n===t.to.row&&kw(e,"bottom")&&(r+=1,i.bottom=e.bottom),o===t.from.col&&kw(e,"start")&&(r+=1,i.start=e.start),o===t.to.col&&kw(e,"end")&&(r+=1,i.end=e.end),r>0&&(this.hot.setCellMeta(n,o,"borders",kF(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(t,e){const n=MF(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,n,o){let i=this.hot.getCellMeta(t,e).borders;if(i=i&&void 0!==i.border?TF(i):AF(t,e),o){i[n]={hide:!0};if(4===this.countHide(i))this.removeAllBorders(t,e);else{this.checkCustomSelectionsFromContextMenu(i,n,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",kF(i))}}else{i[n]={width:1,color:"#000"};this.checkCustomSelectionsFromContextMenu(i,n,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",kF(i))}}prepareBorder(t,e,n){jf(t,(t=>{let{start:o,end:i}=t;if(o.row===i.row&&o.col===i.col)"noBorders"===e?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,e,n);else switch(e){case"noBorders":Ay(o.col,i.col,(t=>{Ay(o.row,i.row,(e=>{this.removeAllBorders(e,t)}))}));break;case"top":Ay(o.col,i.col,(t=>{this.setBorder(o.row,t,e,n)}));break;case"bottom":Ay(o.col,i.col,(t=>{this.setBorder(i.row,t,e,n)}));break;case"start":Ay(o.row,i.row,(t=>{this.setBorder(t,o.col,e,n)}));break;case"end":Ay(o.row,i.row,(t=>{this.setBorder(t,i.col,e,n)}))}}))}createCustomBorders(t){jf(t,(t=>{const e=TF(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)}))}countHide(t){const{top:e,bottom:n,start:o,end:i}=t;return Ff([e,n,o,i],((t,e)=>{let n=t;return e&&e.hide&&(n+=1),n}),0)}clearBordersFromSelectionSettings(t){const e=Bf(this.hot.selection.highlight.customSelections,(t=>t.settings.id)).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){jf(this.hot.selection.highlight.customSelections,((t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1}))}hideBorders(){jf(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()}))}spliceBorder(t){const e=Bf(this.savedBorders,(t=>t.id)).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;return 4===this.countHide(t)?(this.spliceBorder(t.id),e=!0):jf(this.savedBorders,((n,o)=>{if(t.id===n.id)return this.savedBorders[o]=t,e=!0,!1})),e}checkCustomSelectionsFromContextMenu(t,e,n){let o=!1;return jf(this.hot.selection.highlight.customSelections,(i=>{if(t.id===i.settings.id){return jf(this.hot.view._wt.selectionManager.getBorderInstances(i),(t=>{t.toggleHiddenClass(e,n)})),o=!0,!1}})),o}checkCustomSelections(t,e,n){const o=this.countHide(t);let i=!1;return 4===o?(this.removeAllBorders(t.row,t.col),i=!0):jf(this.hot.selection.highlight.customSelections,(o=>{if(t.id===o.settings.id){if(o.visualCellRange=e,o.commit(),n){jf(this.hot.view._wt.selectionManager.getBorderInstances(o),(e=>{e.changeBorderStyle(n,t)}))}return i=!0,!1}})),i}changeBorderSettings(){const t=this.hot.getSettings()[WF];if(Array.isArray(t)){const e=ww(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){const e=t.some((t=>qf(t.left)||qf(t.right)));const n=function(t){return t.some((t=>qf(t.start)||qf(t.end)))}(t);if(e&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function zF(t){var e;this.hot.getSettings()[WF]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(JM)},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[(e=this,{key:"borders:top",name(){let t=this.getTranslatedPhrase(tT);return HF(this,"top")&&(t=IF(t)),t},callback(t,n){const o=HF(this,"top");e.prepareBorder(n,"top",o)}}),DF(this),_F(this),PF(this),NF(this)]}})}function UF(){this.changeBorderSettings()}function YF(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function $F(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GF(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const KF="dragToScroll";var XF=new WeakSet;class qF extends P_{constructor(){super(...arguments),YF(this,XF),$F(this,"boundaries",null),$F(this,"callback",null),$F(this,"listening",!1)}static get PLUGIN_KEY(){return KF}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[KF]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(t=>GF(XF,this,ZF).call(this,t))),this.addHook("afterOnCellCornerMouseDown",(t=>GF(XF,this,ZF).call(this,t))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let n=0,o=0;e<this.boundaries.top?o=e-this.boundaries.top:e>this.boundaries.bottom&&(o=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:t}=this.hot;let e=t;for(;e;)this.eventManager.addEventListener(e.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mousemove",(t=>this.onMouseMove(t))),e=Op(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}function ZF(t){if(hb(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback(((t,n)=>{var o,i;const r=null!==(o=e.scrollLeft)&&void 0!==o?o:e.scrollX,s=null!==(i=e.scrollTop)&&void 0!==i?i:e.scrollY;e.scroll(r+50*Math.sign(t),s+20*Math.sign(n))})),this.listen()}function QF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JF(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tW(t,e,n){return t.set(eW(t,e),n),n}function eW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("afterDropdownMenuDefaultOptions"),tv.getSingleton().register("beforeDropdownMenuShow"),tv.getSingleton().register("afterDropdownMenuShow"),tv.getSingleton().register("afterDropdownMenuHide"),tv.getSingleton().register("afterDropdownMenuExecute");const nW="dropdownMenu",oW="changeType",iW=nW;var rW=new WeakMap,sW=new WeakSet;class lW extends P_{static get PLUGIN_KEY(){return nW}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[zD,UD,WD,GD,WD,jD,WD,YD,WD,BD]}constructor(t){var e,n;super(t),QF(e=this,n=sW),n.add(e),JF(this,"commandExecutor",new jL(this.hot)),JF(this,"itemsFactory",null),JF(this,"menu",null),function(t,e,n){QF(t,e),e.set(t,n)}(this,rW,!1),this.hot.addHook("afterGetColHeader",((t,e)=>eW(sW,this,cW).call(this,t,e)))}isEnabled(){return this.hot.getSettings()[nW]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new UL(this.hot,lW.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return eW(sW,t,mW).call(t,...n)})),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return eW(sW,t,pW).call(t,...n)}));const e=this.hot.getSettings()[nW],n={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const o=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new CV(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",(()=>eW(sW,this,uW).call(this))),this.menu.addLocalHook("afterOpen",(()=>eW(sW,this,dW).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(t=>eW(sW,this,gW).call(this,t))),this.menu.addLocalHook("afterClose",(()=>eW(sW,this,fW).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return t.executeCommand.call(t,...n)})),jf(o,(t=>this.commandExecutor.registerCommand(t.key,t)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);const{from:e}=this.hot.getSelectedRangeLast(),n=VD(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,e.col,!0).querySelector(`.${oW}`),i=o.getBoundingClientRect();this.open({left:i.left+n.left,top:i.top+o.offsetHeight+n.top},{left:i.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:iW},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:iW}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iW)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(t=>eW(sW,this,hW).call(this,t)))}open(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),Rw(n,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.commandExecutor.execute(t,...n)}setListening(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function aW(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function hW(t){if(Wp(t.target,oW)){const e=VD(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),tW(rW,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function cW(t,e){const n=e.parentNode;if(!n)return;const o=n.parentNode.childNodes,i=Array.prototype.indexOf.call(o,n);if(t<0||i!==o.length-1)return;const r=e.querySelector(`.${oW}`);if(this.enabled&&r)return;if(!this.enabled)return void(r&&r.parentNode.removeChild(r));const s=this.hot.rootDocument.createElement("button");s.className=oW,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(zp(s,[["aria-hidden","true"],vp(" ")]),zp(e,[yp("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function uW(){this.hot.runHooks("beforeDropdownMenuShow",this)}function dW(){this.hot.runHooks("afterDropdownMenuShow",this),eW(sW,this,aW).call(this,this.menu)}function gW(t){eW(sW,this,aW).call(this,t)}function fW(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function pW(t){return n=this,(e=rW).get(eW(e,n))?null:t;var e,n}function mW(t){Wp(t.target,oW)&&tW(rW,this,!0)}function wW(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}lW.SEPARATOR={name:WD};const bW=class{constructor(t){wW(this,"hot",void 0),wW(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){const{startRow:t,startCol:e,endRow:n,endCol:o}=this._getDataRange(),i=this.options,r=[];return Ay(t,n,(t=>{const n=[];!i.exportHiddenRows&&this._isHiddenRow(t)||(Ay(e,o,(e=>{!i.exportHiddenColumns&&this._isHiddenColumn(e)||n.push(this.hot.getDataAtCell(t,e))})),r.push(n))})),r}getRowHeaders(){const t=[];if(this.options.rowHeaders){const{startRow:e,endRow:n}=this._getDataRange(),o=this.hot.getRowHeader();Ay(e,n,(e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(o[e])}))}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){const{startCol:e,endCol:n}=this._getDataRange(),o=this.hot.getColHeader();Ay(e,n,(e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(o[e])}))}return t}_getDataRange(){const t=this.hot.countCols()-1,e=this.hot.countRows()-1;let[n=0,o=0,i=e,r=t]=this.options.range;return n=Math.max(n,0),o=Math.max(o,0),i=Math.min(i,e),r=Math.min(r,t),{startRow:n,startCol:o,endRow:i,endCol:r}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}};function vW(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class yW{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){vW(this,"dataProvider",void 0),vW(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=bw(this.constructor.DEFAULT_OPTIONS);const n=new Date;return e=pw(bw(yW.DEFAULT_OPTIONS),e),e=pw(e,t),e.filename=fp(e.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),e}}const CW=yW,SW=String.fromCharCode(13),RW=String.fromCharCode(34),xW=String.fromCharCode(10);const EW=class extends CW{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const t=this.options,e=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const o=n.length>0,i=this.dataProvider.getRowHeaders(),r=i.length>0;let s=t.bom?String.fromCharCode(65279):"";return o&&(n=Bf(n,(t=>this._escapeCell(t,!0))),r&&(s+=t.columnDelimiter),s+=n.join(t.columnDelimiter),s+=t.rowDelimiter),jf(e,((e,n)=>{n>0&&(s+=t.rowDelimiter),r&&(s+=this._escapeCell(i[n])+t.columnDelimiter),s+=e.map((t=>this._escapeCell(t))).join(t.columnDelimiter)})),s}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Xf(t);return""!==n&&(e||n.indexOf(SW)>=0||n.indexOf(RW)>=0||n.indexOf(xW)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}},MW="csv",TW={[MW]:EW};class kW extends P_{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:n,rootWindow:o}=this.hot,i=this._createTypeFormatter(t,e),r=this._createBlob(i),s=o.URL||o.webkitURL,l=n.createElement("a"),a=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==l.download){const t=s.createObjectURL(r);l.style.display="none",l.setAttribute("href",t),l.setAttribute("download",a),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout((()=>{s.revokeObjectURL(t)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,a)}_createTypeFormatter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!TW[t])throw new Error(`Export format type "${t}" is not supported.`);return function(t,e,n){return"function"==typeof TW[t]?new TW[t](e,n):null}(t,new bW(this.hot),e)}_createBlob(t){let e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}function AW(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class HW{constructor(t,e){let{id:n,stateless:o=!0}=e;AW(this,"hot",void 0),AW(this,"id",void 0),AW(this,"elements",[]),AW(this,"hidden",!1),AW(this,"stateId",""),AW(this,"state",void 0),this.hot=t,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new jE)}getElements(){return this.elements}reset(){jf(this.elements,(t=>t.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw new Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),jf(this.elements,(t=>t.destroy())),this.state=null,this.elements=null,this.hot=null}}vw(HW,YR);const IW={};function OW(t,e){if(!IW[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:o}=IW[t];let i=e;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(t){return n.apply(t.meta.instance,[].concat([t],[i]))}}function _W(t){if(!IW[t])throw Error(`Filter condition "${t}" does not exist.`);return IW[t].descriptor}function PW(t,e,n){n.key=t,IW[t]={condition:e,descriptor:n}}const NW="none";PW(NW,(function(){return!0}),{name:gT,inputsCount:0,showOperators:!1});const DW="empty";PW(DW,(function(t){return Qf(t.value)}),{name:fT,inputsCount:0,showOperators:!0});const LW="not_empty";PW(LW,(function(t,e){return!OW(DW,e)(t)}),{name:pT,inputsCount:0,showOperators:!0});const VW="eq";PW(VW,(function(t,e){let[n]=e;return Xf(t.value).toLocaleLowerCase(t.meta.locale)===Xf(n)}),{name:mT,inputsCount:1,showOperators:!0});const FW="neq";PW(FW,(function(t,e){return!OW(VW,e)(t)}),{name:wT,inputsCount:1,showOperators:!0});PW("gt",(function(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>o}),{name:RT,inputsCount:1,showOperators:!0});PW("gte",(function(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>=o}),{name:xT,inputsCount:1,showOperators:!0});PW("lt",(function(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<o}),{name:ET,inputsCount:1,showOperators:!0});PW("lte",(function(t,e){let[n]=e,o=n;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<=o}),{name:MT,inputsCount:1,showOperators:!0});const WW="date_after";PW(WW,(function(t,e){let[n]=e;const o=kc(t.value,t.meta.dateFormat),i=kc(n,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)>=0}),{name:AT,inputsCount:1,showOperators:!0});const BW="date_before";PW(BW,(function(t,e){let[n]=e;const o=kc(t.value,t.meta.dateFormat),i=kc(n,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)<=0}),{name:HT,inputsCount:1,showOperators:!0});const jW="between";PW(jW,(function(t,e){let[n,o]=e,i=n,r=o;if("numeric"===t.meta.type){const t=parseFloat(i,10),e=parseFloat(r,10);i=Math.min(t,e),r=Math.max(t,e)}else if("date"===t.meta.type){const e=OW(BW,[r]),n=OW(WW,[i]);return e(t)&&n(t)}return t.value>=i&&t.value<=r}),{name:TT,inputsCount:2,showOperators:!0});const zW="not_between";PW(zW,(function(t,e){return!OW(jW,e)(t)}),{name:kT,inputsCount:2,showOperators:!0});const UW="begins_with";PW(UW,(function(t,e){let[n]=e;return Xf(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Xf(n))}),{name:bT,inputsCount:1,showOperators:!0});const YW="ends_with";PW(YW,(function(t,e){let[n]=e;return Xf(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Xf(n))}),{name:vT,inputsCount:1,showOperators:!0});const $W="contains";PW($W,(function(t,e){let[n]=e;return Xf(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Xf(n))>=0}),{name:yT,inputsCount:1,showOperators:!0});const GW="not_contains";PW(GW,(function(t,e){return!OW($W,e)(t)}),{name:CT,inputsCount:1,showOperators:!0});const KW="date_tomorrow";PW(KW,(function(t){const e=kc(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(kc().subtract(-1,"days").startOf("day"),"d")}),{name:OT,inputsCount:0});const XW="date_today";PW(XW,(function(t){const e=kc(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(kc().startOf("day"),"d")}),{name:IT,inputsCount:0});const qW="date_yesterday";function ZW(t,e){let n=t;return""===n&&(n=`(${e})`),n}PW(qW,(function(t){const e=kc(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(kc().subtract(1,"days").startOf("day"),"d")}),{name:_T,inputsCount:0}),Nw();const QW=new Set([1]).has(1),JW=QW&&"function"==typeof Array.from;function tB(t){let e=t;return QW&&(e=new Set(e)),function(t){let n;return n=QW?e.has(t):!!~e.indexOf(t),n}}function eB(t){return null==t?"":t}function nB(t){let e=t;return e=JW?Array.from(new Set(e)):Uf(e),e=e.sort(((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1)),e}function oB(t,e,n,o){const i=[],r=t===e;let s;return r||(s=tB(e)),jf(t,(t=>{let e=!1;(r||s(t))&&(e=!0);const l={checked:e,value:t,visualValue:ZW(t,n)};o&&o(l),i.push(l)})),i}const iB="by_value";PW(iB,(function(t,e){let[n]=e;return n(t.value)}),{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[tB(e)]},showOperators:!1});const rB={};function sB(t){return rB[t].name}function lB(t,e,n){rB[t]={name:e,func:n}}const aB="conjunction";lB(aB,DT,(function(t,e){return t.every((t=>t.func(e)))}));const hB="disjunction";lB(hB,LT,(function(t,e){return t.some((t=>t.func(e)))}));const cB="disjunctionWithExtraCondition";lB(cB,LT,(function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((t=>t.func(e)))&&t[t.length-1].func(e)}));const uB="numeric",dB="text",gB="date",fB={[uB]:[NW,WD,DW,LW,WD,VW,FW,WD,"gt","gte","lt","lte",jW,zW],[dB]:[NW,WD,DW,LW,WD,VW,FW,WD,UW,YW,WD,$W,GW],[gB]:[NW,WD,DW,LW,WD,VW,FW,WD,BW,WW,jW,WD,KW,XW,qW]};function pB(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const mB="built",wB="building",bB=["click","input","keydown","keypress","keyup","focus","blur","change"];let vB=class t{static get DEFAULTS(){return bw({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){pB(this,"hot",void 0),pB(this,"eventManager",new pv(this)),pB(this,"options",void 0),pB(this,"_element",void 0),pB(this,"buildState",void 0),this.hot=e,this.options=pw(t.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===wB?this._element:this.buildState===mB?(this.update(),this._element):(this.buildState=wB,this.build(),this.buildState=mB,this._element)}isBuilt(){return this.buildState===mB}translateIfPossible(t){return"string"==typeof t&&t.startsWith(uT)?this.hot.getTranslatedPhrase(t):t}build(){const t=(t,e)=>{this.eventManager.addEventListener(t,e,(t=>this.runLocalHooks(e,t,this)))};if(this.buildState||(this.buildState=wB),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&Bp(this._element,this.options.className),this.options.children.length)jf(this.options.children,(t=>this._element.appendChild(t.element)));else if(this.options.wrapIt){const e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),Rw(this.options,((t,n)=>{void 0!==e[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(e[n]=this.translateIfPossible(t))})),this._element.appendChild(e),jf(bB,(n=>t(e,n)))}else jf(bB,(e=>t(this._element,e)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};function yB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CB(t,e){return t.get(SB(t,e))}function SB(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}vw(vB,YR);var RB=new WeakMap,xB=new WeakSet;class EB extends vB{static get DEFAULTS(){return bw({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){var n,o;super(t,pw(EB.DEFAULTS,e)),yB(n=this,o=xB),o.add(n),function(t,e,n){yB(t,e),e.set(t,n)}(this,RB,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(t=>SB(xB,this,MB).call(this,t)))}build(){super.build();const t=this.hot.rootDocument.createElement("div");var e,n,o;e=RB,n=this,o=this._element.firstChild,e.set(SB(e,n),o),Bp(this._element,"htUIInput"),Bp(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(CB(RB,this).type=this.options.type,CB(RB,this).placeholder=this.translateIfPossible(this.options.placeholder),CB(RB,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&CB(RB,this).focus()}}function MB(t){this.options.value=t.target.value}function TB(t,e,n){kB(t,e),e.set(t,n)}function kB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AB(t,e,n){return t.set(IB(t,e),n),n}function HB(t,e){return t.get(IB(t,e))}function IB(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var OB=new WeakMap,_B=new WeakMap,PB=new WeakMap,NB=new WeakMap,DB=new WeakMap,LB=new WeakSet;class VB extends vB{static get DEFAULTS(){return bw({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){var n,o;super(t,pw(VB.DEFAULTS,e)),kB(n=this,o=LB),o.add(n),TB(this,OB,null),TB(this,_B,[]),TB(this,PB,void 0),TB(this,NB,void 0),TB(this,DB,void 0),this.registerHooks()}getMenu(){return HB(OB,this)}registerHooks(){this.addLocalHook("click",(()=>IB(LB,this,BB).call(this)))}setItems(t){AB(_B,this,this.translateNames(t)),HB(OB,this)&&HB(OB,this).setMenuItems(HB(_B,this))}translateNames(t){return jf(t,(t=>{t.name=this.translateIfPossible(t.name)})),t}build(){super.build(),AB(OB,this,new CV(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),HB(OB,this).setMenuItems(HB(_B,this));const t=new vB(this.hot,{className:"htUISelectCaption"}),e=new vB(this.hot,{className:"htUISelectDropdown"});AB(PB,this,t),AB(NB,this,t.element),AB(DB,this,e),this.hot.getSettings().ariaTags&&(zp(e.element,[["aria-hidden","true"]]),zp(this._element,[["role","listbox"]])),jf([t,e],(t=>this._element.appendChild(t.element))),HB(OB,this).addLocalHook("select",(t=>IB(LB,this,FB).call(this,t))),HB(OB,this).addLocalHook("afterClose",(()=>IB(LB,this,WB).call(this))),this.update()}update(){if(!this.isBuilt())return;let t;t=this.options.value?this.options.value.name:HB(OB,this).hot.getTranslatedPhrase(gT),HB(NB,this).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();HB(OB,this)&&(HB(OB,this).open(),HB(OB,this).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),HB(OB,this).getNavigator().toFirstItem(),HB(OB,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){HB(OB,this)&&HB(OB,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){HB(OB,this)&&(HB(OB,this).destroy(),AB(OB,this,null)),HB(PB,this)&&HB(PB,this).destroy(),HB(DB,this)&&HB(DB,this).destroy(),super.destroy()}}function FB(t){t.name!==WD&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function WB(){this.runLocalHooks("afterClose")}function BB(){this.openOptions()}function jB(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function zB(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UB(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var YB=new WeakSet;class $B extends HW{constructor(t,e){super(t,{id:e.id,stateless:!1}),jB(this,YB),zB(this,"name",""),zB(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new VB(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new EB(this.hot,{placeholder:UT})),this.elements.push(new EB(this.hot,{placeholder:YT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(t=>UB(YB,this,GB).call(this,t))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(t=>this.runLocalHooks("selectTabKeydown",t))),jf(this.getInputElements(),(t=>{t.addLocalHook("keydown",(t=>UB(YB,this,KB).call(this,t)))}))}setState(t){if(this.reset(),!t)return;const e=bw(t.command);e.name.startsWith(dT)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),jf(t.args,((t,n)=>{if(n>e.inputsCount-1)return!1;const o=this.getInputElement(n);o.setValue(t),o[e.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout((()=>o.focus()),10)}))}getState(){const t=this.getSelectElement().getValue()||_W(NW),e=[];return jf(this.getInputElements(),((n,o)=>{t.inputsCount>o&&e.push(n.getValue())})),{command:t,args:e}}updateState(t,e){const n=_W(t?t.name:NW);this.state.setValueAtIndex(e,{command:n,args:t?t.args:[]}),t||jf(this.getInputElements(),(t=>t.setValue(null)))}getSelectElement(){return this.elements.filter((t=>t instanceof VB))[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter((t=>t instanceof EB))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,n,o,i,r)=>{Bp(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Bp(e.parentNode,"border");const s=this.hot.rootDocument.createElement("div");return Bp(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),e.parentElement.hasAttribute("ghost-table")||jf(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getPlugin("filters").getSelectedColumn();let e=[_W(NW)];if(null!==t){const{visualIndex:n}=t;e=function(t){const e=[];let n=t;return fB[n]||(n=dB),jf(fB[n],(t=>{let n;n=t===WD?{name:WD}:bw(_W(t)),e.push(n)})),e}(this.hot.getDataType(0,n,this.hot.countRows(),n))}jf(this.getInputElements(),(t=>t.hide())),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function GB(t){jf(this.getInputElements(),((e,n)=>{e[t.inputsCount>n?"show":"hide"](),0===n&&this.hot._registerTimeout((()=>e.focus()),10)})),this.runLocalHooks("change",t)}function KB(t){rb(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),lb(t))}function XB(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function qB(t,e){return t.get(QB(t,e))}function ZB(t,e,n){return t.set(QB(t,e),n),n}function QB(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var JB=new WeakMap,tj=new WeakMap;class ej extends vB{static get DEFAULTS(){return bw({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,pw(ej.DEFAULTS,e)),XB(this,JB,void 0),XB(this,tj,void 0)}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),ZB(tj,this,t),ZB(JB,this,this._element.firstChild),qB(JB,this).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(qB(tj,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&qB(JB,this).checked}setChecked(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(qB(JB,this).checked=t)}focus(){this.isBuilt()&&qB(JB,this).focus()}}function nj(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function oj(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ij=new WeakSet;class rj extends HW{constructor(t,e){super(t,{id:e.id,stateless:!1}),nj(this,ij),oj(this,"name",""),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(Bp(e.parentNode,"htFiltersMenuOperators"),jf(this.elements,(t=>e.appendChild(t.element))),e)}}buildOperatorsElement(){const t=[aB,hB];jf(t,(e=>{const n=new ej(this.hot,{name:"operator",label:{htmlFor:e,textContent:sB(e)},value:e,checked:e===t[0],id:e});n.addLocalHook("change",(t=>function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(ij,this,sj).call(this,t))),this.elements.push(n)}))}setChecked(t){if(this.elements.length<t)throw Error(Kf(M||(M=j`Radio button with index ${0} doesn't exist.`),t));jf(this.elements,((e,n)=>{e.setChecked(n===t)}))}getActiveOperationId(){const t=this.elements.find((t=>t instanceof ej&&t.isChecked()));return t?t.getValue():aB}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&jf(this.elements,(e=>{e.setChecked(e.getValue()===t)}))}updateState(){let t=arguments.length>1?arguments[1]:void 0,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aB;e===cB&&(e=hB),this.state.setValueAtIndex(t,e)}reset(){this.setChecked(0)}}function sj(t){this.setState(t.target.value)}function lj(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function aj(t,e){return t.get(hj(t,e))}function hj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cj=new WeakMap;class uj extends vB{static get DEFAULTS(){return bw({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,pw(uj.DEFAULTS,e)),lj(this,cj,void 0)}build(){var t,e,n;super.build(),t=cj,e=this,n=this._element.firstChild,t.set(hj(t,e),n)}update(){this.isBuilt()&&(aj(cj,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&aj(cj,this).focus()}activate(){aj(cj,this).click()}}function dj(t,e,n){gj(t,e),e.set(t,n)}function gj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fj(t,e){return t.get(mj(t,e))}function pj(t,e,n){return t.set(mj(t,e),n),n}function mj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wj="multipleSelect.itemBox";var bj=new WeakMap,vj=new WeakMap,yj=new WeakMap,Cj=new WeakMap,Sj=new WeakMap,Rj=new WeakMap,xj=new WeakSet;class Ej extends vB{static get DEFAULTS(){return bw({className:"htUIMultipleSelect",value:[]})}constructor(t,e){var n,o;super(t,pw(Ej.DEFAULTS,e)),gj(n=this,o=xj),o.add(n),dj(this,bj,[]),dj(this,vj,void 0),dj(this,yj,void 0),dj(this,Cj,void 0),dj(this,Sj,void 0),dj(this,Rj,void 0),pj(Cj,this,new EB(this.hot,{placeholder:zT,className:"htUIMultipleSelectSearch"})),pj(Sj,this,new uj(this.hot,{textContent:FT,className:"htUISelectAll"})),pj(Rj,this,new uj(this.hot,{textContent:WT,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return fj(vj,this)}registerHooks(){fj(Cj,this).addLocalHook("keydown",(t=>mj(xj,this,Tj).call(this,t))),fj(Cj,this).addLocalHook("input",(t=>mj(xj,this,Mj).call(this,t))),fj(Sj,this).addLocalHook("click",(t=>mj(xj,this,kj).call(this,t))),fj(Rj,this).addLocalHook("click",(t=>mj(xj,this,Aj).call(this,t)))}setItems(t){var e;pj(bj,this,t),null===(e=fj(vj,this))||void 0===e||e.loadData(fj(bj,this))}setLocale(t){pj(yj,this,t)}getLocale(){return fj(yj,this)}getItems(){return[...fj(bj,this)]}getValue(){return function(t){const e=[];return t.forEach((t=>{t.checked&&e.push(t.value)})),e}(fj(bj,this))}getSearchInputElement(){return fj(Cj,this)}getSelectAllElement(){return fj(Sj,this)}getClearAllElement(){return fj(Rj,this)}isSelectedAllValues(){return fj(bj,this).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,e=t.createElement("div"),n=new vB(this.hot,{className:"htUISelectionControls",children:[fj(Sj,this),fj(Rj,this)]});this._element.appendChild(fj(Cj,this).element),this._element.appendChild(n.element),this._element.appendChild(e);const o=e=>{var n;if(!this._element)return;null===(n=fj(vj,this))||void 0===n||n.destroy(),Bp(e,"htUIMultipleSelectHot"),pj(vj,this,new this.hot.constructor(e,{data:fj(bj,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,n,o,i,r)=>{t.title=r.instance.getDataAtRowProp(e,r.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{fj(vj,this).listen()},colWidths:()=>fj(vj,this).container.scrollWidth-wm(t),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),fj(vj,this).init();const o=fj(vj,this).getShortcutManager().getContext("grid");o.removeShortcutsByKeys(["Tab"]),o.removeShortcutsByKeys(["Shift","Tab"]),o.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:wj}),o.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{fj(vj,this).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:wj})};o(e),this.hot._registerTimeout((()=>o(e)),100)}focus(){this.isBuilt()&&fj(vj,this).listen()}reset(){fj(Cj,this).reset(),fj(Sj,this).reset(),fj(Rj,this).reset()}update(){this.isBuilt()&&(fj(vj,this).loadData(function(t,e){const n=tB(e);return t.map((t=>(t.checked=n(t.value),t)))}(fj(bj,this),this.options.value)),super.update())}destroy(){var t;null===(t=fj(vj,this))||void 0===t||t.destroy(),fj(Cj,this).destroy(),fj(Rj,this).destroy(),fj(Sj,this).destroy(),pj(Cj,this,null),pj(Rj,this,null),pj(Sj,this,null),pj(vj,this,null),pj(bj,this,null),super.destroy()}}function Mj(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;n=""===e?[...fj(bj,this)]:fj(bj,this).filter((t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0)),fj(vj,this).loadData(n)}function Tj(t){this.runLocalHooks("keydown",t,this);_m(rb,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),lb(t),fj(vj,this).listen(),fj(vj,this).selectCell(0,0))}function kj(t){const e=[];t.preventDefault(),fj(vj,this).getSourceData().forEach(((t,n)=>{t.checked=!0,e.push(xE(t,n)[0])})),fj(vj,this).setSourceDataAtCell(e)}function Aj(t){const e=[];t.preventDefault(),fj(vj,this).getSourceData().forEach(((t,n)=>{t.checked=!1,e.push(xE(t,n)[0])})),fj(vj,this).setSourceDataAtCell(e)}function Hj(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function Ij(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _j,Pj=new WeakSet;class Nj extends HW{constructor(t,e){super(t,{id:e.id,stateless:!1}),Hj(this,Pj),Ij(this,"name",""),this.name=e.name,this.elements.push(new Ej(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(t=>Oj(Pj,this,Dj).call(this,t))).addLocalHook("listTabKeydown",(t=>this.runLocalHooks("listTabKeydown",t))),this.hot.addHook("modifyFiltersMultiSelectValue",((t,e)=>Oj(Pj,this,Vj).call(this,t,e)))}getElements(){const t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===iB){const e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){const t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?NW:iB},args:[t.getValue()],itemsSnapshot:e}}updateState(t){const e=(e,n,o,i,r)=>{const[s]=Wf(n,(t=>t.name===iB)),l={},a=this.hot.getTranslatedPhrase(VT);if(s){const n=i(e,r),h=Bf(n,(t=>t.value)),c=new Map(n.map((t=>[t.value,this.hot.getCellMeta(t.meta.visualRow,t.meta.visualCol)]))),u=nB(h);o&&(s.args[0]=o);const d=[],g=oB(u,s.args[0],a,(t=>{t.checked&&d.push(t.value),Oj(Pj,this,Lj).call(this,t,c)})),f=t.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,f).locale,l.args=[d],l.command=_W(iB),l.itemsSnapshot=g}else l.args=[],l.command=_W(NW);this.state.setValueAtIndex(e,l)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((t=>t instanceof Ej))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,n,o,i,r)=>{Bp(e.parentNode,"htFiltersMenuValue");const s=this.hot.rootDocument.createElement("div");return Bp(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),e.parentElement.hasAttribute("ghost-table")||jf(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getTranslatedPhrase(VT),e=this._getColumnVisibleValues(),n=e.map((t=>t.value)),o=new Map(e.map((t=>[t.value,t.meta]))),i=nB(n),r=oB(i,i,t,(t=>{Oj(Pj,this,Lj).call(this,t,o)}));this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(i);const s=this.hot.getPlugin("filters").getSelectedColumn();null!==s&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}_getColumnVisibleValues(){const t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:Bf(this.hot.getDataAtCol(t.visualIndex),((e,n)=>({value:eB(e),meta:this.hot.getCellMeta(n,t.visualIndex)})))}}function Dj(t){rb(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),lb(t))}function Lj(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Vj(t,e){return"numeric"===e.type?e_(t,e):t}function Fj(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function Wj(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Bj=new WeakSet;class jj extends HW{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){super(t,{id:e.id,stateless:!0}),Fj(this,Bj),Wj(this,"name",""),this.name=e.name,this.elements.push(new EB(this.hot,{type:"button",value:BT,className:"htUIButton htUIButtonOK",identifier:jj.BUTTON_OK})),this.elements.push(new EB(this.hot,{type:"button",value:jT,className:"htUIButton htUIButtonCancel",identifier:jj.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){jf(this.elements,(t=>{t.addLocalHook("click",((t,e)=>function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(Bj,this,zj).call(this,t,e)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(Bp(e.parentNode,"htFiltersMenuActionBar"),jf(this.elements,(t=>e.appendChild(t.element))),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function zj(t,e){e.options.identifier===_j.BUTTON_OK?this.accept():this.cancel()}function Uj(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}_j=jj;const Yj="ConditionCollection.filteringStates";class $j{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Uj(this,"hot",void 0),Uj(this,"isMapRegistrable",void 0),Uj(this,"filteringStates",new jE),Uj(this,"previousConditionStack",null),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(Yj,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var n;const o=this.filteringStates.getValueAtIndex(e),i=null!==(n=null==o?void 0:o.conditions)&&void 0!==n?n:[],r=null==o?void 0:o.operation;return this.isMatchInConditions(i,t,r)}isMatchInConditions(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aB;return!t.length||function(t){if(!rB[t])throw Error(`Operation with id "${t}" does not exist.`);const e=rB[t].func;return function(t,n){return e(t,n)}}(n)(t,e)}addCondition(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aB,o=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,t).locale,r=Bf(e.args,(t=>"string"==typeof t?t.toLocaleLowerCase(i):t)),s=e.name||e.command.key;null===this.previousConditionStack&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",t);const l=this.getOperation(t);if(l){if(l!==n)throw Error(Kf(T||(T=j`The column of index ${0} has been already applied with a \`${0}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`),t,l))}else if(Zf(rB[n]))throw new Error(Kf(k||(k=j`Unexpected operation named \`${0}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`),n));const a=this.getConditions(t);0===a.length?this.filteringStates.setValueAtIndex(t,{operation:n,conditions:[{name:s,args:r,func:OW(s,r)}]},o):a.push({name:s,args:r,func:OW(s,r)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,n;return null!==(e=null===(n=this.filteringStates.getValueAtIndex(t))||void 0===n?void 0:n.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((t=>{let[e]=t;return e}))}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return Ff(this.filteringStates.getEntries(),((t,e)=>{let[n,{operation:o,conditions:i}]=e;return t.push({column:n,operation:o,conditions:Bf(i,(t=>{let{name:e,args:n}=t;return{name:e,args:n}}))}),t}),[])}importAllConditions(t){this.clean(),jf(t,(t=>{jf(t.conditions,(e=>this.addCondition(t.column,e)))}))}removeConditions(t){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){const n=this.getConditions(t);return e?n.some((t=>t.name===e)):n.length>0}setPreviousConditionStack(t){this.previousConditionStack=t}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(Yj),this.filteringStates=null,this.clearLocalHooks()}}vw($j,YR);const Gj=$j;function Kj(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Xj=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];Kj(this,"conditionCollection",void 0),Kj(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return jf(this.conditionCollection.getFilteredColumns(),((e,n)=>{let o=this.columnDataFactory(e);n&&(o=this._getIntersectData(o,t)),t=this.filterByColumn(e,o)})),t}filterByColumn(t){const e=[];return jf(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],(n=>{void 0!==n&&this.conditionCollection.isMatch(n,t)&&e.push(n)})),e}_getIntersectData(t,e){const n=[];return jf(e,(e=>{const o=e.meta.visualRow;void 0!==t[o]&&(n[o]=t[o])})),n}};function qj(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function Zj(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jj=new WeakSet;class tz{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];qj(this,Jj),Zj(this,"hot",void 0),Zj(this,"conditionCollection",void 0),Zj(this,"columnDataFactory",void 0),Zj(this,"changes",[]),Zj(this,"grouping",!1),Zj(this,"latestEditedColumnPosition",-1),Zj(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",(t=>Qj(Jj,this,ez).call(this,t))),this.conditionCollection.addLocalHook("afterRemove",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("afterAdd",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("beforeClean",(()=>Qj(Jj,this,nz).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>Qj(Jj,this,oz).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,jf(this.changes,(t=>{this.updateStatesAtColumn(t)})),this.changes.length=0}updateStatesAtColumn(t,e){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));const o=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(t);-1===i&&(i=this.latestEditedColumnPosition);const r=o.slice(0,i),s=o.slice(i);s.length&&s[0].column===t&&s.shift();const l=Pm((function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new Gj(n.hot,!1),r=[].concat(t,o);i.importAllConditions(r);const s=n.columnDataFactory(e);let l;l=i.isEmpty()?s:new Xj(i,(t=>n.columnDataFactory(t))).filter(),l=Bf(l,(t=>t.meta.visualRow));const a=tB(l);return i.destroy(),Wf(s,(t=>a(t.meta.visualRow)))}))(r),a=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:a},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),Rw(this,((t,e)=>{this[e]=null}))}}function ez(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function nz(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function oz(){jf(this.latestOrderStack,(t=>{this.updateStatesAtColumn(t)}))}vw(tz,YR);const iz=tz;const rz="filters";function sz(t,e){let n=-1;const o=(i=e,oV({initialPage:0,size:()=>i.length,onItemSelect:(t,e)=>{const n=i[t];return n instanceof Ej?e:!(n.element&&!qp(n.element))&&void n.focus()}}));var i;const r=n=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(rz),o.setCurrentPage(e.indexOf(n))};function s(i){const r=t.getKeyboardShortcutsCtrl(),s=i.getKeyboardShortcutsCtrl();o.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r.getContext(rz),callback:()=>{i.isSubMenu()&&i.close(),r.listen(rz)}}]),i.isSubMenu()||r.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{const i=t.getNavigator();i.getCurrentPage()>-1&&(n=i.getCurrentPage()),i.clear(),e.shiftKey?o.toPreviousItem():o.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{const n=e[o.getCurrentPage()];n instanceof VB&&(n.openOptions(),t.preventDefault()),n instanceof uj&&(n.activate(),t.preventDefault()),n instanceof vB||t.preventDefault()}}],rz)}return e.forEach((t=>{t instanceof vB&&(t.addLocalHook("click",r(t)),t.addLocalHook("focus",r(t)),t.addLocalHook("afterClose",r(t)))})),t.addLocalHook("afterSelectionChange",(t=>{t.key.startsWith("filter_")||o.clear()})),t.addLocalHook("afterSubmenuOpen",s),t.addLocalHook("afterOpen",s),$($({},o),{},{listen:function(){t.focus(),t.getKeyboardShortcutsCtrl().listen(rz)},getLastMenuPage:function(){return n}})}function lz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function az(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hz(t,e){return t.get(cz(t,e))}function cz(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uz="filters",dz=uz;var gz=new WeakMap,fz=new WeakSet;class pz extends P_{static get PLUGIN_KEY(){return uz}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){var e,n;super(t),lz(e=this,n=fz),n.add(e),az(this,"dropdownMenuPlugin",null),az(this,"conditionCollection",null),az(this,"conditionUpdateObserver",null),az(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),az(this,"filtersRowsMap",null),function(t,e,n){lz(t,e),e.set(t,n)}(this,gz,void 0),this.hot.addHook("afterGetColHeader",((t,e)=>cz(fz,this,Rz).call(this,t,e)))}isEnabled(){return!!this.hot.getSettings()[uz]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new zE),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,n=t=>(t.addLocalHook("accept",(()=>cz(fz,this,yz).call(this,"accept"))),t.addLocalHook("cancel",(()=>cz(fz,this,yz).call(this,"cancel"))),t.addLocalHook("change",(e=>cz(fz,this,Cz).call(this,t,e))),t),o=()=>`${this.hot.getTranslatedPhrase(PT)}:`,i=()=>`${this.hot.getTranslatedPhrase(NT)}:`;if(!this.components.get("filter_by_condition")){const t=new $B(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",(()=>cz(fz,this,Sz).call(this))),this.components.set("filter_by_condition",n(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new rj(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const t=new $B(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",(()=>cz(fz,this,Sz).call(this))),this.components.set("filter_by_condition2",n(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new Nj(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new jj(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Gj(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new iz(this.hot,this.conditionCollection,(t=>this.getDataMapAtColumn(t))),this.conditionUpdateObserver.addLocalHook("update",(t=>cz(fz,this,xz).call(this,t)))),this.components.forEach((t=>t.show())),this.addHook("afterDropdownMenuDefaultOptions",(t=>cz(fz,this,vz).call(this,t))),this.addHook("afterDropdownMenuShow",(()=>cz(fz,this,wz).call(this))),this.addHook("afterDropdownMenuHide",(()=>cz(fz,this,bz).call(this))),this.addHook("afterChange",(t=>cz(fz,this,mz).call(this,t))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!hz(gz,this)&&this.dropdownMenuPlugin.enabled){const t=this.dropdownMenuPlugin.menu,e=[{focus:()=>{const e=t.getNavigator(),n=hz(gz,this).getLastMenuPage();t.focus(),n>0?e.setCurrentPage(n):e.toFirstItem()}},...Array.from(this.components).map((t=>{let[,e]=t;return e.getElements()})).flat()];r=gz,s=this,l=sz(t,e),r.set(cz(r,s),l);const n=t=>{hz(gz,this).listen(),t.preventDefault(),rb(t.keyCode,"TAB")&&(t.shiftKey?hz(gz,this).toPreviousItem():hz(gz,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",n),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",n)}var r,s,l;this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var t;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((t,e)=>{t.destroy(),this.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:dz})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dz)}addCondition(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:aB;const i=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(i,{command:{key:e},args:n},o)}removeConditions(t){const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){const{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let o=[];const i=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",i,this.conditionCollection.previousConditionStack))if(n){const n=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),o=Bf(e.filter(),(t=>t.meta.visualRow));const t=tB(o);Ay(this.hot.countSourceRows()-1,(e=>{t(e)||n.push(e)})),jf(n,(t=>{this.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),t||o.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){const e=this.hot.toVisualColumn(t),n=[];return jf(this.hot.getSourceDataAtCol(e),((t,o)=>{var i;const{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d}=this.hot.getCellMeta(o,e),g=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(o),e))&&void 0!==i?i:t;n.push({meta:{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d},value:eB(g)})})),n}updateValueComponentCondition(t){const e=nB(this.hot.getDataAtCol(t));this.conditionUpdateObserver.updateStatesAtColumn(t,e)}restoreComponents(t){var e;const n=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((t=>{t.isHidden()||t.restoreState(n)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,n,o){let i=t;return i===hB&&e.command.key!==NW&&n.command.key!==NW&&o.command.key!==NW?i=cB:o.command.key!==NW&&(e.command.key!==NW&&n.command.key!==NW||(i=aB)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const t=this.components.get("filter_by_condition"),{command:e}=t.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new Xj(t,(t=>this.getDataMapAtColumn(t)))}getIndexesOfComponents(){const t=[];if(!this.dropdownMenuPlugin)return t;const e=this.dropdownMenuPlugin.menu;for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return jf(o,(n=>{jf(e.menuItems,((e,o)=>{e.key===n.getMenuItemDescriptor().key&&t.push(o)}))})),t}changeComponentsVisibility(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const e=this.dropdownMenuPlugin.menu.hotMenu,n=e.getPlugin("hiddenRows");for(var o=arguments.length,i=new Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];const s=this.getIndexesOfComponents(...i);t?n.showRows(s):n.hideRows(s),e.render()}hideComponents(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach(((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function mz(t){t&&jf(t,(t=>{const[,e]=t,n=this.hot.propToCol(e);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)}))}function wz(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function bz(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function vz(t){t.items.push({name:WD}),this.components.forEach((e=>{t.items.push(e.getMenuItemDescriptor())}))}function yz(t){var e;if("accept"===t){const t=this.getSelectedColumn();var n;if(null===t)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());const{physicalIndex:e}=t,o=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),r=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,i,r);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),o.command.key!==NW&&(this.conditionCollection.addCondition(e,o,s,l),i.command.key!==NW&&this.conditionCollection.addCondition(e,i,s,l)),r.command.key!==NW&&this.conditionCollection.addCondition(e,r,s,l),this.conditionUpdateObserver.flush(),this.components.forEach((t=>t.saveState(e))),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function Cz(t,e){this.updateDependentComponentsVisibility(),t.constructor!==$B||e.inputsCount||this.setListeningDropdownMenu()}function Sz(){this.setListeningDropdownMenu()}function Rz(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Bp(e,"htFiltersActive"):jp(e,"htFiltersActive")}function xz(t){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:n,column:o}}=t,i=n.filter((t=>t.name===iB)),r=n.filter((t=>t.name!==iB));if(i.length>=2||r.length>=3)Ub(Kf(A||(A=j`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`)));else{const e=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(r[0],o),this.components.get("filter_by_condition2").updateState(r[1],o),this.components.get("filter_operators").updateState(e,o),this.components.get("filter_by_value").updateState(t)}}const Ez="internal-use-in-handsontable",Mz={licenseKey:Ez,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Tz(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[wU])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function kz(t){return Object.keys(t).reduce(((e,n)=>("hyperformula"!==n&&(e[n]=t[n]),e)),{})}function Az(){const t="engine_relationship",e=nv(wU);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Hz(){const t="shared_engine_usage",e=nv(wU);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Iz(t){const e=t.getSettings(),n=e[wU],o=null==n?void 0:n.engine;if(!0===n)return null;if(Zf(o))return null;var i;if("function"==typeof o.hyperformula||"function"==typeof o)return function(t,e,n){const o=e[wU],i=function(t){var e;const n=t[wU],o=kz(null!=n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),i=Tz(t);return $($($({},Mz),o),i)}(e),r=Az(),s=Hz();(function(t,e){e&&e.forEach((e=>{const{name:n,plugin:o,translations:i}=e;try{t.registerFunction(n,o,i)}catch(r){Ub(r.message)}}))})(t,o.functions),function(t,e){if(e){const{langCode:o}=e;try{t.registerLanguage(o,e)}catch(n){Ub(n.message)}}}(t,o.language);const l=t.buildEmpty(i);return r.set(l,[n]),s.set(l,[n.guid]),function(t,e){e&&(t.suspendEvaluation(),e.forEach((e=>{const{name:n,expression:o,scope:i,options:r}=e;try{t.addNamedExpression(n,o,i,r)}catch(s){Ub(s.message)}})),t.resumeEvaluation())}(l,o.namedExpressions),l.on("sheetAdded",(()=>{l.rebuildAndRecalculate()})),l.on("sheetRemoved",(()=>{l.rebuildAndRecalculate()})),l}(null!==(i=o.hyperformula)&&void 0!==i?i:o,e,t);if("object"==typeof o&&Zf(o.hyperformula)){const e=Az(),n=Hz().get(o);return e.has(o)||e.set(o,[]),e.get(o).push(t),n&&n.push(t.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:Ez}),o.getConfig().leapYear1900===Mz.leapYear1900&&!1!==yw(o.getConfig().nullDate,Mz.nullDate)||Ub(Kf(H||(H=j`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`))),o}return null}function Oz(t){var e;const n=Az(),o=0===n.size?[]:Array.from(null!==(e=n.get(t))&&void 0!==e?e:[]);return new Map(o.map((t=>[t.getPlugin("formulas").sheetId,t])))}function _z(t,e){if(t){const n=Az(),o=n.get(t),i=Hz(),r=i.get(t);o&&o.includes(e)&&(o.splice(o.indexOf(e),1),0===o.length&&n.delete(t)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),0===r.length&&(i.delete(t),t.destroy()))}}const Pz="DD/MM/YYYY";function Nz(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function Dz(t,e){return"string"==typeof t&&"date"===e}function Lz(t,e){return kc(t,e,!0).isValid()}function Vz(t,e){return kc(t,e,!0).format(Pz)}function Fz(t,e){return kc(new Date(Date.UTC(0,0,t+-1))).format(e)}function Wz(t,e,n){const o=function(t,e){const n=[];return t.forEach((t=>{const o={from:t,to:e};n.forEach((t=>{const e=t.from>t.to,n=t.to<=o.from;t.from>o.from&&n&&e&&(o.from+=1)})),o.from>=e&&(e+=1),n.push(o)})),n}(t,function(t,e,n){const o=Array.from(Array(n).keys()).filter((e=>!1===t.includes(e)));var i;return 0===e?null!==(i=o[e])&&void 0!==i?i:0:o[e-1]+1}(t,e,n));return function(t){return t.forEach(((e,n)=>{t.slice(n+1).forEach((t=>{const n=t.from<t.to;t.from>e.from&&n&&(t.from-=1)}))})),t}(o)}function Bz(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function jz(t,e){return t.get(Uz(t,e))}function zz(t,e,n){return t.set(Uz(t,e),n),n}function Uz(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yz=new WeakMap,$z=new WeakMap,Gz=new WeakMap,Kz=new WeakMap,Xz=new WeakMap,qz=new WeakMap,Zz=new WeakMap;const Qz=class{constructor(t,e,n){Bz(this,Yz,void 0),Bz(this,$z,void 0),Bz(this,Gz,void 0),Bz(this,Kz,[]),Bz(this,Xz,[]),Bz(this,qz,void 0),Bz(this,Zz,[]),zz(Yz,this,t),zz($z,this,e),zz(Gz,this,n)}setRemovedHfIndexes(t){return zz(Zz,this,t.map((t=>{const e=jz($z,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)}))),jz(Zz,this)}getRemovedHfIndexes(){return jz(Zz,this)}getHfIndexFromVisualIndex(t){const e=jz($z,this).getIndexesSequence(),n=jz($z,this).getNotTrimmedIndexes();return e.indexOf(n[t])}syncMoves(t){const e=`move${up(jz(Yz,this))}s`;jz(Gz,this).getEngine().batch((()=>{t.forEach((t=>{const n=t.from!==t.to,o=t.from+1!==t.to;n&&o&&jz(Gz,this).getEngine()[e](jz(Gz,this).getSheetId(),t.from,1,t.to)}))}))}storeMovesInformation(t,e,n){!1!==n&&(zz(Xz,this,t.map((t=>this.getHfIndexFromVisualIndex(t)))),zz(qz,this,this.getHfIndexFromVisualIndex(e)))}calculateAndSyncMoves(t,e){if(jz(Gz,this).isPerformingUndoRedo())return;if(!1===t||!1===e)return;const n=Wz(jz(Xz,this),jz(qz,this),jz($z,this).getNumberOfIndexes());null===jz(Gz,this).getSheetId()?jz(Gz,this).getPostponeAction((()=>this.syncMoves(n))):this.syncMoves(n)}getIndexesChangeSyncMethod(){const t=`set${up(jz(Yz,this))}Order`;return e=>{if(jz(Gz,this).isPerformingUndoRedo())return;const n=jz($z,this).getIndexesSequence();if("update"===e&&n.length>0){const e=jz(Kz,this).map((t=>n.indexOf(t))),o=jz(Gz,this).getEngine().getSheetDimensions(jz(Gz,this).getSheetId());let i;i="row"===jz(Yz,this)?o.height:o.width;for(let t=e.length;t<i;t+=1)e.push(t);jz(Gz,this).getEngine()[t](jz(Gz,this).getSheetId(),e)}zz(Kz,this,n)}}init(){zz(Kz,this,jz($z,this).getIndexesSequence())}};function Jz(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function tU(t,e){return t.get(nU(t,e))}function eU(t,e,n){return t.set(nU(t,e),n),n}function nU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oU=new WeakMap,iU=new WeakMap,rU=new WeakMap,sU=new WeakMap,lU=new WeakMap,aU=new WeakMap,hU=new WeakMap;const cU=class{constructor(t,e,n){Jz(this,oU,void 0),Jz(this,iU,void 0),Jz(this,rU,void 0),Jz(this,sU,!1),Jz(this,lU,!1),Jz(this,aU,null),Jz(this,hU,null),eU(oU,this,new Qz("row",t,this)),eU(iU,this,new Qz("column",e,this)),eU(rU,this,n)}getForAxis(t){return tU("row"===t?oU:iU,this)}setPerformUndo(t){eU(sU,this,t)}setPerformRedo(t){eU(lU,this,t)}isPerformingUndoRedo(){return tU(sU,this)||tU(lU,this)}getSheetId(){return tU(hU,this)}getEngine(){return tU(aU,this)}getPostponeAction(){return tU(rU,this)}setupSyncEndpoint(t,e){eU(aU,this,t),eU(hU,this,e),tU(oU,this).init(),tU(iU,this).init()}};function uU(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dU(t,e,n){gU(t,e),e.set(t,n)}function gU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fU(t,e,n){return t.set(mU(t,e),n),n}function pU(t,e){return t.get(mU(t,e))}function mU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wU="formulas",bU=["maxRows","maxColumns","language"];tv.getSingleton().register("afterNamedExpressionAdded"),tv.getSingleton().register("afterNamedExpressionRemoved"),tv.getSingleton().register("afterSheetAdded"),tv.getSingleton().register("afterSheetRemoved"),tv.getSingleton().register("afterSheetRenamed"),tv.getSingleton().register("afterFormulasValuesUpdate");const vU=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var yU=new WeakMap,CU=new WeakMap,SU=new WeakMap,RU=new WeakSet;class xU extends P_{constructor(){var t,e,n;super(...arguments),t=this,gU(e=this,n=RU),n.add(e),dU(this,yU,!1),dU(this,CU,!1),dU(this,SU,[["valuesUpdated",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return mU(RU,t,zU).call(t,...n)}],["namedExpressionAdded",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return mU(RU,t,UU).call(t,...n)}],["namedExpressionRemoved",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return mU(RU,t,YU).call(t,...n)}],["sheetAdded",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return mU(RU,t,$U).call(t,...n)}],["sheetRenamed",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return mU(RU,t,GU).call(t,...n)}],["sheetRemoved",function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return mU(RU,t,KU).call(t,...n)}]]),uU(this,"staticRegister",nv("formulas")),uU(this,"engine",null),uU(this,"sheetName",null),uU(this,"indexSyncer",null),uU(this,"rowAxisSyncer",null),uU(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return wU}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[wU,...bU]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[wU]}enablePlugin(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=Iz(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,TU).call(e,...n)})),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,AU).call(e,...n)})),this.addHook("beforeUpdateData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,TU).call(e,...n)})),this.addHook("afterUpdateData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,AU).call(e,...n)})),this.addHook("modifyData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,HU).call(e,...n)})),this.addHook("modifySourceData",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,IU).call(e,...n)})),this.addHook("beforeValidate",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,EU).call(e,...n)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,_U).call(e,...n)})),this.addHook("afterSetDataAtCell",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,OU).call(e,...n)})),this.addHook("afterSetDataAtRowProp",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,OU).call(e,...n)})),this.addHook("beforeCreateRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,PU).call(e,...n)})),this.addHook("beforeCreateCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,NU).call(e,...n)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,VU).call(e,...n)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,FU).call(e,...n)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,DU).call(e,...n)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,LU).call(e,...n)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,WU).call(e,...n)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,BU).call(e,...n)})),this.indexSyncer=new cU(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(t=>{this.hot.addHookOnce("init",(()=>{t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((t,e,n,o)=>{this.rowAxisSyncer.storeMovesInformation(t,e,o)})),this.hot.addHook("beforeColumnMove",((t,e,n,o)=>{this.columnAxisSyncer.storeMovesInformation(t,e,o)})),this.hot.addHook("afterRowMove",((t,e,n,o,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("afterColumnMove",((t,e,n,o,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("beforeColumnFreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)})),this.hot.addHook("afterColumnFreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.hot.addHook("beforeColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)})),this.hot.addHook("afterColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.addHook("afterCellMetaReset",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,kU).call(e,...n)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,jU).call(e,...n)})),this.addHook("beforeAutofill",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return mU(RU,e,MU).call(e,...n)})),pU(SU,this).forEach((t=>{let[e,n]=t;return this.engine.on(e,n)})),super.enablePlugin()}else Ub("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){pU(SU,this).forEach((t=>{let[e,n]=t;return this.engine.off(e,n)})),_z(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){const e=function(t){var e;const n=t[wU],o=kz(null!=n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),i=Tz(t);return $($({},o),i)}(this.hot.getSettings());(function(t,e){return Object.keys(e).some((n=>void 0!==e[n]&&e[n]!==t[n]))})(this.engine.getConfig(),e)&&this.engine.updateConfig(e);const n=this.hot.getSettings()[wU];if(qf(n)&&qf(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!t.data&&null===this.sheetName){const t=this.hot.getSettings()[wU].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){pU(SU,this).forEach((t=>{var e;let[n,o]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(n,o)})),fU(SU,this,null),_z(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if(qf(e)&&!ME(e))return Ub("The provided data should be an array of arrays."),!1;if(null!=t&&this.engine.doesSheetExist(t))return Ub("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(null!=t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(n),e),n}catch(n){return Ub(n.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t))return void Yb(`The sheet named \`${t}\` does not exist, switch aborted.`);this.sheetName=t;const e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${up(wU)}.switchSheet`)}getCellType(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(t),i=this.hot.toPhysicalColumn(e);return null!==o&&null!==i?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Set;t.forEach((t=>{var e;const o=null==t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==o&&(n.has(o)||n.add(o))})),Oz(this.engine).forEach(((t,o)=>{var i;(e||o!==this.sheetId)&&n.has(o)&&(t.render(),null===(i=t.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(t){const e=t=>{var e;const{row:n,col:o,sheet:i}=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:{};return qf(i)?`${i}:${n}x${o}`:""},n=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((t=>e(t))));t.forEach((t=>{var o,i;const{row:r,col:s}=null!==(o=t.address)&&void 0!==o?o:{};if(!1===qf(r)||!1===qf(s)||r>=this.hot.countRows()||s>=this.hot.countCols())return;const l=null==t||null===(i=t.address)||void 0===i?void 0:i.sheet,a=e(t);if(void 0!==l&&!n.has(a)){const t=Oz(this.engine).get(l);if(!t)return;t.validateCell(t.getDataAtCell(r,s),t.getCellMeta(r,s),(()=>{}))}}))}syncChangeWithEngine(t,e,n){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o))return void Ub(`Not possible to set cell data at ${JSON.stringify(o)}`);const i=this.hot.getCellMeta(t,e);var r;return Dz(n,i.type)&&(Lz(n,i.dateFormat)?n=Vz(n,i.dateFormat):!1===("string"==typeof(r=n)&&r.startsWith("="))&&(n=`'${n}`)),this.engine.setCellContents(o,n)}}function EU(t,e,n){const o=this.hot.propToCol(n);if(this.isFormulaCellType(e,o)){const t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},n=this.hot.getCellMeta(e,o);let i=this.engine.getCellValue(t);return"date"===n.type&&Ty(i)&&(i=Fz(i,n.dateFormat)),"object"==typeof i&&null!==i?i.value:i}return t}function MU(t,e,n){const{row:o,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),{row:l,col:a}=n.getTopStartCorner(),{row:h,col:c}=n.getBottomEndCorner(),u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const g=this.engine.getFillRangeData(u,d),{row:f,col:p}=u.start,{row:m,col:w}=u.end,b=m-f+1,v=w-p+1;for(let S=0;S<g.length;S+=1)for(let t=0;t<g[S].length;t+=1){const e=g[S][t],n=f+S%b,o=p+t%v,i=this.hot.getCellMeta(n,o);Dz(e,i.type)&&(e.startsWith("'")?g[S][t]=e.slice(1):!1===this.isFormulaCellType(n,o,this.sheetId)&&(g[S][t]=(y=e,C=i.dateFormat,kc(y,Pz,!0).format(C))))}var y,C;return g}function TU(t,e){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(up(wU))||fU(CU,this,Zf(this.hot.getSettings().data))}function kU(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach(((n,o)=>{n.forEach(((n,i)=>{const r=this.hot.getCellMeta(o,i),s=r.dateFormat;Dz(n,r.type)&&(e=!0,Lz(n,s)?t[o][i]=Vz(n,s):!1===this.isFormulaCellType(o,i)&&(t[o][i]=`'${n}`))}))})),!0===e&&(fU(yU,this,!0),this.engine.setSheetContent(this.sheetId,t),fU(yU,this,!1))}function AU(t,e){var n,o;if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(up(wU)))if(this.sheetName=(n=this.engine,!Zf(o=this.hot.getSettings()[wU].sheetName)&&n.doesSheetExist(o)||(o=n.addSheet(o)),o),pU(CU,this))this.switchSheet(this.sheetName);else{const t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){fU(yU,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),fU(yU,this,!1)}}}function HU(t,e,n,o){if("get"!==o||pU(yU,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(null===i||null===e)return;if(!this.isFormulaCellType(i,e)){if("ARRAY"!==this.getCellType(i,e))return void(Nz(n.value)&&(n.value=Nz(r=n.value)?r.substr(1):r))}var r;const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(s),a=this.hot.getCellsMeta().find((t=>t.visualRow===i&&t.visualCol===e));void 0===a&&(a={}),"date"===a.type&&Ty(l)&&(l=Fz(l,a.dateFormat));const h="object"==typeof l&&null!==l?l.value:l;n.value=h}function IU(t,e,n,o){if("get"!==o||pU(yU,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),r=this.hot.propToCol(e);if(null===i||null===r)return;if(!this.isFormulaCellType(i,r)){if("ARRAY"!==this.getCellType(i,r))return}const s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===s.width&&0===s.height)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function OU(t,e){if(vU(e))return;const n=[],o=[],i=this.engine.batch((()=>{t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i),l=this.hot.toPhysicalRow(e),a=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(e,s,r):n.push([e,s,r]),o.push({address:h})}))}));n.length&&this.hot.addHookOnce("afterChange",(()=>{const t=this.engine.batch((()=>{n.forEach((t=>{let[e,n,o]=t;this.syncChangeWithEngine(e,n,o)}))}));this.renderDependentSheets(t,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,o)}function _U(t,e){if(vU(e))return;const n=[],o=[];t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i);if(!Ty(s))return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(l)?(o.push({address:l}),n.push(...this.engine.setCellContents(l,r))):Ub(`Not possible to set source cell data at ${JSON.stringify(l)}`)})),this.renderDependentSheets(n),this.validateDependentCells(n,o)}function PU(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function NU(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function DU(t,e,n){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(n).every((t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1])))&&void 0}function LU(t,e,n){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(n).every((t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1])))&&void 0}function VU(t,e,n){if(vU(n))return;const o=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(o)}function FU(t,e,n){if(vU(n))return;const o=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(o)}function WU(t,e,n,o){if(vU(o))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort(((t,e)=>e-t)),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeRows(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function BU(t,e,n,o){if(vU(o))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort(((t,e)=>e-t)),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeColumns(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function jU(t,e,n){var o;fU(yU,this,!0);const i=this.hot.getSourceDataArray(n,0,n+((null===(o=e.__children)||void 0===o?void 0:o.length)||0),this.hot.countSourceCols());fU(yU,this,!1),i.forEach(((t,e)=>{t.forEach(((t,o)=>{this.engine.setCellContents({col:o,row:n+e,sheet:this.sheetId},[[t]])}))}))}function zU(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function UU(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function YU(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function $U(t){this.hot.runHooks("afterSheetAdded",t)}function GU(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function KU(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function XU(t,e,n){qU(t,e),e.set(t,n)}function qU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZU(t,e){return t.get(JU(t,e))}function QU(t,e,n){return t.set(JU(t,e),n),n}function JU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("beforeHideColumns"),tv.getSingleton().register("afterHideColumns"),tv.getSingleton().register("beforeUnhideColumns"),tv.getSingleton().register("afterUnhideColumns");const tY="hiddenColumns";var eY=new WeakMap,nY=new WeakMap,oY=new WeakSet;class iY extends P_{constructor(){var t,e;super(...arguments),qU(t=this,e=oY),e.add(t),XU(this,eY,{}),XU(this,nY,null)}static get PLUGIN_KEY(){return tY}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[tY]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[tY];Cw(e)&&(QU(eY,this,e),Zf(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),QU(nY,this,new DE),ZU(nY,this).addLocalHook("init",(()=>JU(oY,this,cY).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,ZU(nY,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return JU(oY,t,hY).call(t,...n)})),this.addHook("afterGetCellMeta",((t,e,n)=>JU(oY,this,sY).call(this,t,e,n))),this.addHook("modifyColWidth",((t,e)=>JU(oY,this,rY).call(this,t,e)),2),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return JU(oY,t,aY).call(t,...n)})),this.addHook("modifyCopyableRange",(t=>JU(oY,this,lY).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),QU(eY,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){const e=this.getHiddenColumns(),n=this.isValidConfig(t);let o=e;const i=ZU(nY,this).getValues().slice(),r=t.length>0;if(n&&r){jf(t.map((t=>this.hot.toPhysicalColumn(t))),(t=>{i[t]=!1})),o=Ff(i,((t,e,n)=>(e&&t.push(this.hot.toVisualColumn(n)),t)),[])}!1!==this.hot.runHooks("beforeUnhideColumns",e,o,n&&r)&&(n&&r&&ZU(nY,this).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,o,n&&r,n&&o.length<e.length))}showColumn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}hideColumns(t){const e=this.getHiddenColumns(),n=this.isValidConfig(t);let o=e;n&&(o=Array.from(new Set(e.concat(t))));!1!==this.hot.runHooks("beforeHideColumns",e,o,n)&&(n&&this.hot.batchExecution((()=>{jf(t,(t=>{ZU(nY,this).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",e,o,n,n&&o.length>e.length))}hideColumn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}getHiddenColumns(){return Bf(ZU(nY,this).getHiddenIndexes(),(t=>this.hot.toVisualColumn(t)))}isHidden(t){return ZU(nY,this).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){const e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){jf(this.hot.getCellsMeta(),(t=>{t&&(t.skipColumnOnPaste=!1)}))}destroy(){QU(eY,this,null),QU(nY,this,null),super.destroy()}}function rY(t,e){return this.isHidden(e)?0:ZU(eY,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"==typeof t&&this.hot.hasColHeaders()?t+15:void 0}function sY(t,e,n){if(!1===ZU(eY,this).copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){const t=n.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),n.className=t.join(" ")}}}function lY(t){if(ZU(eY,this).copyPasteEnabled)return t;const e=[],n=(t,n,o,i)=>{e.push({startRow:t,endRow:n,startCol:o,endCol:i})};return jf(t,(t=>{let e=!0,o=0;Ay(t.startCol,t.endCol,(i=>{this.isHidden(i)?(e||n(t.startRow,t.endRow,o,i-1),e=!0):(e&&(o=i),i===t.endCol&&n(t.startRow,t.endRow,o,i),e=!1)}))})),e}function aY(t,e){if(!ZU(eY,this).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Bp(e,n)}function hY(t){var e;t.items.push({name:WD},(e=this,{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[,n,,o]=t;n-o!=0&&(e=1)}return this.getTranslatedPhrase(lT,e)},callback(){const{from:t,to:n}=this.getSelectedRangeLast(),o=Math.max(Math.min(t.col,n.col),0),i=Math.max(t.col,n.col),r=[];for(let e=o;e<=i;e+=1)r.push(e);e.hideColumns(r);const s=r[r.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(t){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(aT,t)},callback(){var n,o;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,r=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==o?o:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),r-i+1===this.countCols()||this.selectColumns(i,r)},disabled:!1,hidden(){const n=Bf(t.getHiddenColumns(),(t=>this.toPhysicalColumn(t)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;e.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,r=o.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(i),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){if(r-i+1>a-l+1){const t=h.slice(i,r+1);c.push(...t.filter((t=>n.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countCols()));else{const t=this.countCols()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1))&&t>r&&c.push(...h.slice(r+1))}return jf(c,(t=>{e.push(this.toVisualColumn(t))})),0===e.length}}}(this))}function cY(){Array.isArray(ZU(eY,this).columns)&&this.hideColumns(ZU(eY,this).columns)}function uY(t,e,n){dY(t,e),e.set(t,n)}function dY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gY(t,e){return t.get(pY(t,e))}function fY(t,e,n){return t.set(pY(t,e),n),n}function pY(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("beforeHideRows"),tv.getSingleton().register("afterHideRows"),tv.getSingleton().register("beforeUnhideRows"),tv.getSingleton().register("afterUnhideRows");const mY="hiddenRows";var wY=new WeakMap,bY=new WeakMap,vY=new WeakSet;class yY extends P_{constructor(){var t,e;super(...arguments),dY(t=this,e=vY),e.add(t),uY(this,wY,{}),uY(this,bY,null)}static get PLUGIN_KEY(){return mY}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[mY]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[mY];Cw(e)&&(fY(wY,this,e),Zf(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),fY(bY,this,new DE),gY(bY,this).addLocalHook("init",(()=>pY(vY,this,MY).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,gY(bY,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return pY(vY,t,EY).call(t,...n)})),this.addHook("afterGetCellMeta",((t,e,n)=>pY(vY,this,SY).call(this,t,e,n))),this.addHook("modifyRowHeight",((t,e)=>pY(vY,this,CY).call(this,t,e))),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return pY(vY,t,xY).call(t,...n)})),this.addHook("modifyCopyableRange",(t=>pY(vY,this,RY).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),fY(wY,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){const e=this.getHiddenRows(),n=this.isValidConfig(t);let o=e;const i=gY(bY,this).getValues().slice(),r=t.length>0;if(n&&r){jf(t.map((t=>this.hot.toPhysicalRow(t))),(t=>{i[t]=!1})),o=Ff(i,((t,e,n)=>(e&&t.push(this.hot.toVisualRow(n)),t)),[])}!1!==this.hot.runHooks("beforeUnhideRows",e,o,n&&r)&&(n&&r&&gY(bY,this).setValues(i),this.hot.runHooks("afterUnhideRows",e,o,n&&r,n&&o.length<e.length))}showRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}hideRows(t){const e=this.getHiddenRows(),n=this.isValidConfig(t);let o=e;n&&(o=Array.from(new Set(e.concat(t))));!1!==this.hot.runHooks("beforeHideRows",e,o,n)&&(n&&this.hot.batchExecution((()=>{jf(t,(t=>{gY(bY,this).setValueAtIndex(this.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",e,o,n,n&&o.length>e.length))}hideRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}getHiddenRows(){return Bf(gY(bY,this).getHiddenIndexes(),(t=>this.hot.toVisualRow(t)))}isHidden(t){return gY(bY,this).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){const e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){jf(this.hot.getCellsMeta(),(t=>{t&&(t.skipRowOnPaste=!1)}))}destroy(){fY(wY,this,null),fY(bY,this,null),super.destroy()}}function CY(t,e){return this.isHidden(e)?0:t}function SY(t,e,n){if(!1===gY(wY,this).copyPasteEnabled&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){const t=n.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),n.className=t.join(" ")}}}function RY(t){if(gY(wY,this).copyPasteEnabled)return t;const e=[],n=(t,n,o,i)=>{e.push({startRow:t,endRow:n,startCol:o,endCol:i})};return jf(t,(t=>{let e=!0,o=0;Ay(t.startRow,t.endRow,(i=>{this.isHidden(i)?(e||n(o,i-1,t.startCol,t.endCol),e=!0):(e&&(o=i),i===t.endRow&&n(o,i,t.startCol,t.endCol),e=!1)}))})),e}function xY(t,e){if(!gY(wY,this).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Bp(e,n)}function EY(t){var e;t.items.push({name:WD},(e=this,{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[n,,o]=t;n-o!=0&&(e=1)}return this.getTranslatedPhrase(hT,e)},callback(){const{from:t,to:n}=this.getSelectedRangeLast(),o=Math.max(Math.min(t.row,n.row),0),i=Math.max(t.row,n.row),r=[];for(let e=o;e<=i;e+=1)r.push(e);e.hideRows(r);const s=r[r.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(t){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(cT,t)},callback(){var n,o;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,r=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==o?o:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),r-i+1===this.countRows()||this.selectRows(i,r)},disabled:!1,hidden(){const n=Bf(t.getHiddenRows(),(t=>this.toPhysicalRow(t)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;e.length=0;const o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,r=o.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(i),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){if(r-i+1>a-l+1){const t=h.slice(i,r+1);c.push(...t.filter((t=>n.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countRows()));else{const t=this.countRows()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1))&&t>r&&c.push(...h.slice(r+1))}return jf(c,(t=>{e.push(this.toVisualRow(t))})),0===e.length}}}(this))}function MY(){Array.isArray(gY(wY,this).rows)&&this.hideRows(gY(wY,this).rows)}function TY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kY(t,e){return t.get(HY(t,e))}function AY(t,e,n){return t.set(HY(t,e),n),n}function HY(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("beforeColumnFreeze"),tv.getSingleton().register("afterColumnFreeze"),tv.getSingleton().register("beforeColumnUnfreeze"),tv.getSingleton().register("afterColumnUnfreeze");const IY="manualColumnFreeze";var OY=new WeakMap,_Y=new WeakSet;class PY extends P_{constructor(){var t,e;super(...arguments),TY(t=this,e=_Y),e.add(t),function(t,e,n){TY(t,e),e.set(t,n)}(this,OY,!1)}static get PLUGIN_KEY(){return IY}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[IY]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>HY(_Y,this,NY).call(this,t))),this.addHook("beforeColumnMove",((t,e)=>HY(_Y,this,DY).call(this,t,e))),super.enablePlugin())}disablePlugin(){AY(OY,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){const e=this.hot.getSettings(),n=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;kY(OY,this)||AY(OY,this,!0);!1!==this.hot.runHooks("beforeColumnFreeze",t,n)&&(n&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,n))}unfreezeColumn(t){const e=this.hot.getSettings(),n=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;kY(OY,this)||AY(OY,this,!0);!1!==this.hot.runHooks("beforeColumnUnfreeze",t,n)&&(n&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,n))}}function NY(t){var e;t.items.push({name:"---------"},(e=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(LM)},callback(t,n){const[{start:{col:o}}]=n;e.freezeColumn(o),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}),function(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(VM)},callback(e,n){const[{start:{col:o}}]=n;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}(this))}function DY(t,e){if(kY(OY,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n)return!1;if(t.some((t=>t<n)))return!1}}function LY(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const VY="px";const FY=class{constructor(t){LY(this,"hot",void 0),LY(this,"_element",null),LY(this,"state",0),LY(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){Ty(t)&&(this._element.style.top=t+VY),Ty(e)&&(this._element.style[this.inlineProperty]=e+VY)}getPosition(){const t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){Ty(t)&&(this._element.style.width=t+VY),Ty(e)&&(this._element.style.height=e+VY)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){Ty(t)&&(this._element.style.marginTop=t+VY),Ty(e)&&(this._element.style[`margin${up(this.inlineProperty)}`]=e+VY)}getOffset(){const t=this._element.style,e=`margin${up(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}};const WY=class extends FY{build(){super.build(),Bp(this._element,"ht__manualColumnMove--backlight")}};const BY=class extends FY{build(){super.build(),Bp(this._element,"ht__manualColumnMove--guideline")}};function jY(t,e,n){zY(t,e),e.set(t,n)}function zY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UY(t,e,n){return t.set($Y(t,e),n),n}function YY(t,e){return t.get($Y(t,e))}function $Y(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("beforeColumnMove"),tv.getSingleton().register("afterColumnMove");const GY="manualColumnMove",KY="ht__manualColumnMove",XY="show-ui",qY="on-moving--columns",ZY="after-selection--columns";var QY=new WeakMap,JY=new WeakMap,t$=new WeakMap,e$=new WeakMap,n$=new WeakMap,o$=new WeakMap,i$=new WeakMap,r$=new WeakMap,s$=new WeakMap,l$=new WeakMap,a$=new WeakMap,h$=new WeakSet;class c$ extends P_{constructor(){var t,e;super(...arguments),zY(t=this,e=h$),e.add(t),jY(this,QY,new WY(this.hot)),jY(this,JY,new BY(this.hot)),jY(this,t$,[]),jY(this,e$,0),jY(this,n$,!1),jY(this,o$,{}),jY(this,i$,void 0),jY(this,r$,void 0),jY(this,s$,void 0),jY(this,l$,void 0),jY(this,a$,void 0)}static get PLUGIN_KEY(){return GY}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[GY]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $Y(h$,t,u$).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $Y(h$,t,g$).call(t,...n)})),this.addHook("afterScrollVertically",(()=>$Y(h$,this,p$).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $Y(h$,t,m$).call(t,...n)})),this.buildPluginUI(),this.registerEvents(),Bp(this.hot.rootElement,KY),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){jp(this.hot.rootElement,KY),this.unregisterEvents(),YY(QY,this).destroy(),YY(JY,this).destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){const n=YY(i$,this),o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeColumnMove",t,e,n,o);if(UY(i$,this,void 0),!1===i)return;o&&this.hot.columnIndexMapper.moveIndexes(t,e);const r=o&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,n,o,r),r}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){const n=this.countFinalIndex(t,e);return UY(i$,this,e),this.moveColumns(t,n)}isMovePossible(t,e){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=t.length+e>n,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=n));return!(o||i||r||s)}isColumnOrderChanged(t,e){return t.some(((t,n)=>t-n!==e))}countFinalIndex(t,e){const n=Ff(t,((t,n)=>(n<e&&(t+=1),t)),0);return e-n}getColumnsWidth(t,e){const n=this.hot.columnIndexMapper;let o=0;for(let i=t;i<=e;i+=1){const t=n.getRenderableFromVisualIndex(i);i<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return o}moveBySettingsOrLoad(){const t=this.hot.getSettings()[GY];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){const n=[];return Ay(t,e,(t=>{n.push(t)})),n}refreshPositions(){const t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(YY(r$,this))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});const e=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,o="number"==typeof n.scrollX?n.scrollX:n.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,YY(r$,this)-1);const r=e.hider.offsetWidth,s=e.TBODY.offsetLeft,l=YY(QY,this).getOffset().start,a=YY(QY,this).getSize().width;let h=0,c=0;if(this.hot.isRtl()){const t=this.hot.rootWindow,e=am(this.hot.rootElement),i=t.innerWidth-YY(s$,this)-e;c=t.innerWidth-YY(o$,this).eventPageX-i-(void 0===n.scrollX?o:0)}else c=YY(o$,this).eventPageX-(YY(s$,this)-(void 0===n.scrollX?o:0));if(YY(l$,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(YY(r$,this))&&(i+=o),i+=h,YY(r$,this)<0)YY(a$,this)>0?YY(o$,this).col=0:YY(o$,this).col=t>0?t-1:t;else if(YY(o$,this).TD.offsetWidth/2+i<=c){const t=YY(r$,this)>=YY(e$,this)?YY(e$,this)-1:YY(r$,this);YY(o$,this).col=t+1,i+=YY(o$,this).TD.offsetWidth}else YY(o$,this).col=YY(r$,this);let u=c,d=i;c+a+l>=r?u=r-a-l:c+l<s+h&&(u=s+h+Math.abs(l)),i>=r-1?d=r-1:0===d?d=1:void 0!==n.scrollX&&YY(r$,this)<YY(a$,this)&&(d-=YY(s$,this)<=n.scrollX?YY(s$,this):0),YY(QY,this).setPosition(null,u),YY(JY,this).setPosition(null,d)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>$Y(h$,this,d$).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>$Y(h$,this,f$).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){YY(QY,this).build(),YY(JY,this).build()}destroy(){YY(QY,this).destroy(),YY(JY,this).destroy(),super.destroy()}}function u$(t,e,n,o){const i=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),l=Wp(t.target,"sortAction");if(!s||!r||YY(n$,this)||0!==t.button||l)return UY(n$,this,!1),YY(t$,this).length=0,void jp(this.hot.rootElement,[qY,XY]);const a=YY(JY,this).isBuilt()&&!YY(JY,this).isAppended(),h=YY(QY,this).isBuilt()&&!YY(QY,this).isAppended();a&&h&&(YY(JY,this).appendTo(i.hider),YY(QY,this).appendTo(i.hider));const{from:c,to:u}=s,d=Math.min(c.col,u.col),g=Math.max(c.col,u.col);if(e.row<0&&e.col>=d&&e.col<=g){o.column=!0,UY(n$,this,!0);const r=n.firstChild?db(t,n.firstChild).x:t.offsetX;YY(o$,this).eventPageX=t.pageX,UY(r$,this,e.col),YY(o$,this).TD=n,YY(o$,this).col=e.col,UY(t$,this,this.prepareColumnsToMoving(d,g)),UY(l$,this,!!this.hot.getSettings().rowHeaders),UY(e$,this,this.hot.countCols()),UY(a$,this,this.hot.getSettings().fixedColumnsStart),UY(s$,this,Zp(this.hot.rootElement).left);const s=YY(l$,this)?-1:0,l=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,a=e.col<YY(a$,this),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),c=Math.abs(r-(this.hot.isRtl()?n.offsetWidth:0)),u=this.getColumnsWidth(d,e.col-1)+c,f=this.getColumnsWidth(s,d-1)+(a?h:0)+u;YY(QY,this).setPosition(l,f),YY(QY,this).setSize(this.getColumnsWidth(d,g),i.hider.offsetHeight-l),YY(QY,this).setOffset(null,-u),Bp(this.hot.rootElement,qY)}else jp(this.hot.rootElement,ZY),UY(n$,this,!1),YY(t$,this).length=0}function d$(t){YY(n$,this)&&(YY(o$,this).eventPageX=t.pageX,this.refreshPositions())}function g$(t,e,n,o){this.hot.getSelectedRangeLast()&&YY(n$,this)&&(YY(t$,this).indexOf(e.col)>-1?jp(this.hot.rootElement,XY):Bp(this.hot.rootElement,XY),o.row=!0,o.column=!0,o.cell=!0,UY(r$,this,e.col),YY(o$,this).TD=n)}function f$(){const t=YY(o$,this).col,e=YY(t$,this).length;if(UY(r$,this,void 0),UY(n$,this,!1),jp(this.hot.rootElement,[qY,XY,ZY]),this.hot.selection.isSelectedByColumnHeader()&&Bp(this.hot.rootElement,ZY),e<1||void 0===t)return;const n=YY(t$,this)[0],o=this.hot.toPhysicalColumn(n),i=this.dragColumns(YY(t$,this),t);if(YY(t$,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const t=this.hot.toVisualColumn(o),n=t+e-1;this.hot.selectColumns(t,n)}}function p$(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;YY(QY,this).setPosition(e),YY(QY,this).setSize(null,t.hider.offsetHeight-e)}function m$(){this.moveBySettingsOrLoad()}function w$(t,e,n){b$(t,e),e.set(t,n)}function b$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v$(t,e,n){return t.set(C$(t,e),n),n}function y$(t,e){return t.get(C$(t,e))}function C$(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const S$="manualColumnResize",R$="manualColumnWidths";var x$=new WeakMap,E$=new WeakMap,M$=new WeakMap,T$=new WeakMap,k$=new WeakMap,A$=new WeakMap,H$=new WeakMap,I$=new WeakMap,O$=new WeakMap,_$=new WeakMap,P$=new WeakMap,N$=new WeakMap,D$=new WeakMap,L$=new WeakMap,V$=new WeakMap,F$=new WeakMap,W$=new WeakSet;class B$ extends P_{static get PLUGIN_KEY(){return S$}static get PLUGIN_PRIORITY(){return 130}constructor(t){var e,n;super(t),b$(e=this,n=W$),n.add(e),w$(this,x$,null),w$(this,E$,null),w$(this,M$,[]),w$(this,T$,null),w$(this,k$,null),w$(this,A$,null),w$(this,H$,null),w$(this,I$,null),w$(this,O$,this.hot.rootDocument.createElement("DIV")),w$(this,_$,this.hot.rootDocument.createElement("DIV")),w$(this,P$,null),w$(this,N$,!1),w$(this,D$,0),w$(this,L$,null),w$(this,V$,void 0),w$(this,F$,void 0),Bp(y$(O$,this),"manualColumnResizer"),Bp(y$(_$,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[S$]}enablePlugin(){this.enabled||(v$(V$,this,new NE),y$(V$,this).addLocalHook("init",(()=>C$(W$,this,j$).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,y$(V$,this)),this.addHook("modifyColWidth",((t,e)=>C$(W$,this,K$).call(this,t,e)),1),this.addHook("beforeStretchingColumnWidth",((t,e)=>C$(W$,this,X$).call(this,t,e))),this.addHook("beforeColumnResize",((t,e,n)=>C$(W$,this,q$).call(this,t,e,n))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){v$(F$,this,y$(V$,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",R$,y$(V$,this).getValues())}loadManualColumnWidths(){const t={};return this.hot.runHooks("persistentStateLoad",R$,t),t.value}setManualSize(t,e){const n=Math.max(e,20),o=this.hot.toPhysicalColumn(t);return y$(V$,this).setValueAtIndex(o,n),n}clearManualSize(t){const e=this.hot.toPhysicalColumn(t);y$(V$,this).setValueAtIndex(e,null)}setupHandlePosition(t){if(!t.parentNode)return;v$(x$,this,t);const{_wt:e}=this.hot.view,n=e.wtTable.getCoords(y$(x$,this)),o=n.col;if(o<0)return;const i=hm(y$(x$,this)),r=y$(x$,this).getBoundingClientRect();let s;o<e.getSetting("fixedColumnsStart")&&(s=e.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(y$(x$,this),n.row,n.col)),s||(s=e.wtOverlays.topOverlay.getRelativeCellPosition(y$(x$,this),n.row,n.col)),v$(E$,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)),v$(M$,this,[]);const l=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&l){jf(this.hot.getSelectedRange(),(t=>{Ay(t.getTopStartCorner().col,t.getBottomEndCorner().col,(t=>{y$(M$,this).includes(t)||y$(M$,this).push(t)}))}))}y$(M$,this).includes(y$(E$,this))||v$(M$,this,[y$(E$,this)]),v$(I$,this,s.start-6),v$(H$,this,parseInt(r.width,10)),y$(O$,this).style.top=`${s.top}px`,y$(O$,this).style[this.inlineDir]=`${y$(I$,this)+y$(H$,this)}px`,y$(O$,this).style.height=`${i}px`,this.hot.rootElement.appendChild(y$(O$,this))}refreshHandlePosition(){y$(O$,this).style[this.inlineDir]=`${y$(I$,this)+y$(T$,this)}px`}setupGuidePosition(){const t=parseInt(hm(y$(O$,this)),10),e=parseInt(y$(O$,this).style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Bp(y$(O$,this),"active"),Bp(y$(_$,this),"active"),y$(_$,this).style.top=`${e}px`,this.refreshGuidePosition(),y$(_$,this).style.height=n-t+"px",this.hot.rootElement.appendChild(y$(_$,this))}refreshGuidePosition(){y$(_$,this).style[this.inlineDir]=y$(O$,this).style[this.inlineDir]}hideHandleAndGuide(){jp(y$(O$,this),"active"),jp(y$(_$,this),"active")}checkIfColumnHeader(t){const e=_p(t,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,o.clone.wtTable.THEAD].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{const o=this.hot.runHooks("beforeColumnResize",y$(k$,this),e,!0);void 0!==o&&v$(k$,this,o),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,y$(k$,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",y$(k$,this),e,!0),n&&t()};if(y$(D$,this)>=2){y$(M$,this).length>1?(jf(y$(M$,this),(t=>{e(t)})),t()):jf(y$(M$,this),(t=>{e(t,!0)}))}v$(D$,this,0),v$(L$,this,null)}bindEvents(){const{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",(t=>C$(W$,this,z$).call(this,t))),this.eventManager.addEventListener(e,"mousedown",(t=>C$(W$,this,U$).call(this,t))),this.eventManager.addEventListener(t,"mousemove",(t=>C$(W$,this,Y$).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>C$(W$,this,$$).call(this))),this.eventManager.addEventListener(y$(O$,this),"contextmenu",(()=>C$(W$,this,G$).call(this)))}destroy(){super.destroy()}}function j$(){const t=this.hot.getSettings()[S$],e=this.loadManualColumnWidths();void 0!==e?this.hot.batchExecution((()=>{e.forEach(((t,e)=>{y$(V$,this).setValueAtIndex(e,t)}))}),!0):Array.isArray(t)?(this.hot.batchExecution((()=>{t.forEach(((t,e)=>{y$(V$,this).setValueAtIndex(e,t)}))}),!0),v$(F$,this,t)):!0===t&&Array.isArray(y$(F$,this))&&this.hot.batchExecution((()=>{y$(F$,this).forEach(((t,e)=>{y$(V$,this).setValueAtIndex(e,t)}))}),!0)}function z$(t){if(!xm(t.target)&&!0!==y$(N$,this)&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");!e||null!==n&&"1"!==n||y$(P$,this)||this.setupHandlePosition(e)}}function U$(t){t.target.parentNode===this.hot.rootElement&&Wp(t.target,"manualColumnResizer")&&(this.setupHandlePosition(y$(x$,this)),this.setupGuidePosition(),v$(P$,this,!0),null===y$(L$,this)&&(v$(L$,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(y$(L$,this))),v$(D$,this,y$(D$,this)+1),this.startX=t.pageX,v$(k$,this,y$(H$,this)))}function Y$(t){if(y$(P$,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();v$(T$,this,y$(H$,this)+e),jf(y$(M$,this),(t=>{v$(k$,this,this.setManualSize(t,y$(T$,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function $$(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{this.hot.runHooks("beforeColumnResize",y$(k$,this),e,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",y$(k$,this),e,!1)};if(y$(P$,this)){if(this.hideHandleAndGuide(),v$(P$,this,!1),y$(k$,this)!==y$(H$,this)){y$(M$,this).length>1?(jf(y$(M$,this),(t=>{e(t)})),t()):jf(y$(M$,this),(t=>{e(t,!0)}))}this.setupHandlePosition(y$(x$,this))}}function G$(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(y$(O$,this)),this.hot.rootElement.removeChild(y$(_$,this)),v$(P$,this,!1),v$(N$,this,!0),this.hot._registerImmediate((()=>{v$(N$,this,!1)}))}function K$(t,e){let n=t;if(this.enabled){const t=this.hot.toPhysicalColumn(e),o=y$(V$,this).getValueAtIndex(t);this.hot.getSettings()[S$]&&o&&(n=o)}return n}function X$(t,e){let n=y$(V$,this).getValueAtIndex(e);return null===n&&(n=t),n}function q$(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Z$(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Q$="px";const J$=class{constructor(t){Z$(this,"hot",void 0),Z$(this,"_element",null),Z$(this,"state",0),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){void 0!==t&&(this._element.style.top=t+Q$),void 0!==e&&(this._element.style.left=e+Q$)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+Q$),e&&(this._element.style.height=e+Q$)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+Q$),e&&(this._element.style.marginLeft=e+Q$)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const tG=class extends J${build(){super.build(),Bp(this._element,"ht__manualRowMove--backlight")}};const eG=class extends J${build(){super.build(),Bp(this._element,"ht__manualRowMove--guideline")}};function nG(t,e,n){oG(t,e),e.set(t,n)}function oG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iG(t,e,n){return t.set(sG(t,e),n),n}function rG(t,e){return t.get(sG(t,e))}function sG(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("beforeRowMove"),tv.getSingleton().register("afterRowMove");const lG="manualRowMove",aG="ht__manualRowMove",hG="show-ui",cG="on-moving--rows",uG="after-selection--rows";var dG=new WeakMap,gG=new WeakMap,fG=new WeakMap,pG=new WeakMap,mG=new WeakMap,wG=new WeakMap,bG=new WeakSet;class vG extends P_{constructor(){var t,e;super(...arguments),oG(t=this,e=bG),e.add(t),nG(this,dG,new tG(this.hot)),nG(this,gG,new eG(this.hot)),nG(this,fG,[]),nG(this,pG,void 0),nG(this,mG,{}),nG(this,wG,void 0)}static get PLUGIN_KEY(){return lG}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[lG]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return sG(bG,t,yG).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return sG(bG,t,SG).call(t,...n)})),this.addHook("afterScrollHorizontally",(()=>sG(bG,this,xG).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return sG(bG,t,EG).call(t,...n)})),this.buildPluginUI(),this.registerEvents(),Bp(this.hot.rootElement,aG),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){jp(this.hot.rootElement,aG),this.unregisterEvents(),rG(dG,this).destroy(),rG(gG,this).destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){const n=rG(wG,this),o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeRowMove",t,e,n,o);if(iG(wG,this,void 0),!1===i)return;o&&this.hot.rowIndexMapper.moveIndexes(t,e);const r=o&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,n,o,r),r}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){const n=this.countFinalIndex(t,e);return iG(wG,this,e),this.moveRows(t,n)}isMovePossible(t,e){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=t.length+e>n,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=n));return!(o||i||r||s)}isRowOrderChanged(t,e){return t.some(((t,n)=>t-n!==e))}countFinalIndex(t,e){const n=Ff(t,((t,n)=>(n<e&&(t+=1),t)),0);return e-n}getRowsHeight(t,e){const n=this.hot.rowIndexMapper;let o=0;for(let i=t;i<=e;i++){const t=n.getRenderableFromVisualIndex(i);null!==t&&(o+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return o}moveBySettingsOrLoad(){const t=this.hot.getSettings()[lG];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){const t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;const{from:n,to:o}=t;return Ay(Math.min(n.row,o.row),Math.max(n.row,o.row),(t=>{e.push(t)})),e}refreshPositions(){const t=rG(mG,this).coords,e=this.hot.view.getFirstFullyVisibleRow(),n=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&n<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,r=rG(mG,this).TD,s=this.hot.rootElement,l=Zp(s),a=rm(s),h=i.holder.scrollTop,c=this.hot.rootWindow!==a?a.scrollTop:0,u=l.top-c,d=rG(mG,this).eventPageY-u+h,g=i.hider.offsetHeight,f=i.TBODY.offsetTop,p=rG(dG,this).getOffset().top,m=rG(dG,this).getSize().height,w=r.offsetHeight/2,b=r.offsetHeight;let v=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const y=d>=v+w;this.isFixedRowTop(t.row)&&(v+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?rG(mG,this).row=e>0?e-1:e:y?(rG(mG,this).row=t.row+1,v+=0===t.row?b-1:b):rG(mG,this).row=t.row;let C=d,S=v;d+m+p>=g?C=g-m-p:d+p<f&&(C=f+Math.abs(p)),v>=g-1&&(S=g-1),rG(dG,this).setPosition(C),rG(gG,this).setPosition(S)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>sG(bG,this,CG).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>sG(bG,this,RG).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){rG(dG,this).build(),rG(gG,this).build()}destroy(){rG(dG,this).destroy(),rG(gG,this).destroy(),super.destroy()}}function yG(t,e,n,o){const{wtTable:i,wtViewport:r}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!s||rG(pG,this)||0!==t.button)return iG(pG,this,!1),rG(fG,this).length=0,void jp(this.hot.rootElement,[cG,hG]);const a=rG(gG,this).isBuilt()&&!rG(gG,this).isAppended(),h=rG(dG,this).isBuilt()&&!rG(dG,this).isAppended();a&&h&&(rG(gG,this).appendTo(i.hider),rG(dG,this).appendTo(i.hider));const{from:c,to:u}=l,d=Math.min(c.row,u.row),g=Math.max(c.row,u.row);if(e.col<0&&e.row>=d&&e.row<=g){o.row=!0,iG(pG,this,!0),rG(mG,this).eventPageY=t.pageY,rG(mG,this).coords=e,rG(mG,this).TD=n,iG(fG,this,this.prepareRowsToMoving());const s=i.holder.scrollLeft+r.getRowHeaderWidth(),l=this.getRowsHeight(d,e.row-1)+t.offsetY;rG(dG,this).setPosition(null,s),rG(dG,this).setSize(i.hider.offsetWidth-s,this.getRowsHeight(d,g)),rG(dG,this).setOffset(-l,null),Bp(this.hot.rootElement,cG),this.refreshPositions()}else jp(this.hot.rootElement,uG),iG(pG,this,!1),rG(fG,this).length=0}function CG(t){rG(pG,this)&&(rG(mG,this).eventPageY=t.pageY,this.refreshPositions())}function SG(t,e,n,o){this.hot.getSelectedRangeLast()&&rG(pG,this)&&(rG(fG,this).indexOf(e.row)>-1?jp(this.hot.rootElement,hG):Bp(this.hot.rootElement,hG),o.row=!0,o.column=!0,o.cell=!0,rG(mG,this).coords=e,rG(mG,this).TD=n)}function RG(){const t=rG(mG,this).row,e=rG(fG,this).length;if(iG(pG,this,!1),jp(this.hot.rootElement,[cG,hG,uG]),this.hot.selection.isSelectedByRowHeader()&&Bp(this.hot.rootElement,uG),e<1||void 0===t)return;const n=rG(fG,this)[0],o=this.hot.toPhysicalRow(n),i=this.dragRows(rG(fG,this),t);if(rG(fG,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const t=this.hot.toVisualRow(o),n=t+e-1;this.hot.selectRows(t,n)}}function xG(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;rG(dG,this).setPosition(null,e),rG(dG,this).setSize(t.hider.offsetWidth-e)}function EG(){this.moveBySettingsOrLoad()}function MG(t,e,n){TG(t,e),e.set(t,n)}function TG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kG(t,e,n){return t.set(HG(t,e),n),n}function AG(t,e){return t.get(HG(t,e))}function HG(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IG="manualRowResize",OG="manualRowHeights";var _G=new WeakMap,PG=new WeakMap,NG=new WeakMap,DG=new WeakMap,LG=new WeakMap,VG=new WeakMap,FG=new WeakMap,WG=new WeakMap,BG=new WeakMap,jG=new WeakMap,zG=new WeakMap,UG=new WeakMap,YG=new WeakMap,$G=new WeakMap,GG=new WeakMap,KG=new WeakMap,XG=new WeakSet;class qG extends P_{static get PLUGIN_KEY(){return IG}static get PLUGIN_PRIORITY(){return 30}constructor(t){var e,n;super(t),TG(e=this,n=XG),n.add(e),MG(this,_G,null),MG(this,PG,null),MG(this,NG,[]),MG(this,DG,null),MG(this,LG,null),MG(this,VG,null),MG(this,FG,null),MG(this,WG,null),MG(this,BG,this.hot.rootDocument.createElement("DIV")),MG(this,jG,this.hot.rootDocument.createElement("DIV")),MG(this,zG,!1),MG(this,UG,!1),MG(this,YG,0),MG(this,$G,null),MG(this,GG,void 0),MG(this,KG,void 0),Bp(AG(BG,this),"manualRowResizer"),Bp(AG(jG,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[IG]}enablePlugin(){this.enabled||(kG(GG,this,new NE),AG(GG,this).addLocalHook("init",(()=>HG(XG,this,oK).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,AG(GG,this)),this.addHook("modifyRowHeight",((t,e)=>HG(XG,this,nK).call(this,t,e))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){kG(KG,this,AG(GG,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",OG,AG(GG,this).getValues())}loadManualRowHeights(){const t={};return this.hot.runHooks("persistentStateLoad",OG,t),t.value}setManualSize(t,e){const n=this.hot.toPhysicalRow(t),o=Math.max(e,23);return AG(GG,this).setValueAtIndex(n,o),o}getLastDesiredRowHeight(){return AG(DG,this)}setupHandlePosition(t){kG(_G,this,t);const{view:e}=this.hot,{_wt:n}=e,o=n.wtTable.getCoords(AG(_G,this)),i=o.row;if(i<0)return;const r=am(AG(_G,this)),s=AG(_G,this).getBoundingClientRect(),l=i<n.getSetting("fixedRowsTop"),a=i>=e.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let h;l?h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(AG(_G,this),o.row,o.col):a&&(h=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(AG(_G,this),o.row,o.col)),h||(h=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(AG(_G,this),o.row,o.col)),kG(PG,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),kG(NG,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){jf(this.hot.getSelectedRange(),(t=>{Ay(t.getTopStartCorner().row,t.getBottomStartCorner().row,(t=>{AG(NG,this).includes(t)||AG(NG,this).push(t)}))}))}AG(NG,this).includes(AG(PG,this))||kG(NG,this,[AG(PG,this)]),kG(WG,this,h.top-6),kG(FG,this,parseInt(s.height,10)),AG(BG,this).style.top=`${AG(WG,this)+AG(FG,this)}px`,AG(BG,this).style[this.inlineDir]=`${h.start}px`,AG(BG,this).style.width=`${r}px`,this.hot.rootElement.appendChild(AG(BG,this))}refreshHandlePosition(){AG(BG,this).style.top=`${AG(WG,this)+AG(DG,this)}px`}setupGuidePosition(){const t=parseInt(am(AG(BG,this)),10),e=parseInt(AG(BG,this).style[this.inlineDir],10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Bp(AG(BG,this),"active"),Bp(AG(jG,this),"active"),AG(jG,this).style.top=AG(BG,this).style.top,AG(jG,this).style[this.inlineDir]=`${e}px`,AG(jG,this).style.width=n-t+"px",this.hot.rootElement.appendChild(AG(jG,this))}refreshGuidePosition(){AG(jG,this).style.top=AG(BG,this).style.top}hideHandleAndGuide(){jp(AG(BG,this),"active"),jp(AG(jG,this),"active")}checkIfRowHeader(t){const e=_p(t,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,o.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){const e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&AG(LG,this)<e?e:AG(LG,this)}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==o&&kG(LG,this,o),this.setManualSize(e,AG(LG,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),n&&t()};if(AG(YG,this)>=2){AG(NG,this).length>1?(jf(AG(NG,this),(t=>{e(t)})),t()):jf(AG(NG,this),(t=>{e(t,!0)}))}kG(YG,this,0),kG($G,this,null)}bindEvents(){const{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",(t=>HG(XG,this,ZG).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>HG(XG,this,QG).call(this,t))),this.eventManager.addEventListener(e,"mousemove",(t=>HG(XG,this,JG).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(()=>HG(XG,this,tK).call(this))),this.eventManager.addEventListener(AG(BG,this),"contextmenu",(()=>HG(XG,this,eK).call(this)))}destroy(){super.destroy()}}function ZG(t){if(!xm(t.target)&&!0!==AG(UG,this)&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(AG(zG,this)||this.setupHandlePosition(e))}}function QG(t){Wp(t.target,"manualRowResizer")&&(this.setupHandlePosition(AG(_G,this)),this.setupGuidePosition(),kG(zG,this,!0),null===AG($G,this)&&(kG($G,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(AG($G,this))),kG(YG,this,AG(YG,this)+1),kG(VG,this,t.pageY),kG(LG,this,AG(FG,this)))}function JG(t){AG(zG,this)&&(kG(DG,this,AG(FG,this)+(t.pageY-AG(VG,this))),jf(AG(NG,this),(t=>{kG(LG,this,this.setManualSize(t,AG(DG,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition())}function tK(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};if(AG(zG,this)){if(this.hideHandleAndGuide(),kG(zG,this,!1),AG(LG,this)!==AG(FG,this)){AG(NG,this).length>1?(jf(AG(NG,this),(t=>{e(t)})),t()):jf(AG(NG,this),(t=>{e(t,!0)}))}this.setupHandlePosition(AG(_G,this))}}function eK(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(AG(BG,this)),this.hot.rootElement.removeChild(AG(jG,this)),kG(zG,this,!1),kG(UG,this,!0),this.hot._registerImmediate((()=>{kG(UG,this,!1)}))}function nK(t,e){let n=t;if(this.enabled){const t=this.hot.toPhysicalRow(e),o=AG(GG,this).getValueAtIndex(t);this.hot.getSettings()[IG]&&o&&(n=o)}return n}function oK(){const t=this.hot.getSettings()[IG],e=this.loadManualRowHeights();this.hot.batchExecution((()=>{void 0!==e?e.forEach(((t,e)=>{AG(GG,this).setValueAtIndex(e,t)})):Array.isArray(t)?(t.forEach(((t,e)=>{AG(GG,this).setValueAtIndex(e,t)})),kG(KG,this,t)):!0===t&&Array.isArray(AG(KG,this))&&AG(KG,this).forEach(((t,e)=>{AG(GG,this).setValueAtIndex(e,t)}))}),!0)}function iK(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function rK(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sK(t,e){return t.get(aK(t,e))}function lK(t,e,n){return t.set(aK(t,e),n),n}function aK(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hK=new WeakMap;const cK=class{constructor(t,e,n,o,i,r){rK(this,"row",void 0),rK(this,"col",void 0),rK(this,"rowspan",void 0),rK(this,"colspan",void 0),rK(this,"removed",!1),rK(this,"cellCoordsFactory",void 0),rK(this,"cellRangeFactory",void 0),iK(this,hK,null),this.row=t,this.col=e,this.rowspan=n,this.colspan=o,this.cellCoordsFactory=i,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(t){let{row:e,col:n,rowspan:o,colspan:i}=t;return Kf(I||(I=j`The merged cell declared with {row: ${0}, col: ${0},\x20
      rowspan: ${0}, colspan: ${0}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`),e,n,o,i)}static IS_OUT_OF_BOUNDS_WARNING(t){let{row:e,col:n}=t;return Kf(O||(O=j`The merged cell declared at [${0}, ${0}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`),e,n)}static IS_SINGLE_CELL(t){let{row:e,col:n}=t;return Kf(_||(_=j`The merged cell declared at [${0}, ${0}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`),e,n)}static ZERO_SPAN_WARNING(t){let{row:e,col:n}=t;return Kf(P||(P=j`The merged cell declared at [${0}, ${0}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`),e,n)}static containsNegativeValues(t){let{row:e,col:n,rowspan:o,colspan:i}=t;return e<0||n<0||o<0||i<0}static isSingleCell(t){let{rowspan:e,colspan:n}=t;return 1===n&&1===e}static containsZeroSpan(t){let{rowspan:e,colspan:n}=t;return 0===n||0===e}static isOutOfBounds(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}normalize(t){const e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),lK(hK,this,null)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){const n=t[0]||t[1],o=e+Math.abs(t[0]||t[1])-1,i=t[0]?"colspan":"rowspan",r=t[0]?"col":"row",s=Math.min(e,o),l=Math.max(e,o),a=this[r],h=this[r]+this[i]-1;if(a>=e&&(this[r]+=n),n>0)e<=h&&e>a&&(this[i]+=n);else if(n<0){if(s<=a&&l>=h)return this.removed=!0,lK(hK,this,null),!1;if(a>=s&&a<=l){const t=l-a+1,e=Math.abs(n)-t;this[r]-=e+n,this[i]-=t}else if(a<=s&&h>=l)this[i]+=n;else if(a<=s&&h>=s&&h<l){const t=h-s+1;this[i]-=t}}return lK(hK,this,null),!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return sK(hK,this)||lK(hK,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),sK(hK,this)}};function uK(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function dK(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gK(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fK=new WeakSet;class pK{constructor(t){uK(this,fK),dK(this,"plugin",void 0),dK(this,"mergedCells",[]),dK(this,"mergedCellsMatrix",new Map),dK(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){let{row:e,col:n}=t;return Kf(N||(N=j`The merged cell declared at [${0}, ${0}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`),e,n)}get(t,e){var n;return!!this.mergedCellsMatrix.has(t)&&(null!==(n=this.mergedCellsMatrix.get(t).get(e))&&void 0!==n&&n)}getByRange(t){let e=!1;return jf(this.mergedCells,(n=>!(n.row<=t.from.row&&n.row+n.rowspan-1>=t.to.row&&n.col<=t.from.col&&n.col+n.colspan-1>=t.to.col)||(e=n,e))),e}filterOverlappingMergeCells(t){const e=new Set;this.mergedCells.forEach((t=>{const{row:n,col:o,colspan:i,rowspan:r}=t;for(let s=n;s<n+r;s++)for(let t=o;t<o+i;t++)e.add(`r${s},c${t}`)}));return t.filter((t=>{const{row:n,col:o,colspan:i,rowspan:r}=t,s=new Set;let l=!1;for(let a=n;a<n+r;a++){for(let n=o;n<o+i;n++){const o=`r${a},c${n}`;if(e.has(o)){Ub(pK.IS_OVERLAPPING_WARNING(t)),l=!0;break}s.add(o)}if(l)break}return l||e.add(...s),!l}))}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{row:n,col:o}=t.getTopStartCorner(),{row:i,col:r}=t.getBottomEndCorner(),s=[];for(let l=n;l<=i;l++)for(let t=o;t<=r;t++){const n=this.get(l,t);n&&(e||!e&&n.row===l&&n.col===t)&&s.push(n)}return s}add(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t.row,o=t.col,i=t.rowspan,r=t.colspan,s=new cK(n,o,i,r,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,o),a=!e&&this.isOverlapping(s);return l||a?(Ub(pK.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),this.mergedCells.push(s),gK(fK,this,wK).call(this,s),s)}remove(t,e){const n=this.get(t,e),o=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===o)&&(this.mergedCells.splice(o,1),gK(fK,this,bK).call(this,n),n)}clear(){jf(this.mergedCells,(t=>{let{row:e,col:n,rowspan:o,colspan:i}=t;Ay(e,e+o,(t=>{Ay(n,n+i,(e=>{const n=this.hot.getCell(t,e);n&&(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}))}))})),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(t){const e=t.getRange();for(let n=0;n<this.mergedCells.length;n++){if(this.mergedCells[n].getRange().overlaps(e))return!0}return!1}isFirstRenderableMergedCell(t,e){const n=this.get(t,e);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===e}getFirstRenderableCoords(t,e){const n=this.get(t,e);if(!n||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(o,i)}getStartMostColumnIndex(t,e){const n=gK(fK,this,mK).call(this,t,"col",-1);let o=e;for(let i=0;i<n.length;i++)if(n[i]<=e){o=n[i];break}return o}getEndMostColumnIndex(t,e){const n=gK(fK,this,mK).call(this,t,"col",1);let o=e;for(let i=0;i<n.length;i++)if(n[i]>=e){o=n[i];break}return o}getTopMostRowIndex(t,e){const n=gK(fK,this,mK).call(this,t,"row",-1);let o=e;for(let i=0;i<n.length;i++)if(n[i]<=e){o=n[i];break}return o}getBottomMostRowIndex(t,e){const n=gK(fK,this,mK).call(this,t,"row",1);let o=e;for(let i=0;i<n.length;i++)if(n[i]>=e){o=n[i];break}return o}shiftCollections(t,e,n){const o=[0,0];switch(t){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n}const i=[];this.mergedCells.forEach((t=>{t.shift(o,e),t.removed&&i.push(t)})),i.forEach((t=>{this.mergedCells.splice(this.mergedCells.indexOf(t),1)})),this.mergedCellsMatrix.clear(),this.mergedCells.forEach((t=>{gK(fK,this,wK).call(this,t)}))}}function mK(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const o=new Map,i=1===n?t.getTopStartCorner():t.getBottomEndCorner(),r=1===n?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;1===n?s<=r.row:s>=r.row;s+=n)for(let t=i.col;1===n?t<=r.col:t>=r.col;t+=n){const i="row"===e?s:t,r=this.get(s,t);let l=i;r&&(l=1===n?r[e]+r[`${e}span`]-1:r[e]),o.has(i)||o.set(i,new Set),o.get(i).add(l)}return Array.from(new Set(Array.from(o.entries()).filter((t=>{let[,e]=t;return 1===e.size})).flatMap((t=>{let[,e]=t;return Array.from(e)}))))}function wK(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function bK(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}const vK=pK;function yK(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const CK=class{constructor(t){yK(this,"plugin",void 0),yK(this,"mergedCellsCollection",void 0),yK(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){const e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){let n=null;return n=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",n}snapDragArea(t,e,n,o){const i=e.slice(0),r=this.getAutofillSize(t,e,n),[s,l,a,h]=t,c=["up","down"].indexOf(n)>-1?a-s+1:h-l+1,u=r-Math.floor(r/c)*c,d=this.getFarthestCollection(t,e,n,o);if(d)if("down"===n){const t=d.row+d.rowspan-s-u;i[2]+t>=this.plugin.hot.countRows()?i[2]-=u:i[2]+=u?t:0}else if("right"===n){const t=d.col+d.colspan-l-u;i[3]+t>=this.plugin.hot.countCols()?i[3]-=u:i[3]+=u?t:0}else if("up"===n){const t=a-u-d.row+1;i[0]+t<0?i[0]+=u:i[0]-=u?t:0}else if("left"===n){const t=h-u-d.col+1;i[1]+t<0?i[1]+=u:i[1]-=u?t:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:o,fillSize:r,dragArea:i,cycleLength:c}),i}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),pw(this.currentFillData,t)}getAutofillSize(t,e,n){const[o,i,r,s]=t,[l,a,h,c]=e;switch(n){case"up":return o-l;case"down":return h-r;case"left":return i-a;case"right":return c-s;default:return null}}getDragArea(t,e,n){const[o,i,r,s]=t,[l,a,h,c]=e;switch(n){case"up":return[l,a,o-1,s];case"down":return[r+1,i,h,s];case"left":return[l,a,r,i-1];case"right":return[o,s+1,h,c];default:return null}}getFarthestCollection(t,e,n,o){const[i,r,s,l]=t,a=["up","down"].indexOf(n)>-1,h=a?s:l,c=a?i:r,u=this.getAutofillSize(t,e,n),d=a?s-i+1:l-r+1,g=u-Math.floor(u/d)*d;let f=null,p=null,m=null;switch(n){case"up":f="includesVertically",m=h-g+1;break;case"left":f="includesHorizontally",m=h-g+1;break;case"down":f="includesVertically",m=c+g-1;break;case"right":f="includesHorizontally",m=c+g-1}return jf(o,(t=>{t[f](m)&&t.isFarther(p,n)&&(p=t)})),p}recreateAfterDataPopulation(t){if(!this.currentFillData)return;const e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,i=(t,n)=>{switch(o){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}};let r=0,s=null,l=1;do{for(let t=0;t<n.length;t+=1){if(s=n[t],r=l*this.currentFillData.cycleLength,i(s,r))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:s.row-r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-r,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+r,colspan:s.colspan})}t===n.length-1&&(l+=1)}}while(i(s,r));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){const e={min:null,max:null},n={min:null,max:null};return jf(t,(t=>{const o=t[0],i=this.plugin.hot.propToCol(t[1]);(null===e.min||o<e.min)&&(e.min=o),(null===e.max||o>e.max)&&(e.max=o),(null===n.min||i<n.min)&&(n.min=i),(null===n.max||i>n.max)&&(n.max=i)})),{from:{row:e.min,column:n.min},to:{row:e.max,column:n.max}}}dragAreaOverlapsCollections(t,e,n){const o=this.getDragArea(t,e,n),[i,r,s,l]=o,a=this.plugin.hot._createCellCoords(i,r),h=this.plugin.hot._createCellCoords(s,l),c=this.plugin.hot._createCellRange(a,a,h);return this.mergedCellsCollection.getWithinRange(c,!0).length>0}};function SK(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const RK=class{constructor(t){SK(this,"plugin",void 0),SK(this,"hot",void 0),SK(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}getSelectedMergedCellClassName(t,e,n,o){const i=Math.min(n[0],n[2]),r=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(void 0===o)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e))return;const a=this.plugin.mergedCellsCollection.get(t,e);if(!a)return;const h=a.getLastRow(),c=a.getLastColumn();return i<=a.row&&r<=a.col&&s>=h&&l>=c?`${this.fullySelectedMergedCellClassName}-${o}`:this.isMergeCellFullySelected(a,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){const n=[];if(!e||!t)return!1;for(let o=0;o<t.rowspan;o+=1)for(let e=0;e<t.colspan;e+=1)n.push(this.hot._createCellCoords(t.row+o,t.col+e));for(let o=0;o<n.length;o+=1){const t=[];for(let i=0;i<e.length;i+=1)t[i]=e[i].includes(n[o]);if(!t.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}};function xK(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class EK{constructor(t){xK(this,"data",void 0),xK(this,"next",null),xK(this,"prev",null),this.data=t}}const MK=class{constructor(){xK(this,"first",null),xK(this,"last",null)}push(t){const e=new EK(t);if(null===this.first)this.first=e,this.last=e;else{const t=this.last;this.last=e,e.prev=t,t.next=e}return e}unshift(t){const e=new EK(t);if(null===this.first)this.first=e,this.last=e;else{const t=this.first;this.first=e,e.next=t,t.prev=e}}inorder(t){let e=this.first;for(;e;){const n=t(e);if(e===this.last||!0===n)break;e=e.next}}remove(t){if(null===this.first)return!1;let e,n,o=this.first;for(;o;){if(o.data===t)return e=o.next,n=o.prev,e&&(e.prev=n),n&&(n.next=e),o===this.first&&(this.first=e),o===this.last&&(this.last=n),!0;o=o.next}return!1}hasCycle(){let t=this.first,e=this.first;for(;;){if(null===t)return!1;if(t=t.next,null===t)return!1;if(t=t.next,e=e.next,t===e)return!0}}pop(){if(null===this.last)return null;const t=this.last;return this.last=this.last.prev,t}shift(){if(null===this.first)return null;const t=this.first;return this.first=this.first.next,t}recursiveReverse(){if(!this.first)return;!function t(e,n){n&&(t(n,n.next),n.next=e)}(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let t,e=this.first.next,n=this.first;for(;e;)t=e.next,e.next=n,n.prev=e,n=e,e=t;this.first.next=null,this.last.prev=null,t=this.first,this.first=n,this.last=t}};function TK(t,e,n){kK(t,e),e.set(t,n)}function kK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AK(t,e){return t.get(IK(t,e))}function HK(t,e,n){return t.set(IK(t,e),n),n}function IK(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var OK=new WeakMap,_K=new WeakMap,PK=new WeakMap,NK=new WeakMap,DK=new WeakMap,LK=new WeakMap,VK=new WeakMap,FK=new WeakSet;class WK{constructor(t){let{mergedCellsGetter:e,rowIndexMapper:n,columnIndexMapper:o}=t;var i,r;kK(i=this,r=FK),r.add(i),TK(this,OK,new MK),TK(this,_K,new MK),TK(this,PK,null),TK(this,NK,null),TK(this,DK,null),TK(this,LK,null),TK(this,VK,null),HK(DK,this,e),HK(LK,this,n),HK(VK,this,o)}getCurrentVerticalNode(){return AK(NK,this).data}getFirstVerticalNode(){return AK(_K,this).first.data}getNextVerticalNode(){return AK(NK,this).next.data}getPrevVerticalNode(){return AK(NK,this).prev.data}getCurrentHorizontalNode(){return AK(PK,this).data}getFirstHorizontalNode(){return AK(OK,this).first.data}getNextHorizontalNode(){return AK(PK,this).next.data}getPrevHorizontalNode(){return AK(PK,this).prev.data}setPrevNodeAsActive(){HK(NK,this,AK(NK,this).prev),HK(PK,this,AK(PK,this).prev)}setNextNodeAsActive(){HK(NK,this,AK(NK,this).next),HK(PK,this,AK(PK,this).next)}buildFocusOrder(t){const e=t.getTopStartCorner(),n=t.getBottomEndCorner(),o=new WeakSet;HK(OK,this,new MK);for(let r=e.row;r<=n.row;r++)if(!AK(LK,this).isHidden(r))for(let i=e.col;i<=n.col;i++){if(AK(VK,this).isHidden(i))continue;const e=IK(FK,this,BK).call(this,t,AK(OK,this),o,r,i);e&&HK(PK,this,e)}AK(OK,this).first&&(AK(OK,this).first.prev=AK(OK,this).last,AK(OK,this).last.next=AK(OK,this).first);const i=new WeakSet;HK(_K,this,new MK);for(let r=e.col;r<=n.col;r++)if(!AK(VK,this).isHidden(r))for(let o=e.row;o<=n.row;o++){if(AK(LK,this).isHidden(o))continue;const e=IK(FK,this,BK).call(this,t,AK(_K,this),i,o,r);e&&HK(NK,this,e)}AK(_K,this).first&&(AK(_K,this).first.prev=AK(_K,this).last,AK(_K,this).last.next=AK(_K,this).first)}setActiveNode(t,e){return AK(OK,this).inorder((n=>{const{rowStart:o,rowEnd:i,colStart:r,colEnd:s}=n.data;if(t>=o&&t<=i&&e>=r&&e<=s)return HK(PK,this,n),!1})),AK(_K,this).inorder((n=>{const{rowStart:o,rowEnd:i,colStart:r,colEnd:s}=n.data;if(t>=o&&t<=i&&e>=r&&e<=s)return HK(NK,this,n),!1})),this}}function BK(t,e,n,o,i){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.highlight.clone().normalize(),a=AK(DK,this).call(this,o,i);if(a&&n.has(a))return null;const h={colStart:i,colEnd:i,rowStart:o,rowEnd:o};if(a){if(n.add(a),a.row<r.row||a.row+a.rowspan-1>s.row||a.col<r.col||a.col+a.colspan-1>s.col)return null;h.colStart=a.col,h.colEnd=a.col+a.colspan-1,h.rowStart=a.row,h.rowEnd=a.row+a.rowspan-1}const c=e.push(h);return o===l.row&&i===l.col||a&&l.row>=a.row&&l.row<=a.row+a.rowspan-1&&l.col>=a.col&&l.col<=a.col+a.colspan-1?c:null}function jK(t,e,n){zK(t,e),e.set(t,n)}function zK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UK(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YK(t,e,n){return t.set(GK(t,e),n),n}function $K(t,e){return t.get(GK(t,e))}function GK(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}tv.getSingleton().register("beforeMergeCells"),tv.getSingleton().register("afterMergeCells"),tv.getSingleton().register("beforeUnmergeCells"),tv.getSingleton().register("afterUnmergeCells");const KK="mergeCells",XK=KK;var qK=new WeakMap,ZK=new WeakMap,QK=new WeakMap,JK=new WeakMap,tX=new WeakSet;class eX extends P_{constructor(){var t,e;super(...arguments),zK(t=this,e=tX),e.add(t),UK(this,"mergedCellsCollection",null),UK(this,"autofillCalculations",null),UK(this,"selectionCalculations",null),jK(this,qK,null),jK(this,ZK,{row:0,col:0}),jK(this,QK,new WK({mergedCellsGetter:(t,e)=>this.mergedCellsCollection.get(t,e),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),jK(this,JK,function(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:o}=e;return{before:function(){},after:function(e,i,r){const s=t.mergedCellsCollection.get(i,r);if(!Cw(s))return e.removeAttribute("rowspan"),e.removeAttribute("colspan"),void(e.style.display="");const{row:l,col:a,colspan:h,rowspan:c}=s,[u,d]=t.translateMergedCellToRenderable(l,c,a,h),g=u-n.getRenderableFromVisualIndex(i)+1,f=d-o.getRenderableFromVisualIndex(r)+1,p=n.getNearestNotHiddenIndex(l,1),m=o.getNearestNotHiddenIndex(a,1),w=Math.min(c,g),b=Math.min(h,f);p===i&&m===r?(e.setAttribute("rowspan",w),e.setAttribute("colspan",b)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none")}}}(this))}static get PLUGIN_KEY(){return KK}static get PLUGIN_PRIORITY(){return 150}isEnabled(){return!!this.hot.getSettings()[KK]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new vK(this),this.autofillCalculations=new CK(this),this.selectionCalculations=new RK(this),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,nX).call(t,...n)})),this.addHook("modifyTransformFocus",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,iX).call(t,...n)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,rX).call(t,...n)})),this.addHook("modifyTransformEnd",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,sX).call(t,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,lX).call(t,...n)})),this.addHook("beforeSetRangeStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,cX).call(t,...n)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,cX).call(t,...n)})),this.addHook("beforeSelectionFocusSet",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,uX).call(t,...n)})),this.addHook("afterSelectionFocusSet",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,dX).call(t,...n)})),this.addHook("afterSelectionEnd",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,gX).call(t,...n)})),this.addHook("modifyGetCellCoords",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,aX).call(t,...n)})),this.addHook("afterIsMultipleSelection",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,oX).call(t,...n)})),this.addHook("afterRenderer",(function(){return $K(JK,t).after(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,hX).call(t,...n)})),this.addHook("afterGetCellMeta",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,fX).call(t,...n)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,pX).call(t,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,mX).call(t,...n)})),this.addHook("modifyAutofillRange",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,wX).call(t,...n)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,bX).call(t,...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,vX).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,yX).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,CX).call(t,...n)})),this.addHook("afterChange",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,SX).call(t,...n)})),this.addHook("beforeDrawBorders",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,RX).call(t,...n)})),this.addHook("afterDrawSelection",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,xX).call(t,...n)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,EX).call(t,...n)})),this.addHook("beforeBeginEditing",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,MX).call(t,...n)})),this.addHook("modifyRowHeightByOverlayName",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return GK(tX,t,TX).call(t,...n)})),this.addHook("beforeUndoStackChange",((t,e)=>{if("MergeCells"===e)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const t=this.hot.getSettings()[KK];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!jw())return;const t=[];let e=[];this.mergedCellsCollection.mergedCells.forEach((t=>{const{row:n,rowspan:o}=t;for(let i=n+1;i<n+o;i++)e.push(i)})),e=[...new Set(e)],e.forEach((e=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map((t=>"master"===(null==t?void 0:t.name)?t:t.clone.wtTable)).forEach((e=>{const o=e.getRow(n);o&&(o.style.background=sm(o,"backgroundColor").replace(")",", 0.99)"),t.push(o))}))})),this.hot._registerTimeout((()=>{t.forEach((t=>{t.style.background=sm(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(t){return!!t&&(cK.containsNegativeValues(t)?(Ub(cK.NEGATIVE_VALUES_WARNING(t)),!1):cK.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(Ub(cK.IS_OUT_OF_BOUNDS_WARNING(t)),!1):cK.isSingleCell(t)?(Ub(cK.IS_SINGLE_CELL(t)),!1):!cK.containsZeroSpan(t)||(Ub(cK.ZERO_SPAN_WARNING(t)),!1))}generateFromSettings(t){if(!Array.isArray(t))return;const e=t.filter((t=>this.validateSetting(t))),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),o=[];n.forEach((t=>{const{row:e,col:n,rowspan:i,colspan:r}=t,s=this.hot._createCellCoords(e,n),l=this.hot._createCellCoords(e+i-1,n+r-1),a=this.hot._createCellRange(s,s,l);this.mergeRange(a,!0,!0);for(let h=e;h<e+i;h++)for(let t=n;t<n+r;t++)h===e&&t===n||o.push([h,t,null])})),0!==o.length&&this.hot.setDataAtCell(o,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(t)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:n}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;const{from:e,to:n}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=t.getTopStartCorner(),i=t.getBottomEndCorner(),r={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},s=[];let l=null;if(!this.canMergeRange(r,e))return!1;this.hot.runHooks("beforeMergeCells",t,e),Ay(0,r.rowspan-1,(t=>{Ay(0,r.colspan-1,(e=>{let n=null;s[t]||(s[t]=[]),0===t&&0===e?n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+t,r.col+e,"hidden",!0),s[t][e]=n}))})),this.hot.setCellMeta(r.row,r.col,"spanned",!0);return!this.mergedCellsCollection.add(r,e)||(n?l=[r.row,r.col,s]:this.hot.populateFromArray(r.row,r.col,s,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,r,e),l)}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCellsCollection.getWithinRange(t);0!==n.length&&(this.hot.runHooks("beforeUnmergeCells",t,e),jf(n,(t=>{this.mergedCellsCollection.remove(t.row,t.col),Ay(0,t.rowspan-1,(e=>{Ay(0,t.colspan-1,(n=>{this.hot.removeCellMeta(t.row+e,t.col+n,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+n,"copyable")}))})),this.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){const e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,n,o){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(n,o);this.mergeRange(this.hot._createCellRange(i,i,r))}unmerge(t,e,n,o){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(n,o);this.unmergeRange(this.hot._createCellRange(i,i,r))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:XK})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(XK)}modifyViewportRowStart(t,e){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(t.startRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(o,i);if(Cw(r)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.row,1));if(o<t.startRow)return t.startRow=o,void this.modifyViewportRowStart(t,e)}}}modifyViewportRowEnd(t,e){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(t.endRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(o,i);if(Cw(r)){const o=r.row+r.rowspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(i>t.endRow)return t.endRow=i,void this.modifyViewportRowEnd(t,e)}}}modifyViewportColumnStart(t,e){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(t.startColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,o);if(Cw(r)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.col,1));if(o<t.startColumn)return t.startColumn=o,void this.modifyViewportColumnStart(t,e)}}}modifyViewportColumnEnd(t,e){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(t.endColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,o);if(Cw(r)){const o=r.col+r.colspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(i>t.endColumn)return t.endColumn=i,void this.modifyViewportColumnEnd(t,e)}}}translateMergedCellToRenderable(t,e,n,o){const{rowIndexMapper:i,columnIndexMapper:r}=this.hot;let s,l;s=0===e?i.getNearestNotHiddenIndex(t,1):i.getNearestNotHiddenIndex(t+e-1,-1),l=0===o?r.getNearestNotHiddenIndex(n,1):r.getNearestNotHiddenIndex(n+o-1,-1);return[t>=0?i.getRenderableFromVisualIndex(s):t,n>=0?r.getRenderableFromVisualIndex(l):n]}}function nX(){this.generateFromSettings(this.hot.getSettings()[KK]),this.hot.render()}function oX(t){if(t){const t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner(),o=e.getBottomEndCorner();for(let i=0;i<t.length;i+=1)if(n.row===t[i].row&&n.col===t[i].col&&o.row===t[i].row+t[i].rowspan-1&&o.col===t[i].col+t[i].colspan-1)return!1}return t}function iX(t){$K(ZK,this).row=t.row,$K(ZK,this).col=t.col}function rX(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:o,rowIndexMapper:i}=this.hot;$K(qK,this)&&(null!==i.getRenderableFromVisualIndex($K(qK,this).row)&&(n.row=$K(qK,this).row),null!==o.getRenderableFromVisualIndex($K(qK,this).col)&&(n.col=$K(qK,this).col),YK(qK,this,null));const r=this.mergedCellsCollection.get(n.row,n.col);if(!r)return;const s=r.col,l=r.col+r.colspan-1;if(t.col<0){const e=n.col>=s&&n.col<=l?s-1:l,i=o.getNearestNotHiddenIndex(e,-1);t.col=null===i?-this.hot.view.countRenderableColumnsInRange(0,n.col):-Math.max(this.hot.view.countRenderableColumnsInRange(i,n.col)-1,1)}else if(t.col>0){const e=n.col>=s&&n.col<=l?l+1:s,i=o.getNearestNotHiddenIndex(e,1);t.col=null===i?this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(n.col,i)-1,1)}const a=r.row,h=r.row+r.rowspan-1;if(t.row<0){const e=n.row>=a&&n.row<=h?a-1:h,o=i.getNearestNotHiddenIndex(e,-1);t.row=null===o?-this.hot.view.countRenderableRowsInRange(0,n.row):-Math.max(this.hot.view.countRenderableRowsInRange(o,n.row)-1,1)}else if(t.row>0){const e=n.row>=a&&n.row<=h?h+1:a,o=i.getNearestNotHiddenIndex(e,1);t.row=null===o?this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(n.row,o)-1,1)}}function sX(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:o}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot,s=(t,e)=>{n.expand(this.hot._createCellCoords(t,e));for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[o].getRange())};if(t.col<0){let r=this.mergedCellsCollection.getStartMostColumnIndex(e,o.col)+t.col;s(o.row,r),"E-W"===e.getHorizontalDirection()&&"E-W"===n.getHorizontalDirection()&&(r=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(r,1);null!==l&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,o.col)-1,1))}else if(t.col>0){let r=this.mergedCellsCollection.getEndMostColumnIndex(e,o.col)+t.col;s(o.row,r),"W-E"===e.getHorizontalDirection()&&"W-E"===n.getHorizontalDirection()&&(r=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(r,-1);null!==l&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(o.col,l)-1,1))}if(t.row<0){let i=this.mergedCellsCollection.getTopMostRowIndex(e,o.row)+t.row;s(i,o.col),"S-N"===e.getVerticalDirection()&&"S-N"===n.getVerticalDirection()&&(i=n.getTopStartCorner().row);const l=r.getNearestNotHiddenIndex(i,1);null!==l&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,o.row)-1,1))}else if(t.row>0){let i=this.mergedCellsCollection.getBottomMostRowIndex(e,o.row)+t.row;s(i,o.col),"N-S"===e.getVerticalDirection()&&"N-S"===n.getVerticalDirection()&&(i=n.getBottomStartCorner().row);const l=r.getNearestNotHiddenIndex(i,-1);null!==l&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(o.row,l)-1,1))}}function lX(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void YK(qK,this,e.clone());for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[o].getRange(),!1);for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[o].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);YK(qK,this,e.clone()),n&&e.assign(n)}function aX(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:o,col:i,colspan:r,rowspan:s}=n;return[o,i,o+s-1,i+r-1]}function hX(t){var e;t.items.push({name:"---------"},(e=this,{key:"mergeCells",name(){const t=this.getSelectedLast();if(t){const n=e.mergedCellsCollection.get(t[0],t[1]);if(n.row===t[0]&&n.col===t[1]&&n.row+n.rowspan-1===t[2]&&n.col+n.colspan-1===t[3])return this.getTranslatedPhrase(WM)}return this.getTranslatedPhrase(FM)},callback(){const t=this.getSelectedRangeLast();if(!t)return;t.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:o}=t;e.toggleMerge(t),this.selectCell(n.row,n.col,o.row,o.col,!1)},disabled(){const t=this.getSelectedLast();return!t||cK.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function cX(){YK(qK,this,null)}function uX(){if($K(qK,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),o=$K(qK,this).clone().normalize();$K(QK,this).setActiveNode(o.row,o.col),$K(ZK,this).row>0||$K(ZK,this).col>0?$K(QK,this).setPrevNodeAsActive():("E-W"===n&&$K(ZK,this).col<0||"S-N"===e&&$K(ZK,this).row<0)&&$K(QK,this).setNextNodeAsActive()}function dX(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:o,rowIndexMapper:i}=this.hot;let r=null,s=null;if($K(ZK,this).col<0){const{rowEnd:t,colEnd:e}=$K(QK,this).getPrevHorizontalNode();s=o.getNearestNotHiddenIndex(e,-1),r=i.getNearestNotHiddenIndex(t,-1)}else if($K(ZK,this).col>0){const{rowStart:t,colStart:e}=$K(QK,this).getNextHorizontalNode();s=o.getNearestNotHiddenIndex(e,1),r=i.getNearestNotHiddenIndex(t,1)}else if($K(ZK,this).row<0){const{rowEnd:t,colEnd:e}=$K(QK,this).getPrevVerticalNode();s=o.getNearestNotHiddenIndex(e,-1),r=i.getNearestNotHiddenIndex(t,-1)}else if($K(ZK,this).row>0){const{rowStart:t,colStart:e}=$K(QK,this).getNextVerticalNode();s=o.getNearestNotHiddenIndex(e,1),r=i.getNearestNotHiddenIndex(t,1)}if(null!==r||null!==s){const o=this.hot._createCellCoords(r,s),i=this.mergedCellsCollection.get(o.row,o.col),l=this.hot.selection.highlight.getFocus();t=o.row,e=o.col,i?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)}):n.highlight.assign(o),l.clear(),l.add(o).commit()}$K(QK,this).setActiveNode(t,e),YK(ZK,this,{row:0,col:0})}function gX(){this.hot.getSelectedRangeLast().isHeader()||$K(QK,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function fX(t,e,n){const o=this.mergedCellsCollection.get(t,e);o&&(o.row!==t||o.col!==e?n.copyable=!1:(n.rowspan=o.rowspan,n.colspan=o.colspan))}function pX(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function mX(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function wX(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let o=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,o,n))return o=e,o;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(i,i,r),l=this.mergedCellsCollection.getWithinRange(s);return 0===l.length||(o=this.autofillCalculations.snapDragArea(e,o,n,l)),o}function bX(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function vX(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function yX(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}function CX(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function SX(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function RX(t,e){if(e&&"area"===e){const e=this.hot.getSelectedRangeLast();jf(this.mergedCellsCollection.getWithinRange(e),(n=>{e.getBottomEndCorner().row===n.getLastRow()&&e.getBottomEndCorner().col===n.getLastColumn()&&(t[2]=n.row,t[3]=n.col)}))}}function xX(t,e,n,o){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,o)}function EX(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function MX(t,e,n,o){if(!(o instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getByRange(i);if(!r)return;const s=this.hot._createCellCoords(r.row,r.col),l=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1);return 0===this.hot.selection.getLayerLevel()&&i.isEqual(this.hot._createCellRange(s,s,l))}function TX(t,e,n){if(this.hot.getSettings().rowHeaders||"bottom"===n||"bottom_inline_start_corner"===n)return t;let o,i;if("master"===n)o=this.hot.view.getFirstRenderedVisibleColumn(),i=this.hot.view.getLastRenderedVisibleColumn();else{const t=this.hot.view.getOverlayByName(n);o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,o))return t;const r=this.hot._createCellCoords(e,o),s=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(r,r,s),a=this.mergedCellsCollection.getWithinRange(l),h=a.reduce(((t,e)=>{let{rowspan:n}=e;return Math.max(t,n)}),1);let c=0;return a.length>1&&a[0].rowspan<h&&(c=h-a[0].rowspan),a.forEach((o=>{var i;let{rowspan:r}=o,s=0;s="top"===n||"top_inline_start_corner"===n?Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-e):r-c,t=Math.max(null!==(i=t)&&void 0!==i?i:0,GK(tX,this,kX).call(this,e,s))})),t}function kX(t,e){const n=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),o=this.hot.getPlugin("autoRowSize");let i=0;for(let s=t;s<t+e;s++){var r;if(!this.hot.rowIndexMapper.isHidden(s))i+=null!==(r=null==o?void 0:o.getRowHeight(s))&&void 0!==r?r:n}return i}function AX(){Ub(Kf(D||(D=j`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)))}const HX="sort";function IX(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const OX="multiColumnSorting",_X="columnSorting",PX=OX;wN(OX,(function(t,e){return function(n,o){const[,...i]=n,[,...r]=o;return function n(o){const s=t[o],l=e[o],a=i[o],h=r[o],c=l.multiColumnSorting,u=(c.compareFunctionFactory?c.compareFunctionFactory:vN(l.type))(s,l,c)(a,h);if(u===yN){const t=o+1;if(void 0!==e[t])return n(t)}return u}(0)}}));class NX extends zN{constructor(){super(...arguments),IX(this,"pluginKey",OX)}static get PLUGIN_KEY(){return OX}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[_X]&&(AX(),this.hot.getPlugin(_X).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();return-1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,WN)),!1},runOnlyIf:()=>{var t,e;const n=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return n&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:GA,position:"before",group:PX})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PX)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];super.updateHeaderClasses(t,...n),jp(t,function(t){const e=t.className.split(" "),n=new RegExp(`^${HX}-[0-9]{1,2}$`);return e.filter((t=>n.test(t)))}(t)),!1!==this.enabled&&Bp(t,function(t,e,n){const o=[];return!1===n||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&o.push(`${HX}-${t.getIndexOfColumnInSortQueue(e)+1}`),o}(...n))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[_X]&&AX(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==HN(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,WN))):this.sort(this.getColumnNextConfig(e.col)))}}function DX(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class LX extends P_{constructor(){super(...arguments),DX(this,"dragged",[]),DX(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return Kw()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const t=this,{rootElement:e}=this.hot;function n(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;const n=t.dragged.indexOf(e);if(-1===n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1===n&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",(e=>{let n;return Wp(e.target,"topSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):Wp(e.target,"bottomSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(e,"touchend",(e=>Wp(e.target,"topSelectionHandle-HitArea")?(n.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):Wp(e.target,"bottomSelectionHandle-HitArea")?(n.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0)),this.eventManager.addEventListener(e,"touchmove",(e=>{const{rootDocument:n}=this.hot;let o,i,r,s,l,a;if(0===t.dragged.length)return;const h=n.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(o=t.hot.getCoords(h),-1===o.col&&(o.col=0),i=t.hot.getSelectedRangeLast(),r=i.getWidth(),s=i.getHeight(),l=i.getDirection(),1===r&&1===s&&t.hot.selection.setRangeEnd(o),a=t.getCurrentRangeCoords(i,o,t.touchStartRange.direction,l,t.dragged[0]),null!==a.start&&t.hot.selection.setRangeStart(a.start),t.hot.selection.setRangeEnd(a.end),t.lastSetCell=h),e.preventDefault())}))}getCurrentRangeCoords(t,e,n,o,i){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.getBottomStartCorner(),a=t.getTopEndCorner();let h={start:null,end:null};switch(n){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":h="top"===i?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,r.col)};break;case"SE-NW":"bottom"===i&&(h={start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,r.col)})}break;case"NW-SE":switch(o){case"NE-SW":"top"===i?h={start:e,end:l}:h.end=e;break;case"NW-SE":"top"===i?h={start:e,end:s}:h.end=e;break;case"SE-NW":"top"===i?h={start:e,end:r}:h.end=e;break;case"SW-NE":"top"===i?h={start:e,end:a}:h.end=e}break;case"SW-NE":switch(o){case"NW-SE":h="bottom"===i?{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(r.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SW-NE":h="top"===i?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)}:{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(r.row,e.col)};break;case"SE-NW":"bottom"===i?h={start:this.hot._createCellCoords(e.row,a.col),end:this.hot._createCellCoords(r.row,e.col)}:"top"===i&&(h={start:l,end:e})}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(h.end=e);break;case"SE-NW":"top"===i?h.end=e:h={start:e,end:r}}}return h}isDragged(){return this.dragged.length>0}}function VX(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:o=!1,crossHiddenColumns:i=[],isCollapsed:r=!1,isHidden:s=!1,isRoot:l=!1,isPlaceholder:a=!1,headerClassNames:h=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:o,isCollapsed:r,crossHiddenColumns:i,isHidden:s,isRoot:l,isPlaceholder:a,headerClassNames:h}}function FX(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function WX(t,e){return t.get(jX(t,e))}function BX(t,e,n){return t.set(jX(t,e),n),n}function jX(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zX=["label","collapsible"];var UX=new WeakMap,YX=new WeakMap,$X=new WeakMap;class GX{constructor(){FX(this,UX,[]),FX(this,YX,0),FX(this,$X,1/0)}setColumnsLimit(t){BX($X,this,t)}setData(){BX(UX,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=[];if(0===e)return n;jf(t,(t=>{const o=[];let i=0;n.push(o),jf(t,(t=>{const n=VX();if(Cw(t)){const{label:e,colspan:o,headerClassName:i}=t;n.label=Xf(e),"number"==typeof o&&o>1&&(n.colspan=o,n.origColspan=o),"string"==typeof i&&(n.headerClassNames=[...i.split(" ")])}else n.label=Xf(t);i+=n.origColspan;let r=!1;if(i>=e&&(n.colspan=n.origColspan-(i-e),n.origColspan=n.colspan,r=!0),o.push(n),n.colspan>1)for(let e=0;e<n.colspan-1;e++)o.push({label:"",isPlaceholder:!0});return!r}))}));const o=Math.max(...Bf(n,(t=>t.length)));return jf(n,(t=>{if(t.length<o){const e=Bf(new Array(o-t.length),(()=>VX()));t.splice(t.length,0,...e)}})),n}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],WX($X,this))),BX(YX,this,WX(UX,this).length)}getData(){return WX(UX,this)}mergeWith(t){jf(t,(t=>{let{row:e,col:n}=t,o=U(t,h);const i=this.getHeaderSettings(e,n);null!==i&&pw(i,o,zX)}))}map(t){jf(WX(UX,this),(e=>{jf(e,(e=>{const n=t($({},e));Cw(n)&&pw(e,n,zX)}))}))}getHeaderSettings(t,e){var n;if(t>=WX(YX,this)||t<0)return null;const o=WX(UX,this)[t];return!1===Array.isArray(o)||e>=o.length?null:null!==(n=o[e])&&void 0!==n?n:null}getHeadersSettings(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const o=[];if(t>=WX(YX,this)||t<0)return o;const i=WX(UX,this)[t];let r=0;for(let s=e;s<i.length;s++){const t=i[s];if(t.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=t.colspan,o.push(t),t.colspan>1&&(s+=t.colspan-1),r===n)break;if(r>n)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return WX(YX,this)}getColumnsCount(){return WX(YX,this)>0?WX(UX,this)[0].length:0}clear(){BX(UX,this,[]),BX(YX,this,0)}}function KX(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const XX="DF-pre-order";const qX=new Map([[XX,function t(e,n){let o=e.call(n,this);for(let i=0;i<this.childs.length;i++){if(!1===o)return!1;o=t.call(this.childs[i],e,n)}return o}],["DF-post-order",function t(e,n){for(let o=0;o<this.childs.length;o++){if(!1===t.call(this.childs[o],e,n))return!1}return e.call(n,this)}],["BF",function(t,e){const n=[this];!function o(){if(0===n.length)return;const i=n.shift();n.push(...i.childs),!1!==t.call(e,i)&&o()}()}]]);class ZX{constructor(t){KX(this,"data",{}),KX(this,"parent",null),KX(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const e=new ZX($({},t.data));for(let n=0;n<t.childs.length;n++)e.addChild(this.cloneTree(t.childs[n]));return e}replaceTreeWith(t){this.data=$({},t.data),this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!qX.has(e))throw new Error(`Traversal strategy "${e}" does not exist`);qX.get(e).call(this,t,this)}walkUp(t){const e=this,n=o=>{!1!==t.call(e,o)&&null!==o.parent&&n(o.parent)};n(this)}}function QX(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function JX(t,e){return t.get(tq(t,e))}function tq(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eq=new WeakMap,nq=new WeakMap,oq=new WeakMap;class iq{constructor(t){var e,n,o;QX(this,eq,new Map),QX(this,nq,new Map),QX(this,oq,null),n=this,o=t,(e=oq).set(tq(e,n),o)}getRoots(){return Array.from(JX(eq,this).values())}getRootByColumn(t){let e;return JX(nq,this).has(t)&&(e=JX(eq,this).get(JX(nq,this).get(t))),e}getNode(t,e){const n=this.getRootByColumn(e);if(!n)return;const o=e-JX(nq,this).get(e);let i,r=0;return n.walkDown((n=>{const{data:{origColspan:s,headerLevel:l}}=n;if(t===l){if(o>=r&&o<=r+s-1)return i=n,i.data.isRoot=e===i.data.columnIndex,!1;r+=s}})),i}rebuildTreeIndex(){let t=0;JX(nq,this).clear(),jf(JX(eq,this),(e=>{let[,{data:{colspan:n}}]=e;for(let o=t;o<t+n;o++)JX(nq,this).set(o,t);t+=n}))}buildTree(){this.clear();const t=JX(oq,this).getColumnsCount();let e=0;for(;e<t;){const t=JX(oq,this).getHeaderSettings(0,e),n=new ZX;JX(eq,this).set(e,n),this.buildLeaves(n,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=JX(oq,this).getHeadersSettings(n,e,o);n+=1,jf(i,(o=>{const i=$($({},o),{},{headerLevel:n-1,columnIndex:e});let r;1===n?(t.data=i,r=t):(r=new ZX(i),t.addChild(r)),n<JX(oq,this).getLayersCount()&&this.buildLeaves(r,e,n,o.origColspan),e+=o.origColspan}))}clear(){JX(eq,this).clear(),JX(nq,this).clear()}}function rq(t,e){t.walkDown((t=>{let{data:n,childs:o}=t;if(!n.isHidden&&(e(n.columnIndex),0===o.length))for(let i=1;i<n.colspan;i++)e(n.columnIndex+i)}))}function sq(t,e){let{childs:n}=t;if(0!==n.length)return n[0].data[e]}function lq(t){return sq(t,"origColspan")===t.data.origColspan}function aq(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(lq(t))return aq(n[0]);e.isCollapsed=!1;const o=n.slice(1),i=new Set;let r=0;if(o.length>0)jf(o,(t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;const e=t.data;r+=e.colspan,rq(t,(t=>{i.add(t)}))}));else{const{colspan:t,origColspan:n,columnIndex:o}=e;r=n-t;for(let e=1;e<n;e++)i.add(o+e)}return t.walkUp((t=>{const{data:e}=t;e.colspan+=r,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):lq(t)&&(e.isCollapsed=sq(t,"isCollapsed"))})),{rollbackModification:()=>hq(t),affectedColumns:Array.from(i),colspanCompensation:r}}function hq(t){var e;const{data:n,childs:o}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(lq(t))return hq(o[0]);n.isCollapsed=!0;const i=o.slice(1),r=new Set;if(i.length>0)jf(i,(t=>{rq(t,(t=>{r.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((t=>{let{data:e}=t;e.isHidden=!0}))}));else{const{origColspan:t,columnIndex:e}=n;for(let n=1;n<t;n++){const t=e+n;r.add(t)}}const s=n.colspan-(null!==(e=sq(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((t=>{const{data:e}=t;e.colspan-=s,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):lq(t)&&(e.isCollapsed=sq(t,"isCollapsed"))})),{rollbackModification:()=>aq(t),affectedColumns:Array.from(r),colspanCompensation:s}}const cq=new Map([["collapse",hq],["expand",aq],["hide-column",function(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Kf(L||(L=j`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`)));const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let o=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return o=!0,!1})),o||t.walkUp((t=>{const{data:n}=t;n.crossHiddenColumns.push(e),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}],["show-column",function(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Kf(V||(V=j`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`)));const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let o=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return o=!0,!1})),o||t.walkUp((t=>{const{data:n}=t;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(e),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}]]);function uq(t){const e=[];return jf(t,(t=>{t.walkDown((t=>{const n=t.data,{origColspan:o,columnIndex:i,headerLevel:r,crossHiddenColumns:s}=n,l=function(t,e){let n;Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n);return n}(e,r);let a=!1;for(let e=i;e<i+o;e++){if(s.includes(e)||a)l.push({label:"",isPlaceholder:!0});else{const t=dq(n);t.isRoot=!0,l.push(t),a=!0}}}))})),e}function dq(t){const e=VX(t),{crossHiddenColumns:n}=e;return U(e,c)}function gq(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function fq(t,e,n){return t.set(mq(t,e),n),n}function pq(t,e){return t.get(mq(t,e))}function mq(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wq=new WeakMap,bq=new WeakMap,vq=new WeakMap;class yq{constructor(){gq(this,wq,new GX),gq(this,bq,new iq(pq(wq,this))),gq(this,vq,[[]])}setState(t){pq(wq,this).setData(t);let e=!1;try{pq(bq,this).buildTree()}catch(n){pq(bq,this).clear(),pq(wq,this).clear(),e=!0}return fq(vq,this,uq(pq(bq,this).getRoots())),e}setColumnsLimit(t){pq(wq,this).setColumnsLimit(t)}mergeStateWith(t){const e=Bf(t,(t=>{let{row:e}=t,n=U(t,u);return $({row:e<0?this.rowCoordsToLevel(e):e},n)}));pq(wq,this).mergeWith(e),pq(bq,this).buildTree(),fq(vq,this,uq(pq(bq,this).getRoots()))}mapState(t){pq(wq,this).map(t),pq(bq,this).buildTree(),fq(vq,this,uq(pq(bq,this).getRoots()))}mapNodes(t){return Ff(pq(bq,this).getRoots(),((e,n)=>(n.walkDown((n=>{const o=t(n.data);void 0!==o&&e.push(o)})),e)),[])}triggerNodeModification(t,e,n){e<0&&(e=this.rowCoordsToLevel(e));const o=pq(bq,this).getNode(e,n);let i;return o&&(i=function(t,e,n){if(!cq.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return cq.get(t)(e,n)}(t,o,n),fq(vq,this,uq(pq(bq,this).getRoots()))),i}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;const e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;const e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var n,o;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(n=null===(o=pq(vq,this)[t])||void 0===o?void 0:o[e])&&void 0!==n?n:null}getHeaderTreeNodeData(t,e){const n=this.getHeaderTreeNode(t,e);return n?$({},n.data):null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;const n=pq(bq,this).getNode(t,e);return n||null}findTopMostEntireHeaderLevel(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const o=n-t+1;let i=!1,r=null;for(let s=t;s<=n;s++){const e=pq(bq,this).getRootByColumn(s);if(!e)break;i=!0,e.walkDown((e=>{const{columnIndex:i,headerLevel:s,origColspan:l,isHidden:a}=e.data;a||l<=o&&i>=t&&i+l-1<=n&&(null===r||s<r)&&(r=s)}),XX)}return i&&null===r?-1:this.levelToRowCoords(null!==(e=r)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var n;const{isRoot:o}=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0};if(o)return e;let i=e-1;for(;i>=0;){var r;const{isRoot:e}=null!==(r=this.getHeaderSettings(t,i))&&void 0!==r?r:{isRoot:!0};if(e)break;i-=1}return i}findRightMostColumnIndex(t,e){var n;const{isRoot:o,origColspan:i}=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0,origColspan:1};if(o)return e+i-1;let r=e+1;for(;r<this.getColumnsCount();){var s;const{isRoot:e}=null!==(s=this.getHeaderSettings(t,r))&&void 0!==s?s:{isRoot:!0};if(e)break;r+=1}return r-1}getLayersCount(){return pq(wq,this).getLayersCount()}getColumnsCount(){return pq(wq,this).getColumnsCount()}clear(){fq(vq,this,[]),pq(wq,this).clear(),pq(bq,this).clear()}}function Cq(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Sq=class{constructor(t,e){Cq(this,"hot",void 0),Cq(this,"nestedHeaderSettingsGetter",void 0),Cq(this,"layersCount",0),Cq(this,"container",void 0),Cq(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let n=0;n<e;n++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(o,t[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){const{rootDocument:e,columnIndexMapper:n}=this.hot,o=e.createDocumentFragment(),i=e.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,s=n.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const t=e.createElement("tr");for(let o=0;o<s;o++){let i=n.getVisualFromRenderableIndex(o);null===i&&(i=o);const s=e.createElement("th"),a=this.nestedHeaderSettingsGetter(l,i);if(a&&(!a.isPlaceholder||a.isHidden)){let e=a.label;r&&(e+='<button class="changeType"></button>'),Kp(s,e),s.colSpan=a.colspan,t.appendChild(s)}}i.appendChild(t)}o.appendChild(i),t.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}};function Rq(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xq(t,e,n){Eq(t,e),e.set(t,n)}function Eq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mq(t,e,n){return t.set(kq(t,e),n),n}function Tq(t,e){return t.get(kq(t,e))}function kq(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Aq="nestedHeaders";var Hq=new WeakMap,Iq=new WeakMap,Oq=new WeakMap,_q=new WeakMap,Pq=new WeakSet;class Nq extends P_{constructor(){var t,e;super(...arguments),Eq(t=this,e=Pq),e.add(t),xq(this,Hq,new yq),xq(this,Iq,null),xq(this,Oq,null),xq(this,_q,!1),Rq(this,"ghostTable",new Sq(this.hot,((t,e)=>this.getHeaderSettings(t,e)))),Rq(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return Aq}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[Aq]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||Ub(Kf(F||(F=j`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`))),this.addHook("init",(()=>kq(Pq,this,Qq).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Jq).call(t,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Wq).call(t,...n)})),this.addHook("afterOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Bq).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,jq).call(t,...n)})),this.addHook("beforeOnCellMouseUp",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,zq).call(t,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Uq).call(t,...n)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Yq).call(t,...n)})),this.addHook("afterSelection",(()=>kq(Pq,this,Dq).call(this))),this.addHook("afterSelectionFocusSet",(()=>kq(Pq,this,Dq).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Lq).call(t,...n)})),this.addHook("afterGetColumnHeaderRenderers",(t=>kq(Pq,this,Gq).call(this,t))),this.addHook("modifyColWidth",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Xq).call(t,...n)})),this.addHook("modifyColumnHeaderValue",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,qq).call(t,...n)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Vq).call(t,...n)})),this.addHook("beforeCopy",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Fq).call(t,...n)})),this.addHook("beforeSelectColumns",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,$q).call(t,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Kq).call(t,...n)})),this.addHook("modifyFocusedElement",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return kq(Pq,t,Zq).call(t,...n)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>kq(Pq,this,Dq).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>kq(Pq,this,Dq).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:t}=this.hot.getSettings();Tq(Hq,this).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=Tq(Hq,this).setState(t)),this.detectedOverlappedHeaders&&Ub(Kf(W||(W=j`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((t,e)=>{const n=!0===t?"hide-column":"show-column";Tq(Hq,this).triggerColumnModification(n,e)})),!Tq(Iq,this)&&this.enabled&&Mq(Iq,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((t=>{t.forEach((t=>{let{op:e,index:n,newValue:o}=t;if("replace"===e){const t=!0===o?"hide-column":"show-column";Tq(Hq,this).triggerColumnModification(t,n)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Tq(Hq,this).clear(),Tq(Iq,this).unsubscribe(),Mq(Iq,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Tq(Hq,this)}getLayersCount(){return Tq(Hq,this).getLayersCount()}getHeaderSettings(t,e){return Tq(Hq,this).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;const{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,n=t.wtTable.THEAD,o=t.wtOverlays.topOverlay.clone.wtTable.THEAD,i=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<e;r++){const t=n.childNodes[r];if(!t)break;const e=o.childNodes[r],s=i?i.childNodes[r]:null;for(let n=0,o=t.childNodes.length;n<o;n++)t.childNodes[n].removeAttribute("colspan"),jp(t.childNodes[n],"hiddenHeader"),e&&e.childNodes[n]&&(e.childNodes[n].removeAttribute("colspan"),jp(e.childNodes[n],"hiddenHeader")),i&&s&&s.childNodes[n]&&(s.childNodes[n].removeAttribute("colspan"),jp(s.childNodes[n],"hiddenHeader"))}}headerRendererFactory(t){var e=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,i)=>{var r;const{columnIndexMapper:s,view:l}=this.hot;let a=s.getVisualFromRenderableIndex(o);null===a&&(a=o),i.removeAttribute("colspan"),jp(i,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:u,headerClassNames:d}=null!==(r=Tq(Hq,this).getHeaderSettings(t,a))&&void 0!==r?r:{label:""};if(u||c)Bp(i,"hiddenHeader");else if(h>1){var g,f;const{wtOverlays:t}=l._wt,e=null===(g=t.topInlineStartCornerOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i),r=null===(f=t.inlineStartOverlay)||void 0===f?void 0:f.clone.wtTable.THEAD.contains(i),s=e||r?Math.min(h,n-o):h;s>1&&i.setAttribute("colspan",s)}if(this.hot.view.appendColHeader(a,i,(function(){return e.getColumnHeaderValue(...arguments)}),t),!u&&!c){const t=i.querySelector("div.relative");t&&d&&d.length>0&&(jp(t,this.hot.getColumnMeta(a).headerClassName),Bp(t,d))}}}getColumnHeaderValue(t,e){var n;const{isHidden:o,isPlaceholder:i}=null!==(n=Tq(Hq,this).getHeaderSettings(e,t))&&void 0!==n?n:{};return i||o?"":this.hot.getColHeader(t,e)}destroy(){Mq(Hq,this,null),null!==Tq(Iq,this)&&(Tq(Iq,this).unsubscribe(),Mq(Iq,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0||t.col<0))return Tq(Hq,this).getHeaderTreeNodeData(t.row,t.col)}}function Dq(){var t;const e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const t=Tq(Hq,this).findLeftMostColumnIndex(n.row,n.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function Lq(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const o=this.hot.view.getFirstFullyVisibleColumn(),i=this.hot.view.getLastFullyVisibleColumn(),r=Tq(Hq,this).findLeftMostColumnIndex(n.row,n.col),s=Tq(Hq,this).findRightMostColumnIndex(n.row,n.col);return r<o&&s>i?t:r<o?r:s}function Vq(t,e,n){const o=Tq(Hq,this).getHeaderTreeNodeData(e,t);if(!o)return t;const{columnCursor:i,selectionType:r,selectionWidth:s}=n,{isRoot:l,colspan:a}=Tq(Hq,this).getHeaderSettings(e,t);if(r===XR){if(!l)return o.columnIndex}else if(r===KR&&(a>s-i||!l))return null;return t}function Fq(t,e,n){let{columnHeadersCount:o}=n;if(0!==o)for(let r=0;r<e.length;r++){const{startRow:n,startCol:o,endRow:s,endCol:l}=e[r],a=s-n+1;if(n>=0||1===o-l+1)break;for(let e=o;e<=l;e++)for(let r=n;r<=s;r++){var i;const n=a+r,s=e-o;if(0===s)continue;!1===(null===(i=Tq(Hq,this).getHeaderTreeNodeData(r,e))||void 0===i?void 0:i.isRoot)&&(t[n][s]="")}}}function Wq(t,e,n,o){this._getHeaderTreeNodeDataByCoords(e)&&(o.column=!0)}function Bq(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Mq(Oq,this,e.clone()),Mq(_q,this,!0);const{selection:o}=this.hot,i=o.isSelected()?o.getSelectedRange().current():null,r=[],{columnIndex:s,origColspan:l}=n,a=!o.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?r.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?r.push(i.getTopStartCorner().col,s+l-1,e.row):r.push(s,s+l-1,e.row):(cb(t)||hb(t)&&a||ub(t))&&r.push(s,s+l-1,e.row),o.selectColumns(...r)}function jq(t,e,n,o){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:r,origColspan:s}=i,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:c}=l;o.column=!0,o.cell=!0;const u=[],d=Oy(e.row,-1/0,-1);e.col<c.col?u.push(h.col,r,d):e.col>c.col?u.push(a.col,r+s-1,d):u.push(r,r+s-1,d),this.hot.selection.selectColumns(...u)}function zq(){Mq(_q,this,!1)}function Uq(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Tq(_q,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,o=e.getBottomEndCorner().col,{columnIndex:i,origColspan:r}=Tq(Hq,this).getHeaderTreeNodeData(Tq(Oq,this).row,Tq(Oq,this).col);if(e.setHighlight(Tq(Oq,this)),r>e.getWidth()||i<n||i+r-1>o){const t=Tq(Hq,this).findTopMostEntireHeaderLevel(Oy(n,i,i+r-1),Oy(o,i,i+r-1));e.highlight.row=t,e.highlight.col=e.from.col}}function Yq(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const o=Tq(Hq,this).findLeftMostColumnIndex(n.row,n.col),i=Tq(Hq,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const n=e.col>=o&&e.col<=i?o-1:i,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,-1);t.col=null===r?-this.hot.view.countRenderableColumnsInRange(0,e.col):-Math.max(this.hot.view.countRenderableColumnsInRange(r,e.col)-1,1)}else if(t.col>0){const n=e.col>=o&&e.col<=i?i+1:o,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,1);t.col=null===r?this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(e.col,r)-1,1)}}function $q(t,e){const n=t.row,o=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(o&&(t.col=o.columnIndex+o.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(o&&(t.col=o.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Gq(t){t.length=0;for(let e=0;e<Tq(Hq,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Kq(t){const e=Tq(Hq,this).getLayersCount();let n=t.startColumn,o=!!e;for(let i=0;i<e;i++){const e=Tq(Hq,this).findLeftMostColumnIndex(i,t.startColumn),r=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(o=!1),Ty(r)&&r<t.startColumn){n=r;break}}t.startColumn=o?Tq(Hq,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Xq(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function qq(t,e,n){var o;const{label:i}=null!==(o=Tq(Hq,this).getHeaderTreeNodeData(n,e))&&void 0!==o?o:{label:""};return i}function Zq(t,e){if(t<0)return this.hot.getCell(t,Tq(Hq,this).findLeftMostColumnIndex(t,e),!0)}function Qq(){this.updatePlugin()}function Jq(t,e){e||this.updatePlugin()}function tZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const eZ=class{constructor(t,e){tZ(this,"hot",void 0),tZ(this,"data",null),tZ(this,"plugin",void 0),tZ(this,"parentReference",new WeakMap),tZ(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ay(0,this.data.length-1,(t=>{this.cacheNode(this.data[t],0,null)}))}cacheNode(t,e,n){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&jf(t.__children,(n=>{this.cacheNode(n,e+1,t)}))}getDataObject(t){return null==t?null:this.cache.rows[t]}readTreeNodes(t,e,n,o){let i=!1,r=e;if(isNaN(r)&&r.end)return r;let s=t;return s||(s={__children:this.data},i=!0,r-=1),null!=n&&r===n?{result:s,end:!0}:null!=o&&s===o?{result:r,end:!0}:(r+=1,s.__children&&jf(s.__children,(t=>{if(this.parentReference.set(t,i?null:s),r=this.readTreeNodes(t,r,n,o),isNaN(r)&&r.end)return!1})),r)}mockParent(){const t=this.mockNode();return t.__children=this.data,t}mockNode(){const t={};return Rw(this.data[0],((e,n)=>{t[n]=null})),t}getRowIndex(t){return null==t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);const n=this.getRowParent(t);return null==n?this.data.indexOf(e):n.__children.indexOf(e)}countAllRows(){const t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(jf(n.__children,(t=>{e+=1,t.__children&&(e+=this.countChildren(t))})),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"==typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null==t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var n;return(null===(n=t.__children)||void 0===n?void 0:n[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(e=n.__children)||void 0===e?void 0:e.length)}addChild(t,e){let n=e;this.hot.runHooks("beforeAddChild",t,n);let o=null;t&&(o=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(t)+1,1);let i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();const r=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",t,n)}addChildAtIndex(t,e,n){let o,i=n;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",t,i,e),t){const n=this.getRowIndex(t)+e+1;this.hot.runHooks("beforeCreateRow",n,1),t.__children.splice(e,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(n,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",n,1),o=n}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[e]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",t,i,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const n=this.translateTrimmedRow(t),o=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(o,i+1,null);break;case"above":this.addChildAtIndex(o,i,null)}}detachFromParent(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;const o=[];Array.isArray(t)?(Ay(t[0],t[2],(t=>{const e=this.translateTrimmedRow(t);o.push(this.getDataObject(e))})),Ay(0,o.length-2,(t=>{this.detachFromParent(o[t],!1)})),n=o[o.length-1]):n=t;const i=this.getRowIndex(n),r=this.countChildren(n),s=this.getRowIndexWithinParent(n),l=this.getRowParent(n),a=this.getRowParent(l),h=this.getRowIndex(a);let c=null;if(this.hot.runHooks("beforeDetachChild",l,n),null!=s){const t=Array.from(new Array(i+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",i,r+1,t,this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,r+1,t,this.plugin.pluginName),a){c=h+this.countChildren(a);const t=this.getChild(a,this.countChildren(a)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,r+1,this.plugin.pluginName),a.__children.push(n)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,r+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,n,this.getRowIndex(n)),e&&this.hot.render()}filterData(t,e,n){const o=[];jf(n,(t=>{o.push(this.getDataObject(t))})),jf(o,(t=>{const e=this.getRowIndexWithinParent(t),n=this.getRowParent(t);null===n?this.data.splice(e,1):n.__children.splice(e,1)})),this.rewriteCache()}spliceData(t,e,n){const o=this.getDataObject(t-1);let i=null,r=t;o&&o.__children&&0===o.__children.length?(i=o,r=0):t<this.countAllRows()&&(i=this.getRowParent(t),r=this.getRowIndexWithinParent(t)),i?n?i.__children.splice(r,e,...n):i.__children.splice(r,e):n?this.data.splice(r,e,...n):this.data.splice(r,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,n=null;do{n=this.getRowParent(n),null!==n&&(e=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,n,o){const i=e===this.hot.countRows(),r=this.getRowParent(t),s=this.getRowIndexWithinParent(t),l=r.__children.slice(s,s+1),a=t>e;let h=i?this.getRowParent(e-1):this.getRowParent(e);null==h&&(h=this.getRowParent(e-1)),null==h&&(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e),h.__children=[]);const c=i||n||o?h.__children.length:this.getRowIndexWithinParent(e),u=r===h;h.__children.splice(c,0,l[0]),r.__children.splice(s+(a&&u?1:0),1),this.syncRowWithRawSource(r),u||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}};function nZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const oZ=class{constructor(t,e){nZ(this,"hot",void 0),nZ(this,"plugin",void 0),this.hot=e,this.plugin=t}};class iZ extends oZ{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){const n=this.hot.toPhysicalRow(t),o=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),r=e.getElementsByTagName("DIV")[0],s=r.querySelector("span.rowHeader"),l=r.querySelectorAll('[class^="ht_nesting"]'),a=this.hot.getSettings().ariaTags;if(jf(l,(t=>{t&&r.removeChild(t)})),Bp(e,iZ.CSS_CLASSES.indicatorContainer),o){const{rootDocument:t}=this.hot,e=s.cloneNode(!0);r.innerHTML="",Ay(0,o-1,(()=>{const e=t.createElement("SPAN");Bp(e,iZ.CSS_CLASSES.emptyIndicator),r.appendChild(e)})),r.appendChild(e)}if(this.dataManager.hasChildren(i)){const t=this.hot.rootDocument.createElement("DIV");a&&zp(t,[["aria-hidden","true"]]),Bp(e,iZ.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(Bp(t,`${iZ.CSS_CLASSES.button} ${iZ.CSS_CLASSES.expandButton}`),a&&zp(e,[Ep(!1)])):(Bp(t,`${iZ.CSS_CLASSES.button} ${iZ.CSS_CLASSES.collapseButton}`),a&&zp(e,[Ep(!0)])),r.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}const rZ=iZ;const sZ=class extends oZ{constructor(t,e){var n;super(t,e),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,t)},shiftStash:function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==e&&(e=1/0),jf(n.lastCollapsedRows,((i,r)=>{i>=t&&i<e&&(n.lastCollapsedRows[r]=i+o)}))},applyStash:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,t),n.lastCollapsedRows=void 0},trimStash:(t,e)=>{Ay(t,t+e-1,(t=>{const e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)}))}}}collapseChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),r=t),this.dataManager.hasChildren(i)&&jf(i.__children,(t=>{o.push(this.dataManager.getRowIndex(t))})),s=this.collapseRows(o,!0,!1),n&&this.trimRows(s),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(r)&&this.collapsedRows.push(r),s}collapseMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];jf(t,(t=>{o.push(...this.collapseChildren(t,!1,!1))})),n&&this.trimRows(o),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=[];return jf(t,(t=>{o.push(t),e&&this.collapseChildRows(t,o)})),n&&this.trimRows(o),o}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){jf(this.dataManager.getDataObject(t).__children,(t=>{const n=this.dataManager.getRowIndex(t);e.push(n),this.collapseChildRows(n,e)}))}n&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=[];return jf(t,(t=>{o.push(t),e&&this.expandChildRows(t,o)})),n&&this.untrimRows(o),o}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){jf(this.dataManager.getDataObject(t).__children,(t=>{if(!this.isAnyParentCollapsed(t)){const n=this.dataManager.getRowIndex(t);e.push(n),this.expandChildRows(n,e)}}))}n&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),r=t),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(i)&&jf(i.__children,(t=>{const e=this.dataManager.getRowIndex(t);o.push(e)})),s=this.expandRows(o,!0,!1),n&&this.untrimRows(s),e&&this.renderAndAdjust(),s}expandMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];jf(t,(t=>{o.push(...this.expandChildren(t,!1,!1))})),n&&this.untrimRows(o),e&&this.renderAndAdjust()}collapseAll(){const t=this.dataManager.getData(),e=[];jf(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){const t=this.dataManager.getData(),e=[];jf(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution((()=>{jf(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}untrimRows(t){this.hot.batchExecution((()=>{jf(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),n=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&jf(e.__children,(t=>{const e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return n=!1,!1})),n}isAnyParentCollapsed(t){let e=t;for(;null!==e;){e=this.dataManager.getRowParent(e);const t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;const n=this.translateTrimmedRow(e.row);Wp(t.target,rZ.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),lb(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};function lZ(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function aZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hZ(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var cZ=new WeakMap;const uZ=class extends oZ{constructor(){super(...arguments),aZ(this,"dataManager",this.plugin.dataManager),lZ(this,cZ,{row_above:(t,e)=>{const n=e[e.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(t,e)=>{const n=e[e.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(t){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(rT)},callback:()=>{const t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{const t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(sT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]);return!this.dataManager.getRowParent(e)||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ay(0,t.items.length-1,(n=>{if(0===n)return jf(e,((e,o)=>{t.items.splice(n+o,0,e)})),!1})),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return Ay(0,t.items.length-1,(e=>{const n=hZ(cZ,this)[t.items[e].key];null!=n&&(t.items[e].callback=n)})),t}};function dZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class gZ{constructor(t){dZ(this,"plugin",void 0),dZ(this,"hot",void 0),dZ(this,"dataManager",void 0),dZ(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,n,o){if(this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:n,movePossible:o}))return!1;this.movedToCollapsed=!1;const i=n===this.hot.countRows(),r=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let s=!0;const l=t.map((t=>{if(!s)return!1;const e=this.dataManager.translateTrimmedRow(t);return s=this.shouldAllowMoving(e,r),e})),a=-1===l.indexOf(r);if(!s||!a)return!1;const h=this.getBaseParent(l),c=this.getTargetParent(i,r),u=h===c;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(c),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(l,r,u),this.moveRows(l,r,c),this.dataManager.rewriteCache(),this.moveCellsMeta(l,r),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,n,o,o&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,n),!1}displayAPICompatibilityWarning(t){const{rows:e,finalIndex:n,dropIndex:o,movePossible:i}=t;let r=!1;return Zf(o)&&(Ub(Kf(B||(B=j`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`))),this.hot.runHooks("afterRowMove",e,n,o,i,!1),r=!0),r}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let n=this.dataManager.getRowParent(t?e-1:e);return null==n&&(n=this.dataManager.getRowParent(e-1)),n}shiftCollapsibleParentsLocations(t,e,n){n||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,n){const o=e===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((()=>{t.forEach((t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,o)}))}))}moveCellsMeta(t,e){const n=[],o=Math.max(...t)<e;t.forEach((t=>{n.push(this.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(o?n.length:0),0,...n)}selectCells(t,e){const n=t.length;let o=0,i=0,r=null,s=null;if(this.movedToCollapsed){let r=null;r=t[n-1]<e?this.dataManager.translateTrimmedRow(e-n):this.dataManager.translateTrimmedRow(e);const s=this.dataManager.getRowParent(null===r?this.hot.countSourceRows()-1:r-1),l=this.dataManager.getRowIndex(s);o=this.dataManager.untranslateTrimmedRow(l),i=o}else t[n-1]<e?(i=e-1,o=i-n+1):(o=e,i=o+n-1);r=this.hot.selection,s=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(o,0)),r.setRangeEnd(this.hot._createCellCoords(i,s),!0)}isRowOrderChanged(t,e){return t.some(((t,n)=>t-n!==e))}}function fZ(t,e,n){pZ(t,e),e.set(t,n)}function pZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wZ(t,e){return t.get(vZ(t,e))}function bZ(t,e,n){return t.set(vZ(t,e),n),n}function vZ(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yZ="nestedRows",CZ=yZ;var SZ=new WeakMap,RZ=new WeakMap,xZ=new WeakSet;class EZ extends P_{constructor(){var t,e;super(...arguments),pZ(t=this,e=xZ),e.add(t),mZ(this,"dataManager",null),mZ(this,"headersUI",null),mZ(this,"collapsedRowsMap",null),fZ(this,SZ,!1),fZ(this,RZ,!1)}static get PLUGIN_KEY(){return yZ}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[yZ]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new zE),this.dataManager=new eZ(this,this.hot),this.collapsingUI=new sZ(this,this.hot),this.headersUI=new rZ(this,this.hot),this.contextMenuUI=new uZ(this,this.hot),this.rowMoveController=new gZ(this),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,FZ).call(t,...n)})),this.addHook("beforeViewRender",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,WZ).call(t,...n)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,kZ).call(t,...n)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,AZ).call(t,...n)})),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,HZ).call(t,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,TZ).call(t,...n)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,_Z).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,OZ).call(t,...n)})),this.addHook("beforeAddChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,PZ).call(t,...n)})),this.addHook("afterAddChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,NZ).call(t,...n)})),this.addHook("beforeDetachChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,DZ).call(t,...n)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,LZ).call(t,...n)})),this.addHook("modifyRowHeaderWidth",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,IZ).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,VZ).call(t,...n)})),this.addHook("beforeRowMove",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return vZ(xZ,t,MZ).call(t,...n)})),this.addHook("beforeLoadData",(t=>vZ(xZ,this,BZ).call(this,t))),this.addHook("beforeUpdateData",(t=>vZ(xZ,this,BZ).call(this,t))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast(),e=this.collapsingUI.translateTrimmedRow(t.row);return this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e),!1},runOnlyIf:()=>{var t,e;const n=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return n&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.col&&n.row>=0},group:CZ,relativeToGroup:GA,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(CZ)}disableCoreAPIModifiers(){bZ(RZ,this,!0)}enableCoreAPIModifiers(){bZ(RZ,this,!1)}onModifyRowData(t){if(!wZ(RZ,this))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!wZ(RZ,this))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,n){return!(!wZ(RZ,this)&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,n),!1)}destroy(){super.destroy()}}function MZ(t,e,n,o){return this.rowMoveController.onBeforeRowMove(t,e,n,o)}function TZ(t,e,n){this.collapsingUI.toggleState(t,e,n)}function kZ(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),bZ(SZ,this,!0),this.dataManager.getData().slice()}function AZ(t){return this.contextMenuUI.appendOptions(t)}function HZ(t,e){this.headersUI.appendLevelIndicators(t,e)}function IZ(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function OZ(t,e,n,o){o!==this.pluginName&&this.hot._registerTimeout((()=>{bZ(SZ,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}))}function _Z(t,e,n){const o=Array.from(n.reduce(((t,e)=>{if(this.dataManager.isParent(e)){const n=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(n)&&n.forEach((e=>t.add(this.dataManager.getRowIndex(e)))),t}return t.add(e)}),new Set));n.length=0,n.push(...o)}function PZ(){this.collapsingUI.collapsedRowsStash.stash()}function NZ(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function DZ(){this.collapsingUI.collapsedRowsStash.stash()}function LZ(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function VZ(){this.dataManager.rewriteCache()}function FZ(){this.headersUI.updateRowHeaderWidth()}function WZ(t,e){wZ(SZ,this)&&(e.skipRender=!0)}function BZ(t){if(!TE(t))return Yb("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[yZ]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}function jZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const zZ=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;jZ(this,"rootWindow",void 0),jZ(this,"prefix",void 0),jZ(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){const n=void 0===t?e:t,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return null===o?void 0:JSON.parse(o)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){jf(this.savedKeys,((t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)})),this.clearSavedKeys()}loadSavedKeys(){const t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};function UZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}tv.getSingleton().register("persistentStateSave"),tv.getSingleton().register("persistentStateLoad"),tv.getSingleton().register("persistentStateReset");const YZ="persistentState";class $Z extends P_{constructor(){super(...arguments),UZ(this,"storage",void 0)}static get PLUGIN_KEY(){return YZ}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[YZ]}enablePlugin(){this.enabled||(this.storage||(this.storage=new zZ(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((t,e)=>this.saveValue(t,e))),this.addHook("persistentStateLoad",((t,e)=>this.loadValue(t,e))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}function GZ(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function KZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XZ(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qZ="search",ZZ=function(t,e,n,o,i){t.getCellMeta(e,n).isSearchResult=i},QZ=function(t,e,n){return!(Zf(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!Zf(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale)))};var JZ=new WeakSet;class tQ extends P_{constructor(){super(...arguments),GZ(this,JZ),KZ(this,"callback",ZZ),KZ(this,"queryMethod",QZ),KZ(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return qZ}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[qZ]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[qZ];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return XZ(JZ,t,eQ).call(t,...n)})),super.enablePlugin()}disablePlugin(){var t=this;const e=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return XZ(JZ,t,eQ).call(t,...n)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",e)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),i=this.hot.countCols(),r=[],s=this.hot;return Ay(0,o-1,(o=>{Ay(0,i-1,(i=>{const l=this.hot.getDataAtCell(o,i),a=this.hot.getCellMeta(o,i),h=a.search.callback||e,c=(a.search.queryMethod||n)(t,l,a);if(c){const t={row:o,col:i,data:l};r.push(t)}h&&h(s,o,i,l,c)}))})),r}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){Cw(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}function eQ(t,e,n,o,i,r){const s=r.className||[];let l=[];"string"==typeof s?l=s.split(" "):l.push(...s),this.isEnabled()&&r.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),r.className=l.join(" ")}function nQ(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function oQ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iQ(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rQ=new WeakSet;class sQ extends P_{constructor(){super(...arguments),nQ(this,rQ),oQ(this,"scrollbars",[]),oQ(this,"clones",[]),oQ(this,"lockedCollection",!1),oQ(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return Ow()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>iQ(rQ,this,lQ).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>iQ(rQ,this,aQ).call(this))),this.addHook("afterMomentumScroll",(()=>iQ(rQ,this,hQ).call(this)))}}function lQ(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function aQ(){this.freezeOverlays=!0,jf(this.clones,(t=>{Bp(t,"hide-tween")}))}function hQ(){this.freezeOverlays=!1,jf(this.clones,(t=>{jp(t,"hide-tween"),Bp(t,"show-tween")})),this.hot._registerTimeout((()=>{jf(this.clones,(t=>{jp(t,"show-tween")}))}),400),jf(this.scrollbars,(t=>{t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function cQ(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function uQ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const dQ="trimRows";var gQ=new WeakSet;class fQ extends P_{constructor(){super(...arguments),cQ(this,gQ),uQ(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return dQ}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[dQ]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new zE),this.trimmedRowsMap.addLocalHook("init",(()=>function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(gQ,this,pQ).call(this))),super.enablePlugin())}updatePlugin(){const t=this.hot.getSettings()[dQ];Array.isArray(t)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),jf(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){const e=this.getTrimmedRows(),n=this.isValidConfig(t);let o=e;n&&(o=Array.from(new Set(e.concat(t))));!1!==this.hot.runHooks("beforeTrimRow",e,o,n)&&(n&&this.hot.batchExecution((()=>{jf(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",e,o,n,n&&o.length>e.length))}trimRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}untrimRows(t){const e=this.getTrimmedRows(),n=this.isValidConfig(t);let o=e;const i=this.trimmedRowsMap.getValues().slice(),r=t.length>0;n&&r&&(jf(t,(t=>{i[t]=!1})),o=Ff(i,((t,e,n)=>(e&&t.push(n),t)),[]));!1!==this.hot.runHooks("beforeUntrimRow",e,o,n&&r)&&(n&&r&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",e,o,n&&r,n&&o.length<e.length))}untrimRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){const e=this.hot.countSourceRows();return t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}destroy(){super.destroy()}}function pQ(){const t=this.hot.getSettings()[dQ];Array.isArray(t)&&this.hot.batchExecution((()=>{jf(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}var mQ={},wQ=mQ,bQ=an("iterator"),vQ=Array.prototype,yQ=_r,CQ=Me,SQ=Vt,RQ=mQ,xQ=an("iterator"),EQ=function(t){if(!SQ(t))return CQ(t,xQ)||CQ(t,"@@iterator")||RQ[yQ(t)]},MQ=mt,TQ=Re,kQ=Fn,AQ=ve,HQ=EQ,IQ=TypeError,OQ=Ma,_Q=mt,PQ=Fn,NQ=ve,DQ=function(t){return void 0!==t&&(wQ.Array===t||vQ[bQ]===t)},LQ=pi,VQ=Qt,FQ=function(t,e){var n=arguments.length<2?HQ(t):e;if(TQ(n))return kQ(MQ(n,t));throw new IQ(AQ(t)+" is not iterable")},WQ=EQ,BQ=Nl,jQ=TypeError,zQ=function(t,e){this.stopped=t,this.result=e},UQ=zQ.prototype,YQ=dt,$Q=Pn,GQ=Rt,KQ=function(t,e,n){var o,i,r,s,l,a,h,c=n&&n.that,u=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_RECORD),g=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),p=OQ(e,c),m=function(t){return o&&BQ(o,"normal",t),new zQ(!0,t)},w=function(t){return u?(PQ(t),f?p(t[0],t[1],m):p(t[0],t[1])):f?p(t,m):p(t)};if(d)o=t.iterator;else if(g)o=t;else{if(!(i=WQ(t)))throw new jQ(NQ(t)+" is not iterable");if(DQ(i)){for(r=0,s=LQ(t);s>r;r++)if((l=w(t[r]))&&VQ(UQ,l))return l;return new zQ(!1)}o=FQ(t,i)}for(a=d?t.next:o.next;!(h=_Q(a,o)).done;){try{l=w(h.value)}catch(Yb){BQ(o,"throw",Yb)}if("object"==typeof l&&l&&VQ(UQ,l))return l}return new zQ(!1)},XQ=function(t,e,n){YQ?$Q.f(t,e,GQ(0,n)):t[e]=n};ir({target:"Object",stat:!0},{fromEntries:function(t){var e={};return KQ(t,(function(t,n){XQ(e,t,n)}),{AS_ENTRIES:!0}),e}});const qQ="undoRedo";function ZQ(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(n,o){const i=n&&n.length;if(!i)return;if(!n.find((t=>{const[,,e,n]=t;return e!==n})))return;e.done((()=>{const e=n.reduce(((t,e)=>(t.push([...e]),t)),[]);jf(e,(e=>{e[1]=t.propToCol(e[1])}));const o=i>1?this.getSelected():[[e[0][0],e[0][1]]];return new ZQ.ChangeAction(e,o)}),o)})),t.addHook("afterCreateRow",((t,n,o)=>{e.done((()=>new ZQ.CreateRowAction(t,n)),o)}));const n=(e,n,o,i)=>{const r=["visualRow","visualCol","row","col","prop"],s=r.length,l=[];return Ay(o,i,(o=>{Ay(e,n,(e=>{const n=t.getCellMeta(e,o);if(Object.keys(n).length!==s){const t=Object.fromEntries(Object.entries(n).filter((t=>{let[e]=t;return!1===r.includes(e)})));l.push([n.visualRow,n.visualCol,t])}}))})),l};t.addHook("beforeRemoveRow",((o,i,r,s)=>{e.done((()=>{const r=t.toPhysicalRow(o),s=r+i-1,l=ww(e.instance.getSourceData(r,0,r+i-1,e.instance.countSourceCols()-1));return new ZQ.RemoveRowAction(r,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(r,s,0,t.countCols()-1))}),s)})),t.addHook("afterCreateCol",((t,n,o)=>{e.done((()=>new ZQ.CreateColumnAction(t,n)),o)})),t.addHook("beforeRemoveCol",((o,i,r,s)=>{e.done((()=>{const r=e.instance.getSourceDataArray(),s=(e.instance.countCols()+o)%e.instance.countCols(),l=s+i-1,a=[],h=[],c=[];Ay(r.length-1,(e=>{const n=[],o=r[e];Ay(s,l,(e=>{n.push(o[t.toPhysicalColumn(e)])})),a.push(n)})),Ay(i-1,(e=>{c.push(t.toPhysicalColumn(s+e))})),Array.isArray(t.getSettings().colHeaders)&&Ay(i-1,(e=>{h.push(t.getSettings().colHeaders[t.toPhysicalColumn(s+e)]||null)}));const u=t.columnIndexMapper.getIndexesSequence(),d=t.rowIndexMapper.getIndexesSequence();return new ZQ.RemoveColumnAction(s,c,a,h,u,d,t.getSettings().fixedColumnsStart,n(0,t.countRows(),s,l))}),s)})),t.addHook("beforeCellAlignment",((t,n,o,i)=>{e.done((()=>new ZQ.CellAlignmentAction(t,n,o,i)))})),t.addHook("beforeFilter",((t,n)=>{e.done((()=>new ZQ.FiltersAction(t,n)))})),t.addHook("beforeRowMove",((t,n)=>{!1!==t&&e.done((()=>new ZQ.RowMoveAction(t,n)))})),t.addHook("beforeColumnMove",((t,n)=>{!1!==t&&e.done((()=>new ZQ.ColumnMoveAction(t,n)))})),t.addHook("beforeMergeCells",((n,o)=>{o||e.done((()=>new ZQ.MergeCellsAction(t,n)))})),t.addHook("afterUnmergeCells",((n,o)=>{o||e.done((()=>new ZQ.UnmergeCellsAction(t,n)))})),t.addHook("beforeColumnSort",((t,n,o)=>{o&&e.done((()=>new ZQ.ColumnSortAction(t,n)))})),t.addHook("afterInit",(()=>{e.init()}))}ZQ.prototype.done=function(t,e){if(this.ignoreNewActions)return;if("UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e)return;const n=this.doneActions.slice();if(!1===this.instance.runHooks("beforeUndoStackChange",n,e))return;const o=t(),i=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice())},ZQ.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=ww(e);if(!1===this.instance.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;const o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,(()=>{o.ignoreNewActions=!1,o.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},ZQ.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=ww(e);if(!1===this.instance.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;const o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,(()=>{o.ignoreNewActions=!1,o.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},ZQ.prototype.isUndoAvailable=function(){return this.doneActions.length>0},ZQ.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},ZQ.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},ZQ.prototype.isEnabled=function(){return this.enabled},ZQ.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;var e;this.enabled=!0,(e=t).undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()},this.registerShortcuts(),t.addHook("afterChange",tJ)},ZQ.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;var e;this.enabled=!1,delete(e=t).undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo,this.unregisterShortcuts(),t.removeHook("afterChange",tJ)},ZQ.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},ZQ.Action=function(){},ZQ.Action.prototype.undo=function(){},ZQ.Action.prototype.redo=function(){},ZQ.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},fw(ZQ.ChangeAction,ZQ.Action),ZQ.ChangeAction.prototype.undo=function(t,e){const n=ww(this.changes),o=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let s=0,l=n.length;s<l;s++)n[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let s=0,l=n.length;s<l;s++){const[e,r]=n[s];t.getSettings().minSpareRows&&e+1+t.getSettings().minSpareRows===t.countRows()&&o===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(e+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&r+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(r+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const r=t.getSelectedLast();if(void 0!==r){const[e,o]=n[0],[i,s]=r,l=e>=t.view.getFirstFullyVisibleRow(),a=o>=t.view.getFirstFullyVisibleColumn();if(!1===(l&&a)&&!0===(i!==e||s!==o)){const n={row:e,col:o};!1===l&&(n.verticalSnap="top"),!1===a&&(n.horizontalSnap="start"),t.scrollViewportTo(n)}}t.selectCells(this.selected,!1,!1)},ZQ.ChangeAction.prototype.redo=function(t,e){const n=ww(this.changes);for(let o=0,i=n.length;o<i;o++)n[o].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},ZQ.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},fw(ZQ.CreateRowAction,ZQ.Action),ZQ.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),o=t.getSettings().minSpareRows;this.index>=n&&this.index-o<n&&(this.index-=o),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},ZQ.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},ZQ.RemoveRowAction=function(t,e,n,o,i,r){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=o,this.rowIndexesSequence=i,this.removedCellMetas=r},fw(ZQ.RemoveRowAction,ZQ.Action),ZQ.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((t,e)=>{Object.keys(t).forEach((n=>{const i=parseInt(n,10);o.push([this.index+e,isNaN(i)?n:i,t[n]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach((e=>{let[n,o,i]=e;t.setCellMetaObject(n,o,i)})),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},ZQ.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},ZQ.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},fw(ZQ.CreateColumnAction,ZQ.Action),ZQ.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},ZQ.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},ZQ.RemoveColumnAction=function(t,e,n,o,i,r,s,l){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=o,this.columnPositions=i.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=l},fw(ZQ.RemoveColumnAction,ZQ.Action),ZQ.RemoveColumnAction.prototype.undo=function(t,e){t.getSettings().fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),o=(t,e,o)=>o[this.indexes.indexOf(n[e])],i=this.data.length,r=[];for(let a=0;a<i;a++)r.push(Bf(this.data[a],o));const s=Bf(this.headers,o),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),jf(t.getSourceDataArray(),((t,e)=>{jf(n,((n,o)=>{t[n]=r[e][o],l.push([e,n,t[n]])}))})),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&jf(s,((e,o)=>{t.getSettings().colHeaders[n[o]]=e})),this.removedCellMetas.forEach((e=>{let[n,o,i]=e;t.setCellMetaObject(n,o,i)})),t.batchExecution((()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},ZQ.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},ZQ.CellAlignmentAction=function(t,e,n,o){this.stateBefore=t,this.range=e,this.type=n,this.alignment=o},ZQ.CellAlignmentAction.prototype.undo=function(t,e){jf(this.range,(e=>{e.forAll(((e,n)=>{e>=0&&n>=0&&t.setCellMeta(e,n,"className",this.stateBefore[e][n]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},ZQ.CellAlignmentAction.prototype.redo=function(t,e){ND(this.range,this.type,this.alignment,((e,n)=>t.getCellMeta(e,n)),((e,n,o,i)=>t.setCellMeta(e,n,o,i))),t.addHookOnce("afterViewRender",e),t.render()},ZQ.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"},fw(ZQ.FiltersAction,ZQ.Action),ZQ.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&n.conditionCollection.importAllConditions(this.previousConditionsStack),n.filter()},ZQ.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class QQ extends ZQ.Action{constructor(t,e){super(),this.cellRange=e;const n=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(n.row,n.col,o.row,o.col)}undo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();t.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange)}}ZQ.MergeCellsAction=QQ;class JQ extends ZQ.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange,!0)}redo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}function tJ(t,e){if("loadData"===e)return this.undoRedo.clear()}ZQ.UnmergeCellsAction=JQ,ZQ.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"},fw(ZQ.RowMoveAction,ZQ.Action),ZQ.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e);Wz(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach((t=>{let{from:e,to:o}=t;e<o&&(o-=1),n.moveRow(o,e)})),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},ZQ.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},ZQ.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"},fw(ZQ.ColumnMoveAction,ZQ.Action),ZQ.ColumnMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e);Wz(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach((t=>{let{from:e,to:o}=t;e<o&&(o-=1),n.moveColumn(o,e)})),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},ZQ.ColumnMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),n.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},ZQ.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e},fw(ZQ.ColumnSortAction,ZQ.Action),ZQ.ColumnSortAction.prototype.undo=function(t,e){const n=t.getPlugin("columnSorting"),o=t.getPlugin("multiColumnSorting"),i=o.isEnabled()?o:n;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()},ZQ.ColumnSortAction.prototype.redo=function(t,e){const n=t.getPlugin("columnSorting"),o=t.getPlugin("multiColumnSorting");(o.isEnabled()?o:n).sort(this.nextSortState),e()},ZQ.prototype.init=function(){const t=this.instance.getSettings().undo,e=void 0===t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},ZQ.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager().getContext("grid"),e={runOnlyIf:t=>!t.altKey,group:qQ};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],e)},ZQ.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(qQ)};const eJ=tv.getSingleton();var nJ,oJ,iJ,rJ,sJ;eJ.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),eJ.register("beforeUndo"),eJ.register("afterUndo"),eJ.register("beforeRedo"),eJ.register("afterRedo"),ZQ.PLUGIN_KEY="undoRedo",ZQ.SETTING_KEYS=!0,dv(JA),dv(nO),dv(oO),dv(_O),dv(PO),dv(ZI),dv(NO),dv(DO),dv(FO),dv(cI),dv(WO),tC(jO),tC(uI),tC(qO),tC(zO),tC(QO),tC(BO),tC(n_),tC(o_),tC(i_),tC(dI),tC(r_),lC(s_),lC(u_),lC(c_),lC(d_),lC(f_),yA(p_),yA(m_),yA(b_),yA(v_),yA(y_),yA(C_),yA(S_),yA(R_),yA(gI),yA(x_),Gy(Z_),Gy(dP),Gy(EP),Gy(UP),Gy(iN),Gy(zN),Gy(nD),Gy(SL),Gy(kV),Gy(pF),Gy(jF),Gy(qF),Gy(lW),Gy(kW),Gy(pz),Gy(xU),Gy(iY),Gy(yY),Gy(PY),Gy(c$),Gy(B$),Gy(vG),Gy(qG),Gy(eX),Gy(NX),Gy(LX),Gy(Nq),Gy(EZ),Gy($Z),Gy(tQ),Gy(sQ),Gy(fQ),Gy(ZQ),function(t){const e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){const n=this.first();let o,i=n.data("handsontable");if("string"!=typeof e){const o=e||{};return i?i.updateSettings(o):(i=new t.Core(n[0],o),n.data("handsontable",i),i.init()),n}if(i){if(void 0===i[e])throw new Error(`Handsontable do not provide action: ${e}`);for(var r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];o=i[e].call(i,...s),"destroy"===e&&n.removeData()}return o})}(fI),fI.__GhostTable=L_,fI._getListenersCounter=function(){return fv},fI._getRegisteredMapsCounter=function(){return XE},fI.EventManager=pv;const lJ=[Gf,Jw,kE,h_,Dw,Dm,cp,_y,Aw,wp,sb,My],aJ=[Am,gb];fI.helper={},fI.dom={},jf(lJ,(t=>{jf(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(fI.helper[e]=t[e])}))})),jf(aJ,(t=>{jf(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(fI.dom[e]=t[e])}))})),fI.cellTypes=null!==(nJ=fI.cellTypes)&&void 0!==nJ?nJ:{},jf(wA(),(t=>{fI.cellTypes[t]=vA(t)})),fI.cellTypes.registerCellType=yA,fI.cellTypes.getCellType=vA,fI.editors=null!==(oJ=fI.editors)&&void 0!==oJ?oJ:{},jf(lv(),(t=>{fI.editors[`${up(t)}Editor`]=uv(t)})),fI.editors.registerEditor=dv,fI.editors.getEditor=uv,fI.renderers=null!==(iJ=fI.renderers)&&void 0!==iJ?iJ:{},jf(Zy(),(t=>{const e=Jy(t);"base"===t&&(fI.renderers.cellDecorator=e),fI.renderers[`${up(t)}Renderer`]=e})),fI.renderers.registerRenderer=tC,fI.renderers.getRenderer=Jy,fI.validators=null!==(rJ=fI.validators)&&void 0!==rJ?rJ:{},jf(iC(),(t=>{fI.validators[`${up(t)}Validator`]=sC(t)})),fI.validators.registerValidator=lC,fI.validators.getValidator=sC,fI.plugins=null!==(sJ=fI.plugins)&&void 0!==sJ?sJ:{},jf(Yy(),(t=>{fI.plugins[t]=$y(t)})),fI.plugins[`${up(P_.PLUGIN_KEY)}Plugin`]=P_,fI.plugins.registerPlugin=Gy,fI.plugins.getPlugin=$y;ok({languageCode:"zh-CN",[SM]:"上方插入行",[RM]:"下方插入行",[xM]:"左方插入列",[EM]:"右方插入列",[MM]:["移除该行","移除多行"],[TM]:["移除该列","移除多列"],[kM]:"撤销",[AM]:"恢复",[HM]:"只读",[IM]:"清空该列",[YM]:"对齐",[$M]:"左对齐",[GM]:"水平居中",[KM]:"右对齐",[XM]:"两端对齐",[qM]:"顶端对齐",[ZM]:"垂直居中",[QM]:"底端对齐",[LM]:"冻结该列",[VM]:"取消冻结",[JM]:"边框",[tT]:"上",[eT]:"右",[nT]:"下",[oT]:"左",[iT]:"移除边框",[BM]:"插入批注",[jM]:"编辑批注",[zM]:"删除批注",[UM]:"只读批注",[FM]:"合并",[WM]:"取消合并",[OM]:"复制",[_M]:"带标题的复制",[PM]:"带标题组的复制",[NM]:"仅复制标题",[DM]:"剪切",[rT]:"插入子行",[sT]:"与母行分离",[lT]:["隐藏该列","隐藏多列"],[aT]:["显示该列","显示多列"],[hT]:["隐藏该行","隐藏多行"],[cT]:["显示该行","显示多行"],[gT]:"无",[fT]:"为空",[pT]:"不为空",[mT]:"等于",[wT]:"不等于",[bT]:"开头是",[vT]:"结尾是",[yT]:"包含",[CT]:"不包含",[RT]:"大于",[xT]:"大于或等于",[ET]:"小于",[MT]:"小于或等于",[TT]:"在此范围",[kT]:"不在此范围",[AT]:"之后",[HT]:"之前",[IT]:"今天",[OT]:"明天",[_T]:"昨天",[VT]:"空白单元格",[PT]:"按条件过滤",[NT]:"按值过滤",[DT]:"且",[LT]:"或",[FT]:"全选",[WT]:"清除",[BT]:"确认",[jT]:"取消",[zT]:"搜索",[UT]:"值",[YT]:"第二值"});fI.renderers.registerRenderer("styleRender",(function(t,e,n,o,i,r,s){if(fI.renderers.getRenderer("text")(t,e,n,o,i,r,s),s.style){const t=e.style;Object.assign(t,s.style)}}));const hJ=J({__name:"XlsxTable",props:{data:null,type:null},setup(t){const e=t,n=q(null),o=q([]),i=q(0);let r;const s={language:"zh-CN",colHeaders:!0,rowHeaders:!0,autoRowSize:!1,autoColumnSize:!1,height:"100%",cells(t,e){var n;const o=null===(n=r)||void 0===n?void 0:n.cell;return o&&Object.keys(o).length?o[function(t,e){return`${t}-${e}`}(t,e)]:{}},columns(t){var e;const n=null===(e=r)||void 0===e?void 0:e.columns;return null!=n&&n.length?n[t]:{}},colWidths(t){var e,n;const o=null===(e=r)||void 0===e?void 0:e.colWidths;return"number"==typeof o?o:o&&o[t]||(null===(n=r)||void 0===n?void 0:n.defaults.colWidth)},rowHeights(t){var e,n;const o=null===(e=r)||void 0===e?void 0:e.rowHeights;return"number"==typeof o?o:o&&o[t]||(null===(n=r)||void 0===n?void 0:n.defaults.rowHeight)},outsideClickDeselects:!1,licenseKey:"non-commercial-and-evaluation"},l=tt((()=>{var t;return null===(t=n.value)||void 0===t?void 0:t.hotInstance})),a=()=>"binary"===e.type?XI.create():KI.create(),{loading:h,worker:c,onWorkerEvent:u}=(t=>{const e=q(!0),n=t(),o={emit:(t,o)=>{e.value=!0,null==n||n.postMessage({type:t,payload:o})}},i={},r=[],s=[];return null==n||n.addEventListener("message",(t=>{const{type:e,payload:n}=t.data,o=i[e];null!=o&&o.length&&o.forEach((t=>t(n))),r.forEach((e=>e(t)))})),null==n||n.addEventListener("error",(t=>{console.error(t),s.forEach((e=>e(t)))})),Q((()=>{null==n||n.terminate()})),{loading:e,worker:o,onWorkerMessage:t=>r.push(t),onWorkerError:t=>s.push(t),onWorkerEvent:(t,e)=>{let n=i[t];n||(n=i[t]=[]),n.push(e)},mapEvents:t=>Array.isArray(t)?t.reduce(((t,e)=>(t[e]=t=>o.emit(e,t),t)),{}):Object.keys(t).reduce(((e,n)=>(e[t[n]]=t=>o.emit(n,t),e)),{})}})(a),d=()=>ot((()=>{setTimeout((()=>{var t,e,n;null===(t=l.value)||void 0===t||t.updateSettings({data:null===(e=r)||void 0===e?void 0:e.data,mergeCells:null===(n=r)||void 0===n?void 0:n.merge})}),0)}));return u("sheets",(({sheets:t})=>{if(o.value=t,t.length){const[{id:e}]=t;i.value=e,c.emit("parseSheet",{sheet:i.value})}})),u("parseSheet",(({sheetData:t})=>{r=t,d()})),et((()=>e.data),(()=>{c.emit("parseWorkbook",{workbook:e.data})})),nt((()=>{var t;null===(t=l.value)||void 0===t||t.addHook("afterUpdateSettings",(()=>h.value=!1)),c.emit("parseWorkbook",{workbook:e.data})})),{__sfc:!0,props:e,table:n,sheets:o,sheetIndex:i,sheetData:r,hotSettings:s,tableInstance:l,compositeWorkerFactory:a,loading:h,worker:c,onWorkerEvent:u,handleSheet:t=>{var e;i.value!==t&&(i.value=t,c.emit("parseSheet",{sheet:null!==(e=i.value)&&void 0!==e?e:o.value[0].id}))},updateTable:d,HotTable:VI}}}),cJ=""+new URL("xlsx-08add3c8.png",G.meta.url).href,uJ=""+new URL("loading-43b144a3.gif",G.meta.url).href;Y("default",it(hJ,(function(){var t=this,e=t._self._c,n=t._self._setupProxy;return e("div",{staticClass:"excel-wrapper"},[n.loading?e("div",{staticClass:"loading"},[e("img",{staticClass:"lg",attrs:{src:cJ,alt:"xlsx"}}),e("img",{staticClass:"sm",attrs:{src:uJ,alt:"loading"}}),t._v(" 加载中，请耐心等待... ")]):t._e(),e("div",{staticClass:"table-wrapper"},[e(n.HotTable,{ref:"table",attrs:{settings:n.hotSettings}})],1),e("div",{staticClass:"btn-group"},t._l(n.sheets,(function(o){return e("button",{key:o.id,class:{active:n.sheetIndex===o.id},staticStyle:{padding:"0 30px"},on:{click:function(t){return n.handleSheet(o.id)}}},[t._v(" "+t._s(o.name)+" ")])})),0)])}),[],!1,null,"d33b0ee8",null,null).exports)}}}))}();
